"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "_rsc_lib_auth-local_js-_ee010";
exports.ids = ["_rsc_lib_auth-local_js-_ee010"];
exports.modules = {

/***/ "(rsc)/./lib/auth-local.js":
/*!***************************!*\
  !*** ./lib/auth-local.js ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createUser: () => (/* binding */ createUser),\n/* harmony export */   generateToken: () => (/* binding */ generateToken),\n/* harmony export */   getUserById: () => (/* binding */ getUserById),\n/* harmony export */   getUserFromToken: () => (/* binding */ getUserFromToken),\n/* harmony export */   hashPassword: () => (/* binding */ hashPassword),\n/* harmony export */   signIn: () => (/* binding */ signIn),\n/* harmony export */   verifyPassword: () => (/* binding */ verifyPassword),\n/* harmony export */   verifyToken: () => (/* binding */ verifyToken)\n/* harmony export */ });\n/* harmony import */ var bcryptjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! bcryptjs */ \"(rsc)/./node_modules/bcryptjs/index.js\");\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! jsonwebtoken */ \"(rsc)/./node_modules/jsonwebtoken/index.js\");\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(jsonwebtoken__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _db_local__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./db-local */ \"(rsc)/./lib/db-local.js\");\n// Local Authentication System\n// Used when LOCAL_MODE=true - no Supabase needed\n\n\n\nconst JWT_SECRET = process.env.JWT_SECRET || \"local-dev-secret-change-in-production\";\nconst TOKEN_EXPIRY = \"7d\";\nasync function hashPassword(password) {\n    return bcryptjs__WEBPACK_IMPORTED_MODULE_0__[\"default\"].hash(password, 10);\n}\nasync function verifyPassword(password, hash) {\n    return bcryptjs__WEBPACK_IMPORTED_MODULE_0__[\"default\"].compare(password, hash);\n}\nfunction generateToken(user) {\n    return jsonwebtoken__WEBPACK_IMPORTED_MODULE_1___default().sign({\n        id: user.id,\n        email: user.email,\n        is_admin: user.is_admin\n    }, JWT_SECRET, {\n        expiresIn: TOKEN_EXPIRY\n    });\n}\nfunction verifyToken(token) {\n    try {\n        return jsonwebtoken__WEBPACK_IMPORTED_MODULE_1___default().verify(token, JWT_SECRET);\n    } catch (error) {\n        return null;\n    }\n}\nasync function createUser(email, password) {\n    const passwordHash = await hashPassword(password);\n    const id = crypto.randomUUID();\n    try {\n        const result = await (0,_db_local__WEBPACK_IMPORTED_MODULE_2__.query)(`INSERT INTO local_users (id, email, password_hash, is_admin) \n       VALUES ($1, $2, $3, $4) \n       RETURNING id, email, is_admin, created_at`, [\n            id,\n            email.toLowerCase(),\n            passwordHash,\n            false\n        ]);\n        return {\n            user: result.rows[0],\n            error: null\n        };\n    } catch (error) {\n        if (error.code === \"23505\") {\n            return {\n                user: null,\n                error: \"User already exists\"\n            };\n        }\n        return {\n            user: null,\n            error: error.message\n        };\n    }\n}\nasync function signIn(email, password) {\n    try {\n        const result = await (0,_db_local__WEBPACK_IMPORTED_MODULE_2__.query)(\"SELECT * FROM local_users WHERE email = $1\", [\n            email.toLowerCase()\n        ]);\n        if (result.rows.length === 0) {\n            return {\n                user: null,\n                token: null,\n                error: \"Invalid email or password\"\n            };\n        }\n        const user = result.rows[0];\n        const validPassword = await verifyPassword(password, user.password_hash);\n        if (!validPassword) {\n            return {\n                user: null,\n                token: null,\n                error: \"Invalid email or password\"\n            };\n        }\n        const token = generateToken(user);\n        return {\n            user: {\n                id: user.id,\n                email: user.email,\n                is_admin: user.is_admin\n            },\n            token,\n            error: null\n        };\n    } catch (error) {\n        return {\n            user: null,\n            token: null,\n            error: error.message\n        };\n    }\n}\nasync function getUserFromToken(token) {\n    const decoded = verifyToken(token);\n    if (!decoded) return null;\n    try {\n        const result = await (0,_db_local__WEBPACK_IMPORTED_MODULE_2__.query)(\"SELECT id, email, is_admin, created_at FROM local_users WHERE id = $1\", [\n            decoded.id\n        ]);\n        return result.rows[0] || null;\n    } catch (error) {\n        return null;\n    }\n}\nasync function getUserById(id) {\n    try {\n        const result = await (0,_db_local__WEBPACK_IMPORTED_MODULE_2__.query)(\"SELECT id, email, is_admin, created_at FROM local_users WHERE id = $1\", [\n            id\n        ]);\n        return result.rows[0] || null;\n    } catch (error) {\n        return null;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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SUFBSTtJQUMzQixFQUFFLE9BQU9QLE9BQU87UUFDZCxPQUFPO0lBQ1Q7QUFDRjtBQUVPLGVBQWVnQixZQUFZdkIsRUFBRTtJQUNsQyxJQUFJO1FBQ0YsTUFBTVksU0FBUyxNQUFNekIsZ0RBQUtBLENBQ3hCLHlFQUNBO1lBQUNhO1NBQUc7UUFFTixPQUFPWSxPQUFPRSxJQUFJLENBQUMsRUFBRSxJQUFJO0lBQzNCLEVBQUUsT0FBT1AsT0FBTztRQUNkLE9BQU87SUFDVDtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYXN3ZWFsbGFyZS1hZG1pbi8uL2xpYi9hdXRoLWxvY2FsLmpzPzUxODciXSwic291cmNlc0NvbnRlbnQiOlsiLy8gTG9jYWwgQXV0aGVudGljYXRpb24gU3lzdGVtXG4vLyBVc2VkIHdoZW4gTE9DQUxfTU9ERT10cnVlIC0gbm8gU3VwYWJhc2UgbmVlZGVkXG5cbmltcG9ydCBiY3J5cHQgZnJvbSAnYmNyeXB0anMnXG5pbXBvcnQgand0IGZyb20gJ2pzb253ZWJ0b2tlbidcbmltcG9ydCB7IHF1ZXJ5IH0gZnJvbSAnLi9kYi1sb2NhbCdcblxuY29uc3QgSldUX1NFQ1JFVCA9IHByb2Nlc3MuZW52LkpXVF9TRUNSRVQgfHwgJ2xvY2FsLWRldi1zZWNyZXQtY2hhbmdlLWluLXByb2R1Y3Rpb24nXG5jb25zdCBUT0tFTl9FWFBJUlkgPSAnN2QnXG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBoYXNoUGFzc3dvcmQocGFzc3dvcmQpIHtcbiAgcmV0dXJuIGJjcnlwdC5oYXNoKHBhc3N3b3JkLCAxMClcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHZlcmlmeVBhc3N3b3JkKHBhc3N3b3JkLCBoYXNoKSB7XG4gIHJldHVybiBiY3J5cHQuY29tcGFyZShwYXNzd29yZCwgaGFzaClcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdlbmVyYXRlVG9rZW4odXNlcikge1xuICByZXR1cm4gand0LnNpZ24oXG4gICAgeyBpZDogdXNlci5pZCwgZW1haWw6IHVzZXIuZW1haWwsIGlzX2FkbWluOiB1c2VyLmlzX2FkbWluIH0sXG4gICAgSldUX1NFQ1JFVCxcbiAgICB7IGV4cGlyZXNJbjogVE9LRU5fRVhQSVJZIH1cbiAgKVxufVxuXG5leHBvcnQgZnVuY3Rpb24gdmVyaWZ5VG9rZW4odG9rZW4pIHtcbiAgdHJ5IHtcbiAgICByZXR1cm4gand0LnZlcmlmeSh0b2tlbiwgSldUX1NFQ1JFVClcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICByZXR1cm4gbnVsbFxuICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVVc2VyKGVtYWlsLCBwYXNzd29yZCkge1xuICBjb25zdCBwYXNzd29yZEhhc2ggPSBhd2FpdCBoYXNoUGFzc3dvcmQocGFzc3dvcmQpXG4gIGNvbnN0IGlkID0gY3J5cHRvLnJhbmRvbVVVSUQoKVxuICBcbiAgdHJ5IHtcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBxdWVyeShcbiAgICAgIGBJTlNFUlQgSU5UTyBsb2NhbF91c2VycyAoaWQsIGVtYWlsLCBwYXNzd29yZF9oYXNoLCBpc19hZG1pbikgXG4gICAgICAgVkFMVUVTICgkMSwgJDIsICQzLCAkNCkgXG4gICAgICAgUkVUVVJOSU5HIGlkLCBlbWFpbCwgaXNfYWRtaW4sIGNyZWF0ZWRfYXRgLFxuICAgICAgW2lkLCBlbWFpbC50b0xvd2VyQ2FzZSgpLCBwYXNzd29yZEhhc2gsIGZhbHNlXVxuICAgIClcbiAgICByZXR1cm4geyB1c2VyOiByZXN1bHQucm93c1swXSwgZXJyb3I6IG51bGwgfVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGlmIChlcnJvci5jb2RlID09PSAnMjM1MDUnKSB7IC8vIFVuaXF1ZSB2aW9sYXRpb25cbiAgICAgIHJldHVybiB7IHVzZXI6IG51bGwsIGVycm9yOiAnVXNlciBhbHJlYWR5IGV4aXN0cycgfVxuICAgIH1cbiAgICByZXR1cm4geyB1c2VyOiBudWxsLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9XG4gIH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNpZ25JbihlbWFpbCwgcGFzc3dvcmQpIHtcbiAgdHJ5IHtcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBxdWVyeShcbiAgICAgICdTRUxFQ1QgKiBGUk9NIGxvY2FsX3VzZXJzIFdIRVJFIGVtYWlsID0gJDEnLFxuICAgICAgW2VtYWlsLnRvTG93ZXJDYXNlKCldXG4gICAgKVxuICAgIFxuICAgIGlmIChyZXN1bHQucm93cy5sZW5ndGggPT09IDApIHtcbiAgICAgIHJldHVybiB7IHVzZXI6IG51bGwsIHRva2VuOiBudWxsLCBlcnJvcjogJ0ludmFsaWQgZW1haWwgb3IgcGFzc3dvcmQnIH1cbiAgICB9XG4gICAgXG4gICAgY29uc3QgdXNlciA9IHJlc3VsdC5yb3dzWzBdXG4gICAgY29uc3QgdmFsaWRQYXNzd29yZCA9IGF3YWl0IHZlcmlmeVBhc3N3b3JkKHBhc3N3b3JkLCB1c2VyLnBhc3N3b3JkX2hhc2gpXG4gICAgXG4gICAgaWYgKCF2YWxpZFBhc3N3b3JkKSB7XG4gICAgICByZXR1cm4geyB1c2VyOiBudWxsLCB0b2tlbjogbnVsbCwgZXJyb3I6ICdJbnZhbGlkIGVtYWlsIG9yIHBhc3N3b3JkJyB9XG4gICAgfVxuICAgIFxuICAgIGNvbnN0IHRva2VuID0gZ2VuZXJhdGVUb2tlbih1c2VyKVxuICAgIHJldHVybiB7XG4gICAgICB1c2VyOiB7IGlkOiB1c2VyLmlkLCBlbWFpbDogdXNlci5lbWFpbCwgaXNfYWRtaW46IHVzZXIuaXNfYWRtaW4gfSxcbiAgICAgIHRva2VuLFxuICAgICAgZXJyb3I6IG51bGxcbiAgICB9XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgcmV0dXJuIHsgdXNlcjogbnVsbCwgdG9rZW46IG51bGwsIGVycm9yOiBlcnJvci5tZXNzYWdlIH1cbiAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0VXNlckZyb21Ub2tlbih0b2tlbikge1xuICBjb25zdCBkZWNvZGVkID0gdmVyaWZ5VG9rZW4odG9rZW4pXG4gIGlmICghZGVjb2RlZCkgcmV0dXJuIG51bGxcbiAgXG4gIHRyeSB7XG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcXVlcnkoXG4gICAgICAnU0VMRUNUIGlkLCBlbWFpbCwgaXNfYWRtaW4sIGNyZWF0ZWRfYXQgRlJPTSBsb2NhbF91c2VycyBXSEVSRSBpZCA9ICQxJyxcbiAgICAgIFtkZWNvZGVkLmlkXVxuICAgIClcbiAgICByZXR1cm4gcmVzdWx0LnJvd3NbMF0gfHwgbnVsbFxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIHJldHVybiBudWxsXG4gIH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFVzZXJCeUlkKGlkKSB7XG4gIHRyeSB7XG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcXVlcnkoXG4gICAgICAnU0VMRUNUIGlkLCBlbWFpbCwgaXNfYWRtaW4sIGNyZWF0ZWRfYXQgRlJPTSBsb2NhbF91c2VycyBXSEVSRSBpZCA9ICQxJyxcbiAgICAgIFtpZF1cbiAgICApXG4gICAgcmV0dXJuIHJlc3VsdC5yb3dzWzBdIHx8IG51bGxcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICByZXR1cm4gbnVsbFxuICB9XG59XG4iXSwibmFtZXMiOlsiYmNyeXB0Iiwiand0IiwicXVlcnkiLCJKV1RfU0VDUkVUIiwicHJvY2VzcyIsImVudiIsIlRPS0VOX0VYUElSWSIsImhhc2hQYXNzd29yZCIsInBhc3N3b3JkIiwiaGFzaCIsInZlcmlmeVBhc3N3b3JkIiwiY29tcGFyZSIsImdlbmVyYXRlVG9rZW4iLCJ1c2VyIiwic2lnbiIsImlkIiwiZW1haWwiLCJpc19hZG1pbiIsImV4cGlyZXNJbiIsInZlcmlmeVRva2VuIiwidG9rZW4iLCJ2ZXJpZnkiLCJlcnJvciIsImNyZWF0ZVVzZXIiLCJwYXNzd29yZEhhc2giLCJjcnlwdG8iLCJyYW5kb21VVUlEIiwicmVzdWx0IiwidG9Mb3dlckNhc2UiLCJyb3dzIiwiY29kZSIsIm1lc3NhZ2UiLCJzaWduSW4iLCJsZW5ndGgiLCJ2YWxpZFBhc3N3b3JkIiwicGFzc3dvcmRfaGFzaCIsImdldFVzZXJGcm9tVG9rZW4iLCJkZWNvZGVkIiwiZ2V0VXNlckJ5SWQiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/auth-local.js\n");

/***/ })

};
;