"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/admin/upload/route";
exports.ids = ["app/api/admin/upload/route"];
exports.modules = {

/***/ "../../client/components/action-async-storage.external":
/*!*******************************************************************************!*\
  !*** external "next/dist/client/components/action-async-storage.external.js" ***!
  \*******************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/action-async-storage.external.js");

/***/ }),

/***/ "../../client/components/request-async-storage.external":
/*!********************************************************************************!*\
  !*** external "next/dist/client/components/request-async-storage.external.js" ***!
  \********************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/request-async-storage.external.js");

/***/ }),

/***/ "../../client/components/static-generation-async-storage.external":
/*!******************************************************************************************!*\
  !*** external "next/dist/client/components/static-generation-async-storage.external.js" ***!
  \******************************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/static-generation-async-storage.external.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "pg":
/*!*********************!*\
  !*** external "pg" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("pg");

/***/ }),

/***/ "buffer":
/*!*************************!*\
  !*** external "buffer" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("buffer");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("stream");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("util");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fadmin%2Fupload%2Froute&page=%2Fapi%2Fadmin%2Fupload%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fadmin%2Fupload%2Froute.js&appDir=%2Fapp%2Fapps%2Fadmin%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fapp%2Fapps%2Fadmin&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D!":
/*!**************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fadmin%2Fupload%2Froute&page=%2Fapi%2Fadmin%2Fupload%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fadmin%2Fupload%2Froute.js&appDir=%2Fapp%2Fapps%2Fadmin%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fapp%2Fapps%2Fadmin&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D! ***!
  \**************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _app_apps_admin_app_api_admin_upload_route_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/admin/upload/route.js */ \"(rsc)/./app/api/admin/upload/route.js\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"standalone\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/admin/upload/route\",\n        pathname: \"/api/admin/upload\",\n        filename: \"route\",\n        bundlePath: \"app/api/admin/upload/route\"\n    },\n    resolvedPagePath: \"/app/apps/admin/app/api/admin/upload/route.js\",\n    nextConfigOutput,\n    userland: _app_apps_admin_app_api_admin_upload_route_js__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/admin/upload/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZhZG1pbiUyRnVwbG9hZCUyRnJvdXRlJnBhZ2U9JTJGYXBpJTJGYWRtaW4lMkZ1cGxvYWQlMkZyb3V0ZSZhcHBQYXRocz0mcGFnZVBhdGg9cHJpdmF0ZS1uZXh0LWFwcC1kaXIlMkZhcGklMkZhZG1pbiUyRnVwbG9hZCUyRnJvdXRlLmpzJmFwcERpcj0lMkZhcHAlMkZhcHBzJTJGYWRtaW4lMkZhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPSUyRmFwcCUyRmFwcHMlMkZhZG1pbiZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD1zdGFuZGFsb25lJnByZWZlcnJlZFJlZ2lvbj0mbWlkZGxld2FyZUNvbmZpZz1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNjO0FBQ0g7QUFDMUU7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGdIQUFtQjtBQUMzQztBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLFlBQVk7QUFDWixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsUUFBUSxpRUFBaUU7QUFDekU7QUFDQTtBQUNBLFdBQVcsNEVBQVc7QUFDdEI7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUN1SDs7QUFFdkgiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9hc3dlYWxsYXJlLWFkbWluLz9lOGYxIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgcGF0Y2hGZXRjaCBhcyBfcGF0Y2hGZXRjaCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi9wYXRjaC1mZXRjaFwiO1xuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi9hcHAvYXBwcy9hZG1pbi9hcHAvYXBpL2FkbWluL3VwbG9hZC9yb3V0ZS5qc1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJzdGFuZGFsb25lXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL2FkbWluL3VwbG9hZC9yb3V0ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL2FkbWluL3VwbG9hZFwiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvYWRtaW4vdXBsb2FkL3JvdXRlXCJcbiAgICB9LFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiL2FwcC9hcHBzL2FkbWluL2FwcC9hcGkvYWRtaW4vdXBsb2FkL3JvdXRlLmpzXCIsXG4gICAgbmV4dENvbmZpZ091dHB1dCxcbiAgICB1c2VybGFuZFxufSk7XG4vLyBQdWxsIG91dCB0aGUgZXhwb3J0cyB0aGF0IHdlIG5lZWQgdG8gZXhwb3NlIGZyb20gdGhlIG1vZHVsZS4gVGhpcyBzaG91bGRcbi8vIGJlIGVsaW1pbmF0ZWQgd2hlbiB3ZSd2ZSBtb3ZlZCB0aGUgb3RoZXIgcm91dGVzIHRvIHRoZSBuZXcgZm9ybWF0LiBUaGVzZVxuLy8gYXJlIHVzZWQgdG8gaG9vayBpbnRvIHRoZSByb3V0ZS5cbmNvbnN0IHsgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MgfSA9IHJvdXRlTW9kdWxlO1xuY29uc3Qgb3JpZ2luYWxQYXRobmFtZSA9IFwiL2FwaS9hZG1pbi91cGxvYWQvcm91dGVcIjtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgc2VydmVySG9va3MsXG4gICAgICAgIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fadmin%2Fupload%2Froute&page=%2Fapi%2Fadmin%2Fupload%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fadmin%2Fupload%2Froute.js&appDir=%2Fapp%2Fapps%2Fadmin%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fapp%2Fapps%2Fadmin&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/admin/upload/route.js":
/*!***************************************!*\
  !*** ./app/api/admin/upload/route.js ***!
  \***************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @supabase/supabase-js */ \"(rsc)/./node_modules/@supabase/supabase-js/dist/index.mjs\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! crypto */ \"crypto\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(crypto__WEBPACK_IMPORTED_MODULE_1__);\n\n\n\nconst BUCKET_NAME = \"assets\";\n// Helper to get authenticated user and check admin status\nasync function getAuthenticatedUserAndCheckAdmin() {\n    // In local mode, check the auth-token cookie\n    if (process.env.LOCAL_MODE === \"true\") {\n        const { cookies } = await __webpack_require__.e(/*! import() */ \"vendor-chunks/next\").then(__webpack_require__.bind(__webpack_require__, /*! next/headers */ \"(rsc)/./node_modules/next/dist/api/headers.js\"));\n        const { getUserFromToken } = await Promise.all(/*! import() */[__webpack_require__.e(\"vendor-chunks/semver\"), __webpack_require__.e(\"vendor-chunks/bcryptjs\"), __webpack_require__.e(\"vendor-chunks/jsonwebtoken\"), __webpack_require__.e(\"vendor-chunks/lodash.includes\"), __webpack_require__.e(\"vendor-chunks/jws\"), __webpack_require__.e(\"vendor-chunks/lodash.once\"), __webpack_require__.e(\"vendor-chunks/jwa\"), __webpack_require__.e(\"vendor-chunks/lodash.isinteger\"), __webpack_require__.e(\"vendor-chunks/ecdsa-sig-formatter\"), __webpack_require__.e(\"vendor-chunks/lodash.isplainobject\"), __webpack_require__.e(\"vendor-chunks/ms\"), __webpack_require__.e(\"vendor-chunks/lodash.isstring\"), __webpack_require__.e(\"vendor-chunks/lodash.isnumber\"), __webpack_require__.e(\"vendor-chunks/lodash.isboolean\"), __webpack_require__.e(\"vendor-chunks/safe-buffer\"), __webpack_require__.e(\"vendor-chunks/buffer-equal-constant-time\"), __webpack_require__.e(\"_rsc_lib_auth-local_js-_ee011\")]).then(__webpack_require__.bind(__webpack_require__, /*! ../../../../lib/auth-local */ \"(rsc)/./lib/auth-local.js\"));\n        const cookieStore = cookies();\n        const token = cookieStore.get(\"auth-token\")?.value;\n        if (token) {\n            const user = await getUserFromToken(token);\n            if (user) {\n                return {\n                    user,\n                    isAdmin: true,\n                    error: null\n                };\n            }\n        }\n        return {\n            user: null,\n            isAdmin: false,\n            error: \"Not authenticated\"\n        };\n    }\n    // Supabase mode\n    const { createSupabaseServer } = await Promise.all(/*! import() */[__webpack_require__.e(\"vendor-chunks/next\"), __webpack_require__.e(\"vendor-chunks/@supabase\"), __webpack_require__.e(\"vendor-chunks/cookie\"), __webpack_require__.e(\"_rsc_lib_supabase-server_js\")]).then(__webpack_require__.bind(__webpack_require__, /*! ../../../../lib/supabase-server */ \"(rsc)/./lib/supabase-server.js\"));\n    const supabase = createSupabaseServer();\n    const { data: { user }, error } = await supabase.auth.getUser();\n    if (error || !user) {\n        return {\n            user: null,\n            isAdmin: false,\n            error: error?.message || \"Not authenticated\"\n        };\n    }\n    // Check if user is admin by querying app_config admin_emails\n    try {\n        const supabaseAdmin = (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_2__.createClient)(\"https://pwdwemakaozxmutwswqa.supabase.co\", process.env.SUPABASE_SERVICE_ROLE_KEY);\n        const { data: config } = await supabaseAdmin.from(\"app_config\").select(\"admin_emails\").single();\n        const adminEmails = config?.admin_emails || [];\n        const isAdmin = adminEmails.includes(user.email);\n        return {\n            user,\n            isAdmin,\n            error: null\n        };\n    } catch (dbError) {\n        console.error(\"[UPLOAD] Error checking admin status:\", dbError);\n        return {\n            user,\n            isAdmin: false,\n            error: null\n        };\n    }\n}\n// Get Supabase admin client for storage operations\nfunction getSupabaseAdmin() {\n    return (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_2__.createClient)(\"https://pwdwemakaozxmutwswqa.supabase.co\", process.env.SUPABASE_SERVICE_ROLE_KEY);\n}\nasync function POST(request) {\n    try {\n        // Check auth and admin status\n        const { user, isAdmin, error: authError } = await getAuthenticatedUserAndCheckAdmin();\n        if (authError || !user) {\n            console.log(\"[UPLOAD] Auth failed:\", {\n                authError,\n                user: user?.email\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Unauthorized - Not authenticated\"\n            }, {\n                status: 401\n            });\n        }\n        if (!isAdmin) {\n            console.log(\"[UPLOAD] Admin check failed:\", {\n                user: user?.email,\n                isAdmin\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Unauthorized - Admin access required\"\n            }, {\n                status: 403\n            });\n        }\n        console.log(\"[UPLOAD] Auth passed for admin:\", user?.email);\n        const formData = await request.formData();\n        const file = formData.get(\"file\");\n        const folder = formData.get(\"folder\") || \"uploads\" // e.g., collections/unscripted_conversations/piles\n        ;\n        const customFilename = formData.get(\"filename\") // Optional custom filename\n        ;\n        if (!file) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"No file provided\"\n            }, {\n                status: 400\n            });\n        }\n        // Get file buffer\n        const bytes = await file.arrayBuffer();\n        const buffer = Buffer.from(bytes);\n        // Determine file extension from original filename or mime type\n        const originalName = file.name || \"file\";\n        const extension = originalName.includes(\".\") ? \".\" + originalName.split(\".\").pop() : \"\";\n        // Generate filename\n        let filename;\n        if (customFilename) {\n            // Use custom filename if provided, ensure extension\n            filename = customFilename.includes(\".\") ? customFilename : `${customFilename}${extension}`;\n        } else {\n            // Generate MD5 hash for unique filename\n            const md5Hash = crypto__WEBPACK_IMPORTED_MODULE_1___default().createHash(\"md5\").update(buffer).digest(\"hex\");\n            filename = `${md5Hash}${extension}`;\n        }\n        // Build storage path: folder/filename\n        const storagePath = folder ? `${folder}/${filename}` : filename;\n        console.log(`[UPLOAD] Uploading to Supabase Storage: ${BUCKET_NAME}/${storagePath}`);\n        // Upload to Supabase Storage\n        const supabase = getSupabaseAdmin();\n        const { data, error: uploadError } = await supabase.storage.from(BUCKET_NAME).upload(storagePath, buffer, {\n            contentType: file.type || \"application/octet-stream\",\n            upsert: true // Overwrite if exists\n        });\n        if (uploadError) {\n            console.error(\"[UPLOAD] Supabase Storage error:\", uploadError);\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: `Storage upload failed: ${uploadError.message}`\n            }, {\n                status: 500\n            });\n        }\n        // Get public URL\n        const { data: { publicUrl } } = supabase.storage.from(BUCKET_NAME).getPublicUrl(storagePath);\n        console.log(`[UPLOAD] File uploaded successfully: ${publicUrl}`);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: true,\n            path: publicUrl,\n            imagePath: publicUrl,\n            image_path: publicUrl,\n            url: publicUrl,\n            filename,\n            storagePath,\n            message: \"File uploaded successfully to Supabase Storage\"\n        });\n    } catch (error) {\n        console.error(\"[UPLOAD] Error:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: error.message\n        }, {\n            status: 500\n        });\n    }\n}\nasync function GET() {\n    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n        message: \"Use POST to upload files to Supabase Storage\",\n        bucket: BUCKET_NAME,\n        fields: {\n            file: \"File to upload (required)\",\n            folder: \"Folder path within bucket (e.g., collections/unscripted_conversations/piles)\",\n            filename: \"Optional custom filename\"\n        }\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QVM7UUFDVHNELFFBQVF6RTtRQUNSMEUsUUFBUTtZQUNOakMsTUFBTTtZQUNOQyxRQUFRO1lBQ1JXLFVBQVU7UUFDWjtJQUNGO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9hc3dlYWxsYXJlLWFkbWluLy4vYXBwL2FwaS9hZG1pbi91cGxvYWQvcm91dGUuanM/ZTEzMCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0UmVzcG9uc2UgfSBmcm9tICduZXh0L3NlcnZlcidcbmltcG9ydCB7IGNyZWF0ZUNsaWVudCB9IGZyb20gJ0BzdXBhYmFzZS9zdXBhYmFzZS1qcydcbmltcG9ydCBjcnlwdG8gZnJvbSAnY3J5cHRvJ1xuXG5jb25zdCBCVUNLRVRfTkFNRSA9ICdhc3NldHMnXG5cbi8vIEhlbHBlciB0byBnZXQgYXV0aGVudGljYXRlZCB1c2VyIGFuZCBjaGVjayBhZG1pbiBzdGF0dXNcbmFzeW5jIGZ1bmN0aW9uIGdldEF1dGhlbnRpY2F0ZWRVc2VyQW5kQ2hlY2tBZG1pbigpIHtcbiAgLy8gSW4gbG9jYWwgbW9kZSwgY2hlY2sgdGhlIGF1dGgtdG9rZW4gY29va2llXG4gIGlmIChwcm9jZXNzLmVudi5MT0NBTF9NT0RFID09PSAndHJ1ZScpIHtcbiAgICBjb25zdCB7IGNvb2tpZXMgfSA9IGF3YWl0IGltcG9ydCgnbmV4dC9oZWFkZXJzJylcbiAgICBjb25zdCB7IGdldFVzZXJGcm9tVG9rZW4gfSA9IGF3YWl0IGltcG9ydCgnLi4vLi4vLi4vLi4vbGliL2F1dGgtbG9jYWwnKVxuICAgIFxuICAgIGNvbnN0IGNvb2tpZVN0b3JlID0gY29va2llcygpXG4gICAgY29uc3QgdG9rZW4gPSBjb29raWVTdG9yZS5nZXQoJ2F1dGgtdG9rZW4nKT8udmFsdWVcbiAgICBcbiAgICBpZiAodG9rZW4pIHtcbiAgICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBnZXRVc2VyRnJvbVRva2VuKHRva2VuKVxuICAgICAgaWYgKHVzZXIpIHtcbiAgICAgICAgcmV0dXJuIHsgdXNlciwgaXNBZG1pbjogdHJ1ZSwgZXJyb3I6IG51bGwgfVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4geyB1c2VyOiBudWxsLCBpc0FkbWluOiBmYWxzZSwgZXJyb3I6ICdOb3QgYXV0aGVudGljYXRlZCcgfVxuICB9XG4gIFxuICAvLyBTdXBhYmFzZSBtb2RlXG4gIGNvbnN0IHsgY3JlYXRlU3VwYWJhc2VTZXJ2ZXIgfSA9IGF3YWl0IGltcG9ydCgnLi4vLi4vLi4vLi4vbGliL3N1cGFiYXNlLXNlcnZlcicpXG4gIFxuICBjb25zdCBzdXBhYmFzZSA9IGNyZWF0ZVN1cGFiYXNlU2VydmVyKClcbiAgY29uc3QgeyBkYXRhOiB7IHVzZXIgfSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlLmF1dGguZ2V0VXNlcigpXG4gIFxuICBpZiAoZXJyb3IgfHwgIXVzZXIpIHtcbiAgICByZXR1cm4geyB1c2VyOiBudWxsLCBpc0FkbWluOiBmYWxzZSwgZXJyb3I6IGVycm9yPy5tZXNzYWdlIHx8ICdOb3QgYXV0aGVudGljYXRlZCcgfVxuICB9XG4gIFxuICAvLyBDaGVjayBpZiB1c2VyIGlzIGFkbWluIGJ5IHF1ZXJ5aW5nIGFwcF9jb25maWcgYWRtaW5fZW1haWxzXG4gIHRyeSB7XG4gICAgY29uc3Qgc3VwYWJhc2VBZG1pbiA9IGNyZWF0ZUNsaWVudChcbiAgICAgIHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTCxcbiAgICAgIHByb2Nlc3MuZW52LlNVUEFCQVNFX1NFUlZJQ0VfUk9MRV9LRVlcbiAgICApXG4gICAgXG4gICAgY29uc3QgeyBkYXRhOiBjb25maWcgfSA9IGF3YWl0IHN1cGFiYXNlQWRtaW5cbiAgICAgIC5mcm9tKCdhcHBfY29uZmlnJylcbiAgICAgIC5zZWxlY3QoJ2FkbWluX2VtYWlscycpXG4gICAgICAuc2luZ2xlKClcbiAgICBcbiAgICBjb25zdCBhZG1pbkVtYWlscyA9IGNvbmZpZz8uYWRtaW5fZW1haWxzIHx8IFtdXG4gICAgY29uc3QgaXNBZG1pbiA9IGFkbWluRW1haWxzLmluY2x1ZGVzKHVzZXIuZW1haWwpXG4gICAgXG4gICAgcmV0dXJuIHsgdXNlciwgaXNBZG1pbiwgZXJyb3I6IG51bGwgfVxuICB9IGNhdGNoIChkYkVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignW1VQTE9BRF0gRXJyb3IgY2hlY2tpbmcgYWRtaW4gc3RhdHVzOicsIGRiRXJyb3IpXG4gICAgcmV0dXJuIHsgdXNlciwgaXNBZG1pbjogZmFsc2UsIGVycm9yOiBudWxsIH1cbiAgfVxufVxuXG4vLyBHZXQgU3VwYWJhc2UgYWRtaW4gY2xpZW50IGZvciBzdG9yYWdlIG9wZXJhdGlvbnNcbmZ1bmN0aW9uIGdldFN1cGFiYXNlQWRtaW4oKSB7XG4gIHJldHVybiBjcmVhdGVDbGllbnQoXG4gICAgcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMLFxuICAgIHByb2Nlc3MuZW52LlNVUEFCQVNFX1NFUlZJQ0VfUk9MRV9LRVlcbiAgKVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gUE9TVChyZXF1ZXN0KSB7XG4gIHRyeSB7XG4gICAgLy8gQ2hlY2sgYXV0aCBhbmQgYWRtaW4gc3RhdHVzXG4gICAgY29uc3QgeyB1c2VyLCBpc0FkbWluLCBlcnJvcjogYXV0aEVycm9yIH0gPSBhd2FpdCBnZXRBdXRoZW50aWNhdGVkVXNlckFuZENoZWNrQWRtaW4oKVxuICAgIFxuICAgIGlmIChhdXRoRXJyb3IgfHwgIXVzZXIpIHtcbiAgICAgIGNvbnNvbGUubG9nKCdbVVBMT0FEXSBBdXRoIGZhaWxlZDonLCB7IGF1dGhFcnJvciwgdXNlcjogdXNlcj8uZW1haWwgfSlcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnVW5hdXRob3JpemVkIC0gTm90IGF1dGhlbnRpY2F0ZWQnIH0sIHsgc3RhdHVzOiA0MDEgfSlcbiAgICB9XG4gICAgXG4gICAgaWYgKCFpc0FkbWluKSB7XG4gICAgICBjb25zb2xlLmxvZygnW1VQTE9BRF0gQWRtaW4gY2hlY2sgZmFpbGVkOicsIHsgdXNlcjogdXNlcj8uZW1haWwsIGlzQWRtaW4gfSlcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnVW5hdXRob3JpemVkIC0gQWRtaW4gYWNjZXNzIHJlcXVpcmVkJyB9LCB7IHN0YXR1czogNDAzIH0pXG4gICAgfVxuICAgIFxuICAgIGNvbnNvbGUubG9nKCdbVVBMT0FEXSBBdXRoIHBhc3NlZCBmb3IgYWRtaW46JywgdXNlcj8uZW1haWwpXG4gICAgXG4gICAgY29uc3QgZm9ybURhdGEgPSBhd2FpdCByZXF1ZXN0LmZvcm1EYXRhKClcbiAgICBjb25zdCBmaWxlID0gZm9ybURhdGEuZ2V0KCdmaWxlJylcbiAgICBjb25zdCBmb2xkZXIgPSBmb3JtRGF0YS5nZXQoJ2ZvbGRlcicpIHx8ICd1cGxvYWRzJyAvLyBlLmcuLCBjb2xsZWN0aW9ucy91bnNjcmlwdGVkX2NvbnZlcnNhdGlvbnMvcGlsZXNcbiAgICBjb25zdCBjdXN0b21GaWxlbmFtZSA9IGZvcm1EYXRhLmdldCgnZmlsZW5hbWUnKSAvLyBPcHRpb25hbCBjdXN0b20gZmlsZW5hbWVcbiAgICBcbiAgICBpZiAoIWZpbGUpIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnTm8gZmlsZSBwcm92aWRlZCcgfSwgeyBzdGF0dXM6IDQwMCB9KVxuICAgIH1cbiAgICBcbiAgICAvLyBHZXQgZmlsZSBidWZmZXJcbiAgICBjb25zdCBieXRlcyA9IGF3YWl0IGZpbGUuYXJyYXlCdWZmZXIoKVxuICAgIGNvbnN0IGJ1ZmZlciA9IEJ1ZmZlci5mcm9tKGJ5dGVzKVxuICAgIFxuICAgIC8vIERldGVybWluZSBmaWxlIGV4dGVuc2lvbiBmcm9tIG9yaWdpbmFsIGZpbGVuYW1lIG9yIG1pbWUgdHlwZVxuICAgIGNvbnN0IG9yaWdpbmFsTmFtZSA9IGZpbGUubmFtZSB8fCAnZmlsZSdcbiAgICBjb25zdCBleHRlbnNpb24gPSBvcmlnaW5hbE5hbWUuaW5jbHVkZXMoJy4nKSBcbiAgICAgID8gJy4nICsgb3JpZ2luYWxOYW1lLnNwbGl0KCcuJykucG9wKClcbiAgICAgIDogJydcbiAgICBcbiAgICAvLyBHZW5lcmF0ZSBmaWxlbmFtZVxuICAgIGxldCBmaWxlbmFtZVxuICAgIGlmIChjdXN0b21GaWxlbmFtZSkge1xuICAgICAgLy8gVXNlIGN1c3RvbSBmaWxlbmFtZSBpZiBwcm92aWRlZCwgZW5zdXJlIGV4dGVuc2lvblxuICAgICAgZmlsZW5hbWUgPSBjdXN0b21GaWxlbmFtZS5pbmNsdWRlcygnLicpID8gY3VzdG9tRmlsZW5hbWUgOiBgJHtjdXN0b21GaWxlbmFtZX0ke2V4dGVuc2lvbn1gXG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIEdlbmVyYXRlIE1ENSBoYXNoIGZvciB1bmlxdWUgZmlsZW5hbWVcbiAgICAgIGNvbnN0IG1kNUhhc2ggPSBjcnlwdG8uY3JlYXRlSGFzaCgnbWQ1JykudXBkYXRlKGJ1ZmZlcikuZGlnZXN0KCdoZXgnKVxuICAgICAgZmlsZW5hbWUgPSBgJHttZDVIYXNofSR7ZXh0ZW5zaW9ufWBcbiAgICB9XG4gICAgXG4gICAgLy8gQnVpbGQgc3RvcmFnZSBwYXRoOiBmb2xkZXIvZmlsZW5hbWVcbiAgICBjb25zdCBzdG9yYWdlUGF0aCA9IGZvbGRlciA/IGAke2ZvbGRlcn0vJHtmaWxlbmFtZX1gIDogZmlsZW5hbWVcbiAgICBcbiAgICBjb25zb2xlLmxvZyhgW1VQTE9BRF0gVXBsb2FkaW5nIHRvIFN1cGFiYXNlIFN0b3JhZ2U6ICR7QlVDS0VUX05BTUV9LyR7c3RvcmFnZVBhdGh9YClcbiAgICBcbiAgICAvLyBVcGxvYWQgdG8gU3VwYWJhc2UgU3RvcmFnZVxuICAgIGNvbnN0IHN1cGFiYXNlID0gZ2V0U3VwYWJhc2VBZG1pbigpXG4gICAgXG4gICAgY29uc3QgeyBkYXRhLCBlcnJvcjogdXBsb2FkRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlLnN0b3JhZ2VcbiAgICAgIC5mcm9tKEJVQ0tFVF9OQU1FKVxuICAgICAgLnVwbG9hZChzdG9yYWdlUGF0aCwgYnVmZmVyLCB7XG4gICAgICAgIGNvbnRlbnRUeXBlOiBmaWxlLnR5cGUgfHwgJ2FwcGxpY2F0aW9uL29jdGV0LXN0cmVhbScsXG4gICAgICAgIHVwc2VydDogdHJ1ZSAvLyBPdmVyd3JpdGUgaWYgZXhpc3RzXG4gICAgICB9KVxuICAgIFxuICAgIGlmICh1cGxvYWRFcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignW1VQTE9BRF0gU3VwYWJhc2UgU3RvcmFnZSBlcnJvcjonLCB1cGxvYWRFcnJvcilcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IFxuICAgICAgICBlcnJvcjogYFN0b3JhZ2UgdXBsb2FkIGZhaWxlZDogJHt1cGxvYWRFcnJvci5tZXNzYWdlfWAgXG4gICAgICB9LCB7IHN0YXR1czogNTAwIH0pXG4gICAgfVxuICAgIFxuICAgIC8vIEdldCBwdWJsaWMgVVJMXG4gICAgY29uc3QgeyBkYXRhOiB7IHB1YmxpY1VybCB9IH0gPSBzdXBhYmFzZS5zdG9yYWdlXG4gICAgICAuZnJvbShCVUNLRVRfTkFNRSlcbiAgICAgIC5nZXRQdWJsaWNVcmwoc3RvcmFnZVBhdGgpXG4gICAgXG4gICAgY29uc29sZS5sb2coYFtVUExPQURdIEZpbGUgdXBsb2FkZWQgc3VjY2Vzc2Z1bGx5OiAke3B1YmxpY1VybH1gKVxuICAgIFxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IFxuICAgICAgc3VjY2VzczogdHJ1ZSwgXG4gICAgICBwYXRoOiBwdWJsaWNVcmwsXG4gICAgICBpbWFnZVBhdGg6IHB1YmxpY1VybCxcbiAgICAgIGltYWdlX3BhdGg6IHB1YmxpY1VybCxcbiAgICAgIHVybDogcHVibGljVXJsLFxuICAgICAgZmlsZW5hbWUsXG4gICAgICBzdG9yYWdlUGF0aCxcbiAgICAgIG1lc3NhZ2U6ICdGaWxlIHVwbG9hZGVkIHN1Y2Nlc3NmdWxseSB0byBTdXBhYmFzZSBTdG9yYWdlJ1xuICAgIH0pXG4gICAgXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignW1VQTE9BRF0gRXJyb3I6JywgZXJyb3IpXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfSwgeyBzdGF0dXM6IDUwMCB9KVxuICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBHRVQoKSB7XG4gIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IFxuICAgIG1lc3NhZ2U6ICdVc2UgUE9TVCB0byB1cGxvYWQgZmlsZXMgdG8gU3VwYWJhc2UgU3RvcmFnZScsXG4gICAgYnVja2V0OiBCVUNLRVRfTkFNRSxcbiAgICBmaWVsZHM6IHtcbiAgICAgIGZpbGU6ICdGaWxlIHRvIHVwbG9hZCAocmVxdWlyZWQpJyxcbiAgICAgIGZvbGRlcjogJ0ZvbGRlciBwYXRoIHdpdGhpbiBidWNrZXQgKGUuZy4sIGNvbGxlY3Rpb25zL3Vuc2NyaXB0ZWRfY29udmVyc2F0aW9ucy9waWxlcyknLFxuICAgICAgZmlsZW5hbWU6ICdPcHRpb25hbCBjdXN0b20gZmlsZW5hbWUnXG4gICAgfVxuICB9KVxufVxuIl0sIm5hbWVzIjpbIk5leHRSZXNwb25zZSIsImNyZWF0ZUNsaWVudCIsImNyeXB0byIsIkJVQ0tFVF9OQU1FIiwiZ2V0QXV0aGVudGljYXRlZFVzZXJBbmRDaGVja0FkbWluIiwicHJvY2VzcyIsImVudiIsIkxPQ0FMX01PREUiLCJjb29raWVzIiwiZ2V0VXNlckZyb21Ub2tlbiIsImNvb2tpZVN0b3JlIiwidG9rZW4iLCJnZXQiLCJ2YWx1ZSIsInVzZXIiLCJpc0FkbWluIiwiZXJyb3IiLCJjcmVhdGVTdXBhYmFzZVNlcnZlciIsInN1cGFiYXNlIiwiZGF0YSIsImF1dGgiLCJnZXRVc2VyIiwibWVzc2FnZSIsInN1cGFiYXNlQWRtaW4iLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwiLCJTVVBBQkFTRV9TRVJWSUNFX1JPTEVfS0VZIiwiY29uZmlnIiwiZnJvbSIsInNlbGVjdCIsInNpbmdsZSIsImFkbWluRW1haWxzIiwiYWRtaW5fZW1haWxzIiwiaW5jbHVkZXMiLCJlbWFpbCIsImRiRXJyb3IiLCJjb25zb2xlIiwiZ2V0U3VwYWJhc2VBZG1pbiIsIlBPU1QiLCJyZXF1ZXN0IiwiYXV0aEVycm9yIiwibG9nIiwianNvbiIsInN0YXR1cyIsImZvcm1EYXRhIiwiZmlsZSIsImZvbGRlciIsImN1c3RvbUZpbGVuYW1lIiwiYnl0ZXMiLCJhcnJheUJ1ZmZlciIsImJ1ZmZlciIsIkJ1ZmZlciIsIm9yaWdpbmFsTmFtZSIsIm5hbWUiLCJleHRlbnNpb24iLCJzcGxpdCIsInBvcCIsImZpbGVuYW1lIiwibWQ1SGFzaCIsImNyZWF0ZUhhc2giLCJ1cGRhdGUiLCJkaWdlc3QiLCJzdG9yYWdlUGF0aCIsInVwbG9hZEVycm9yIiwic3RvcmFnZSIsInVwbG9hZCIsImNvbnRlbnRUeXBlIiwidHlwZSIsInVwc2VydCIsInB1YmxpY1VybCIsImdldFB1YmxpY1VybCIsInN1Y2Nlc3MiLCJwYXRoIiwiaW1hZ2VQYXRoIiwiaW1hZ2VfcGF0aCIsInVybCIsIkdFVCIsImJ1Y2tldCIsImZpZWxkcyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./app/api/admin/upload/route.js\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/@supabase","vendor-chunks/tslib","vendor-chunks/iceberg-js"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fadmin%2Fupload%2Froute&page=%2Fapi%2Fadmin%2Fupload%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fadmin%2Fupload%2Froute.js&appDir=%2Fapp%2Fapps%2Fadmin%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fapp%2Fapps%2Fadmin&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();