"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/[[...path]]/route";
exports.ids = ["app/api/[[...path]]/route"];
exports.modules = {

/***/ "../../client/components/action-async-storage.external":
/*!*******************************************************************************!*\
  !*** external "next/dist/client/components/action-async-storage.external.js" ***!
  \*******************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/action-async-storage.external.js");

/***/ }),

/***/ "../../client/components/request-async-storage.external":
/*!********************************************************************************!*\
  !*** external "next/dist/client/components/request-async-storage.external.js" ***!
  \********************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/request-async-storage.external.js");

/***/ }),

/***/ "../../client/components/static-generation-async-storage.external":
/*!******************************************************************************************!*\
  !*** external "next/dist/client/components/static-generation-async-storage.external.js" ***!
  \******************************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/static-generation-async-storage.external.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "pg":
/*!*********************!*\
  !*** external "pg" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("pg");

/***/ }),

/***/ "buffer":
/*!*************************!*\
  !*** external "buffer" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("buffer");

/***/ }),

/***/ "child_process":
/*!********************************!*\
  !*** external "child_process" ***!
  \********************************/
/***/ ((module) => {

module.exports = require("child_process");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "events":
/*!*************************!*\
  !*** external "events" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("events");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

module.exports = require("https");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("stream");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("util");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2F%5B%5B...path%5D%5D%2Froute&page=%2Fapi%2F%5B%5B...path%5D%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2F%5B%5B...path%5D%5D%2Froute.js&appDir=%2Fapp%2Fapps%2Fadmin%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fapp%2Fapps%2Fadmin&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D!":
/*!*****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2F%5B%5B...path%5D%5D%2Froute&page=%2Fapi%2F%5B%5B...path%5D%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2F%5B%5B...path%5D%5D%2Froute.js&appDir=%2Fapp%2Fapps%2Fadmin%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fapp%2Fapps%2Fadmin&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _app_apps_admin_app_api_path_route_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/[[...path]]/route.js */ \"(rsc)/./app/api/[[...path]]/route.js\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"standalone\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/[[...path]]/route\",\n        pathname: \"/api/[[...path]]\",\n        filename: \"route\",\n        bundlePath: \"app/api/[[...path]]/route\"\n    },\n    resolvedPagePath: \"/app/apps/admin/app/api/[[...path]]/route.js\",\n    nextConfigOutput,\n    userland: _app_apps_admin_app_api_path_route_js__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/[[...path]]/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkYlNUIlNUIuLi5wYXRoJTVEJTVEJTJGcm91dGUmcGFnZT0lMkZhcGklMkYlNUIlNUIuLi5wYXRoJTVEJTVEJTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGJTVCJTVCLi4ucGF0aCU1RCU1RCUyRnJvdXRlLmpzJmFwcERpcj0lMkZhcHAlMkZhcHBzJTJGYWRtaW4lMkZhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPSUyRmFwcCUyRmFwcHMlMkZhZG1pbiZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD1zdGFuZGFsb25lJnByZWZlcnJlZFJlZ2lvbj0mbWlkZGxld2FyZUNvbmZpZz1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNjO0FBQ0o7QUFDekU7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGdIQUFtQjtBQUMzQztBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLFlBQVk7QUFDWixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsUUFBUSxpRUFBaUU7QUFDekU7QUFDQTtBQUNBLFdBQVcsNEVBQVc7QUFDdEI7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUN1SDs7QUFFdkgiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9hc3dlYWxsYXJlLWFkbWluLz8yMmFjIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgcGF0Y2hGZXRjaCBhcyBfcGF0Y2hGZXRjaCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi9wYXRjaC1mZXRjaFwiO1xuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi9hcHAvYXBwcy9hZG1pbi9hcHAvYXBpL1tbLi4ucGF0aF1dL3JvdXRlLmpzXCI7XG4vLyBXZSBpbmplY3QgdGhlIG5leHRDb25maWdPdXRwdXQgaGVyZSBzbyB0aGF0IHdlIGNhbiB1c2UgdGhlbSBpbiB0aGUgcm91dGVcbi8vIG1vZHVsZS5cbmNvbnN0IG5leHRDb25maWdPdXRwdXQgPSBcInN0YW5kYWxvbmVcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvW1suLi5wYXRoXV0vcm91dGVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9bWy4uLnBhdGhdXVwiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvW1suLi5wYXRoXV0vcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCIvYXBwL2FwcHMvYWRtaW4vYXBwL2FwaS9bWy4uLnBhdGhdXS9yb3V0ZS5qc1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzIH0gPSByb3V0ZU1vZHVsZTtcbmNvbnN0IG9yaWdpbmFsUGF0aG5hbWUgPSBcIi9hcGkvW1suLi5wYXRoXV0vcm91dGVcIjtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgc2VydmVySG9va3MsXG4gICAgICAgIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2F%5B%5B...path%5D%5D%2Froute&page=%2Fapi%2F%5B%5B...path%5D%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2F%5B%5B...path%5D%5D%2Froute.js&appDir=%2Fapp%2Fapps%2Fadmin%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fapp%2Fapps%2Fadmin&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/[[...path]]/route.js":
/*!**************************************!*\
  !*** ./app/api/[[...path]]/route.js ***!
  \**************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   DELETE: () => (/* binding */ DELETE),\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   OPTIONS: () => (/* binding */ OPTIONS),\n/* harmony export */   POST: () => (/* binding */ POST),\n/* harmony export */   PUT: () => (/* binding */ PUT)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_supabase_server__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../lib/supabase-server */ \"(rsc)/./lib/supabase-server.js\");\n/* harmony import */ var _lib_stripe__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../lib/stripe */ \"(rsc)/./lib/stripe.js\");\n/* harmony import */ var uuid__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! uuid */ \"(rsc)/./node_modules/uuid/dist/esm-node/v4.js\");\n/* harmony import */ var _lib_entitlements__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../lib/entitlements */ \"(rsc)/./lib/entitlements.js\");\n\n\n\n\n// CORS helper\nfunction handleCORS(response) {\n    response.headers.set(\"Access-Control-Allow-Origin\", \"*\");\n    response.headers.set(\"Access-Control-Allow-Methods\", \"GET, POST, PUT, DELETE, OPTIONS\");\n    response.headers.set(\"Access-Control-Allow-Headers\", \"Content-Type, Authorization\");\n    return response;\n}\n// OPTIONS handler for CORS\nasync function OPTIONS() {\n    return handleCORS(new next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse(null, {\n        status: 200\n    }));\n}\n// Helper to get authenticated user\nasync function getAuthenticatedUser() {\n    // In local mode, check the auth-token cookie\n    if (process.env.LOCAL_MODE === \"true\") {\n        const { cookies } = await Promise.resolve(/*! import() */).then(__webpack_require__.bind(__webpack_require__, /*! next/headers */ \"(rsc)/./node_modules/next/dist/api/headers.js\"));\n        const { getUserFromToken } = await Promise.all(/*! import() */[__webpack_require__.e(\"vendor-chunks/semver\"), __webpack_require__.e(\"vendor-chunks/jsonwebtoken\"), __webpack_require__.e(\"vendor-chunks/jws\"), __webpack_require__.e(\"vendor-chunks/ecdsa-sig-formatter\"), __webpack_require__.e(\"vendor-chunks/bcryptjs\"), __webpack_require__.e(\"vendor-chunks/safe-buffer\"), __webpack_require__.e(\"vendor-chunks/ms\"), __webpack_require__.e(\"vendor-chunks/lodash.once\"), __webpack_require__.e(\"vendor-chunks/lodash.isstring\"), __webpack_require__.e(\"vendor-chunks/lodash.isplainobject\"), __webpack_require__.e(\"vendor-chunks/lodash.isnumber\"), __webpack_require__.e(\"vendor-chunks/lodash.isinteger\"), __webpack_require__.e(\"vendor-chunks/lodash.isboolean\"), __webpack_require__.e(\"vendor-chunks/lodash.includes\"), __webpack_require__.e(\"vendor-chunks/jwa\"), __webpack_require__.e(\"vendor-chunks/buffer-equal-constant-time\"), __webpack_require__.e(\"_rsc_lib_auth-local_js\")]).then(__webpack_require__.bind(__webpack_require__, /*! ../../../lib/auth-local */ \"(rsc)/./lib/auth-local.js\"));\n        const cookieStore = cookies();\n        const token = cookieStore.get(\"auth-token\")?.value;\n        if (token) {\n            const user = await getUserFromToken(token);\n            if (user) {\n                return {\n                    user,\n                    error: null\n                };\n            }\n        }\n        return {\n            user: null,\n            error: null\n        };\n    }\n    // Supabase mode\n    const supabase = (0,_lib_supabase_server__WEBPACK_IMPORTED_MODULE_1__.createSupabaseServer)();\n    const { data: { user }, error } = await supabase.auth.getUser();\n    return {\n        user,\n        error\n    };\n}\n// Import entitlements helper\n\n// Helper to get user's accessible boxes - uses entitlements as source of truth\nasync function getUserAccessibleBoxes(userId) {\n    const supabase = (0,_lib_supabase_server__WEBPACK_IMPORTED_MODULE_1__.createSupabaseServer)();\n    // Get all active boxes\n    const { data: boxes, error: boxError } = await supabase.from(\"boxes\").select(\"*\").eq(\"is_active\", true).order(\"display_order\", {\n        ascending: true\n    });\n    if (boxError || !boxes) {\n        return {\n            boxes: [],\n            accessibleBoxIds: []\n        };\n    }\n    // Use entitlements helper as the single source of truth\n    const { boxIds: accessibleBoxIds, hasMembership } = await (0,_lib_entitlements__WEBPACK_IMPORTED_MODULE_3__.getUserEntitledBoxIds)(userId);\n    return {\n        boxes,\n        accessibleBoxIds,\n        hasAllAccess: hasMembership\n    };\n}\n// Helper to check if user has paid access\nasync function checkUserAccess(userId) {\n    const { accessibleBoxIds, hasAllAccess } = await getUserAccessibleBoxes(userId);\n    // User has paid access if they have access to any non-sample box\n    const supabase = (0,_lib_supabase_server__WEBPACK_IMPORTED_MODULE_1__.createSupabaseServer)();\n    const { data: sampleBoxes } = await supabase.from(\"boxes\").select(\"id\").eq(\"is_sample\", true);\n    const sampleBoxIds = (sampleBoxes || []).map((b)=>b.id);\n    const hasPaidAccess = hasAllAccess || accessibleBoxIds.some((id)=>!sampleBoxIds.includes(id));\n    return {\n        hasPaidAccess,\n        accessibleBoxIds,\n        hasAllAccess\n    };\n}\n// Main request handler\nasync function GET(request) {\n    const url = new URL(request.url);\n    const path = url.pathname.replace(\"/api/\", \"\");\n    const supabase = (0,_lib_supabase_server__WEBPACK_IMPORTED_MODULE_1__.createSupabaseServer)();\n    try {\n        // AUTH ROUTES\n        if (path === \"auth/user\") {\n            const { user, error } = await getAuthenticatedUser();\n            if (error || !user) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    user: null\n                }, {\n                    status: 200\n                }));\n            }\n            // Check user access\n            const { hasPaidAccess, accessibleBoxIds, hasAllAccess } = await checkUserAccess(user.id);\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                user: {\n                    id: user.id,\n                    email: user.email,\n                    hasPaidAccess,\n                    accessibleBoxIds,\n                    hasAllAccess\n                }\n            }));\n        }\n        // BOXES ROUTES - Get all boxes with user access info\n        if (path === \"boxes\") {\n            const { user } = await getAuthenticatedUser();\n            const userId = user?.id || null;\n            const { boxes, accessibleBoxIds, hasAllAccess } = await getUserAccessibleBoxes(userId);\n            // Add hasAccess flag to each box\n            const boxesWithAccess = boxes.map((box)=>({\n                    ...box,\n                    hasAccess: accessibleBoxIds.includes(box.id)\n                }));\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                boxes: boxesWithAccess,\n                hasAllAccess\n            }));\n        }\n        // CARDS ROUTES - Now supports box filtering\n        if (path === \"cards\") {\n            const { user } = await getAuthenticatedUser();\n            const boxIds = url.searchParams.get(\"box_ids\")?.split(\",\").filter(Boolean) || [];\n            // Get user's accessible boxes\n            const { accessibleBoxIds } = await getUserAccessibleBoxes(user?.id || null);\n            // Determine which boxes to query\n            let queryBoxIds = [];\n            if (boxIds.length > 0) {\n                queryBoxIds = boxIds.filter((id)=>accessibleBoxIds.includes(id));\n                if (queryBoxIds.length === 0) {\n                    return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                        cards: [],\n                        message: \"No accessible boxes\"\n                    }));\n                }\n            } else if (accessibleBoxIds.length > 0) {\n                queryBoxIds = accessibleBoxIds;\n            } else {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    cards: [],\n                    message: \"No accessible boxes\"\n                }));\n            }\n            // Query cards\n            const { data: cards, error } = await supabase.from(\"cards\").select(\"*\").in(\"box_id\", queryBoxIds).eq(\"is_active\", true).order(\"created_at\", {\n                ascending: false\n            });\n            if (error) {\n                console.error(\"[CARDS API] Error fetching cards:\", error);\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            // If we have cards, fetch piles separately for card back images\n            let pilesMap = {};\n            if (cards && cards.length > 0) {\n                const pileIds = [\n                    ...new Set(cards.map((c)=>c.pile_id).filter(Boolean))\n                ];\n                if (pileIds.length > 0) {\n                    const { data: piles } = await supabase.from(\"piles\").select(\"*\").in(\"id\", pileIds);\n                    if (piles) {\n                        piles.forEach((p)=>{\n                            pilesMap[p.id] = p;\n                        });\n                    }\n                }\n            }\n            // Transform cards to include pile info for the frontend\n            const transformedCards = (cards || []).map((card)=>{\n                const pile = pilesMap[card.pile_id] || {};\n                return {\n                    id: card.id,\n                    box_id: card.box_id,\n                    pile_id: card.pile_id,\n                    text: card.text,\n                    image_path: card.image_path,\n                    is_active: card.is_active,\n                    created_at: card.created_at,\n                    // Add pile info for card back images\n                    color: pile.slug || \"black\",\n                    pile_name: pile.name,\n                    pile_image: pile.image_path,\n                    // Legacy fields for compatibility\n                    title: card.text,\n                    imagePath: card.image_path\n                };\n            });\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                cards: transformedCards\n            }));\n        }\n        // SUBSCRIPTION PLANS\n        if (path === \"plans\") {\n            const { data: plans, error } = await supabase.from(\"subscription_plans\").select(\"*\").eq(\"is_active\", true).order(\"price\", {\n                ascending: true\n            });\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                plans: plans || []\n            }));\n        }\n        // COLLECTION SERIES - Public endpoint\n        if (path === \"collection-series\") {\n            const { data: series, error } = await supabase.from(\"collection_series\").select(\"*\").eq(\"is_active\", true).order(\"display_order\", {\n                ascending: true\n            });\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                series: series || []\n            }));\n        }\n        // USER PURCHASES - Get user's purchase history\n        if (path === \"purchases\") {\n            const { user, error: authError } = await getAuthenticatedUser();\n            if (authError || !user) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Unauthorized\"\n                }, {\n                    status: 401\n                }));\n            }\n            const { data: purchases, error } = await supabase.from(\"user_products\").select(\"*, boxes(name, color, price)\").eq(\"user_id\", user.id).order(\"created_at\", {\n                ascending: false\n            });\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                purchases: purchases || []\n            }));\n        }\n        // SAVED DRAWS ROUTES\n        if (path === \"draws\") {\n            const { user, error: authError } = await getAuthenticatedUser();\n            if (authError || !user) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Unauthorized\"\n                }, {\n                    status: 401\n                }));\n            }\n            const { data: draws, error } = await supabase.from(\"saved_draws\").select(\"*\").eq(\"userid\", user.id).order(\"timestamp\", {\n                ascending: false\n            });\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                draws: draws || []\n            }));\n        }\n        // ADMIN ROUTES - Get all cards\n        if (path === \"admin/cards\") {\n            const { user, error: authError } = await getAuthenticatedUser();\n            if (authError || !user) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Unauthorized\"\n                }, {\n                    status: 401\n                }));\n            }\n            // Get cards\n            const { data: cards, error } = await supabase.from(\"cards\").select(\"*\").order(\"created_at\", {\n                ascending: false\n            });\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            // Get boxes, piles and series for enrichment - use Promise.all for reliability\n            const [boxesResult, pilesResult, seriesResult] = await Promise.all([\n                supabase.from(\"boxes\").select(\"*\"),\n                supabase.from(\"piles\").select(\"*\"),\n                supabase.from(\"collection_series\").select(\"*\")\n            ]);\n            const boxes = boxesResult.data || [];\n            const piles = pilesResult.data || [];\n            const series = seriesResult.data || [];\n            const boxMap = {};\n            const pileMap = {};\n            const seriesMap = {};\n            boxes.forEach((b)=>{\n                if (b && b.id) boxMap[b.id] = b;\n            });\n            piles.forEach((p)=>{\n                if (p && p.id) pileMap[p.id] = p;\n            });\n            series.forEach((s)=>{\n                if (s && s.id) seriesMap[s.id] = s;\n            });\n            // Enrich cards with box/pile info\n            const enrichedCards = (cards || []).map((card)=>{\n                const box = boxMap[card.box_id];\n                const pile = pileMap[card.pile_id];\n                const collectionSeries = box ? seriesMap[box.collection_series_id] : null;\n                return {\n                    ...card,\n                    boxes: box ? {\n                        name: box.name,\n                        color: box.color,\n                        collection_series_id: box.collection_series_id,\n                        collection_series: collectionSeries ? {\n                            name: collectionSeries.name\n                        } : null\n                    } : null,\n                    piles: pile ? {\n                        name: pile.name,\n                        slug: pile.slug\n                    } : null\n                };\n            });\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                cards: enrichedCards\n            }));\n        }\n        // ADMIN ROUTES - Get all boxes\n        if (path === \"admin/boxes\") {\n            const { user, error: authError } = await getAuthenticatedUser();\n            if (authError || !user) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Unauthorized\"\n                }, {\n                    status: 401\n                }));\n            }\n            // Get boxes\n            const { data: boxes, error } = await supabase.from(\"boxes\").select(\"*\").order(\"display_order\", {\n                ascending: true\n            });\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            // Get all related data - use Promise.all for parallel fetching\n            const [cardsResult, pilesResult, seriesResult, pricesResult] = await Promise.all([\n                supabase.from(\"cards\").select(\"*\"),\n                supabase.from(\"piles\").select(\"*\"),\n                supabase.from(\"collection_series\").select(\"*\"),\n                supabase.from(\"prices\").select(\"*\")\n            ]);\n            const cards = cardsResult.data || [];\n            const piles = pilesResult.data || [];\n            const series = seriesResult.data || [];\n            const prices = pricesResult.data || [];\n            // Log for debugging\n            console.log(`[admin/boxes] Loaded ${boxes?.length || 0} boxes, ${series.length} series, ${piles.length} piles, ${prices.length} prices`);\n            const seriesMap = {};\n            const priceMap = {};\n            const pileMap = {};\n            series.forEach((s)=>{\n                if (s && s.id) seriesMap[s.id] = s;\n            });\n            prices.forEach((p)=>{\n                if (p && p.id) priceMap[p.id] = p;\n            });\n            piles.forEach((p)=>{\n                if (p && p.id) pileMap[p.id] = p;\n            });\n            // Count cards per box per pile\n            const cardCounts = {};\n            if (cards) {\n                cards.forEach((card)=>{\n                    const key = `${card.box_id}`;\n                    if (!cardCounts[key]) {\n                        cardCounts[key] = {\n                            total: 0,\n                            byPile: {}\n                        };\n                    }\n                    cardCounts[key].total++;\n                    const pileId = card.pile_id;\n                    if (!cardCounts[key].byPile[pileId]) {\n                        cardCounts[key].byPile[pileId] = {\n                            count: 0,\n                            pileName: pileMap[pileId]?.name || \"Unknown\",\n                            pileSlug: pileMap[pileId]?.slug || \"\"\n                        };\n                    }\n                    cardCounts[key].byPile[pileId].count++;\n                });\n            }\n            // Enrich boxes with related data\n            const enrichedBoxes = (boxes || []).map((box)=>({\n                    ...box,\n                    collection_series: seriesMap[box.collection_series_id] || null,\n                    prices: priceMap[box.price_id] || null,\n                    cardStats: cardCounts[box.id] || {\n                        total: 0,\n                        byPile: {}\n                    }\n                }));\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                boxes: enrichedBoxes,\n                piles: piles || []\n            }));\n        }\n        // ADMIN ROUTES - Get all collection series\n        if (path === \"admin/collection-series\") {\n            const { user, error: authError } = await getAuthenticatedUser();\n            if (authError || !user) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Unauthorized\"\n                }, {\n                    status: 401\n                }));\n            }\n            const { data: series, error } = await supabase.from(\"collection_series\").select(\"*\").order(\"display_order\", {\n                ascending: true\n            });\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                series: series || []\n            }));\n        }\n        // ADMIN ROUTES - Get all prices\n        if (path === \"admin/prices\") {\n            const { user, error: authError } = await getAuthenticatedUser();\n            if (authError || !user) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Unauthorized\"\n                }, {\n                    status: 401\n                }));\n            }\n            const { data: prices, error } = await supabase.from(\"prices\").select(\"*\").order(\"display_order\", {\n                ascending: true\n            });\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                prices: prices || []\n            }));\n        }\n        // ADMIN ROUTES - Get all piles\n        if (path === \"admin/piles\") {\n            const { user, error: authError } = await getAuthenticatedUser();\n            if (authError || !user) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Unauthorized\"\n                }, {\n                    status: 401\n                }));\n            }\n            // Get piles first\n            const { data: piles, error: pilesError } = await supabase.from(\"piles\").select(\"*\").order(\"display_order\", {\n                ascending: true\n            });\n            if (pilesError) {\n                console.error(\"Failed to load piles:\", pilesError);\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: pilesError.message\n                }, {\n                    status: 500\n                }));\n            }\n            // Get all series for mapping - do this as a separate guaranteed query\n            const { data: series, error: seriesError } = await supabase.from(\"collection_series\").select(\"*\");\n            if (seriesError) {\n                console.error(\"Failed to load collection_series:\", seriesError);\n            }\n            // Build series lookup map\n            const seriesMap = {};\n            if (series && Array.isArray(series)) {\n                series.forEach((s)=>{\n                    if (s && s.id) {\n                        seriesMap[s.id] = s;\n                    }\n                });\n            }\n            // Log for debugging\n            console.log(`[admin/piles] Loaded ${(piles || []).length} piles, ${Object.keys(seriesMap).length} series`);\n            // Enrich piles with series data\n            const enrichedPiles = (piles || []).map((p)=>{\n                const seriesData = p.collection_series_id ? seriesMap[p.collection_series_id] : null;\n                return {\n                    ...p,\n                    collection_series: seriesData || null\n                };\n            });\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                piles: enrichedPiles\n            }));\n        }\n        // ADMIN ROUTES - Get all bundles\n        if (path === \"admin/bundles\") {\n            const { user, error: authError } = await getAuthenticatedUser();\n            if (authError || !user) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Unauthorized\"\n                }, {\n                    status: 401\n                }));\n            }\n            const { data: bundles, error } = await supabase.from(\"bundles\").select(\"*\").order(\"display_order\", {\n                ascending: true\n            });\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            // Enrich with price info\n            const { data: prices } = await supabase.from(\"prices\").select(\"*\");\n            const priceMap = {};\n            if (prices) prices.forEach((p)=>{\n                priceMap[p.id] = p;\n            });\n            const enrichedBundles = (bundles || []).map((b)=>({\n                    ...b,\n                    prices: priceMap[b.price_id] || null\n                }));\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                bundles: enrichedBundles\n            }));\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                bundles: bundles || []\n            }));\n        }\n        // PUBLIC ROUTES - Get active prices for store\n        if (path === \"store/prices\") {\n            const { data: prices, error } = await supabase.from(\"prices\").select(\"*\").eq(\"is_active\", true).order(\"display_order\", {\n                ascending: true\n            });\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                prices: prices || []\n            }));\n        }\n        // PUBLIC ROUTES - Get active bundles for store\n        if (path === \"store/bundles\") {\n            const { data: bundles, error } = await supabase.from(\"bundles\").select(\"*, prices(id, label, amount, currency, is_membership, membership_days)\").eq(\"is_active\", true).order(\"display_order\", {\n                ascending: true\n            });\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                bundles: bundles || []\n            }));\n        }\n        return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Route not found\"\n        }, {\n            status: 404\n        }));\n    } catch (error) {\n        console.error(\"API Error:\", error);\n        return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: error.message\n        }, {\n            status: 500\n        }));\n    }\n}\nasync function POST(request) {\n    const url = new URL(request.url);\n    const path = url.pathname.replace(\"/api/\", \"\");\n    const supabase = (0,_lib_supabase_server__WEBPACK_IMPORTED_MODULE_1__.createSupabaseServer)();\n    try {\n        const body = await request.json();\n        // AUTH ROUTES\n        if (path === \"auth/signup\") {\n            const { email, password } = body;\n            const { data, error } = await supabase.auth.signUp({\n                email,\n                password\n            });\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 400\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                user: data.user\n            }));\n        }\n        if (path === \"auth/signin\") {\n            const { email, password } = body;\n            const { data, error } = await supabase.auth.signInWithPassword({\n                email,\n                password\n            });\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 400\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                user: data.user\n            }));\n        }\n        if (path === \"auth/signout\") {\n            const { error } = await supabase.auth.signOut();\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 400\n                }));\n            }\n            // Create response and clear auth cookies\n            const response = next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true\n            });\n            // Clear Supabase auth cookies by setting them to expire\n            const cookieOptions = {\n                path: \"/\",\n                expires: new Date(0),\n                maxAge: 0\n            };\n            response.cookies.set(\"sb-access-token\", \"\", cookieOptions);\n            response.cookies.set(\"sb-refresh-token\", \"\", cookieOptions);\n            // Also try to clear any Supabase project-specific cookies\n            const supabaseUrl = \"https://pwdwemakaozxmutwswqa.supabase.co\" || 0;\n            const projectRef = supabaseUrl.match(/https:\\/\\/([^.]+)/)?.[1];\n            if (projectRef) {\n                response.cookies.set(`sb-${projectRef}-auth-token`, \"\", cookieOptions);\n                response.cookies.set(`sb-${projectRef}-auth-token-code-verifier`, \"\", cookieOptions);\n            }\n            return handleCORS(response);\n        }\n        if (path === \"auth/google\") {\n            const { data, error } = await supabase.auth.signInWithOAuth({\n                provider: \"google\",\n                options: {\n                    redirectTo: `${\"https://appsmono.preview.emergentagent.com\"}/auth/callback`\n                }\n            });\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 400\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                url: data.url\n            }));\n        }\n        // Password Reset Request\n        if (path === \"auth/reset-password\") {\n            const { email } = body;\n            if (!email) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Email is required\"\n                }, {\n                    status: 400\n                }));\n            }\n            const { error } = await supabase.auth.resetPasswordForEmail(email, {\n                redirectTo: `${\"https://appsmono.preview.emergentagent.com\"}/auth/reset-callback`\n            });\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 400\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true,\n                message: \"Password reset email sent\"\n            }));\n        }\n        // SAVED DRAWS\n        if (path === \"draws/save\") {\n            const { user, error: authError } = await getAuthenticatedUser();\n            if (authError || !user) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Unauthorized\"\n                }, {\n                    status: 401\n                }));\n            }\n            const { blackCardId, whiteCardId, blackCardTitle, whiteCardTitle } = body;\n            const draw = {\n                id: (0,uuid__WEBPACK_IMPORTED_MODULE_4__[\"default\"])(),\n                userid: user.id,\n                useremail: user.email,\n                blackcardid: blackCardId,\n                whitecardid: whiteCardId,\n                blackcardtitle: blackCardTitle,\n                whitecardtitle: whiteCardTitle,\n                timestamp: new Date().toISOString()\n            };\n            const { data, error } = await supabase.from(\"saved_draws\").insert([\n                draw\n            ]).select().single();\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                draw: data\n            }));\n        }\n        // PAYMENT ROUTES - Purchase a single box\n        if (path === \"payment/purchase-box\") {\n            const { user, error: authError } = await getAuthenticatedUser();\n            if (authError || !user) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Unauthorized\"\n                }, {\n                    status: 401\n                }));\n            }\n            const { boxId } = body;\n            // Get box details\n            const { data: box, error: boxError } = await supabase.from(\"boxes\").select(\"*\").eq(\"id\", boxId).single();\n            if (boxError || !box) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Box not found\"\n                }, {\n                    status: 404\n                }));\n            }\n            if (box.is_sample) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Sample box is free\"\n                }, {\n                    status: 400\n                }));\n            }\n            const session = await (0,_lib_stripe__WEBPACK_IMPORTED_MODULE_2__.getStripe)().checkout.sessions.create({\n                payment_method_types: [\n                    \"card\"\n                ],\n                line_items: [\n                    {\n                        price_data: {\n                            currency: \"usd\",\n                            product_data: {\n                                name: `AS WE ALL ARE - ${box.name}`,\n                                description: box.description || `Unlock the ${box.name} card collection`\n                            },\n                            unit_amount: Math.round(box.price * 100)\n                        },\n                        quantity: 1\n                    }\n                ],\n                mode: \"payment\",\n                success_url: `${\"https://appsmono.preview.emergentagent.com\"}?payment=success&box=${boxId}`,\n                cancel_url: `${\"https://appsmono.preview.emergentagent.com\"}?payment=cancelled`,\n                client_reference_id: user.id,\n                customer_email: user.email,\n                metadata: {\n                    box_id: boxId,\n                    purchase_type: \"one_time\"\n                }\n            });\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                url: session.url\n            }));\n        }\n        // PAYMENT ROUTES - Subscribe to all access\n        if (path === \"payment/subscribe-all\") {\n            const { user, error: authError } = await getAuthenticatedUser();\n            if (authError || !user) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Unauthorized\"\n                }, {\n                    status: 401\n                }));\n            }\n            const { planId } = body;\n            // Get plan details\n            const { data: plan, error: planError } = await supabase.from(\"subscription_plans\").select(\"*\").eq(\"id\", planId).single();\n            if (planError || !plan) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Plan not found\"\n                }, {\n                    status: 404\n                }));\n            }\n            // Calculate interval\n            let interval = \"month\";\n            let intervalCount = 1;\n            if (plan.interval === \"quarter\") {\n                interval = \"month\";\n                intervalCount = 3;\n            } else if (plan.interval === \"year\") {\n                interval = \"year\";\n                intervalCount = 1;\n            }\n            const session = await (0,_lib_stripe__WEBPACK_IMPORTED_MODULE_2__.getStripe)().checkout.sessions.create({\n                payment_method_types: [\n                    \"card\"\n                ],\n                line_items: [\n                    {\n                        price_data: {\n                            currency: \"usd\",\n                            product_data: {\n                                name: `AS WE ALL ARE - ${plan.name}`,\n                                description: plan.description || \"Full access to all card boxes\"\n                            },\n                            unit_amount: Math.round(plan.price * 100),\n                            recurring: {\n                                interval,\n                                interval_count: intervalCount\n                            }\n                        },\n                        quantity: 1\n                    }\n                ],\n                mode: \"subscription\",\n                success_url: `${\"https://appsmono.preview.emergentagent.com\"}?payment=success&subscription=true`,\n                cancel_url: `${\"https://appsmono.preview.emergentagent.com\"}?payment=cancelled`,\n                client_reference_id: user.id,\n                customer_email: user.email,\n                metadata: {\n                    plan_id: planId,\n                    purchase_type: \"all_access\"\n                }\n            });\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                url: session.url\n            }));\n        }\n        // CANCEL SUBSCRIPTION\n        if (path === \"payment/cancel-subscription\") {\n            const { user, error: authError } = await getAuthenticatedUser();\n            if (authError || !user) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Unauthorized\"\n                }, {\n                    status: 401\n                }));\n            }\n            const { purchaseId } = body;\n            // Get the purchase record\n            const { data: purchase, error: purchaseError } = await supabase.from(\"user_products\").select(\"*\").eq(\"id\", purchaseId).eq(\"user_id\", user.id).single();\n            if (purchaseError || !purchase) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Purchase not found\"\n                }, {\n                    status: 404\n                }));\n            }\n            if (!purchase.stripe_subscription_id) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"This is not a subscription\"\n                }, {\n                    status: 400\n                }));\n            }\n            try {\n                // Cancel the subscription in Stripe\n                await (0,_lib_stripe__WEBPACK_IMPORTED_MODULE_2__.getStripe)().subscriptions.cancel(purchase.stripe_subscription_id);\n                // Update our database\n                await supabase.from(\"user_products\").update({\n                    is_active: false\n                }).eq(\"id\", purchaseId);\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    success: true,\n                    message: \"Subscription cancelled\"\n                }));\n            } catch (stripeError) {\n                console.error(\"Stripe cancellation error:\", stripeError);\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Failed to cancel subscription\"\n                }, {\n                    status: 500\n                }));\n            }\n        }\n        // Legacy payment route (for backward compatibility)\n        if (path === \"payment/create-checkout\") {\n            const { user, error: authError } = await getAuthenticatedUser();\n            if (authError || !user) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Unauthorized\"\n                }, {\n                    status: 401\n                }));\n            }\n            const { paymentType, couponCode } = body;\n            let sessionConfig = {\n                payment_method_types: [\n                    \"card\"\n                ],\n                line_items: [],\n                mode: paymentType === \"subscription\" ? \"subscription\" : \"payment\",\n                success_url: `${\"https://appsmono.preview.emergentagent.com\"}?payment=success`,\n                cancel_url: `${\"https://appsmono.preview.emergentagent.com\"}?payment=cancelled`,\n                client_reference_id: user.id,\n                customer_email: user.email,\n                metadata: {\n                    purchase_type: paymentType === \"subscription\" ? \"all_access\" : \"legacy_full\"\n                }\n            };\n            if (paymentType === \"onetime\") {\n                sessionConfig.line_items.push({\n                    price_data: {\n                        currency: \"usd\",\n                        product_data: {\n                            name: \"AS WE ALL ARE - Full Access\",\n                            description: \"One-time unlock of all cards\"\n                        },\n                        unit_amount: 2000\n                    },\n                    quantity: 1\n                });\n            } else {\n                sessionConfig.line_items.push({\n                    price_data: {\n                        currency: \"usd\",\n                        product_data: {\n                            name: \"AS WE ALL ARE - Subscription\",\n                            description: \"Full access subscription\"\n                        },\n                        unit_amount: 300,\n                        recurring: {\n                            interval: \"month\",\n                            interval_count: 3\n                        }\n                    },\n                    quantity: 1\n                });\n            }\n            if (couponCode) {\n                try {\n                    const coupons = await (0,_lib_stripe__WEBPACK_IMPORTED_MODULE_2__.getStripe)().coupons.list({\n                        limit: 100\n                    });\n                    const validCoupon = coupons.data.find((c)=>c.id.toLowerCase() === couponCode.toLowerCase());\n                    if (validCoupon) {\n                        sessionConfig.discounts = [\n                            {\n                                coupon: validCoupon.id\n                            }\n                        ];\n                    }\n                } catch (error) {\n                    console.error(\"Coupon validation error:\", error);\n                }\n            }\n            const session = await stripe.checkout.sessions.create(sessionConfig);\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                url: session.url\n            }));\n        }\n        // ADMIN ROUTES - Create card\n        if (path === \"admin/cards\") {\n            const { user, error: authError } = await getAuthenticatedUser();\n            if (authError || !user) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Unauthorized\"\n                }, {\n                    status: 401\n                }));\n            }\n            const { boxId, pileId, text, imagePath, isActive } = body;\n            // Generate MD5 hash ID\n            const crypto = await Promise.resolve(/*! import() */).then(__webpack_require__.t.bind(__webpack_require__, /*! crypto */ \"crypto\", 23));\n            const cardId = crypto.createHash(\"md5\").update(`${Date.now()}-${Math.random()}`).digest(\"hex\");\n            const card = {\n                id: cardId,\n                box_id: boxId,\n                pile_id: pileId,\n                text: text || null,\n                image_path: imagePath || \"\",\n                is_active: isActive !== false,\n                created_at: new Date().toISOString()\n            };\n            const { data, error } = await supabase.from(\"cards\").insert([\n                card\n            ]).select().single();\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                card: data\n            }));\n        }\n        // ADMIN ROUTES - Create box (enhanced with new fields)\n        if (path === \"admin/boxes\") {\n            const { user, error: authError } = await getAuthenticatedUser();\n            if (authError || !user) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Unauthorized\"\n                }, {\n                    status: 401\n                }));\n            }\n            const { id: boxId, name, description, descriptionShort, tagline, topics, priceId, color, colorPalette, path: boxPath, displayOrder, isSample, fullBoxId, isActive, collectionSeriesId } = body;\n            const box = {\n                id: boxId || `box_${(0,uuid__WEBPACK_IMPORTED_MODULE_4__[\"default\"])().slice(0, 8)}`,\n                name,\n                description: description || \"\",\n                description_short: descriptionShort || \"\",\n                tagline: tagline || \"\",\n                topics: topics || [],\n                price_id: priceId || null,\n                color: color || \"#000000\",\n                color_palette: colorPalette || [],\n                path: boxPath || \"\",\n                display_order: displayOrder || 0,\n                is_sample: isSample || false,\n                full_box_id: isSample ? fullBoxId || null : null,\n                is_active: isActive !== false,\n                collection_series_id: collectionSeriesId || \"unscripted_conversations\",\n                created_at: new Date().toISOString()\n            };\n            const { data, error } = await supabase.from(\"boxes\").insert([\n                box\n            ]).select().single();\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                box: data\n            }));\n        }\n        // ADMIN ROUTES - Create collection series\n        if (path === \"admin/collection-series\") {\n            const { user, error: authError } = await getAuthenticatedUser();\n            if (authError || !user) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Unauthorized\"\n                }, {\n                    status: 401\n                }));\n            }\n            const { id, name, description, displayOrder, isActive } = body;\n            const series = {\n                id: id || `series_${(0,uuid__WEBPACK_IMPORTED_MODULE_4__[\"default\"])().slice(0, 8)}`,\n                name,\n                description: description || \"\",\n                display_order: displayOrder || 0,\n                is_active: isActive !== false,\n                created_at: new Date().toISOString()\n            };\n            const { data, error } = await supabase.from(\"collection_series\").insert([\n                series\n            ]).select().single();\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                series: data\n            }));\n        }\n        // ADMIN ROUTES - Create price\n        if (path === \"admin/prices\") {\n            const { user, error: authError } = await getAuthenticatedUser();\n            if (authError || !user) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Unauthorized\"\n                }, {\n                    status: 401\n                }));\n            }\n            const { id, label, paymentInfo, hookInfo, amount, promoAmount, promoEnabled, currency, membershipDays, stripePriceId, displayOrder, isActive } = body;\n            const price = {\n                id: id || `price_${(0,uuid__WEBPACK_IMPORTED_MODULE_4__[\"default\"])().slice(0, 8)}`,\n                label,\n                payment_info: paymentInfo || \"\",\n                hook_info: hookInfo || \"\",\n                amount: amount || 0,\n                promo_amount: promoAmount || null,\n                promo_enabled: promoEnabled || false,\n                currency: currency || \"USD\",\n                membership_days: membershipDays || null,\n                stripe_price_id: stripePriceId || null,\n                display_order: displayOrder || 0,\n                is_active: isActive !== false,\n                created_at: new Date().toISOString()\n            };\n            const { data, error } = await supabase.from(\"prices\").insert([\n                price\n            ]).select().single();\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                price: data\n            }));\n        }\n        // ADMIN ROUTES - Create pile\n        if (path === \"admin/piles\") {\n            const { user, error: authError } = await getAuthenticatedUser();\n            if (authError || !user) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Unauthorized\"\n                }, {\n                    status: 401\n                }));\n            }\n            const { id, slug, name, imagePath, collectionSeriesId, displayOrder, isActive } = body;\n            const pile = {\n                id: id || `pile_${(0,uuid__WEBPACK_IMPORTED_MODULE_4__[\"default\"])().slice(0, 8)}`,\n                slug: slug || name.toLowerCase().replace(/\\s+/g, \"_\"),\n                name,\n                image_path: imagePath || \"\",\n                collection_series_id: collectionSeriesId || null,\n                display_order: displayOrder || 0,\n                is_active: isActive !== false,\n                created_at: new Date().toISOString()\n            };\n            const { data, error } = await supabase.from(\"piles\").insert([\n                pile\n            ]).select().single();\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                pile: data\n            }));\n        }\n        // ADMIN ROUTES - Create bundle\n        if (path === \"admin/bundles\") {\n            const { user, error: authError } = await getAuthenticatedUser();\n            if (authError || !user) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Unauthorized\"\n                }, {\n                    status: 401\n                }));\n            }\n            const { id, name, description, priceId, boxIds, displayOrder, isActive } = body;\n            const bundle = {\n                id: id || `bundle_${(0,uuid__WEBPACK_IMPORTED_MODULE_4__[\"default\"])().slice(0, 8)}`,\n                name,\n                description: description || \"\",\n                price_id: priceId || null,\n                box_ids: boxIds || [],\n                display_order: displayOrder || 0,\n                is_active: isActive !== false,\n                created_at: new Date().toISOString()\n            };\n            const { data, error } = await supabase.from(\"bundles\").insert([\n                bundle\n            ]).select().single();\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                bundle: data\n            }));\n        }\n        // ADMIN ROUTES - Bulk delete cards\n        if (path === \"admin/cards/bulk-delete\") {\n            const { user, error: authError } = await getAuthenticatedUser();\n            if (authError || !user) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Unauthorized\"\n                }, {\n                    status: 401\n                }));\n            }\n            const { boxId, pileId } = body;\n            if (!boxId) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"boxId required\"\n                }, {\n                    status: 400\n                }));\n            }\n            // Build delete query\n            let deleteResult;\n            if (pileId) {\n                // Delete cards for specific box and pile\n                const { data: cards } = await supabase.from(\"cards\").select(\"*\").eq(\"box_id\", boxId).eq(\"pile_id\", pileId);\n                if (cards && cards.length > 0) {\n                    for (const card of cards){\n                        await supabase.from(\"cards\").delete().eq(\"id\", card.id);\n                    }\n                }\n                deleteResult = {\n                    deleted: cards?.length || 0\n                };\n            } else {\n                // Delete all cards for box\n                const { data: cards } = await supabase.from(\"cards\").select(\"*\").eq(\"box_id\", boxId);\n                if (cards && cards.length > 0) {\n                    for (const card of cards){\n                        await supabase.from(\"cards\").delete().eq(\"id\", card.id);\n                    }\n                }\n                deleteResult = {\n                    deleted: cards?.length || 0\n                };\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true,\n                ...deleteResult\n            }));\n        }\n        // ADMIN ROUTES - Export card paths\n        if (path === \"admin/cards/export\") {\n            const { user, error: authError } = await getAuthenticatedUser();\n            if (authError || !user) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Unauthorized\"\n                }, {\n                    status: 401\n                }));\n            }\n            const { boxId, pileId } = body;\n            if (!boxId) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"boxId required\"\n                }, {\n                    status: 400\n                }));\n            }\n            let query = supabase.from(\"cards\").select(\"*\").eq(\"box_id\", boxId);\n            if (pileId) {\n                query = query.eq(\"pile_id\", pileId);\n            }\n            const { data: cards, error } = await query;\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                cards: cards || [],\n                imagePaths: (cards || []).map((c)=>c.image_path)\n            }));\n        }\n        return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Route not found\"\n        }, {\n            status: 404\n        }));\n    } catch (error) {\n        console.error(\"API Error:\", error);\n        return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: error.message\n        }, {\n            status: 500\n        }));\n    }\n}\nasync function PUT(request) {\n    const url = new URL(request.url);\n    const path = url.pathname.replace(\"/api/\", \"\");\n    const supabase = (0,_lib_supabase_server__WEBPACK_IMPORTED_MODULE_1__.createSupabaseServer)();\n    try {\n        const { user, error: authError } = await getAuthenticatedUser();\n        if (authError || !user) {\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Unauthorized\"\n            }, {\n                status: 401\n            }));\n        }\n        // ADMIN ROUTES - Update card\n        if (path.startsWith(\"admin/cards/\")) {\n            const cardId = path.split(\"/\")[2];\n            const body = await request.json();\n            const updateData = {};\n            if (body.boxId !== undefined) updateData.box_id = body.boxId;\n            if (body.pileId !== undefined) updateData.pile_id = body.pileId;\n            if (body.text !== undefined) updateData.text = body.text;\n            if (body.imagePath !== undefined) updateData.image_path = body.imagePath;\n            if (body.isActive !== undefined) updateData.is_active = body.isActive;\n            const { error } = await supabase.from(\"cards\").update(updateData).eq(\"id\", cardId);\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true\n            }));\n        }\n        // ADMIN ROUTES - Update box (enhanced with new fields)\n        if (path.startsWith(\"admin/boxes/\")) {\n            const boxId = path.split(\"/\")[2];\n            const body = await request.json();\n            // Map camelCase to snake_case\n            const updateData = {};\n            if (body.name !== undefined) updateData.name = body.name;\n            if (body.description !== undefined) updateData.description = body.description;\n            if (body.descriptionShort !== undefined) updateData.description_short = body.descriptionShort;\n            if (body.tagline !== undefined) updateData.tagline = body.tagline;\n            if (body.topics !== undefined) updateData.topics = body.topics;\n            if (body.priceId !== undefined) updateData.price_id = body.priceId;\n            if (body.color !== undefined) updateData.color = body.color;\n            if (body.colorPalette !== undefined) updateData.color_palette = body.colorPalette;\n            if (body.path !== undefined) updateData.path = body.path;\n            if (body.displayOrder !== undefined) updateData.display_order = body.displayOrder;\n            if (body.collectionSeriesId !== undefined) updateData.collection_series_id = body.collectionSeriesId;\n            if (body.isActive !== undefined) updateData.is_active = body.isActive;\n            // Handle is_sample and full_box_id fields\n            if (body.isSample !== undefined) updateData.is_sample = body.isSample;\n            if (body.fullBoxId !== undefined) {\n                // Only set full_box_id if this is a sample box\n                updateData.full_box_id = body.isSample ? body.fullBoxId : null;\n            }\n            // If setting isSample to false, clear the full_box_id\n            if (body.isSample === false) {\n                updateData.full_box_id = null;\n            }\n            const { error } = await supabase.from(\"boxes\").update(updateData).eq(\"id\", boxId);\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true\n            }));\n        }\n        // ADMIN ROUTES - Update collection series\n        if (path.startsWith(\"admin/collection-series/\")) {\n            const seriesId = path.split(\"/\")[2];\n            const body = await request.json();\n            const updateData = {};\n            if (body.name !== undefined) updateData.name = body.name;\n            if (body.description !== undefined) updateData.description = body.description;\n            if (body.displayOrder !== undefined) updateData.display_order = body.displayOrder;\n            if (body.isActive !== undefined) updateData.is_active = body.isActive;\n            const { error } = await supabase.from(\"collection_series\").update(updateData).eq(\"id\", seriesId);\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true\n            }));\n        }\n        // ADMIN ROUTES - Update price\n        if (path.startsWith(\"admin/prices/\")) {\n            const priceId = path.split(\"/\")[2];\n            const body = await request.json();\n            const updateData = {};\n            if (body.label !== undefined) updateData.label = body.label;\n            if (body.paymentInfo !== undefined) updateData.payment_info = body.paymentInfo;\n            if (body.hookInfo !== undefined) updateData.hook_info = body.hookInfo;\n            if (body.amount !== undefined) updateData.amount = body.amount;\n            if (body.promoAmount !== undefined) updateData.promo_amount = body.promoAmount;\n            if (body.promoEnabled !== undefined) updateData.promo_enabled = body.promoEnabled;\n            if (body.currency !== undefined) updateData.currency = body.currency;\n            if (body.membershipDays !== undefined) updateData.membership_days = body.membershipDays;\n            if (body.stripePriceId !== undefined) updateData.stripe_price_id = body.stripePriceId;\n            if (body.displayOrder !== undefined) updateData.display_order = body.displayOrder;\n            if (body.isActive !== undefined) updateData.is_active = body.isActive;\n            const { error } = await supabase.from(\"prices\").update(updateData).eq(\"id\", priceId);\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true\n            }));\n        }\n        // ADMIN ROUTES - Update pile\n        if (path.startsWith(\"admin/piles/\")) {\n            const pileId = path.split(\"/\")[2];\n            const body = await request.json();\n            const updateData = {};\n            if (body.slug !== undefined) updateData.slug = body.slug;\n            if (body.name !== undefined) updateData.name = body.name;\n            if (body.imagePath !== undefined) updateData.image_path = body.imagePath;\n            if (body.collectionSeriesId !== undefined) updateData.collection_series_id = body.collectionSeriesId;\n            if (body.displayOrder !== undefined) updateData.display_order = body.displayOrder;\n            if (body.isActive !== undefined) updateData.is_active = body.isActive;\n            const { error } = await supabase.from(\"piles\").update(updateData).eq(\"id\", pileId);\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true\n            }));\n        }\n        // ADMIN ROUTES - Update bundle\n        if (path.startsWith(\"admin/bundles/\")) {\n            const bundleId = path.split(\"/\")[2];\n            const body = await request.json();\n            const updateData = {};\n            if (body.name !== undefined) updateData.name = body.name;\n            if (body.description !== undefined) updateData.description = body.description;\n            if (body.priceId !== undefined) updateData.price_id = body.priceId;\n            if (body.boxIds !== undefined) updateData.box_ids = body.boxIds;\n            if (body.displayOrder !== undefined) updateData.display_order = body.displayOrder;\n            if (body.isActive !== undefined) updateData.is_active = body.isActive;\n            const { error } = await supabase.from(\"bundles\").update(updateData).eq(\"id\", bundleId);\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true\n            }));\n        }\n        return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Route not found\"\n        }, {\n            status: 404\n        }));\n    } catch (error) {\n        console.error(\"API Error:\", error);\n        return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: error.message\n        }, {\n            status: 500\n        }));\n    }\n}\nasync function DELETE(request) {\n    const url = new URL(request.url);\n    const path = url.pathname.replace(\"/api/\", \"\");\n    const supabase = (0,_lib_supabase_server__WEBPACK_IMPORTED_MODULE_1__.createSupabaseServer)();\n    try {\n        const { user, error: authError } = await getAuthenticatedUser();\n        if (authError || !user) {\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Unauthorized\"\n            }, {\n                status: 401\n            }));\n        }\n        // ADMIN ROUTES - Delete card\n        if (path.startsWith(\"admin/cards/\")) {\n            const cardId = path.split(\"/\")[2];\n            const { error } = await supabase.from(\"cards\").delete().eq(\"id\", cardId);\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true\n            }));\n        }\n        // ADMIN ROUTES - Delete box\n        if (path.startsWith(\"admin/boxes/\")) {\n            const boxId = path.split(\"/\")[2];\n            // First check if any cards are assigned to this box\n            const { data: cards } = await supabase.from(\"cards\").select(\"id\").eq(\"box_id\", boxId).limit(1);\n            if (cards && cards.length > 0) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Cannot delete box with assigned cards. Remove cards first.\"\n                }, {\n                    status: 400\n                }));\n            }\n            const { error } = await supabase.from(\"boxes\").delete().eq(\"id\", boxId);\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true\n            }));\n        }\n        // ADMIN ROUTES - Delete collection series\n        if (path.startsWith(\"admin/collection-series/\")) {\n            const seriesId = path.split(\"/\")[2];\n            const { error } = await supabase.from(\"collection_series\").delete().eq(\"id\", seriesId);\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true\n            }));\n        }\n        // ADMIN ROUTES - Delete price\n        if (path.startsWith(\"admin/prices/\")) {\n            const priceId = path.split(\"/\")[2];\n            const { error } = await supabase.from(\"prices\").delete().eq(\"id\", priceId);\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true\n            }));\n        }\n        // ADMIN ROUTES - Delete pile\n        if (path.startsWith(\"admin/piles/\")) {\n            const pileId = path.split(\"/\")[2];\n            const { error } = await supabase.from(\"piles\").delete().eq(\"id\", pileId);\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true\n            }));\n        }\n        // ADMIN ROUTES - Delete bundle\n        if (path.startsWith(\"admin/bundles/\")) {\n            const bundleId = path.split(\"/\")[2];\n            const { error } = await supabase.from(\"bundles\").delete().eq(\"id\", bundleId);\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true\n            }));\n        }\n        return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Route not found\"\n        }, {\n            status: 404\n        }));\n    } catch (error) {\n        console.error(\"API Error:\", error);\n        return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: error.message\n        }, {\n            status: 500\n        }));\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUMwRCxJQUFJLENBQUM7WUFBRXBDLE9BQU87UUFBa0IsR0FBRztZQUFFWixRQUFRO1FBQUk7SUFFbEYsRUFBRSxPQUFPWSxPQUFPO1FBQ2RrRCxRQUFRbEQsS0FBSyxDQUFDLGNBQWNBO1FBQzVCLE9BQU9qQixXQUFXTCxxREFBWUEsQ0FBQzBELElBQUksQ0FBQztZQUFFcEMsT0FBT0EsTUFBTWdELE9BQU87UUFBQyxHQUFHO1lBQUU1RCxRQUFRO1FBQUk7SUFDOUU7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL2Fzd2VhbGxhcmUtYWRtaW4vLi9hcHAvYXBpL1tbLi4ucGF0aF1dL3JvdXRlLmpzPzQ4ZjEiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dFJlc3BvbnNlIH0gZnJvbSAnbmV4dC9zZXJ2ZXInXG5pbXBvcnQgeyBjcmVhdGVTdXBhYmFzZVNlcnZlciB9IGZyb20gJy4uLy4uLy4uL2xpYi9zdXBhYmFzZS1zZXJ2ZXInXG5pbXBvcnQgeyBnZXRTdHJpcGUgfSBmcm9tICcuLi8uLi8uLi9saWIvc3RyaXBlJ1xuaW1wb3J0IHsgdjQgYXMgdXVpZHY0IH0gZnJvbSAndXVpZCdcblxuLy8gQ09SUyBoZWxwZXJcbmZ1bmN0aW9uIGhhbmRsZUNPUlMocmVzcG9uc2UpIHtcbiAgcmVzcG9uc2UuaGVhZGVycy5zZXQoJ0FjY2Vzcy1Db250cm9sLUFsbG93LU9yaWdpbicsICcqJylcbiAgcmVzcG9uc2UuaGVhZGVycy5zZXQoJ0FjY2Vzcy1Db250cm9sLUFsbG93LU1ldGhvZHMnLCAnR0VULCBQT1NULCBQVVQsIERFTEVURSwgT1BUSU9OUycpXG4gIHJlc3BvbnNlLmhlYWRlcnMuc2V0KCdBY2Nlc3MtQ29udHJvbC1BbGxvdy1IZWFkZXJzJywgJ0NvbnRlbnQtVHlwZSwgQXV0aG9yaXphdGlvbicpXG4gIHJldHVybiByZXNwb25zZVxufVxuXG4vLyBPUFRJT05TIGhhbmRsZXIgZm9yIENPUlNcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBPUFRJT05TKCkge1xuICByZXR1cm4gaGFuZGxlQ09SUyhuZXcgTmV4dFJlc3BvbnNlKG51bGwsIHsgc3RhdHVzOiAyMDAgfSkpXG59XG5cbi8vIEhlbHBlciB0byBnZXQgYXV0aGVudGljYXRlZCB1c2VyXG5hc3luYyBmdW5jdGlvbiBnZXRBdXRoZW50aWNhdGVkVXNlcigpIHtcbiAgLy8gSW4gbG9jYWwgbW9kZSwgY2hlY2sgdGhlIGF1dGgtdG9rZW4gY29va2llXG4gIGlmIChwcm9jZXNzLmVudi5MT0NBTF9NT0RFID09PSAndHJ1ZScpIHtcbiAgICBjb25zdCB7IGNvb2tpZXMgfSA9IGF3YWl0IGltcG9ydCgnbmV4dC9oZWFkZXJzJylcbiAgICBjb25zdCB7IGdldFVzZXJGcm9tVG9rZW4gfSA9IGF3YWl0IGltcG9ydCgnLi4vLi4vLi4vbGliL2F1dGgtbG9jYWwnKVxuICAgIFxuICAgIGNvbnN0IGNvb2tpZVN0b3JlID0gY29va2llcygpXG4gICAgY29uc3QgdG9rZW4gPSBjb29raWVTdG9yZS5nZXQoJ2F1dGgtdG9rZW4nKT8udmFsdWVcbiAgICBcbiAgICBpZiAodG9rZW4pIHtcbiAgICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBnZXRVc2VyRnJvbVRva2VuKHRva2VuKVxuICAgICAgaWYgKHVzZXIpIHtcbiAgICAgICAgcmV0dXJuIHsgdXNlciwgZXJyb3I6IG51bGwgfVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4geyB1c2VyOiBudWxsLCBlcnJvcjogbnVsbCB9XG4gIH1cbiAgXG4gIC8vIFN1cGFiYXNlIG1vZGVcbiAgY29uc3Qgc3VwYWJhc2UgPSBjcmVhdGVTdXBhYmFzZVNlcnZlcigpXG4gIGNvbnN0IHsgZGF0YTogeyB1c2VyIH0sIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZS5hdXRoLmdldFVzZXIoKVxuICByZXR1cm4geyB1c2VyLCBlcnJvciB9XG59XG5cbi8vIEltcG9ydCBlbnRpdGxlbWVudHMgaGVscGVyXG5pbXBvcnQgeyBnZXRVc2VyRW50aXRsZWRCb3hJZHMsIGdldEJveGVzV2l0aFZpc2liaWxpdHkgfSBmcm9tICcuLi8uLi8uLi9saWIvZW50aXRsZW1lbnRzJ1xuXG4vLyBIZWxwZXIgdG8gZ2V0IHVzZXIncyBhY2Nlc3NpYmxlIGJveGVzIC0gdXNlcyBlbnRpdGxlbWVudHMgYXMgc291cmNlIG9mIHRydXRoXG5hc3luYyBmdW5jdGlvbiBnZXRVc2VyQWNjZXNzaWJsZUJveGVzKHVzZXJJZCkge1xuICBjb25zdCBzdXBhYmFzZSA9IGNyZWF0ZVN1cGFiYXNlU2VydmVyKClcbiAgXG4gIC8vIEdldCBhbGwgYWN0aXZlIGJveGVzXG4gIGNvbnN0IHsgZGF0YTogYm94ZXMsIGVycm9yOiBib3hFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAuZnJvbSgnYm94ZXMnKVxuICAgIC5zZWxlY3QoJyonKVxuICAgIC5lcSgnaXNfYWN0aXZlJywgdHJ1ZSlcbiAgICAub3JkZXIoJ2Rpc3BsYXlfb3JkZXInLCB7IGFzY2VuZGluZzogdHJ1ZSB9KVxuICBcbiAgaWYgKGJveEVycm9yIHx8ICFib3hlcykge1xuICAgIHJldHVybiB7IGJveGVzOiBbXSwgYWNjZXNzaWJsZUJveElkczogW10gfVxuICB9XG4gIFxuICAvLyBVc2UgZW50aXRsZW1lbnRzIGhlbHBlciBhcyB0aGUgc2luZ2xlIHNvdXJjZSBvZiB0cnV0aFxuICBjb25zdCB7IGJveElkczogYWNjZXNzaWJsZUJveElkcywgaGFzTWVtYmVyc2hpcCB9ID0gYXdhaXQgZ2V0VXNlckVudGl0bGVkQm94SWRzKHVzZXJJZClcbiAgXG4gIHJldHVybiB7IFxuICAgIGJveGVzLCBcbiAgICBhY2Nlc3NpYmxlQm94SWRzLCBcbiAgICBoYXNBbGxBY2Nlc3M6IGhhc01lbWJlcnNoaXAgXG4gIH1cbn1cblxuLy8gSGVscGVyIHRvIGNoZWNrIGlmIHVzZXIgaGFzIHBhaWQgYWNjZXNzXG5hc3luYyBmdW5jdGlvbiBjaGVja1VzZXJBY2Nlc3ModXNlcklkKSB7XG4gIGNvbnN0IHsgYWNjZXNzaWJsZUJveElkcywgaGFzQWxsQWNjZXNzIH0gPSBhd2FpdCBnZXRVc2VyQWNjZXNzaWJsZUJveGVzKHVzZXJJZClcbiAgXG4gIC8vIFVzZXIgaGFzIHBhaWQgYWNjZXNzIGlmIHRoZXkgaGF2ZSBhY2Nlc3MgdG8gYW55IG5vbi1zYW1wbGUgYm94XG4gIGNvbnN0IHN1cGFiYXNlID0gY3JlYXRlU3VwYWJhc2VTZXJ2ZXIoKVxuICBjb25zdCB7IGRhdGE6IHNhbXBsZUJveGVzIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgIC5mcm9tKCdib3hlcycpXG4gICAgLnNlbGVjdCgnaWQnKVxuICAgIC5lcSgnaXNfc2FtcGxlJywgdHJ1ZSlcbiAgXG4gIGNvbnN0IHNhbXBsZUJveElkcyA9IChzYW1wbGVCb3hlcyB8fCBbXSkubWFwKGIgPT4gYi5pZClcbiAgY29uc3QgaGFzUGFpZEFjY2VzcyA9IGhhc0FsbEFjY2VzcyB8fCBhY2Nlc3NpYmxlQm94SWRzLnNvbWUoaWQgPT4gIXNhbXBsZUJveElkcy5pbmNsdWRlcyhpZCkpXG4gIFxuICByZXR1cm4geyBoYXNQYWlkQWNjZXNzLCBhY2Nlc3NpYmxlQm94SWRzLCBoYXNBbGxBY2Nlc3MgfVxufVxuXG4vLyBNYWluIHJlcXVlc3QgaGFuZGxlclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIEdFVChyZXF1ZXN0KSB7XG4gIGNvbnN0IHVybCA9IG5ldyBVUkwocmVxdWVzdC51cmwpXG4gIGNvbnN0IHBhdGggPSB1cmwucGF0aG5hbWUucmVwbGFjZSgnL2FwaS8nLCAnJylcbiAgY29uc3Qgc3VwYWJhc2UgPSBjcmVhdGVTdXBhYmFzZVNlcnZlcigpXG5cbiAgdHJ5IHtcbiAgICAvLyBBVVRIIFJPVVRFU1xuICAgIGlmIChwYXRoID09PSAnYXV0aC91c2VyJykge1xuICAgICAgY29uc3QgeyB1c2VyLCBlcnJvciB9ID0gYXdhaXQgZ2V0QXV0aGVudGljYXRlZFVzZXIoKVxuICAgICAgXG4gICAgICBpZiAoZXJyb3IgfHwgIXVzZXIpIHtcbiAgICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyB1c2VyOiBudWxsIH0sIHsgc3RhdHVzOiAyMDAgfSkpXG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIENoZWNrIHVzZXIgYWNjZXNzXG4gICAgICBjb25zdCB7IGhhc1BhaWRBY2Nlc3MsIGFjY2Vzc2libGVCb3hJZHMsIGhhc0FsbEFjY2VzcyB9ID0gYXdhaXQgY2hlY2tVc2VyQWNjZXNzKHVzZXIuaWQpXG4gICAgICBcbiAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgXG4gICAgICAgIHVzZXI6IHtcbiAgICAgICAgICBpZDogdXNlci5pZCxcbiAgICAgICAgICBlbWFpbDogdXNlci5lbWFpbCxcbiAgICAgICAgICBoYXNQYWlkQWNjZXNzLFxuICAgICAgICAgIGFjY2Vzc2libGVCb3hJZHMsXG4gICAgICAgICAgaGFzQWxsQWNjZXNzXG4gICAgICAgIH1cbiAgICAgIH0pKVxuICAgIH1cblxuICAgIC8vIEJPWEVTIFJPVVRFUyAtIEdldCBhbGwgYm94ZXMgd2l0aCB1c2VyIGFjY2VzcyBpbmZvXG4gICAgaWYgKHBhdGggPT09ICdib3hlcycpIHtcbiAgICAgIGNvbnN0IHsgdXNlciB9ID0gYXdhaXQgZ2V0QXV0aGVudGljYXRlZFVzZXIoKVxuICAgICAgY29uc3QgdXNlcklkID0gdXNlcj8uaWQgfHwgbnVsbFxuICAgICAgXG4gICAgICBjb25zdCB7IGJveGVzLCBhY2Nlc3NpYmxlQm94SWRzLCBoYXNBbGxBY2Nlc3MgfSA9IGF3YWl0IGdldFVzZXJBY2Nlc3NpYmxlQm94ZXModXNlcklkKVxuICAgICAgXG4gICAgICAvLyBBZGQgaGFzQWNjZXNzIGZsYWcgdG8gZWFjaCBib3hcbiAgICAgIGNvbnN0IGJveGVzV2l0aEFjY2VzcyA9IGJveGVzLm1hcChib3ggPT4gKHtcbiAgICAgICAgLi4uYm94LFxuICAgICAgICBoYXNBY2Nlc3M6IGFjY2Vzc2libGVCb3hJZHMuaW5jbHVkZXMoYm94LmlkKVxuICAgICAgfSkpXG4gICAgICBcbiAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgXG4gICAgICAgIGJveGVzOiBib3hlc1dpdGhBY2Nlc3MsXG4gICAgICAgIGhhc0FsbEFjY2Vzc1xuICAgICAgfSkpXG4gICAgfVxuXG4gICAgLy8gQ0FSRFMgUk9VVEVTIC0gTm93IHN1cHBvcnRzIGJveCBmaWx0ZXJpbmdcbiAgICBpZiAocGF0aCA9PT0gJ2NhcmRzJykge1xuICAgICAgY29uc3QgeyB1c2VyIH0gPSBhd2FpdCBnZXRBdXRoZW50aWNhdGVkVXNlcigpXG4gICAgICBjb25zdCBib3hJZHMgPSB1cmwuc2VhcmNoUGFyYW1zLmdldCgnYm94X2lkcycpPy5zcGxpdCgnLCcpLmZpbHRlcihCb29sZWFuKSB8fCBbXVxuICAgICAgXG4gICAgICAvLyBHZXQgdXNlcidzIGFjY2Vzc2libGUgYm94ZXNcbiAgICAgIGNvbnN0IHsgYWNjZXNzaWJsZUJveElkcyB9ID0gYXdhaXQgZ2V0VXNlckFjY2Vzc2libGVCb3hlcyh1c2VyPy5pZCB8fCBudWxsKVxuICAgICAgXG4gICAgICAvLyBEZXRlcm1pbmUgd2hpY2ggYm94ZXMgdG8gcXVlcnlcbiAgICAgIGxldCBxdWVyeUJveElkcyA9IFtdXG4gICAgICBpZiAoYm94SWRzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgcXVlcnlCb3hJZHMgPSBib3hJZHMuZmlsdGVyKGlkID0+IGFjY2Vzc2libGVCb3hJZHMuaW5jbHVkZXMoaWQpKVxuICAgICAgICBpZiAocXVlcnlCb3hJZHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBjYXJkczogW10sIG1lc3NhZ2U6ICdObyBhY2Nlc3NpYmxlIGJveGVzJyB9KSlcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIGlmIChhY2Nlc3NpYmxlQm94SWRzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgcXVlcnlCb3hJZHMgPSBhY2Nlc3NpYmxlQm94SWRzXG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IGNhcmRzOiBbXSwgbWVzc2FnZTogJ05vIGFjY2Vzc2libGUgYm94ZXMnIH0pKVxuICAgICAgfVxuICAgICAgXG4gICAgICAvLyBRdWVyeSBjYXJkc1xuICAgICAgY29uc3QgeyBkYXRhOiBjYXJkcywgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgIC5mcm9tKCdjYXJkcycpXG4gICAgICAgIC5zZWxlY3QoJyonKVxuICAgICAgICAuaW4oJ2JveF9pZCcsIHF1ZXJ5Qm94SWRzKVxuICAgICAgICAuZXEoJ2lzX2FjdGl2ZScsIHRydWUpXG4gICAgICAgIC5vcmRlcignY3JlYXRlZF9hdCcsIHsgYXNjZW5kaW5nOiBmYWxzZSB9KVxuICAgICAgXG4gICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignW0NBUkRTIEFQSV0gRXJyb3IgZmV0Y2hpbmcgY2FyZHM6JywgZXJyb3IpXG4gICAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfSwgeyBzdGF0dXM6IDUwMCB9KSlcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8gSWYgd2UgaGF2ZSBjYXJkcywgZmV0Y2ggcGlsZXMgc2VwYXJhdGVseSBmb3IgY2FyZCBiYWNrIGltYWdlc1xuICAgICAgbGV0IHBpbGVzTWFwID0ge31cbiAgICAgIGlmIChjYXJkcyAmJiBjYXJkcy5sZW5ndGggPiAwKSB7XG4gICAgICAgIGNvbnN0IHBpbGVJZHMgPSBbLi4ubmV3IFNldChjYXJkcy5tYXAoYyA9PiBjLnBpbGVfaWQpLmZpbHRlcihCb29sZWFuKSldXG4gICAgICAgIGlmIChwaWxlSWRzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICBjb25zdCB7IGRhdGE6IHBpbGVzIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAgICAgLmZyb20oJ3BpbGVzJylcbiAgICAgICAgICAgIC5zZWxlY3QoJyonKVxuICAgICAgICAgICAgLmluKCdpZCcsIHBpbGVJZHMpXG4gICAgICAgICAgXG4gICAgICAgICAgaWYgKHBpbGVzKSB7XG4gICAgICAgICAgICBwaWxlcy5mb3JFYWNoKHAgPT4geyBwaWxlc01hcFtwLmlkXSA9IHAgfSlcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8gVHJhbnNmb3JtIGNhcmRzIHRvIGluY2x1ZGUgcGlsZSBpbmZvIGZvciB0aGUgZnJvbnRlbmRcbiAgICAgIGNvbnN0IHRyYW5zZm9ybWVkQ2FyZHMgPSAoY2FyZHMgfHwgW10pLm1hcChjYXJkID0+IHtcbiAgICAgICAgY29uc3QgcGlsZSA9IHBpbGVzTWFwW2NhcmQucGlsZV9pZF0gfHwge31cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBpZDogY2FyZC5pZCxcbiAgICAgICAgICBib3hfaWQ6IGNhcmQuYm94X2lkLFxuICAgICAgICAgIHBpbGVfaWQ6IGNhcmQucGlsZV9pZCxcbiAgICAgICAgICB0ZXh0OiBjYXJkLnRleHQsXG4gICAgICAgICAgaW1hZ2VfcGF0aDogY2FyZC5pbWFnZV9wYXRoLFxuICAgICAgICAgIGlzX2FjdGl2ZTogY2FyZC5pc19hY3RpdmUsXG4gICAgICAgICAgY3JlYXRlZF9hdDogY2FyZC5jcmVhdGVkX2F0LFxuICAgICAgICAgIC8vIEFkZCBwaWxlIGluZm8gZm9yIGNhcmQgYmFjayBpbWFnZXNcbiAgICAgICAgICBjb2xvcjogcGlsZS5zbHVnIHx8ICdibGFjaycsIC8vICdibGFjaycgb3IgJ3doaXRlJyBmcm9tIHBpbGUgc2x1Z1xuICAgICAgICAgIHBpbGVfbmFtZTogcGlsZS5uYW1lLFxuICAgICAgICAgIHBpbGVfaW1hZ2U6IHBpbGUuaW1hZ2VfcGF0aCxcbiAgICAgICAgICAvLyBMZWdhY3kgZmllbGRzIGZvciBjb21wYXRpYmlsaXR5XG4gICAgICAgICAgdGl0bGU6IGNhcmQudGV4dCxcbiAgICAgICAgICBpbWFnZVBhdGg6IGNhcmQuaW1hZ2VfcGF0aFxuICAgICAgICB9XG4gICAgICB9KVxuICAgICAgXG4gICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IGNhcmRzOiB0cmFuc2Zvcm1lZENhcmRzIH0pKVxuICAgIH1cblxuICAgIC8vIFNVQlNDUklQVElPTiBQTEFOU1xuICAgIGlmIChwYXRoID09PSAncGxhbnMnKSB7XG4gICAgICBjb25zdCB7IGRhdGE6IHBsYW5zLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgLmZyb20oJ3N1YnNjcmlwdGlvbl9wbGFucycpXG4gICAgICAgIC5zZWxlY3QoJyonKVxuICAgICAgICAuZXEoJ2lzX2FjdGl2ZScsIHRydWUpXG4gICAgICAgIC5vcmRlcigncHJpY2UnLCB7IGFzY2VuZGluZzogdHJ1ZSB9KVxuICAgICAgXG4gICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogZXJyb3IubWVzc2FnZSB9LCB7IHN0YXR1czogNTAwIH0pKVxuICAgICAgfVxuICAgICAgXG4gICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IHBsYW5zOiBwbGFucyB8fCBbXSB9KSlcbiAgICB9XG5cbiAgICAvLyBDT0xMRUNUSU9OIFNFUklFUyAtIFB1YmxpYyBlbmRwb2ludFxuICAgIGlmIChwYXRoID09PSAnY29sbGVjdGlvbi1zZXJpZXMnKSB7XG4gICAgICBjb25zdCB7IGRhdGE6IHNlcmllcywgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgIC5mcm9tKCdjb2xsZWN0aW9uX3NlcmllcycpXG4gICAgICAgIC5zZWxlY3QoJyonKVxuICAgICAgICAuZXEoJ2lzX2FjdGl2ZScsIHRydWUpXG4gICAgICAgIC5vcmRlcignZGlzcGxheV9vcmRlcicsIHsgYXNjZW5kaW5nOiB0cnVlIH0pXG4gICAgICBcbiAgICAgIGlmIChlcnJvcikge1xuICAgICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiBlcnJvci5tZXNzYWdlIH0sIHsgc3RhdHVzOiA1MDAgfSkpXG4gICAgICB9XG4gICAgICBcbiAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgc2VyaWVzOiBzZXJpZXMgfHwgW10gfSkpXG4gICAgfVxuXG4gICAgLy8gVVNFUiBQVVJDSEFTRVMgLSBHZXQgdXNlcidzIHB1cmNoYXNlIGhpc3RvcnlcbiAgICBpZiAocGF0aCA9PT0gJ3B1cmNoYXNlcycpIHtcbiAgICAgIGNvbnN0IHsgdXNlciwgZXJyb3I6IGF1dGhFcnJvciB9ID0gYXdhaXQgZ2V0QXV0aGVudGljYXRlZFVzZXIoKVxuICAgICAgXG4gICAgICBpZiAoYXV0aEVycm9yIHx8ICF1c2VyKSB7XG4gICAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdVbmF1dGhvcml6ZWQnIH0sIHsgc3RhdHVzOiA0MDEgfSkpXG4gICAgICB9XG4gICAgICBcbiAgICAgIGNvbnN0IHsgZGF0YTogcHVyY2hhc2VzLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgLmZyb20oJ3VzZXJfcHJvZHVjdHMnKVxuICAgICAgICAuc2VsZWN0KCcqLCBib3hlcyhuYW1lLCBjb2xvciwgcHJpY2UpJylcbiAgICAgICAgLmVxKCd1c2VyX2lkJywgdXNlci5pZClcbiAgICAgICAgLm9yZGVyKCdjcmVhdGVkX2F0JywgeyBhc2NlbmRpbmc6IGZhbHNlIH0pXG4gICAgICBcbiAgICAgIGlmIChlcnJvcikge1xuICAgICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiBlcnJvci5tZXNzYWdlIH0sIHsgc3RhdHVzOiA1MDAgfSkpXG4gICAgICB9XG4gICAgICBcbiAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgcHVyY2hhc2VzOiBwdXJjaGFzZXMgfHwgW10gfSkpXG4gICAgfVxuXG4gICAgLy8gU0FWRUQgRFJBV1MgUk9VVEVTXG4gICAgaWYgKHBhdGggPT09ICdkcmF3cycpIHtcbiAgICAgIGNvbnN0IHsgdXNlciwgZXJyb3I6IGF1dGhFcnJvciB9ID0gYXdhaXQgZ2V0QXV0aGVudGljYXRlZFVzZXIoKVxuICAgICAgXG4gICAgICBpZiAoYXV0aEVycm9yIHx8ICF1c2VyKSB7XG4gICAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdVbmF1dGhvcml6ZWQnIH0sIHsgc3RhdHVzOiA0MDEgfSkpXG4gICAgICB9XG4gICAgICBcbiAgICAgIGNvbnN0IHsgZGF0YTogZHJhd3MsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAuZnJvbSgnc2F2ZWRfZHJhd3MnKVxuICAgICAgICAuc2VsZWN0KCcqJylcbiAgICAgICAgLmVxKCd1c2VyaWQnLCB1c2VyLmlkKVxuICAgICAgICAub3JkZXIoJ3RpbWVzdGFtcCcsIHsgYXNjZW5kaW5nOiBmYWxzZSB9KVxuICAgICAgXG4gICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogZXJyb3IubWVzc2FnZSB9LCB7IHN0YXR1czogNTAwIH0pKVxuICAgICAgfVxuICAgICAgXG4gICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IGRyYXdzOiBkcmF3cyB8fCBbXSB9KSlcbiAgICB9XG5cbiAgICAvLyBBRE1JTiBST1VURVMgLSBHZXQgYWxsIGNhcmRzXG4gICAgaWYgKHBhdGggPT09ICdhZG1pbi9jYXJkcycpIHtcbiAgICAgIGNvbnN0IHsgdXNlciwgZXJyb3I6IGF1dGhFcnJvciB9ID0gYXdhaXQgZ2V0QXV0aGVudGljYXRlZFVzZXIoKVxuICAgICAgXG4gICAgICBpZiAoYXV0aEVycm9yIHx8ICF1c2VyKSB7XG4gICAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdVbmF1dGhvcml6ZWQnIH0sIHsgc3RhdHVzOiA0MDEgfSkpXG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIEdldCBjYXJkc1xuICAgICAgY29uc3QgeyBkYXRhOiBjYXJkcywgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgIC5mcm9tKCdjYXJkcycpXG4gICAgICAgIC5zZWxlY3QoJyonKVxuICAgICAgICAub3JkZXIoJ2NyZWF0ZWRfYXQnLCB7IGFzY2VuZGluZzogZmFsc2UgfSlcbiAgICAgIFxuICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfSwgeyBzdGF0dXM6IDUwMCB9KSlcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8gR2V0IGJveGVzLCBwaWxlcyBhbmQgc2VyaWVzIGZvciBlbnJpY2htZW50IC0gdXNlIFByb21pc2UuYWxsIGZvciByZWxpYWJpbGl0eVxuICAgICAgY29uc3QgW2JveGVzUmVzdWx0LCBwaWxlc1Jlc3VsdCwgc2VyaWVzUmVzdWx0XSA9IGF3YWl0IFByb21pc2UuYWxsKFtcbiAgICAgICAgc3VwYWJhc2UuZnJvbSgnYm94ZXMnKS5zZWxlY3QoJyonKSxcbiAgICAgICAgc3VwYWJhc2UuZnJvbSgncGlsZXMnKS5zZWxlY3QoJyonKSxcbiAgICAgICAgc3VwYWJhc2UuZnJvbSgnY29sbGVjdGlvbl9zZXJpZXMnKS5zZWxlY3QoJyonKVxuICAgICAgXSlcbiAgICAgIFxuICAgICAgY29uc3QgYm94ZXMgPSBib3hlc1Jlc3VsdC5kYXRhIHx8IFtdXG4gICAgICBjb25zdCBwaWxlcyA9IHBpbGVzUmVzdWx0LmRhdGEgfHwgW11cbiAgICAgIGNvbnN0IHNlcmllcyA9IHNlcmllc1Jlc3VsdC5kYXRhIHx8IFtdXG4gICAgICBcbiAgICAgIGNvbnN0IGJveE1hcCA9IHt9XG4gICAgICBjb25zdCBwaWxlTWFwID0ge31cbiAgICAgIGNvbnN0IHNlcmllc01hcCA9IHt9XG4gICAgICBcbiAgICAgIGJveGVzLmZvckVhY2goYiA9PiB7IGlmIChiICYmIGIuaWQpIGJveE1hcFtiLmlkXSA9IGIgfSlcbiAgICAgIHBpbGVzLmZvckVhY2gocCA9PiB7IGlmIChwICYmIHAuaWQpIHBpbGVNYXBbcC5pZF0gPSBwIH0pXG4gICAgICBzZXJpZXMuZm9yRWFjaChzID0+IHsgaWYgKHMgJiYgcy5pZCkgc2VyaWVzTWFwW3MuaWRdID0gcyB9KVxuICAgICAgXG4gICAgICAvLyBFbnJpY2ggY2FyZHMgd2l0aCBib3gvcGlsZSBpbmZvXG4gICAgICBjb25zdCBlbnJpY2hlZENhcmRzID0gKGNhcmRzIHx8IFtdKS5tYXAoY2FyZCA9PiB7XG4gICAgICAgIGNvbnN0IGJveCA9IGJveE1hcFtjYXJkLmJveF9pZF1cbiAgICAgICAgY29uc3QgcGlsZSA9IHBpbGVNYXBbY2FyZC5waWxlX2lkXVxuICAgICAgICBjb25zdCBjb2xsZWN0aW9uU2VyaWVzID0gYm94ID8gc2VyaWVzTWFwW2JveC5jb2xsZWN0aW9uX3Nlcmllc19pZF0gOiBudWxsXG4gICAgICAgIFxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIC4uLmNhcmQsXG4gICAgICAgICAgYm94ZXM6IGJveCA/IHtcbiAgICAgICAgICAgIG5hbWU6IGJveC5uYW1lLFxuICAgICAgICAgICAgY29sb3I6IGJveC5jb2xvcixcbiAgICAgICAgICAgIGNvbGxlY3Rpb25fc2VyaWVzX2lkOiBib3guY29sbGVjdGlvbl9zZXJpZXNfaWQsXG4gICAgICAgICAgICBjb2xsZWN0aW9uX3NlcmllczogY29sbGVjdGlvblNlcmllcyA/IHsgbmFtZTogY29sbGVjdGlvblNlcmllcy5uYW1lIH0gOiBudWxsXG4gICAgICAgICAgfSA6IG51bGwsXG4gICAgICAgICAgcGlsZXM6IHBpbGUgPyB7XG4gICAgICAgICAgICBuYW1lOiBwaWxlLm5hbWUsXG4gICAgICAgICAgICBzbHVnOiBwaWxlLnNsdWdcbiAgICAgICAgICB9IDogbnVsbFxuICAgICAgICB9XG4gICAgICB9KVxuICAgICAgXG4gICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IGNhcmRzOiBlbnJpY2hlZENhcmRzIH0pKVxuICAgIH1cblxuICAgIC8vIEFETUlOIFJPVVRFUyAtIEdldCBhbGwgYm94ZXNcbiAgICBpZiAocGF0aCA9PT0gJ2FkbWluL2JveGVzJykge1xuICAgICAgY29uc3QgeyB1c2VyLCBlcnJvcjogYXV0aEVycm9yIH0gPSBhd2FpdCBnZXRBdXRoZW50aWNhdGVkVXNlcigpXG4gICAgICBcbiAgICAgIGlmIChhdXRoRXJyb3IgfHwgIXVzZXIpIHtcbiAgICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ1VuYXV0aG9yaXplZCcgfSwgeyBzdGF0dXM6IDQwMSB9KSlcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8gR2V0IGJveGVzXG4gICAgICBjb25zdCB7IGRhdGE6IGJveGVzLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgLmZyb20oJ2JveGVzJylcbiAgICAgICAgLnNlbGVjdCgnKicpXG4gICAgICAgIC5vcmRlcignZGlzcGxheV9vcmRlcicsIHsgYXNjZW5kaW5nOiB0cnVlIH0pXG4gICAgICBcbiAgICAgIGlmIChlcnJvcikge1xuICAgICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiBlcnJvci5tZXNzYWdlIH0sIHsgc3RhdHVzOiA1MDAgfSkpXG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIEdldCBhbGwgcmVsYXRlZCBkYXRhIC0gdXNlIFByb21pc2UuYWxsIGZvciBwYXJhbGxlbCBmZXRjaGluZ1xuICAgICAgY29uc3QgW2NhcmRzUmVzdWx0LCBwaWxlc1Jlc3VsdCwgc2VyaWVzUmVzdWx0LCBwcmljZXNSZXN1bHRdID0gYXdhaXQgUHJvbWlzZS5hbGwoW1xuICAgICAgICBzdXBhYmFzZS5mcm9tKCdjYXJkcycpLnNlbGVjdCgnKicpLFxuICAgICAgICBzdXBhYmFzZS5mcm9tKCdwaWxlcycpLnNlbGVjdCgnKicpLFxuICAgICAgICBzdXBhYmFzZS5mcm9tKCdjb2xsZWN0aW9uX3NlcmllcycpLnNlbGVjdCgnKicpLFxuICAgICAgICBzdXBhYmFzZS5mcm9tKCdwcmljZXMnKS5zZWxlY3QoJyonKVxuICAgICAgXSlcbiAgICAgIFxuICAgICAgY29uc3QgY2FyZHMgPSBjYXJkc1Jlc3VsdC5kYXRhIHx8IFtdXG4gICAgICBjb25zdCBwaWxlcyA9IHBpbGVzUmVzdWx0LmRhdGEgfHwgW11cbiAgICAgIGNvbnN0IHNlcmllcyA9IHNlcmllc1Jlc3VsdC5kYXRhIHx8IFtdXG4gICAgICBjb25zdCBwcmljZXMgPSBwcmljZXNSZXN1bHQuZGF0YSB8fCBbXVxuICAgICAgXG4gICAgICAvLyBMb2cgZm9yIGRlYnVnZ2luZ1xuICAgICAgY29uc29sZS5sb2coYFthZG1pbi9ib3hlc10gTG9hZGVkICR7Ym94ZXM/Lmxlbmd0aCB8fCAwfSBib3hlcywgJHtzZXJpZXMubGVuZ3RofSBzZXJpZXMsICR7cGlsZXMubGVuZ3RofSBwaWxlcywgJHtwcmljZXMubGVuZ3RofSBwcmljZXNgKVxuICAgICAgXG4gICAgICBjb25zdCBzZXJpZXNNYXAgPSB7fVxuICAgICAgY29uc3QgcHJpY2VNYXAgPSB7fVxuICAgICAgY29uc3QgcGlsZU1hcCA9IHt9XG4gICAgICBcbiAgICAgIHNlcmllcy5mb3JFYWNoKHMgPT4geyBpZiAocyAmJiBzLmlkKSBzZXJpZXNNYXBbcy5pZF0gPSBzIH0pXG4gICAgICBwcmljZXMuZm9yRWFjaChwID0+IHsgaWYgKHAgJiYgcC5pZCkgcHJpY2VNYXBbcC5pZF0gPSBwIH0pXG4gICAgICBwaWxlcy5mb3JFYWNoKHAgPT4geyBpZiAocCAmJiBwLmlkKSBwaWxlTWFwW3AuaWRdID0gcCB9KVxuICAgICAgXG4gICAgICAvLyBDb3VudCBjYXJkcyBwZXIgYm94IHBlciBwaWxlXG4gICAgICBjb25zdCBjYXJkQ291bnRzID0ge31cbiAgICAgIGlmIChjYXJkcykge1xuICAgICAgICBjYXJkcy5mb3JFYWNoKGNhcmQgPT4ge1xuICAgICAgICAgIGNvbnN0IGtleSA9IGAke2NhcmQuYm94X2lkfWBcbiAgICAgICAgICBpZiAoIWNhcmRDb3VudHNba2V5XSkge1xuICAgICAgICAgICAgY2FyZENvdW50c1trZXldID0geyB0b3RhbDogMCwgYnlQaWxlOiB7fSB9XG4gICAgICAgICAgfVxuICAgICAgICAgIGNhcmRDb3VudHNba2V5XS50b3RhbCsrXG4gICAgICAgICAgXG4gICAgICAgICAgY29uc3QgcGlsZUlkID0gY2FyZC5waWxlX2lkXG4gICAgICAgICAgaWYgKCFjYXJkQ291bnRzW2tleV0uYnlQaWxlW3BpbGVJZF0pIHtcbiAgICAgICAgICAgIGNhcmRDb3VudHNba2V5XS5ieVBpbGVbcGlsZUlkXSA9IHsgY291bnQ6IDAsIHBpbGVOYW1lOiBwaWxlTWFwW3BpbGVJZF0/Lm5hbWUgfHwgJ1Vua25vd24nLCBwaWxlU2x1ZzogcGlsZU1hcFtwaWxlSWRdPy5zbHVnIHx8ICcnIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgY2FyZENvdW50c1trZXldLmJ5UGlsZVtwaWxlSWRdLmNvdW50KytcbiAgICAgICAgfSlcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8gRW5yaWNoIGJveGVzIHdpdGggcmVsYXRlZCBkYXRhXG4gICAgICBjb25zdCBlbnJpY2hlZEJveGVzID0gKGJveGVzIHx8IFtdKS5tYXAoYm94ID0+ICh7XG4gICAgICAgIC4uLmJveCxcbiAgICAgICAgY29sbGVjdGlvbl9zZXJpZXM6IHNlcmllc01hcFtib3guY29sbGVjdGlvbl9zZXJpZXNfaWRdIHx8IG51bGwsXG4gICAgICAgIHByaWNlczogcHJpY2VNYXBbYm94LnByaWNlX2lkXSB8fCBudWxsLFxuICAgICAgICBjYXJkU3RhdHM6IGNhcmRDb3VudHNbYm94LmlkXSB8fCB7IHRvdGFsOiAwLCBieVBpbGU6IHt9IH1cbiAgICAgIH0pKVxuICAgICAgXG4gICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IGJveGVzOiBlbnJpY2hlZEJveGVzLCBwaWxlczogcGlsZXMgfHwgW10gfSkpXG4gICAgfVxuXG4gICAgLy8gQURNSU4gUk9VVEVTIC0gR2V0IGFsbCBjb2xsZWN0aW9uIHNlcmllc1xuICAgIGlmIChwYXRoID09PSAnYWRtaW4vY29sbGVjdGlvbi1zZXJpZXMnKSB7XG4gICAgICBjb25zdCB7IHVzZXIsIGVycm9yOiBhdXRoRXJyb3IgfSA9IGF3YWl0IGdldEF1dGhlbnRpY2F0ZWRVc2VyKClcbiAgICAgIFxuICAgICAgaWYgKGF1dGhFcnJvciB8fCAhdXNlcikge1xuICAgICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnVW5hdXRob3JpemVkJyB9LCB7IHN0YXR1czogNDAxIH0pKVxuICAgICAgfVxuICAgICAgXG4gICAgICBjb25zdCB7IGRhdGE6IHNlcmllcywgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgIC5mcm9tKCdjb2xsZWN0aW9uX3NlcmllcycpXG4gICAgICAgIC5zZWxlY3QoJyonKVxuICAgICAgICAub3JkZXIoJ2Rpc3BsYXlfb3JkZXInLCB7IGFzY2VuZGluZzogdHJ1ZSB9KVxuICAgICAgXG4gICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogZXJyb3IubWVzc2FnZSB9LCB7IHN0YXR1czogNTAwIH0pKVxuICAgICAgfVxuICAgICAgXG4gICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IHNlcmllczogc2VyaWVzIHx8IFtdIH0pKVxuICAgIH1cblxuICAgIC8vIEFETUlOIFJPVVRFUyAtIEdldCBhbGwgcHJpY2VzXG4gICAgaWYgKHBhdGggPT09ICdhZG1pbi9wcmljZXMnKSB7XG4gICAgICBjb25zdCB7IHVzZXIsIGVycm9yOiBhdXRoRXJyb3IgfSA9IGF3YWl0IGdldEF1dGhlbnRpY2F0ZWRVc2VyKClcbiAgICAgIFxuICAgICAgaWYgKGF1dGhFcnJvciB8fCAhdXNlcikge1xuICAgICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnVW5hdXRob3JpemVkJyB9LCB7IHN0YXR1czogNDAxIH0pKVxuICAgICAgfVxuICAgICAgXG4gICAgICBjb25zdCB7IGRhdGE6IHByaWNlcywgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgIC5mcm9tKCdwcmljZXMnKVxuICAgICAgICAuc2VsZWN0KCcqJylcbiAgICAgICAgLm9yZGVyKCdkaXNwbGF5X29yZGVyJywgeyBhc2NlbmRpbmc6IHRydWUgfSlcbiAgICAgIFxuICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfSwgeyBzdGF0dXM6IDUwMCB9KSlcbiAgICAgIH1cbiAgICAgIFxuICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBwcmljZXM6IHByaWNlcyB8fCBbXSB9KSlcbiAgICB9XG5cbiAgICAvLyBBRE1JTiBST1VURVMgLSBHZXQgYWxsIHBpbGVzXG4gICAgaWYgKHBhdGggPT09ICdhZG1pbi9waWxlcycpIHtcbiAgICAgIGNvbnN0IHsgdXNlciwgZXJyb3I6IGF1dGhFcnJvciB9ID0gYXdhaXQgZ2V0QXV0aGVudGljYXRlZFVzZXIoKVxuICAgICAgXG4gICAgICBpZiAoYXV0aEVycm9yIHx8ICF1c2VyKSB7XG4gICAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdVbmF1dGhvcml6ZWQnIH0sIHsgc3RhdHVzOiA0MDEgfSkpXG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIEdldCBwaWxlcyBmaXJzdFxuICAgICAgY29uc3QgeyBkYXRhOiBwaWxlcywgZXJyb3I6IHBpbGVzRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgIC5mcm9tKCdwaWxlcycpXG4gICAgICAgIC5zZWxlY3QoJyonKVxuICAgICAgICAub3JkZXIoJ2Rpc3BsYXlfb3JkZXInLCB7IGFzY2VuZGluZzogdHJ1ZSB9KVxuICAgICAgXG4gICAgICBpZiAocGlsZXNFcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gbG9hZCBwaWxlczonLCBwaWxlc0Vycm9yKVxuICAgICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiBwaWxlc0Vycm9yLm1lc3NhZ2UgfSwgeyBzdGF0dXM6IDUwMCB9KSlcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8gR2V0IGFsbCBzZXJpZXMgZm9yIG1hcHBpbmcgLSBkbyB0aGlzIGFzIGEgc2VwYXJhdGUgZ3VhcmFudGVlZCBxdWVyeVxuICAgICAgY29uc3QgeyBkYXRhOiBzZXJpZXMsIGVycm9yOiBzZXJpZXNFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgLmZyb20oJ2NvbGxlY3Rpb25fc2VyaWVzJylcbiAgICAgICAgLnNlbGVjdCgnKicpXG4gICAgICBcbiAgICAgIGlmIChzZXJpZXNFcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gbG9hZCBjb2xsZWN0aW9uX3NlcmllczonLCBzZXJpZXNFcnJvcilcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8gQnVpbGQgc2VyaWVzIGxvb2t1cCBtYXBcbiAgICAgIGNvbnN0IHNlcmllc01hcCA9IHt9XG4gICAgICBpZiAoc2VyaWVzICYmIEFycmF5LmlzQXJyYXkoc2VyaWVzKSkge1xuICAgICAgICBzZXJpZXMuZm9yRWFjaChzID0+IHsgXG4gICAgICAgICAgaWYgKHMgJiYgcy5pZCkge1xuICAgICAgICAgICAgc2VyaWVzTWFwW3MuaWRdID0gcyBcbiAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIExvZyBmb3IgZGVidWdnaW5nXG4gICAgICBjb25zb2xlLmxvZyhgW2FkbWluL3BpbGVzXSBMb2FkZWQgJHsocGlsZXMgfHwgW10pLmxlbmd0aH0gcGlsZXMsICR7T2JqZWN0LmtleXMoc2VyaWVzTWFwKS5sZW5ndGh9IHNlcmllc2ApXG4gICAgICBcbiAgICAgIC8vIEVucmljaCBwaWxlcyB3aXRoIHNlcmllcyBkYXRhXG4gICAgICBjb25zdCBlbnJpY2hlZFBpbGVzID0gKHBpbGVzIHx8IFtdKS5tYXAocCA9PiB7XG4gICAgICAgIGNvbnN0IHNlcmllc0RhdGEgPSBwLmNvbGxlY3Rpb25fc2VyaWVzX2lkID8gc2VyaWVzTWFwW3AuY29sbGVjdGlvbl9zZXJpZXNfaWRdIDogbnVsbFxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIC4uLnAsXG4gICAgICAgICAgY29sbGVjdGlvbl9zZXJpZXM6IHNlcmllc0RhdGEgfHwgbnVsbFxuICAgICAgICB9XG4gICAgICB9KVxuICAgICAgXG4gICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IHBpbGVzOiBlbnJpY2hlZFBpbGVzIH0pKVxuICAgIH1cblxuICAgIC8vIEFETUlOIFJPVVRFUyAtIEdldCBhbGwgYnVuZGxlc1xuICAgIGlmIChwYXRoID09PSAnYWRtaW4vYnVuZGxlcycpIHtcbiAgICAgIGNvbnN0IHsgdXNlciwgZXJyb3I6IGF1dGhFcnJvciB9ID0gYXdhaXQgZ2V0QXV0aGVudGljYXRlZFVzZXIoKVxuICAgICAgXG4gICAgICBpZiAoYXV0aEVycm9yIHx8ICF1c2VyKSB7XG4gICAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdVbmF1dGhvcml6ZWQnIH0sIHsgc3RhdHVzOiA0MDEgfSkpXG4gICAgICB9XG4gICAgICBcbiAgICAgIGNvbnN0IHsgZGF0YTogYnVuZGxlcywgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgIC5mcm9tKCdidW5kbGVzJylcbiAgICAgICAgLnNlbGVjdCgnKicpXG4gICAgICAgIC5vcmRlcignZGlzcGxheV9vcmRlcicsIHsgYXNjZW5kaW5nOiB0cnVlIH0pXG4gICAgICBcbiAgICAgIGlmIChlcnJvcikge1xuICAgICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiBlcnJvci5tZXNzYWdlIH0sIHsgc3RhdHVzOiA1MDAgfSkpXG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIEVucmljaCB3aXRoIHByaWNlIGluZm9cbiAgICAgIGNvbnN0IHsgZGF0YTogcHJpY2VzIH0gPSBhd2FpdCBzdXBhYmFzZS5mcm9tKCdwcmljZXMnKS5zZWxlY3QoJyonKVxuICAgICAgY29uc3QgcHJpY2VNYXAgPSB7fVxuICAgICAgaWYgKHByaWNlcykgcHJpY2VzLmZvckVhY2gocCA9PiB7IHByaWNlTWFwW3AuaWRdID0gcCB9KVxuICAgICAgXG4gICAgICBjb25zdCBlbnJpY2hlZEJ1bmRsZXMgPSAoYnVuZGxlcyB8fCBbXSkubWFwKGIgPT4gKHtcbiAgICAgICAgLi4uYixcbiAgICAgICAgcHJpY2VzOiBwcmljZU1hcFtiLnByaWNlX2lkXSB8fCBudWxsXG4gICAgICB9KSlcbiAgICAgIFxuICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBidW5kbGVzOiBlbnJpY2hlZEJ1bmRsZXMgfSkpXG4gICAgICBcbiAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgYnVuZGxlczogYnVuZGxlcyB8fCBbXSB9KSlcbiAgICB9XG5cbiAgICAvLyBQVUJMSUMgUk9VVEVTIC0gR2V0IGFjdGl2ZSBwcmljZXMgZm9yIHN0b3JlXG4gICAgaWYgKHBhdGggPT09ICdzdG9yZS9wcmljZXMnKSB7XG4gICAgICBjb25zdCB7IGRhdGE6IHByaWNlcywgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgIC5mcm9tKCdwcmljZXMnKVxuICAgICAgICAuc2VsZWN0KCcqJylcbiAgICAgICAgLmVxKCdpc19hY3RpdmUnLCB0cnVlKVxuICAgICAgICAub3JkZXIoJ2Rpc3BsYXlfb3JkZXInLCB7IGFzY2VuZGluZzogdHJ1ZSB9KVxuICAgICAgXG4gICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogZXJyb3IubWVzc2FnZSB9LCB7IHN0YXR1czogNTAwIH0pKVxuICAgICAgfVxuICAgICAgXG4gICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IHByaWNlczogcHJpY2VzIHx8IFtdIH0pKVxuICAgIH1cblxuICAgIC8vIFBVQkxJQyBST1VURVMgLSBHZXQgYWN0aXZlIGJ1bmRsZXMgZm9yIHN0b3JlXG4gICAgaWYgKHBhdGggPT09ICdzdG9yZS9idW5kbGVzJykge1xuICAgICAgY29uc3QgeyBkYXRhOiBidW5kbGVzLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgLmZyb20oJ2J1bmRsZXMnKVxuICAgICAgICAuc2VsZWN0KCcqLCBwcmljZXMoaWQsIGxhYmVsLCBhbW91bnQsIGN1cnJlbmN5LCBpc19tZW1iZXJzaGlwLCBtZW1iZXJzaGlwX2RheXMpJylcbiAgICAgICAgLmVxKCdpc19hY3RpdmUnLCB0cnVlKVxuICAgICAgICAub3JkZXIoJ2Rpc3BsYXlfb3JkZXInLCB7IGFzY2VuZGluZzogdHJ1ZSB9KVxuICAgICAgXG4gICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogZXJyb3IubWVzc2FnZSB9LCB7IHN0YXR1czogNTAwIH0pKVxuICAgICAgfVxuICAgICAgXG4gICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IGJ1bmRsZXM6IGJ1bmRsZXMgfHwgW10gfSkpXG4gICAgfVxuXG4gICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ1JvdXRlIG5vdCBmb3VuZCcgfSwgeyBzdGF0dXM6IDQwNCB9KSlcbiAgICBcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdBUEkgRXJyb3I6JywgZXJyb3IpXG4gICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogZXJyb3IubWVzc2FnZSB9LCB7IHN0YXR1czogNTAwIH0pKVxuICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBQT1NUKHJlcXVlc3QpIHtcbiAgY29uc3QgdXJsID0gbmV3IFVSTChyZXF1ZXN0LnVybClcbiAgY29uc3QgcGF0aCA9IHVybC5wYXRobmFtZS5yZXBsYWNlKCcvYXBpLycsICcnKVxuICBjb25zdCBzdXBhYmFzZSA9IGNyZWF0ZVN1cGFiYXNlU2VydmVyKClcblxuICB0cnkge1xuICAgIGNvbnN0IGJvZHkgPSBhd2FpdCByZXF1ZXN0Lmpzb24oKVxuXG4gICAgLy8gQVVUSCBST1VURVNcbiAgICBpZiAocGF0aCA9PT0gJ2F1dGgvc2lnbnVwJykge1xuICAgICAgY29uc3QgeyBlbWFpbCwgcGFzc3dvcmQgfSA9IGJvZHlcbiAgICAgIFxuICAgICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2UuYXV0aC5zaWduVXAoe1xuICAgICAgICBlbWFpbCxcbiAgICAgICAgcGFzc3dvcmQsXG4gICAgICB9KVxuICAgICAgXG4gICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogZXJyb3IubWVzc2FnZSB9LCB7IHN0YXR1czogNDAwIH0pKVxuICAgICAgfVxuICAgICAgXG4gICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IHVzZXI6IGRhdGEudXNlciB9KSlcbiAgICB9XG5cbiAgICBpZiAocGF0aCA9PT0gJ2F1dGgvc2lnbmluJykge1xuICAgICAgY29uc3QgeyBlbWFpbCwgcGFzc3dvcmQgfSA9IGJvZHlcbiAgICAgIFxuICAgICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2UuYXV0aC5zaWduSW5XaXRoUGFzc3dvcmQoe1xuICAgICAgICBlbWFpbCxcbiAgICAgICAgcGFzc3dvcmQsXG4gICAgICB9KVxuICAgICAgXG4gICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogZXJyb3IubWVzc2FnZSB9LCB7IHN0YXR1czogNDAwIH0pKVxuICAgICAgfVxuICAgICAgXG4gICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IHVzZXI6IGRhdGEudXNlciB9KSlcbiAgICB9XG5cbiAgICBpZiAocGF0aCA9PT0gJ2F1dGgvc2lnbm91dCcpIHtcbiAgICAgIGNvbnN0IHsgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlLmF1dGguc2lnbk91dCgpXG4gICAgICBcbiAgICAgIGlmIChlcnJvcikge1xuICAgICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiBlcnJvci5tZXNzYWdlIH0sIHsgc3RhdHVzOiA0MDAgfSkpXG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIENyZWF0ZSByZXNwb25zZSBhbmQgY2xlYXIgYXV0aCBjb29raWVzXG4gICAgICBjb25zdCByZXNwb25zZSA9IE5leHRSZXNwb25zZS5qc29uKHsgc3VjY2VzczogdHJ1ZSB9KVxuICAgICAgXG4gICAgICAvLyBDbGVhciBTdXBhYmFzZSBhdXRoIGNvb2tpZXMgYnkgc2V0dGluZyB0aGVtIHRvIGV4cGlyZVxuICAgICAgY29uc3QgY29va2llT3B0aW9ucyA9IHtcbiAgICAgICAgcGF0aDogJy8nLFxuICAgICAgICBleHBpcmVzOiBuZXcgRGF0ZSgwKSxcbiAgICAgICAgbWF4QWdlOiAwXG4gICAgICB9XG4gICAgICBcbiAgICAgIHJlc3BvbnNlLmNvb2tpZXMuc2V0KCdzYi1hY2Nlc3MtdG9rZW4nLCAnJywgY29va2llT3B0aW9ucylcbiAgICAgIHJlc3BvbnNlLmNvb2tpZXMuc2V0KCdzYi1yZWZyZXNoLXRva2VuJywgJycsIGNvb2tpZU9wdGlvbnMpXG4gICAgICBcbiAgICAgIC8vIEFsc28gdHJ5IHRvIGNsZWFyIGFueSBTdXBhYmFzZSBwcm9qZWN0LXNwZWNpZmljIGNvb2tpZXNcbiAgICAgIGNvbnN0IHN1cGFiYXNlVXJsID0gcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMIHx8ICcnXG4gICAgICBjb25zdCBwcm9qZWN0UmVmID0gc3VwYWJhc2VVcmwubWF0Y2goL2h0dHBzOlxcL1xcLyhbXi5dKykvKT8uWzFdXG4gICAgICBpZiAocHJvamVjdFJlZikge1xuICAgICAgICByZXNwb25zZS5jb29raWVzLnNldChgc2ItJHtwcm9qZWN0UmVmfS1hdXRoLXRva2VuYCwgJycsIGNvb2tpZU9wdGlvbnMpXG4gICAgICAgIHJlc3BvbnNlLmNvb2tpZXMuc2V0KGBzYi0ke3Byb2plY3RSZWZ9LWF1dGgtdG9rZW4tY29kZS12ZXJpZmllcmAsICcnLCBjb29raWVPcHRpb25zKVxuICAgICAgfVxuICAgICAgXG4gICAgICByZXR1cm4gaGFuZGxlQ09SUyhyZXNwb25zZSlcbiAgICB9XG5cbiAgICBpZiAocGF0aCA9PT0gJ2F1dGgvZ29vZ2xlJykge1xuICAgICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2UuYXV0aC5zaWduSW5XaXRoT0F1dGgoe1xuICAgICAgICBwcm92aWRlcjogJ2dvb2dsZScsXG4gICAgICAgIG9wdGlvbnM6IHtcbiAgICAgICAgICByZWRpcmVjdFRvOiBgJHtwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19CQVNFX1VSTH0vYXV0aC9jYWxsYmFja2BcbiAgICAgICAgfVxuICAgICAgfSlcbiAgICAgIFxuICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfSwgeyBzdGF0dXM6IDQwMCB9KSlcbiAgICAgIH1cbiAgICAgIFxuICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyB1cmw6IGRhdGEudXJsIH0pKVxuICAgIH1cblxuICAgIC8vIFBhc3N3b3JkIFJlc2V0IFJlcXVlc3RcbiAgICBpZiAocGF0aCA9PT0gJ2F1dGgvcmVzZXQtcGFzc3dvcmQnKSB7XG4gICAgICBjb25zdCB7IGVtYWlsIH0gPSBib2R5XG4gICAgICBcbiAgICAgIGlmICghZW1haWwpIHtcbiAgICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ0VtYWlsIGlzIHJlcXVpcmVkJyB9LCB7IHN0YXR1czogNDAwIH0pKVxuICAgICAgfVxuICAgICAgXG4gICAgICBjb25zdCB7IGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZS5hdXRoLnJlc2V0UGFzc3dvcmRGb3JFbWFpbChlbWFpbCwge1xuICAgICAgICByZWRpcmVjdFRvOiBgJHtwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19CQVNFX1VSTH0vYXV0aC9yZXNldC1jYWxsYmFja2BcbiAgICAgIH0pXG4gICAgICBcbiAgICAgIGlmIChlcnJvcikge1xuICAgICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiBlcnJvci5tZXNzYWdlIH0sIHsgc3RhdHVzOiA0MDAgfSkpXG4gICAgICB9XG4gICAgICBcbiAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgc3VjY2VzczogdHJ1ZSwgbWVzc2FnZTogJ1Bhc3N3b3JkIHJlc2V0IGVtYWlsIHNlbnQnIH0pKVxuICAgIH1cblxuICAgIC8vIFNBVkVEIERSQVdTXG4gICAgaWYgKHBhdGggPT09ICdkcmF3cy9zYXZlJykge1xuICAgICAgY29uc3QgeyB1c2VyLCBlcnJvcjogYXV0aEVycm9yIH0gPSBhd2FpdCBnZXRBdXRoZW50aWNhdGVkVXNlcigpXG4gICAgICBcbiAgICAgIGlmIChhdXRoRXJyb3IgfHwgIXVzZXIpIHtcbiAgICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ1VuYXV0aG9yaXplZCcgfSwgeyBzdGF0dXM6IDQwMSB9KSlcbiAgICAgIH1cbiAgICAgIFxuICAgICAgY29uc3QgeyBibGFja0NhcmRJZCwgd2hpdGVDYXJkSWQsIGJsYWNrQ2FyZFRpdGxlLCB3aGl0ZUNhcmRUaXRsZSB9ID0gYm9keVxuICAgICAgXG4gICAgICBjb25zdCBkcmF3ID0ge1xuICAgICAgICBpZDogdXVpZHY0KCksXG4gICAgICAgIHVzZXJpZDogdXNlci5pZCxcbiAgICAgICAgdXNlcmVtYWlsOiB1c2VyLmVtYWlsLFxuICAgICAgICBibGFja2NhcmRpZDogYmxhY2tDYXJkSWQsXG4gICAgICAgIHdoaXRlY2FyZGlkOiB3aGl0ZUNhcmRJZCxcbiAgICAgICAgYmxhY2tjYXJkdGl0bGU6IGJsYWNrQ2FyZFRpdGxlLFxuICAgICAgICB3aGl0ZWNhcmR0aXRsZTogd2hpdGVDYXJkVGl0bGUsXG4gICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXG4gICAgICB9XG4gICAgICBcbiAgICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgIC5mcm9tKCdzYXZlZF9kcmF3cycpXG4gICAgICAgIC5pbnNlcnQoW2RyYXddKVxuICAgICAgICAuc2VsZWN0KClcbiAgICAgICAgLnNpbmdsZSgpXG4gICAgICBcbiAgICAgIGlmIChlcnJvcikge1xuICAgICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiBlcnJvci5tZXNzYWdlIH0sIHsgc3RhdHVzOiA1MDAgfSkpXG4gICAgICB9XG4gICAgICBcbiAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgZHJhdzogZGF0YSB9KSlcbiAgICB9XG5cbiAgICAvLyBQQVlNRU5UIFJPVVRFUyAtIFB1cmNoYXNlIGEgc2luZ2xlIGJveFxuICAgIGlmIChwYXRoID09PSAncGF5bWVudC9wdXJjaGFzZS1ib3gnKSB7XG4gICAgICBjb25zdCB7IHVzZXIsIGVycm9yOiBhdXRoRXJyb3IgfSA9IGF3YWl0IGdldEF1dGhlbnRpY2F0ZWRVc2VyKClcbiAgICAgIFxuICAgICAgaWYgKGF1dGhFcnJvciB8fCAhdXNlcikge1xuICAgICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnVW5hdXRob3JpemVkJyB9LCB7IHN0YXR1czogNDAxIH0pKVxuICAgICAgfVxuICAgICAgXG4gICAgICBjb25zdCB7IGJveElkIH0gPSBib2R5XG4gICAgICBcbiAgICAgIC8vIEdldCBib3ggZGV0YWlsc1xuICAgICAgY29uc3QgeyBkYXRhOiBib3gsIGVycm9yOiBib3hFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgLmZyb20oJ2JveGVzJylcbiAgICAgICAgLnNlbGVjdCgnKicpXG4gICAgICAgIC5lcSgnaWQnLCBib3hJZClcbiAgICAgICAgLnNpbmdsZSgpXG4gICAgICBcbiAgICAgIGlmIChib3hFcnJvciB8fCAhYm94KSB7XG4gICAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdCb3ggbm90IGZvdW5kJyB9LCB7IHN0YXR1czogNDA0IH0pKVxuICAgICAgfVxuICAgICAgXG4gICAgICBpZiAoYm94LmlzX3NhbXBsZSkge1xuICAgICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnU2FtcGxlIGJveCBpcyBmcmVlJyB9LCB7IHN0YXR1czogNDAwIH0pKVxuICAgICAgfVxuICAgICAgXG4gICAgICBjb25zdCBzZXNzaW9uID0gYXdhaXQgZ2V0U3RyaXBlKCkuY2hlY2tvdXQuc2Vzc2lvbnMuY3JlYXRlKHtcbiAgICAgICAgcGF5bWVudF9tZXRob2RfdHlwZXM6IFsnY2FyZCddLFxuICAgICAgICBsaW5lX2l0ZW1zOiBbe1xuICAgICAgICAgIHByaWNlX2RhdGE6IHtcbiAgICAgICAgICAgIGN1cnJlbmN5OiAndXNkJyxcbiAgICAgICAgICAgIHByb2R1Y3RfZGF0YToge1xuICAgICAgICAgICAgICBuYW1lOiBgQVMgV0UgQUxMIEFSRSAtICR7Ym94Lm5hbWV9YCxcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IGJveC5kZXNjcmlwdGlvbiB8fCBgVW5sb2NrIHRoZSAke2JveC5uYW1lfSBjYXJkIGNvbGxlY3Rpb25gXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgdW5pdF9hbW91bnQ6IE1hdGgucm91bmQoYm94LnByaWNlICogMTAwKSxcbiAgICAgICAgICB9LFxuICAgICAgICAgIHF1YW50aXR5OiAxLFxuICAgICAgICB9XSxcbiAgICAgICAgbW9kZTogJ3BheW1lbnQnLFxuICAgICAgICBzdWNjZXNzX3VybDogYCR7cHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfQkFTRV9VUkx9P3BheW1lbnQ9c3VjY2VzcyZib3g9JHtib3hJZH1gLFxuICAgICAgICBjYW5jZWxfdXJsOiBgJHtwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19CQVNFX1VSTH0/cGF5bWVudD1jYW5jZWxsZWRgLFxuICAgICAgICBjbGllbnRfcmVmZXJlbmNlX2lkOiB1c2VyLmlkLFxuICAgICAgICBjdXN0b21lcl9lbWFpbDogdXNlci5lbWFpbCxcbiAgICAgICAgbWV0YWRhdGE6IHtcbiAgICAgICAgICBib3hfaWQ6IGJveElkLFxuICAgICAgICAgIHB1cmNoYXNlX3R5cGU6ICdvbmVfdGltZSdcbiAgICAgICAgfVxuICAgICAgfSlcbiAgICAgIFxuICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyB1cmw6IHNlc3Npb24udXJsIH0pKVxuICAgIH1cblxuICAgIC8vIFBBWU1FTlQgUk9VVEVTIC0gU3Vic2NyaWJlIHRvIGFsbCBhY2Nlc3NcbiAgICBpZiAocGF0aCA9PT0gJ3BheW1lbnQvc3Vic2NyaWJlLWFsbCcpIHtcbiAgICAgIGNvbnN0IHsgdXNlciwgZXJyb3I6IGF1dGhFcnJvciB9ID0gYXdhaXQgZ2V0QXV0aGVudGljYXRlZFVzZXIoKVxuICAgICAgXG4gICAgICBpZiAoYXV0aEVycm9yIHx8ICF1c2VyKSB7XG4gICAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdVbmF1dGhvcml6ZWQnIH0sIHsgc3RhdHVzOiA0MDEgfSkpXG4gICAgICB9XG4gICAgICBcbiAgICAgIGNvbnN0IHsgcGxhbklkIH0gPSBib2R5XG4gICAgICBcbiAgICAgIC8vIEdldCBwbGFuIGRldGFpbHNcbiAgICAgIGNvbnN0IHsgZGF0YTogcGxhbiwgZXJyb3I6IHBsYW5FcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgLmZyb20oJ3N1YnNjcmlwdGlvbl9wbGFucycpXG4gICAgICAgIC5zZWxlY3QoJyonKVxuICAgICAgICAuZXEoJ2lkJywgcGxhbklkKVxuICAgICAgICAuc2luZ2xlKClcbiAgICAgIFxuICAgICAgaWYgKHBsYW5FcnJvciB8fCAhcGxhbikge1xuICAgICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnUGxhbiBub3QgZm91bmQnIH0sIHsgc3RhdHVzOiA0MDQgfSkpXG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIENhbGN1bGF0ZSBpbnRlcnZhbFxuICAgICAgbGV0IGludGVydmFsID0gJ21vbnRoJ1xuICAgICAgbGV0IGludGVydmFsQ291bnQgPSAxXG4gICAgICBpZiAocGxhbi5pbnRlcnZhbCA9PT0gJ3F1YXJ0ZXInKSB7XG4gICAgICAgIGludGVydmFsID0gJ21vbnRoJ1xuICAgICAgICBpbnRlcnZhbENvdW50ID0gM1xuICAgICAgfSBlbHNlIGlmIChwbGFuLmludGVydmFsID09PSAneWVhcicpIHtcbiAgICAgICAgaW50ZXJ2YWwgPSAneWVhcidcbiAgICAgICAgaW50ZXJ2YWxDb3VudCA9IDFcbiAgICAgIH1cbiAgICAgIFxuICAgICAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IGdldFN0cmlwZSgpLmNoZWNrb3V0LnNlc3Npb25zLmNyZWF0ZSh7XG4gICAgICAgIHBheW1lbnRfbWV0aG9kX3R5cGVzOiBbJ2NhcmQnXSxcbiAgICAgICAgbGluZV9pdGVtczogW3tcbiAgICAgICAgICBwcmljZV9kYXRhOiB7XG4gICAgICAgICAgICBjdXJyZW5jeTogJ3VzZCcsXG4gICAgICAgICAgICBwcm9kdWN0X2RhdGE6IHtcbiAgICAgICAgICAgICAgbmFtZTogYEFTIFdFIEFMTCBBUkUgLSAke3BsYW4ubmFtZX1gLFxuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogcGxhbi5kZXNjcmlwdGlvbiB8fCAnRnVsbCBhY2Nlc3MgdG8gYWxsIGNhcmQgYm94ZXMnXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgdW5pdF9hbW91bnQ6IE1hdGgucm91bmQocGxhbi5wcmljZSAqIDEwMCksXG4gICAgICAgICAgICByZWN1cnJpbmc6IHtcbiAgICAgICAgICAgICAgaW50ZXJ2YWwsXG4gICAgICAgICAgICAgIGludGVydmFsX2NvdW50OiBpbnRlcnZhbENvdW50LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9LFxuICAgICAgICAgIHF1YW50aXR5OiAxLFxuICAgICAgICB9XSxcbiAgICAgICAgbW9kZTogJ3N1YnNjcmlwdGlvbicsXG4gICAgICAgIHN1Y2Nlc3NfdXJsOiBgJHtwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19CQVNFX1VSTH0/cGF5bWVudD1zdWNjZXNzJnN1YnNjcmlwdGlvbj10cnVlYCxcbiAgICAgICAgY2FuY2VsX3VybDogYCR7cHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfQkFTRV9VUkx9P3BheW1lbnQ9Y2FuY2VsbGVkYCxcbiAgICAgICAgY2xpZW50X3JlZmVyZW5jZV9pZDogdXNlci5pZCxcbiAgICAgICAgY3VzdG9tZXJfZW1haWw6IHVzZXIuZW1haWwsXG4gICAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgICAgcGxhbl9pZDogcGxhbklkLFxuICAgICAgICAgIHB1cmNoYXNlX3R5cGU6ICdhbGxfYWNjZXNzJ1xuICAgICAgICB9XG4gICAgICB9KVxuICAgICAgXG4gICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IHVybDogc2Vzc2lvbi51cmwgfSkpXG4gICAgfVxuXG4gICAgLy8gQ0FOQ0VMIFNVQlNDUklQVElPTlxuICAgIGlmIChwYXRoID09PSAncGF5bWVudC9jYW5jZWwtc3Vic2NyaXB0aW9uJykge1xuICAgICAgY29uc3QgeyB1c2VyLCBlcnJvcjogYXV0aEVycm9yIH0gPSBhd2FpdCBnZXRBdXRoZW50aWNhdGVkVXNlcigpXG4gICAgICBcbiAgICAgIGlmIChhdXRoRXJyb3IgfHwgIXVzZXIpIHtcbiAgICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ1VuYXV0aG9yaXplZCcgfSwgeyBzdGF0dXM6IDQwMSB9KSlcbiAgICAgIH1cbiAgICAgIFxuICAgICAgY29uc3QgeyBwdXJjaGFzZUlkIH0gPSBib2R5XG4gICAgICBcbiAgICAgIC8vIEdldCB0aGUgcHVyY2hhc2UgcmVjb3JkXG4gICAgICBjb25zdCB7IGRhdGE6IHB1cmNoYXNlLCBlcnJvcjogcHVyY2hhc2VFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgLmZyb20oJ3VzZXJfcHJvZHVjdHMnKVxuICAgICAgICAuc2VsZWN0KCcqJylcbiAgICAgICAgLmVxKCdpZCcsIHB1cmNoYXNlSWQpXG4gICAgICAgIC5lcSgndXNlcl9pZCcsIHVzZXIuaWQpXG4gICAgICAgIC5zaW5nbGUoKVxuICAgICAgXG4gICAgICBpZiAocHVyY2hhc2VFcnJvciB8fCAhcHVyY2hhc2UpIHtcbiAgICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ1B1cmNoYXNlIG5vdCBmb3VuZCcgfSwgeyBzdGF0dXM6IDQwNCB9KSlcbiAgICAgIH1cbiAgICAgIFxuICAgICAgaWYgKCFwdXJjaGFzZS5zdHJpcGVfc3Vic2NyaXB0aW9uX2lkKSB7XG4gICAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdUaGlzIGlzIG5vdCBhIHN1YnNjcmlwdGlvbicgfSwgeyBzdGF0dXM6IDQwMCB9KSlcbiAgICAgIH1cbiAgICAgIFxuICAgICAgdHJ5IHtcbiAgICAgICAgLy8gQ2FuY2VsIHRoZSBzdWJzY3JpcHRpb24gaW4gU3RyaXBlXG4gICAgICAgIGF3YWl0IGdldFN0cmlwZSgpLnN1YnNjcmlwdGlvbnMuY2FuY2VsKHB1cmNoYXNlLnN0cmlwZV9zdWJzY3JpcHRpb25faWQpXG4gICAgICAgIFxuICAgICAgICAvLyBVcGRhdGUgb3VyIGRhdGFiYXNlXG4gICAgICAgIGF3YWl0IHN1cGFiYXNlXG4gICAgICAgICAgLmZyb20oJ3VzZXJfcHJvZHVjdHMnKVxuICAgICAgICAgIC51cGRhdGUoeyBpc19hY3RpdmU6IGZhbHNlIH0pXG4gICAgICAgICAgLmVxKCdpZCcsIHB1cmNoYXNlSWQpXG4gICAgICAgIFxuICAgICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IHN1Y2Nlc3M6IHRydWUsIG1lc3NhZ2U6ICdTdWJzY3JpcHRpb24gY2FuY2VsbGVkJyB9KSlcbiAgICAgIH0gY2F0Y2ggKHN0cmlwZUVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ1N0cmlwZSBjYW5jZWxsYXRpb24gZXJyb3I6Jywgc3RyaXBlRXJyb3IpXG4gICAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdGYWlsZWQgdG8gY2FuY2VsIHN1YnNjcmlwdGlvbicgfSwgeyBzdGF0dXM6IDUwMCB9KSlcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBMZWdhY3kgcGF5bWVudCByb3V0ZSAoZm9yIGJhY2t3YXJkIGNvbXBhdGliaWxpdHkpXG4gICAgaWYgKHBhdGggPT09ICdwYXltZW50L2NyZWF0ZS1jaGVja291dCcpIHtcbiAgICAgIGNvbnN0IHsgdXNlciwgZXJyb3I6IGF1dGhFcnJvciB9ID0gYXdhaXQgZ2V0QXV0aGVudGljYXRlZFVzZXIoKVxuICAgICAgXG4gICAgICBpZiAoYXV0aEVycm9yIHx8ICF1c2VyKSB7XG4gICAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdVbmF1dGhvcml6ZWQnIH0sIHsgc3RhdHVzOiA0MDEgfSkpXG4gICAgICB9XG4gICAgICBcbiAgICAgIGNvbnN0IHsgcGF5bWVudFR5cGUsIGNvdXBvbkNvZGUgfSA9IGJvZHlcbiAgICAgIFxuICAgICAgbGV0IHNlc3Npb25Db25maWcgPSB7XG4gICAgICAgIHBheW1lbnRfbWV0aG9kX3R5cGVzOiBbJ2NhcmQnXSxcbiAgICAgICAgbGluZV9pdGVtczogW10sXG4gICAgICAgIG1vZGU6IHBheW1lbnRUeXBlID09PSAnc3Vic2NyaXB0aW9uJyA/ICdzdWJzY3JpcHRpb24nIDogJ3BheW1lbnQnLFxuICAgICAgICBzdWNjZXNzX3VybDogYCR7cHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfQkFTRV9VUkx9P3BheW1lbnQ9c3VjY2Vzc2AsXG4gICAgICAgIGNhbmNlbF91cmw6IGAke3Byb2Nlc3MuZW52Lk5FWFRfUFVCTElDX0JBU0VfVVJMfT9wYXltZW50PWNhbmNlbGxlZGAsXG4gICAgICAgIGNsaWVudF9yZWZlcmVuY2VfaWQ6IHVzZXIuaWQsXG4gICAgICAgIGN1c3RvbWVyX2VtYWlsOiB1c2VyLmVtYWlsLFxuICAgICAgICBtZXRhZGF0YToge1xuICAgICAgICAgIHB1cmNoYXNlX3R5cGU6IHBheW1lbnRUeXBlID09PSAnc3Vic2NyaXB0aW9uJyA/ICdhbGxfYWNjZXNzJyA6ICdsZWdhY3lfZnVsbCdcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgXG4gICAgICBpZiAocGF5bWVudFR5cGUgPT09ICdvbmV0aW1lJykge1xuICAgICAgICBzZXNzaW9uQ29uZmlnLmxpbmVfaXRlbXMucHVzaCh7XG4gICAgICAgICAgcHJpY2VfZGF0YToge1xuICAgICAgICAgICAgY3VycmVuY3k6ICd1c2QnLFxuICAgICAgICAgICAgcHJvZHVjdF9kYXRhOiB7XG4gICAgICAgICAgICAgIG5hbWU6ICdBUyBXRSBBTEwgQVJFIC0gRnVsbCBBY2Nlc3MnLFxuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogJ09uZS10aW1lIHVubG9jayBvZiBhbGwgY2FyZHMnXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgdW5pdF9hbW91bnQ6IDIwMDAsXG4gICAgICAgICAgfSxcbiAgICAgICAgICBxdWFudGl0eTogMSxcbiAgICAgICAgfSlcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHNlc3Npb25Db25maWcubGluZV9pdGVtcy5wdXNoKHtcbiAgICAgICAgICBwcmljZV9kYXRhOiB7XG4gICAgICAgICAgICBjdXJyZW5jeTogJ3VzZCcsXG4gICAgICAgICAgICBwcm9kdWN0X2RhdGE6IHtcbiAgICAgICAgICAgICAgbmFtZTogJ0FTIFdFIEFMTCBBUkUgLSBTdWJzY3JpcHRpb24nLFxuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogJ0Z1bGwgYWNjZXNzIHN1YnNjcmlwdGlvbidcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB1bml0X2Ftb3VudDogMzAwLFxuICAgICAgICAgICAgcmVjdXJyaW5nOiB7XG4gICAgICAgICAgICAgIGludGVydmFsOiAnbW9udGgnLFxuICAgICAgICAgICAgICBpbnRlcnZhbF9jb3VudDogMyxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSxcbiAgICAgICAgICBxdWFudGl0eTogMSxcbiAgICAgICAgfSlcbiAgICAgIH1cbiAgICAgIFxuICAgICAgaWYgKGNvdXBvbkNvZGUpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBjb25zdCBjb3Vwb25zID0gYXdhaXQgZ2V0U3RyaXBlKCkuY291cG9ucy5saXN0KHsgbGltaXQ6IDEwMCB9KVxuICAgICAgICAgIGNvbnN0IHZhbGlkQ291cG9uID0gY291cG9ucy5kYXRhLmZpbmQoYyA9PiBjLmlkLnRvTG93ZXJDYXNlKCkgPT09IGNvdXBvbkNvZGUudG9Mb3dlckNhc2UoKSlcbiAgICAgICAgICBcbiAgICAgICAgICBpZiAodmFsaWRDb3Vwb24pIHtcbiAgICAgICAgICAgIHNlc3Npb25Db25maWcuZGlzY291bnRzID0gW3sgY291cG9uOiB2YWxpZENvdXBvbi5pZCB9XVxuICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKCdDb3Vwb24gdmFsaWRhdGlvbiBlcnJvcjonLCBlcnJvcilcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgXG4gICAgICBjb25zdCBzZXNzaW9uID0gYXdhaXQgc3RyaXBlLmNoZWNrb3V0LnNlc3Npb25zLmNyZWF0ZShzZXNzaW9uQ29uZmlnKVxuICAgICAgXG4gICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IHVybDogc2Vzc2lvbi51cmwgfSkpXG4gICAgfVxuXG4gICAgLy8gQURNSU4gUk9VVEVTIC0gQ3JlYXRlIGNhcmRcbiAgICBpZiAocGF0aCA9PT0gJ2FkbWluL2NhcmRzJykge1xuICAgICAgY29uc3QgeyB1c2VyLCBlcnJvcjogYXV0aEVycm9yIH0gPSBhd2FpdCBnZXRBdXRoZW50aWNhdGVkVXNlcigpXG4gICAgICBcbiAgICAgIGlmIChhdXRoRXJyb3IgfHwgIXVzZXIpIHtcbiAgICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ1VuYXV0aG9yaXplZCcgfSwgeyBzdGF0dXM6IDQwMSB9KSlcbiAgICAgIH1cbiAgICAgIFxuICAgICAgY29uc3QgeyBib3hJZCwgcGlsZUlkLCB0ZXh0LCBpbWFnZVBhdGgsIGlzQWN0aXZlIH0gPSBib2R5XG4gICAgICBcbiAgICAgIC8vIEdlbmVyYXRlIE1ENSBoYXNoIElEXG4gICAgICBjb25zdCBjcnlwdG8gPSBhd2FpdCBpbXBvcnQoJ2NyeXB0bycpXG4gICAgICBjb25zdCBjYXJkSWQgPSBjcnlwdG8uY3JlYXRlSGFzaCgnbWQ1JykudXBkYXRlKGAke0RhdGUubm93KCl9LSR7TWF0aC5yYW5kb20oKX1gKS5kaWdlc3QoJ2hleCcpXG4gICAgICBcbiAgICAgIGNvbnN0IGNhcmQgPSB7XG4gICAgICAgIGlkOiBjYXJkSWQsXG4gICAgICAgIGJveF9pZDogYm94SWQsXG4gICAgICAgIHBpbGVfaWQ6IHBpbGVJZCxcbiAgICAgICAgdGV4dDogdGV4dCB8fCBudWxsLFxuICAgICAgICBpbWFnZV9wYXRoOiBpbWFnZVBhdGggfHwgJycsXG4gICAgICAgIGlzX2FjdGl2ZTogaXNBY3RpdmUgIT09IGZhbHNlLFxuICAgICAgICBjcmVhdGVkX2F0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcbiAgICAgIH1cbiAgICAgIFxuICAgICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgLmZyb20oJ2NhcmRzJylcbiAgICAgICAgLmluc2VydChbY2FyZF0pXG4gICAgICAgIC5zZWxlY3QoKVxuICAgICAgICAuc2luZ2xlKClcbiAgICAgIFxuICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfSwgeyBzdGF0dXM6IDUwMCB9KSlcbiAgICAgIH1cbiAgICAgIFxuICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBjYXJkOiBkYXRhIH0pKVxuICAgIH1cblxuICAgIC8vIEFETUlOIFJPVVRFUyAtIENyZWF0ZSBib3ggKGVuaGFuY2VkIHdpdGggbmV3IGZpZWxkcylcbiAgICBpZiAocGF0aCA9PT0gJ2FkbWluL2JveGVzJykge1xuICAgICAgY29uc3QgeyB1c2VyLCBlcnJvcjogYXV0aEVycm9yIH0gPSBhd2FpdCBnZXRBdXRoZW50aWNhdGVkVXNlcigpXG4gICAgICBcbiAgICAgIGlmIChhdXRoRXJyb3IgfHwgIXVzZXIpIHtcbiAgICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ1VuYXV0aG9yaXplZCcgfSwgeyBzdGF0dXM6IDQwMSB9KSlcbiAgICAgIH1cbiAgICAgIFxuICAgICAgY29uc3QgeyBcbiAgICAgICAgaWQ6IGJveElkLCBuYW1lLCBkZXNjcmlwdGlvbiwgZGVzY3JpcHRpb25TaG9ydCwgdGFnbGluZSwgdG9waWNzLFxuICAgICAgICBwcmljZUlkLCBjb2xvciwgY29sb3JQYWxldHRlLCBwYXRoOiBib3hQYXRoLCBkaXNwbGF5T3JkZXIsIFxuICAgICAgICBpc1NhbXBsZSwgZnVsbEJveElkLCBpc0FjdGl2ZSwgY29sbGVjdGlvblNlcmllc0lkIFxuICAgICAgfSA9IGJvZHlcbiAgICAgIFxuICAgICAgY29uc3QgYm94ID0ge1xuICAgICAgICBpZDogYm94SWQgfHwgYGJveF8ke3V1aWR2NCgpLnNsaWNlKDAsIDgpfWAsXG4gICAgICAgIG5hbWUsXG4gICAgICAgIGRlc2NyaXB0aW9uOiBkZXNjcmlwdGlvbiB8fCAnJyxcbiAgICAgICAgZGVzY3JpcHRpb25fc2hvcnQ6IGRlc2NyaXB0aW9uU2hvcnQgfHwgJycsXG4gICAgICAgIHRhZ2xpbmU6IHRhZ2xpbmUgfHwgJycsXG4gICAgICAgIHRvcGljczogdG9waWNzIHx8IFtdLFxuICAgICAgICBwcmljZV9pZDogcHJpY2VJZCB8fCBudWxsLFxuICAgICAgICBjb2xvcjogY29sb3IgfHwgJyMwMDAwMDAnLFxuICAgICAgICBjb2xvcl9wYWxldHRlOiBjb2xvclBhbGV0dGUgfHwgW10sXG4gICAgICAgIHBhdGg6IGJveFBhdGggfHwgJycsXG4gICAgICAgIGRpc3BsYXlfb3JkZXI6IGRpc3BsYXlPcmRlciB8fCAwLFxuICAgICAgICBpc19zYW1wbGU6IGlzU2FtcGxlIHx8IGZhbHNlLFxuICAgICAgICBmdWxsX2JveF9pZDogaXNTYW1wbGUgPyAoZnVsbEJveElkIHx8IG51bGwpIDogbnVsbCwgIC8vIE9ubHkgc2V0IGlmIHNhbXBsZVxuICAgICAgICBpc19hY3RpdmU6IGlzQWN0aXZlICE9PSBmYWxzZSxcbiAgICAgICAgY29sbGVjdGlvbl9zZXJpZXNfaWQ6IGNvbGxlY3Rpb25TZXJpZXNJZCB8fCAndW5zY3JpcHRlZF9jb252ZXJzYXRpb25zJyxcbiAgICAgICAgY3JlYXRlZF9hdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXG4gICAgICB9XG4gICAgICBcbiAgICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgIC5mcm9tKCdib3hlcycpXG4gICAgICAgIC5pbnNlcnQoW2JveF0pXG4gICAgICAgIC5zZWxlY3QoKVxuICAgICAgICAuc2luZ2xlKClcbiAgICAgIFxuICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfSwgeyBzdGF0dXM6IDUwMCB9KSlcbiAgICAgIH1cbiAgICAgIFxuICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBib3g6IGRhdGEgfSkpXG4gICAgfVxuXG4gICAgLy8gQURNSU4gUk9VVEVTIC0gQ3JlYXRlIGNvbGxlY3Rpb24gc2VyaWVzXG4gICAgaWYgKHBhdGggPT09ICdhZG1pbi9jb2xsZWN0aW9uLXNlcmllcycpIHtcbiAgICAgIGNvbnN0IHsgdXNlciwgZXJyb3I6IGF1dGhFcnJvciB9ID0gYXdhaXQgZ2V0QXV0aGVudGljYXRlZFVzZXIoKVxuICAgICAgXG4gICAgICBpZiAoYXV0aEVycm9yIHx8ICF1c2VyKSB7XG4gICAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdVbmF1dGhvcml6ZWQnIH0sIHsgc3RhdHVzOiA0MDEgfSkpXG4gICAgICB9XG4gICAgICBcbiAgICAgIGNvbnN0IHsgaWQsIG5hbWUsIGRlc2NyaXB0aW9uLCBkaXNwbGF5T3JkZXIsIGlzQWN0aXZlIH0gPSBib2R5XG4gICAgICBcbiAgICAgIGNvbnN0IHNlcmllcyA9IHtcbiAgICAgICAgaWQ6IGlkIHx8IGBzZXJpZXNfJHt1dWlkdjQoKS5zbGljZSgwLCA4KX1gLFxuICAgICAgICBuYW1lLFxuICAgICAgICBkZXNjcmlwdGlvbjogZGVzY3JpcHRpb24gfHwgJycsXG4gICAgICAgIGRpc3BsYXlfb3JkZXI6IGRpc3BsYXlPcmRlciB8fCAwLFxuICAgICAgICBpc19hY3RpdmU6IGlzQWN0aXZlICE9PSBmYWxzZSxcbiAgICAgICAgY3JlYXRlZF9hdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXG4gICAgICB9XG4gICAgICBcbiAgICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgIC5mcm9tKCdjb2xsZWN0aW9uX3NlcmllcycpXG4gICAgICAgIC5pbnNlcnQoW3Nlcmllc10pXG4gICAgICAgIC5zZWxlY3QoKVxuICAgICAgICAuc2luZ2xlKClcbiAgICAgIFxuICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfSwgeyBzdGF0dXM6IDUwMCB9KSlcbiAgICAgIH1cbiAgICAgIFxuICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBzZXJpZXM6IGRhdGEgfSkpXG4gICAgfVxuXG4gICAgLy8gQURNSU4gUk9VVEVTIC0gQ3JlYXRlIHByaWNlXG4gICAgaWYgKHBhdGggPT09ICdhZG1pbi9wcmljZXMnKSB7XG4gICAgICBjb25zdCB7IHVzZXIsIGVycm9yOiBhdXRoRXJyb3IgfSA9IGF3YWl0IGdldEF1dGhlbnRpY2F0ZWRVc2VyKClcbiAgICAgIFxuICAgICAgaWYgKGF1dGhFcnJvciB8fCAhdXNlcikge1xuICAgICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnVW5hdXRob3JpemVkJyB9LCB7IHN0YXR1czogNDAxIH0pKVxuICAgICAgfVxuICAgICAgXG4gICAgICBjb25zdCB7IFxuICAgICAgICBpZCwgbGFiZWwsIHBheW1lbnRJbmZvLCBob29rSW5mbywgYW1vdW50LCBwcm9tb0Ftb3VudCwgcHJvbW9FbmFibGVkLCBjdXJyZW5jeSxcbiAgICAgICAgbWVtYmVyc2hpcERheXMsIHN0cmlwZVByaWNlSWQsIGRpc3BsYXlPcmRlciwgaXNBY3RpdmUgXG4gICAgICB9ID0gYm9keVxuICAgICAgXG4gICAgICBjb25zdCBwcmljZSA9IHtcbiAgICAgICAgaWQ6IGlkIHx8IGBwcmljZV8ke3V1aWR2NCgpLnNsaWNlKDAsIDgpfWAsXG4gICAgICAgIGxhYmVsLFxuICAgICAgICBwYXltZW50X2luZm86IHBheW1lbnRJbmZvIHx8ICcnLFxuICAgICAgICBob29rX2luZm86IGhvb2tJbmZvIHx8ICcnLFxuICAgICAgICBhbW91bnQ6IGFtb3VudCB8fCAwLFxuICAgICAgICBwcm9tb19hbW91bnQ6IHByb21vQW1vdW50IHx8IG51bGwsXG4gICAgICAgIHByb21vX2VuYWJsZWQ6IHByb21vRW5hYmxlZCB8fCBmYWxzZSxcbiAgICAgICAgY3VycmVuY3k6IGN1cnJlbmN5IHx8ICdVU0QnLFxuICAgICAgICBtZW1iZXJzaGlwX2RheXM6IG1lbWJlcnNoaXBEYXlzIHx8IG51bGwsXG4gICAgICAgIHN0cmlwZV9wcmljZV9pZDogc3RyaXBlUHJpY2VJZCB8fCBudWxsLFxuICAgICAgICBkaXNwbGF5X29yZGVyOiBkaXNwbGF5T3JkZXIgfHwgMCxcbiAgICAgICAgaXNfYWN0aXZlOiBpc0FjdGl2ZSAhPT0gZmFsc2UsXG4gICAgICAgIGNyZWF0ZWRfYXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxuICAgICAgfVxuICAgICAgXG4gICAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAuZnJvbSgncHJpY2VzJylcbiAgICAgICAgLmluc2VydChbcHJpY2VdKVxuICAgICAgICAuc2VsZWN0KClcbiAgICAgICAgLnNpbmdsZSgpXG4gICAgICBcbiAgICAgIGlmIChlcnJvcikge1xuICAgICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiBlcnJvci5tZXNzYWdlIH0sIHsgc3RhdHVzOiA1MDAgfSkpXG4gICAgICB9XG4gICAgICBcbiAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgcHJpY2U6IGRhdGEgfSkpXG4gICAgfVxuXG4gICAgLy8gQURNSU4gUk9VVEVTIC0gQ3JlYXRlIHBpbGVcbiAgICBpZiAocGF0aCA9PT0gJ2FkbWluL3BpbGVzJykge1xuICAgICAgY29uc3QgeyB1c2VyLCBlcnJvcjogYXV0aEVycm9yIH0gPSBhd2FpdCBnZXRBdXRoZW50aWNhdGVkVXNlcigpXG4gICAgICBcbiAgICAgIGlmIChhdXRoRXJyb3IgfHwgIXVzZXIpIHtcbiAgICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ1VuYXV0aG9yaXplZCcgfSwgeyBzdGF0dXM6IDQwMSB9KSlcbiAgICAgIH1cbiAgICAgIFxuICAgICAgY29uc3QgeyBpZCwgc2x1ZywgbmFtZSwgaW1hZ2VQYXRoLCBjb2xsZWN0aW9uU2VyaWVzSWQsIGRpc3BsYXlPcmRlciwgaXNBY3RpdmUgfSA9IGJvZHlcbiAgICAgIFxuICAgICAgY29uc3QgcGlsZSA9IHtcbiAgICAgICAgaWQ6IGlkIHx8IGBwaWxlXyR7dXVpZHY0KCkuc2xpY2UoMCwgOCl9YCxcbiAgICAgICAgc2x1Zzogc2x1ZyB8fCBuYW1lLnRvTG93ZXJDYXNlKCkucmVwbGFjZSgvXFxzKy9nLCAnXycpLFxuICAgICAgICBuYW1lLFxuICAgICAgICBpbWFnZV9wYXRoOiBpbWFnZVBhdGggfHwgJycsXG4gICAgICAgIGNvbGxlY3Rpb25fc2VyaWVzX2lkOiBjb2xsZWN0aW9uU2VyaWVzSWQgfHwgbnVsbCxcbiAgICAgICAgZGlzcGxheV9vcmRlcjogZGlzcGxheU9yZGVyIHx8IDAsXG4gICAgICAgIGlzX2FjdGl2ZTogaXNBY3RpdmUgIT09IGZhbHNlLFxuICAgICAgICBjcmVhdGVkX2F0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcbiAgICAgIH1cbiAgICAgIFxuICAgICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgLmZyb20oJ3BpbGVzJylcbiAgICAgICAgLmluc2VydChbcGlsZV0pXG4gICAgICAgIC5zZWxlY3QoKVxuICAgICAgICAuc2luZ2xlKClcbiAgICAgIFxuICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfSwgeyBzdGF0dXM6IDUwMCB9KSlcbiAgICAgIH1cbiAgICAgIFxuICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBwaWxlOiBkYXRhIH0pKVxuICAgIH1cblxuICAgIC8vIEFETUlOIFJPVVRFUyAtIENyZWF0ZSBidW5kbGVcbiAgICBpZiAocGF0aCA9PT0gJ2FkbWluL2J1bmRsZXMnKSB7XG4gICAgICBjb25zdCB7IHVzZXIsIGVycm9yOiBhdXRoRXJyb3IgfSA9IGF3YWl0IGdldEF1dGhlbnRpY2F0ZWRVc2VyKClcbiAgICAgIFxuICAgICAgaWYgKGF1dGhFcnJvciB8fCAhdXNlcikge1xuICAgICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnVW5hdXRob3JpemVkJyB9LCB7IHN0YXR1czogNDAxIH0pKVxuICAgICAgfVxuICAgICAgXG4gICAgICBjb25zdCB7IGlkLCBuYW1lLCBkZXNjcmlwdGlvbiwgcHJpY2VJZCwgYm94SWRzLCBkaXNwbGF5T3JkZXIsIGlzQWN0aXZlIH0gPSBib2R5XG4gICAgICBcbiAgICAgIGNvbnN0IGJ1bmRsZSA9IHtcbiAgICAgICAgaWQ6IGlkIHx8IGBidW5kbGVfJHt1dWlkdjQoKS5zbGljZSgwLCA4KX1gLFxuICAgICAgICBuYW1lLFxuICAgICAgICBkZXNjcmlwdGlvbjogZGVzY3JpcHRpb24gfHwgJycsXG4gICAgICAgIHByaWNlX2lkOiBwcmljZUlkIHx8IG51bGwsXG4gICAgICAgIGJveF9pZHM6IGJveElkcyB8fCBbXSxcbiAgICAgICAgZGlzcGxheV9vcmRlcjogZGlzcGxheU9yZGVyIHx8IDAsXG4gICAgICAgIGlzX2FjdGl2ZTogaXNBY3RpdmUgIT09IGZhbHNlLFxuICAgICAgICBjcmVhdGVkX2F0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcbiAgICAgIH1cbiAgICAgIFxuICAgICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgLmZyb20oJ2J1bmRsZXMnKVxuICAgICAgICAuaW5zZXJ0KFtidW5kbGVdKVxuICAgICAgICAuc2VsZWN0KClcbiAgICAgICAgLnNpbmdsZSgpXG4gICAgICBcbiAgICAgIGlmIChlcnJvcikge1xuICAgICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiBlcnJvci5tZXNzYWdlIH0sIHsgc3RhdHVzOiA1MDAgfSkpXG4gICAgICB9XG4gICAgICBcbiAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgYnVuZGxlOiBkYXRhIH0pKVxuICAgIH1cblxuICAgIC8vIEFETUlOIFJPVVRFUyAtIEJ1bGsgZGVsZXRlIGNhcmRzXG4gICAgaWYgKHBhdGggPT09ICdhZG1pbi9jYXJkcy9idWxrLWRlbGV0ZScpIHtcbiAgICAgIGNvbnN0IHsgdXNlciwgZXJyb3I6IGF1dGhFcnJvciB9ID0gYXdhaXQgZ2V0QXV0aGVudGljYXRlZFVzZXIoKVxuICAgICAgXG4gICAgICBpZiAoYXV0aEVycm9yIHx8ICF1c2VyKSB7XG4gICAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdVbmF1dGhvcml6ZWQnIH0sIHsgc3RhdHVzOiA0MDEgfSkpXG4gICAgICB9XG4gICAgICBcbiAgICAgIGNvbnN0IHsgYm94SWQsIHBpbGVJZCB9ID0gYm9keVxuICAgICAgXG4gICAgICBpZiAoIWJveElkKSB7XG4gICAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdib3hJZCByZXF1aXJlZCcgfSwgeyBzdGF0dXM6IDQwMCB9KSlcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8gQnVpbGQgZGVsZXRlIHF1ZXJ5XG4gICAgICBsZXQgZGVsZXRlUmVzdWx0XG4gICAgICBpZiAocGlsZUlkKSB7XG4gICAgICAgIC8vIERlbGV0ZSBjYXJkcyBmb3Igc3BlY2lmaWMgYm94IGFuZCBwaWxlXG4gICAgICAgIGNvbnN0IHsgZGF0YTogY2FyZHMgfSA9IGF3YWl0IHN1cGFiYXNlLmZyb20oJ2NhcmRzJykuc2VsZWN0KCcqJykuZXEoJ2JveF9pZCcsIGJveElkKS5lcSgncGlsZV9pZCcsIHBpbGVJZClcbiAgICAgICAgaWYgKGNhcmRzICYmIGNhcmRzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICBmb3IgKGNvbnN0IGNhcmQgb2YgY2FyZHMpIHtcbiAgICAgICAgICAgIGF3YWl0IHN1cGFiYXNlLmZyb20oJ2NhcmRzJykuZGVsZXRlKCkuZXEoJ2lkJywgY2FyZC5pZClcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZGVsZXRlUmVzdWx0ID0geyBkZWxldGVkOiBjYXJkcz8ubGVuZ3RoIHx8IDAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gRGVsZXRlIGFsbCBjYXJkcyBmb3IgYm94XG4gICAgICAgIGNvbnN0IHsgZGF0YTogY2FyZHMgfSA9IGF3YWl0IHN1cGFiYXNlLmZyb20oJ2NhcmRzJykuc2VsZWN0KCcqJykuZXEoJ2JveF9pZCcsIGJveElkKVxuICAgICAgICBpZiAoY2FyZHMgJiYgY2FyZHMubGVuZ3RoID4gMCkge1xuICAgICAgICAgIGZvciAoY29uc3QgY2FyZCBvZiBjYXJkcykge1xuICAgICAgICAgICAgYXdhaXQgc3VwYWJhc2UuZnJvbSgnY2FyZHMnKS5kZWxldGUoKS5lcSgnaWQnLCBjYXJkLmlkKVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBkZWxldGVSZXN1bHQgPSB7IGRlbGV0ZWQ6IGNhcmRzPy5sZW5ndGggfHwgMCB9XG4gICAgICB9XG4gICAgICBcbiAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgc3VjY2VzczogdHJ1ZSwgLi4uZGVsZXRlUmVzdWx0IH0pKVxuICAgIH1cbiAgICBcbiAgICAvLyBBRE1JTiBST1VURVMgLSBFeHBvcnQgY2FyZCBwYXRoc1xuICAgIGlmIChwYXRoID09PSAnYWRtaW4vY2FyZHMvZXhwb3J0Jykge1xuICAgICAgY29uc3QgeyB1c2VyLCBlcnJvcjogYXV0aEVycm9yIH0gPSBhd2FpdCBnZXRBdXRoZW50aWNhdGVkVXNlcigpXG4gICAgICBcbiAgICAgIGlmIChhdXRoRXJyb3IgfHwgIXVzZXIpIHtcbiAgICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ1VuYXV0aG9yaXplZCcgfSwgeyBzdGF0dXM6IDQwMSB9KSlcbiAgICAgIH1cbiAgICAgIFxuICAgICAgY29uc3QgeyBib3hJZCwgcGlsZUlkIH0gPSBib2R5XG4gICAgICBcbiAgICAgIGlmICghYm94SWQpIHtcbiAgICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ2JveElkIHJlcXVpcmVkJyB9LCB7IHN0YXR1czogNDAwIH0pKVxuICAgICAgfVxuICAgICAgXG4gICAgICBsZXQgcXVlcnkgPSBzdXBhYmFzZS5mcm9tKCdjYXJkcycpLnNlbGVjdCgnKicpLmVxKCdib3hfaWQnLCBib3hJZClcbiAgICAgIFxuICAgICAgaWYgKHBpbGVJZCkge1xuICAgICAgICBxdWVyeSA9IHF1ZXJ5LmVxKCdwaWxlX2lkJywgcGlsZUlkKVxuICAgICAgfVxuICAgICAgXG4gICAgICBjb25zdCB7IGRhdGE6IGNhcmRzLCBlcnJvciB9ID0gYXdhaXQgcXVlcnlcbiAgICAgIFxuICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfSwgeyBzdGF0dXM6IDUwMCB9KSlcbiAgICAgIH1cbiAgICAgIFxuICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBcbiAgICAgICAgY2FyZHM6IGNhcmRzIHx8IFtdLFxuICAgICAgICBpbWFnZVBhdGhzOiAoY2FyZHMgfHwgW10pLm1hcChjID0+IGMuaW1hZ2VfcGF0aClcbiAgICAgIH0pKVxuICAgIH1cblxuICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdSb3V0ZSBub3QgZm91bmQnIH0sIHsgc3RhdHVzOiA0MDQgfSkpXG4gICAgXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignQVBJIEVycm9yOicsIGVycm9yKVxuICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfSwgeyBzdGF0dXM6IDUwMCB9KSlcbiAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gUFVUKHJlcXVlc3QpIHtcbiAgY29uc3QgdXJsID0gbmV3IFVSTChyZXF1ZXN0LnVybClcbiAgY29uc3QgcGF0aCA9IHVybC5wYXRobmFtZS5yZXBsYWNlKCcvYXBpLycsICcnKVxuICBjb25zdCBzdXBhYmFzZSA9IGNyZWF0ZVN1cGFiYXNlU2VydmVyKClcblxuICB0cnkge1xuICAgIGNvbnN0IHsgdXNlciwgZXJyb3I6IGF1dGhFcnJvciB9ID0gYXdhaXQgZ2V0QXV0aGVudGljYXRlZFVzZXIoKVxuICAgIFxuICAgIGlmIChhdXRoRXJyb3IgfHwgIXVzZXIpIHtcbiAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdVbmF1dGhvcml6ZWQnIH0sIHsgc3RhdHVzOiA0MDEgfSkpXG4gICAgfVxuXG4gICAgLy8gQURNSU4gUk9VVEVTIC0gVXBkYXRlIGNhcmRcbiAgICBpZiAocGF0aC5zdGFydHNXaXRoKCdhZG1pbi9jYXJkcy8nKSkge1xuICAgICAgY29uc3QgY2FyZElkID0gcGF0aC5zcGxpdCgnLycpWzJdXG4gICAgICBjb25zdCBib2R5ID0gYXdhaXQgcmVxdWVzdC5qc29uKClcbiAgICAgIFxuICAgICAgY29uc3QgdXBkYXRlRGF0YSA9IHt9XG4gICAgICBpZiAoYm9keS5ib3hJZCAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLmJveF9pZCA9IGJvZHkuYm94SWRcbiAgICAgIGlmIChib2R5LnBpbGVJZCAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLnBpbGVfaWQgPSBib2R5LnBpbGVJZFxuICAgICAgaWYgKGJvZHkudGV4dCAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLnRleHQgPSBib2R5LnRleHRcbiAgICAgIGlmIChib2R5LmltYWdlUGF0aCAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLmltYWdlX3BhdGggPSBib2R5LmltYWdlUGF0aFxuICAgICAgaWYgKGJvZHkuaXNBY3RpdmUgIT09IHVuZGVmaW5lZCkgdXBkYXRlRGF0YS5pc19hY3RpdmUgPSBib2R5LmlzQWN0aXZlXG4gICAgICBcbiAgICAgIGNvbnN0IHsgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgIC5mcm9tKCdjYXJkcycpXG4gICAgICAgIC51cGRhdGUodXBkYXRlRGF0YSlcbiAgICAgICAgLmVxKCdpZCcsIGNhcmRJZClcbiAgICAgIFxuICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfSwgeyBzdGF0dXM6IDUwMCB9KSlcbiAgICAgIH1cbiAgICAgIFxuICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBzdWNjZXNzOiB0cnVlIH0pKVxuICAgIH1cblxuICAgIC8vIEFETUlOIFJPVVRFUyAtIFVwZGF0ZSBib3ggKGVuaGFuY2VkIHdpdGggbmV3IGZpZWxkcylcbiAgICBpZiAocGF0aC5zdGFydHNXaXRoKCdhZG1pbi9ib3hlcy8nKSkge1xuICAgICAgY29uc3QgYm94SWQgPSBwYXRoLnNwbGl0KCcvJylbMl1cbiAgICAgIGNvbnN0IGJvZHkgPSBhd2FpdCByZXF1ZXN0Lmpzb24oKVxuICAgICAgXG4gICAgICAvLyBNYXAgY2FtZWxDYXNlIHRvIHNuYWtlX2Nhc2VcbiAgICAgIGNvbnN0IHVwZGF0ZURhdGEgPSB7fVxuICAgICAgaWYgKGJvZHkubmFtZSAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLm5hbWUgPSBib2R5Lm5hbWVcbiAgICAgIGlmIChib2R5LmRlc2NyaXB0aW9uICE9PSB1bmRlZmluZWQpIHVwZGF0ZURhdGEuZGVzY3JpcHRpb24gPSBib2R5LmRlc2NyaXB0aW9uXG4gICAgICBpZiAoYm9keS5kZXNjcmlwdGlvblNob3J0ICE9PSB1bmRlZmluZWQpIHVwZGF0ZURhdGEuZGVzY3JpcHRpb25fc2hvcnQgPSBib2R5LmRlc2NyaXB0aW9uU2hvcnRcbiAgICAgIGlmIChib2R5LnRhZ2xpbmUgIT09IHVuZGVmaW5lZCkgdXBkYXRlRGF0YS50YWdsaW5lID0gYm9keS50YWdsaW5lXG4gICAgICBpZiAoYm9keS50b3BpY3MgIT09IHVuZGVmaW5lZCkgdXBkYXRlRGF0YS50b3BpY3MgPSBib2R5LnRvcGljc1xuICAgICAgaWYgKGJvZHkucHJpY2VJZCAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLnByaWNlX2lkID0gYm9keS5wcmljZUlkXG4gICAgICBpZiAoYm9keS5jb2xvciAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLmNvbG9yID0gYm9keS5jb2xvclxuICAgICAgaWYgKGJvZHkuY29sb3JQYWxldHRlICE9PSB1bmRlZmluZWQpIHVwZGF0ZURhdGEuY29sb3JfcGFsZXR0ZSA9IGJvZHkuY29sb3JQYWxldHRlXG4gICAgICBpZiAoYm9keS5wYXRoICE9PSB1bmRlZmluZWQpIHVwZGF0ZURhdGEucGF0aCA9IGJvZHkucGF0aFxuICAgICAgaWYgKGJvZHkuZGlzcGxheU9yZGVyICE9PSB1bmRlZmluZWQpIHVwZGF0ZURhdGEuZGlzcGxheV9vcmRlciA9IGJvZHkuZGlzcGxheU9yZGVyXG4gICAgICBpZiAoYm9keS5jb2xsZWN0aW9uU2VyaWVzSWQgIT09IHVuZGVmaW5lZCkgdXBkYXRlRGF0YS5jb2xsZWN0aW9uX3Nlcmllc19pZCA9IGJvZHkuY29sbGVjdGlvblNlcmllc0lkXG4gICAgICBpZiAoYm9keS5pc0FjdGl2ZSAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLmlzX2FjdGl2ZSA9IGJvZHkuaXNBY3RpdmVcbiAgICAgIFxuICAgICAgLy8gSGFuZGxlIGlzX3NhbXBsZSBhbmQgZnVsbF9ib3hfaWQgZmllbGRzXG4gICAgICBpZiAoYm9keS5pc1NhbXBsZSAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLmlzX3NhbXBsZSA9IGJvZHkuaXNTYW1wbGVcbiAgICAgIGlmIChib2R5LmZ1bGxCb3hJZCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIC8vIE9ubHkgc2V0IGZ1bGxfYm94X2lkIGlmIHRoaXMgaXMgYSBzYW1wbGUgYm94XG4gICAgICAgIHVwZGF0ZURhdGEuZnVsbF9ib3hfaWQgPSBib2R5LmlzU2FtcGxlID8gYm9keS5mdWxsQm94SWQgOiBudWxsXG4gICAgICB9XG4gICAgICAvLyBJZiBzZXR0aW5nIGlzU2FtcGxlIHRvIGZhbHNlLCBjbGVhciB0aGUgZnVsbF9ib3hfaWRcbiAgICAgIGlmIChib2R5LmlzU2FtcGxlID09PSBmYWxzZSkge1xuICAgICAgICB1cGRhdGVEYXRhLmZ1bGxfYm94X2lkID0gbnVsbFxuICAgICAgfVxuICAgICAgXG4gICAgICBjb25zdCB7IGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAuZnJvbSgnYm94ZXMnKVxuICAgICAgICAudXBkYXRlKHVwZGF0ZURhdGEpXG4gICAgICAgIC5lcSgnaWQnLCBib3hJZClcbiAgICAgIFxuICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfSwgeyBzdGF0dXM6IDUwMCB9KSlcbiAgICAgIH1cbiAgICAgIFxuICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBzdWNjZXNzOiB0cnVlIH0pKVxuICAgIH1cblxuICAgIC8vIEFETUlOIFJPVVRFUyAtIFVwZGF0ZSBjb2xsZWN0aW9uIHNlcmllc1xuICAgIGlmIChwYXRoLnN0YXJ0c1dpdGgoJ2FkbWluL2NvbGxlY3Rpb24tc2VyaWVzLycpKSB7XG4gICAgICBjb25zdCBzZXJpZXNJZCA9IHBhdGguc3BsaXQoJy8nKVsyXVxuICAgICAgY29uc3QgYm9keSA9IGF3YWl0IHJlcXVlc3QuanNvbigpXG4gICAgICBcbiAgICAgIGNvbnN0IHVwZGF0ZURhdGEgPSB7fVxuICAgICAgaWYgKGJvZHkubmFtZSAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLm5hbWUgPSBib2R5Lm5hbWVcbiAgICAgIGlmIChib2R5LmRlc2NyaXB0aW9uICE9PSB1bmRlZmluZWQpIHVwZGF0ZURhdGEuZGVzY3JpcHRpb24gPSBib2R5LmRlc2NyaXB0aW9uXG4gICAgICBpZiAoYm9keS5kaXNwbGF5T3JkZXIgIT09IHVuZGVmaW5lZCkgdXBkYXRlRGF0YS5kaXNwbGF5X29yZGVyID0gYm9keS5kaXNwbGF5T3JkZXJcbiAgICAgIGlmIChib2R5LmlzQWN0aXZlICE9PSB1bmRlZmluZWQpIHVwZGF0ZURhdGEuaXNfYWN0aXZlID0gYm9keS5pc0FjdGl2ZVxuICAgICAgXG4gICAgICBjb25zdCB7IGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAuZnJvbSgnY29sbGVjdGlvbl9zZXJpZXMnKVxuICAgICAgICAudXBkYXRlKHVwZGF0ZURhdGEpXG4gICAgICAgIC5lcSgnaWQnLCBzZXJpZXNJZClcbiAgICAgIFxuICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfSwgeyBzdGF0dXM6IDUwMCB9KSlcbiAgICAgIH1cbiAgICAgIFxuICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBzdWNjZXNzOiB0cnVlIH0pKVxuICAgIH1cblxuICAgIC8vIEFETUlOIFJPVVRFUyAtIFVwZGF0ZSBwcmljZVxuICAgIGlmIChwYXRoLnN0YXJ0c1dpdGgoJ2FkbWluL3ByaWNlcy8nKSkge1xuICAgICAgY29uc3QgcHJpY2VJZCA9IHBhdGguc3BsaXQoJy8nKVsyXVxuICAgICAgY29uc3QgYm9keSA9IGF3YWl0IHJlcXVlc3QuanNvbigpXG4gICAgICBcbiAgICAgIGNvbnN0IHVwZGF0ZURhdGEgPSB7fVxuICAgICAgaWYgKGJvZHkubGFiZWwgIT09IHVuZGVmaW5lZCkgdXBkYXRlRGF0YS5sYWJlbCA9IGJvZHkubGFiZWxcbiAgICAgIGlmIChib2R5LnBheW1lbnRJbmZvICE9PSB1bmRlZmluZWQpIHVwZGF0ZURhdGEucGF5bWVudF9pbmZvID0gYm9keS5wYXltZW50SW5mb1xuICAgICAgaWYgKGJvZHkuaG9va0luZm8gIT09IHVuZGVmaW5lZCkgdXBkYXRlRGF0YS5ob29rX2luZm8gPSBib2R5Lmhvb2tJbmZvXG4gICAgICBpZiAoYm9keS5hbW91bnQgIT09IHVuZGVmaW5lZCkgdXBkYXRlRGF0YS5hbW91bnQgPSBib2R5LmFtb3VudFxuICAgICAgaWYgKGJvZHkucHJvbW9BbW91bnQgIT09IHVuZGVmaW5lZCkgdXBkYXRlRGF0YS5wcm9tb19hbW91bnQgPSBib2R5LnByb21vQW1vdW50XG4gICAgICBpZiAoYm9keS5wcm9tb0VuYWJsZWQgIT09IHVuZGVmaW5lZCkgdXBkYXRlRGF0YS5wcm9tb19lbmFibGVkID0gYm9keS5wcm9tb0VuYWJsZWRcbiAgICAgIGlmIChib2R5LmN1cnJlbmN5ICE9PSB1bmRlZmluZWQpIHVwZGF0ZURhdGEuY3VycmVuY3kgPSBib2R5LmN1cnJlbmN5XG4gICAgICBpZiAoYm9keS5tZW1iZXJzaGlwRGF5cyAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLm1lbWJlcnNoaXBfZGF5cyA9IGJvZHkubWVtYmVyc2hpcERheXNcbiAgICAgIGlmIChib2R5LnN0cmlwZVByaWNlSWQgIT09IHVuZGVmaW5lZCkgdXBkYXRlRGF0YS5zdHJpcGVfcHJpY2VfaWQgPSBib2R5LnN0cmlwZVByaWNlSWRcbiAgICAgIGlmIChib2R5LmRpc3BsYXlPcmRlciAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLmRpc3BsYXlfb3JkZXIgPSBib2R5LmRpc3BsYXlPcmRlclxuICAgICAgaWYgKGJvZHkuaXNBY3RpdmUgIT09IHVuZGVmaW5lZCkgdXBkYXRlRGF0YS5pc19hY3RpdmUgPSBib2R5LmlzQWN0aXZlXG4gICAgICBcbiAgICAgIGNvbnN0IHsgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgIC5mcm9tKCdwcmljZXMnKVxuICAgICAgICAudXBkYXRlKHVwZGF0ZURhdGEpXG4gICAgICAgIC5lcSgnaWQnLCBwcmljZUlkKVxuICAgICAgXG4gICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogZXJyb3IubWVzc2FnZSB9LCB7IHN0YXR1czogNTAwIH0pKVxuICAgICAgfVxuICAgICAgXG4gICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IHN1Y2Nlc3M6IHRydWUgfSkpXG4gICAgfVxuXG4gICAgLy8gQURNSU4gUk9VVEVTIC0gVXBkYXRlIHBpbGVcbiAgICBpZiAocGF0aC5zdGFydHNXaXRoKCdhZG1pbi9waWxlcy8nKSkge1xuICAgICAgY29uc3QgcGlsZUlkID0gcGF0aC5zcGxpdCgnLycpWzJdXG4gICAgICBjb25zdCBib2R5ID0gYXdhaXQgcmVxdWVzdC5qc29uKClcbiAgICAgIFxuICAgICAgY29uc3QgdXBkYXRlRGF0YSA9IHt9XG4gICAgICBpZiAoYm9keS5zbHVnICE9PSB1bmRlZmluZWQpIHVwZGF0ZURhdGEuc2x1ZyA9IGJvZHkuc2x1Z1xuICAgICAgaWYgKGJvZHkubmFtZSAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLm5hbWUgPSBib2R5Lm5hbWVcbiAgICAgIGlmIChib2R5LmltYWdlUGF0aCAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLmltYWdlX3BhdGggPSBib2R5LmltYWdlUGF0aFxuICAgICAgaWYgKGJvZHkuY29sbGVjdGlvblNlcmllc0lkICE9PSB1bmRlZmluZWQpIHVwZGF0ZURhdGEuY29sbGVjdGlvbl9zZXJpZXNfaWQgPSBib2R5LmNvbGxlY3Rpb25TZXJpZXNJZFxuICAgICAgaWYgKGJvZHkuZGlzcGxheU9yZGVyICE9PSB1bmRlZmluZWQpIHVwZGF0ZURhdGEuZGlzcGxheV9vcmRlciA9IGJvZHkuZGlzcGxheU9yZGVyXG4gICAgICBpZiAoYm9keS5pc0FjdGl2ZSAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLmlzX2FjdGl2ZSA9IGJvZHkuaXNBY3RpdmVcbiAgICAgIFxuICAgICAgY29uc3QgeyBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgLmZyb20oJ3BpbGVzJylcbiAgICAgICAgLnVwZGF0ZSh1cGRhdGVEYXRhKVxuICAgICAgICAuZXEoJ2lkJywgcGlsZUlkKVxuICAgICAgXG4gICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogZXJyb3IubWVzc2FnZSB9LCB7IHN0YXR1czogNTAwIH0pKVxuICAgICAgfVxuICAgICAgXG4gICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IHN1Y2Nlc3M6IHRydWUgfSkpXG4gICAgfVxuXG4gICAgLy8gQURNSU4gUk9VVEVTIC0gVXBkYXRlIGJ1bmRsZVxuICAgIGlmIChwYXRoLnN0YXJ0c1dpdGgoJ2FkbWluL2J1bmRsZXMvJykpIHtcbiAgICAgIGNvbnN0IGJ1bmRsZUlkID0gcGF0aC5zcGxpdCgnLycpWzJdXG4gICAgICBjb25zdCBib2R5ID0gYXdhaXQgcmVxdWVzdC5qc29uKClcbiAgICAgIFxuICAgICAgY29uc3QgdXBkYXRlRGF0YSA9IHt9XG4gICAgICBpZiAoYm9keS5uYW1lICE9PSB1bmRlZmluZWQpIHVwZGF0ZURhdGEubmFtZSA9IGJvZHkubmFtZVxuICAgICAgaWYgKGJvZHkuZGVzY3JpcHRpb24gIT09IHVuZGVmaW5lZCkgdXBkYXRlRGF0YS5kZXNjcmlwdGlvbiA9IGJvZHkuZGVzY3JpcHRpb25cbiAgICAgIGlmIChib2R5LnByaWNlSWQgIT09IHVuZGVmaW5lZCkgdXBkYXRlRGF0YS5wcmljZV9pZCA9IGJvZHkucHJpY2VJZFxuICAgICAgaWYgKGJvZHkuYm94SWRzICE9PSB1bmRlZmluZWQpIHVwZGF0ZURhdGEuYm94X2lkcyA9IGJvZHkuYm94SWRzXG4gICAgICBpZiAoYm9keS5kaXNwbGF5T3JkZXIgIT09IHVuZGVmaW5lZCkgdXBkYXRlRGF0YS5kaXNwbGF5X29yZGVyID0gYm9keS5kaXNwbGF5T3JkZXJcbiAgICAgIGlmIChib2R5LmlzQWN0aXZlICE9PSB1bmRlZmluZWQpIHVwZGF0ZURhdGEuaXNfYWN0aXZlID0gYm9keS5pc0FjdGl2ZVxuICAgICAgXG4gICAgICBjb25zdCB7IGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAuZnJvbSgnYnVuZGxlcycpXG4gICAgICAgIC51cGRhdGUodXBkYXRlRGF0YSlcbiAgICAgICAgLmVxKCdpZCcsIGJ1bmRsZUlkKVxuICAgICAgXG4gICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogZXJyb3IubWVzc2FnZSB9LCB7IHN0YXR1czogNTAwIH0pKVxuICAgICAgfVxuICAgICAgXG4gICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IHN1Y2Nlc3M6IHRydWUgfSkpXG4gICAgfVxuXG4gICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ1JvdXRlIG5vdCBmb3VuZCcgfSwgeyBzdGF0dXM6IDQwNCB9KSlcbiAgICBcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdBUEkgRXJyb3I6JywgZXJyb3IpXG4gICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogZXJyb3IubWVzc2FnZSB9LCB7IHN0YXR1czogNTAwIH0pKVxuICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBERUxFVEUocmVxdWVzdCkge1xuICBjb25zdCB1cmwgPSBuZXcgVVJMKHJlcXVlc3QudXJsKVxuICBjb25zdCBwYXRoID0gdXJsLnBhdGhuYW1lLnJlcGxhY2UoJy9hcGkvJywgJycpXG4gIGNvbnN0IHN1cGFiYXNlID0gY3JlYXRlU3VwYWJhc2VTZXJ2ZXIoKVxuXG4gIHRyeSB7XG4gICAgY29uc3QgeyB1c2VyLCBlcnJvcjogYXV0aEVycm9yIH0gPSBhd2FpdCBnZXRBdXRoZW50aWNhdGVkVXNlcigpXG4gICAgXG4gICAgaWYgKGF1dGhFcnJvciB8fCAhdXNlcikge1xuICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ1VuYXV0aG9yaXplZCcgfSwgeyBzdGF0dXM6IDQwMSB9KSlcbiAgICB9XG5cbiAgICAvLyBBRE1JTiBST1VURVMgLSBEZWxldGUgY2FyZFxuICAgIGlmIChwYXRoLnN0YXJ0c1dpdGgoJ2FkbWluL2NhcmRzLycpKSB7XG4gICAgICBjb25zdCBjYXJkSWQgPSBwYXRoLnNwbGl0KCcvJylbMl1cbiAgICAgIFxuICAgICAgY29uc3QgeyBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgLmZyb20oJ2NhcmRzJylcbiAgICAgICAgLmRlbGV0ZSgpXG4gICAgICAgIC5lcSgnaWQnLCBjYXJkSWQpXG4gICAgICBcbiAgICAgIGlmIChlcnJvcikge1xuICAgICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiBlcnJvci5tZXNzYWdlIH0sIHsgc3RhdHVzOiA1MDAgfSkpXG4gICAgICB9XG4gICAgICBcbiAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgc3VjY2VzczogdHJ1ZSB9KSlcbiAgICB9XG5cbiAgICAvLyBBRE1JTiBST1VURVMgLSBEZWxldGUgYm94XG4gICAgaWYgKHBhdGguc3RhcnRzV2l0aCgnYWRtaW4vYm94ZXMvJykpIHtcbiAgICAgIGNvbnN0IGJveElkID0gcGF0aC5zcGxpdCgnLycpWzJdXG4gICAgICBcbiAgICAgIC8vIEZpcnN0IGNoZWNrIGlmIGFueSBjYXJkcyBhcmUgYXNzaWduZWQgdG8gdGhpcyBib3hcbiAgICAgIGNvbnN0IHsgZGF0YTogY2FyZHMgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgIC5mcm9tKCdjYXJkcycpXG4gICAgICAgIC5zZWxlY3QoJ2lkJylcbiAgICAgICAgLmVxKCdib3hfaWQnLCBib3hJZClcbiAgICAgICAgLmxpbWl0KDEpXG4gICAgICBcbiAgICAgIGlmIChjYXJkcyAmJiBjYXJkcy5sZW5ndGggPiAwKSB7XG4gICAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgXG4gICAgICAgICAgZXJyb3I6ICdDYW5ub3QgZGVsZXRlIGJveCB3aXRoIGFzc2lnbmVkIGNhcmRzLiBSZW1vdmUgY2FyZHMgZmlyc3QuJyBcbiAgICAgICAgfSwgeyBzdGF0dXM6IDQwMCB9KSlcbiAgICAgIH1cbiAgICAgIFxuICAgICAgY29uc3QgeyBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgLmZyb20oJ2JveGVzJylcbiAgICAgICAgLmRlbGV0ZSgpXG4gICAgICAgIC5lcSgnaWQnLCBib3hJZClcbiAgICAgIFxuICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfSwgeyBzdGF0dXM6IDUwMCB9KSlcbiAgICAgIH1cbiAgICAgIFxuICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBzdWNjZXNzOiB0cnVlIH0pKVxuICAgIH1cblxuICAgIC8vIEFETUlOIFJPVVRFUyAtIERlbGV0ZSBjb2xsZWN0aW9uIHNlcmllc1xuICAgIGlmIChwYXRoLnN0YXJ0c1dpdGgoJ2FkbWluL2NvbGxlY3Rpb24tc2VyaWVzLycpKSB7XG4gICAgICBjb25zdCBzZXJpZXNJZCA9IHBhdGguc3BsaXQoJy8nKVsyXVxuICAgICAgXG4gICAgICBjb25zdCB7IGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAuZnJvbSgnY29sbGVjdGlvbl9zZXJpZXMnKVxuICAgICAgICAuZGVsZXRlKClcbiAgICAgICAgLmVxKCdpZCcsIHNlcmllc0lkKVxuICAgICAgXG4gICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogZXJyb3IubWVzc2FnZSB9LCB7IHN0YXR1czogNTAwIH0pKVxuICAgICAgfVxuICAgICAgXG4gICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IHN1Y2Nlc3M6IHRydWUgfSkpXG4gICAgfVxuXG4gICAgLy8gQURNSU4gUk9VVEVTIC0gRGVsZXRlIHByaWNlXG4gICAgaWYgKHBhdGguc3RhcnRzV2l0aCgnYWRtaW4vcHJpY2VzLycpKSB7XG4gICAgICBjb25zdCBwcmljZUlkID0gcGF0aC5zcGxpdCgnLycpWzJdXG4gICAgICBcbiAgICAgIGNvbnN0IHsgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgIC5mcm9tKCdwcmljZXMnKVxuICAgICAgICAuZGVsZXRlKClcbiAgICAgICAgLmVxKCdpZCcsIHByaWNlSWQpXG4gICAgICBcbiAgICAgIGlmIChlcnJvcikge1xuICAgICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiBlcnJvci5tZXNzYWdlIH0sIHsgc3RhdHVzOiA1MDAgfSkpXG4gICAgICB9XG4gICAgICBcbiAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgc3VjY2VzczogdHJ1ZSB9KSlcbiAgICB9XG5cbiAgICAvLyBBRE1JTiBST1VURVMgLSBEZWxldGUgcGlsZVxuICAgIGlmIChwYXRoLnN0YXJ0c1dpdGgoJ2FkbWluL3BpbGVzLycpKSB7XG4gICAgICBjb25zdCBwaWxlSWQgPSBwYXRoLnNwbGl0KCcvJylbMl1cbiAgICAgIFxuICAgICAgY29uc3QgeyBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgLmZyb20oJ3BpbGVzJylcbiAgICAgICAgLmRlbGV0ZSgpXG4gICAgICAgIC5lcSgnaWQnLCBwaWxlSWQpXG4gICAgICBcbiAgICAgIGlmIChlcnJvcikge1xuICAgICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiBlcnJvci5tZXNzYWdlIH0sIHsgc3RhdHVzOiA1MDAgfSkpXG4gICAgICB9XG4gICAgICBcbiAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgc3VjY2VzczogdHJ1ZSB9KSlcbiAgICB9XG5cbiAgICAvLyBBRE1JTiBST1VURVMgLSBEZWxldGUgYnVuZGxlXG4gICAgaWYgKHBhdGguc3RhcnRzV2l0aCgnYWRtaW4vYnVuZGxlcy8nKSkge1xuICAgICAgY29uc3QgYnVuZGxlSWQgPSBwYXRoLnNwbGl0KCcvJylbMl1cbiAgICAgIFxuICAgICAgY29uc3QgeyBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgLmZyb20oJ2J1bmRsZXMnKVxuICAgICAgICAuZGVsZXRlKClcbiAgICAgICAgLmVxKCdpZCcsIGJ1bmRsZUlkKVxuICAgICAgXG4gICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogZXJyb3IubWVzc2FnZSB9LCB7IHN0YXR1czogNTAwIH0pKVxuICAgICAgfVxuICAgICAgXG4gICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IHN1Y2Nlc3M6IHRydWUgfSkpXG4gICAgfVxuXG4gICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ1JvdXRlIG5vdCBmb3VuZCcgfSwgeyBzdGF0dXM6IDQwNCB9KSlcbiAgICBcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdBUEkgRXJyb3I6JywgZXJyb3IpXG4gICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogZXJyb3IubWVzc2FnZSB9LCB7IHN0YXR1czogNTAwIH0pKVxuICB9XG59XG4iXSwibmFtZXMiOlsiTmV4dFJlc3BvbnNlIiwiY3JlYXRlU3VwYWJhc2VTZXJ2ZXIiLCJnZXRTdHJpcGUiLCJ2NCIsInV1aWR2NCIsImhhbmRsZUNPUlMiLCJyZXNwb25zZSIsImhlYWRlcnMiLCJzZXQiLCJPUFRJT05TIiwic3RhdHVzIiwiZ2V0QXV0aGVudGljYXRlZFVzZXIiLCJwcm9jZXNzIiwiZW52IiwiTE9DQUxfTU9ERSIsImNvb2tpZXMiLCJnZXRVc2VyRnJvbVRva2VuIiwiY29va2llU3RvcmUiLCJ0b2tlbiIsImdldCIsInZhbHVlIiwidXNlciIsImVycm9yIiwic3VwYWJhc2UiLCJkYXRhIiwiYXV0aCIsImdldFVzZXIiLCJnZXRVc2VyRW50aXRsZWRCb3hJZHMiLCJnZXRCb3hlc1dpdGhWaXNpYmlsaXR5IiwiZ2V0VXNlckFjY2Vzc2libGVCb3hlcyIsInVzZXJJZCIsImJveGVzIiwiYm94RXJyb3IiLCJmcm9tIiwic2VsZWN0IiwiZXEiLCJvcmRlciIsImFzY2VuZGluZyIsImFjY2Vzc2libGVCb3hJZHMiLCJib3hJZHMiLCJoYXNNZW1iZXJzaGlwIiwiaGFzQWxsQWNjZXNzIiwiY2hlY2tVc2VyQWNjZXNzIiwic2FtcGxlQm94ZXMiLCJzYW1wbGVCb3hJZHMiLCJtYXAiLCJiIiwiaWQiLCJoYXNQYWlkQWNjZXNzIiwic29tZSIsImluY2x1ZGVzIiwiR0VUIiwicmVxdWVzdCIsInVybCIsIlVSTCIsInBhdGgiLCJwYXRobmFtZSIsInJlcGxhY2UiLCJqc29uIiwiZW1haWwiLCJib3hlc1dpdGhBY2Nlc3MiLCJib3giLCJoYXNBY2Nlc3MiLCJzZWFyY2hQYXJhbXMiLCJzcGxpdCIsImZpbHRlciIsIkJvb2xlYW4iLCJxdWVyeUJveElkcyIsImxlbmd0aCIsImNhcmRzIiwibWVzc2FnZSIsImluIiwiY29uc29sZSIsInBpbGVzTWFwIiwicGlsZUlkcyIsIlNldCIsImMiLCJwaWxlX2lkIiwicGlsZXMiLCJmb3JFYWNoIiwicCIsInRyYW5zZm9ybWVkQ2FyZHMiLCJjYXJkIiwicGlsZSIsImJveF9pZCIsInRleHQiLCJpbWFnZV9wYXRoIiwiaXNfYWN0aXZlIiwiY3JlYXRlZF9hdCIsImNvbG9yIiwic2x1ZyIsInBpbGVfbmFtZSIsIm5hbWUiLCJwaWxlX2ltYWdlIiwidGl0bGUiLCJpbWFnZVBhdGgiLCJwbGFucyIsInNlcmllcyIsImF1dGhFcnJvciIsInB1cmNoYXNlcyIsImRyYXdzIiwiYm94ZXNSZXN1bHQiLCJwaWxlc1Jlc3VsdCIsInNlcmllc1Jlc3VsdCIsIlByb21pc2UiLCJhbGwiLCJib3hNYXAiLCJwaWxlTWFwIiwic2VyaWVzTWFwIiwicyIsImVucmljaGVkQ2FyZHMiLCJjb2xsZWN0aW9uU2VyaWVzIiwiY29sbGVjdGlvbl9zZXJpZXNfaWQiLCJjb2xsZWN0aW9uX3NlcmllcyIsImNhcmRzUmVzdWx0IiwicHJpY2VzUmVzdWx0IiwicHJpY2VzIiwibG9nIiwicHJpY2VNYXAiLCJjYXJkQ291bnRzIiwia2V5IiwidG90YWwiLCJieVBpbGUiLCJwaWxlSWQiLCJjb3VudCIsInBpbGVOYW1lIiwicGlsZVNsdWciLCJlbnJpY2hlZEJveGVzIiwicHJpY2VfaWQiLCJjYXJkU3RhdHMiLCJwaWxlc0Vycm9yIiwic2VyaWVzRXJyb3IiLCJBcnJheSIsImlzQXJyYXkiLCJPYmplY3QiLCJrZXlzIiwiZW5yaWNoZWRQaWxlcyIsInNlcmllc0RhdGEiLCJidW5kbGVzIiwiZW5yaWNoZWRCdW5kbGVzIiwiUE9TVCIsImJvZHkiLCJwYXNzd29yZCIsInNpZ25VcCIsInNpZ25JbldpdGhQYXNzd29yZCIsInNpZ25PdXQiLCJzdWNjZXNzIiwiY29va2llT3B0aW9ucyIsImV4cGlyZXMiLCJEYXRlIiwibWF4QWdlIiwic3VwYWJhc2VVcmwiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwiLCJwcm9qZWN0UmVmIiwibWF0Y2giLCJzaWduSW5XaXRoT0F1dGgiLCJwcm92aWRlciIsIm9wdGlvbnMiLCJyZWRpcmVjdFRvIiwiTkVYVF9QVUJMSUNfQkFTRV9VUkwiLCJyZXNldFBhc3N3b3JkRm9yRW1haWwiLCJibGFja0NhcmRJZCIsIndoaXRlQ2FyZElkIiwiYmxhY2tDYXJkVGl0bGUiLCJ3aGl0ZUNhcmRUaXRsZSIsImRyYXciLCJ1c2VyaWQiLCJ1c2VyZW1haWwiLCJibGFja2NhcmRpZCIsIndoaXRlY2FyZGlkIiwiYmxhY2tjYXJkdGl0bGUiLCJ3aGl0ZWNhcmR0aXRsZSIsInRpbWVzdGFtcCIsInRvSVNPU3RyaW5nIiwiaW5zZXJ0Iiwic2luZ2xlIiwiYm94SWQiLCJpc19zYW1wbGUiLCJzZXNzaW9uIiwiY2hlY2tvdXQiLCJzZXNzaW9ucyIsImNyZWF0ZSIsInBheW1lbnRfbWV0aG9kX3R5cGVzIiwibGluZV9pdGVtcyIsInByaWNlX2RhdGEiLCJjdXJyZW5jeSIsInByb2R1Y3RfZGF0YSIsImRlc2NyaXB0aW9uIiwidW5pdF9hbW91bnQiLCJNYXRoIiwicm91bmQiLCJwcmljZSIsInF1YW50aXR5IiwibW9kZSIsInN1Y2Nlc3NfdXJsIiwiY2FuY2VsX3VybCIsImNsaWVudF9yZWZlcmVuY2VfaWQiLCJjdXN0b21lcl9lbWFpbCIsIm1ldGFkYXRhIiwicHVyY2hhc2VfdHlwZSIsInBsYW5JZCIsInBsYW4iLCJwbGFuRXJyb3IiLCJpbnRlcnZhbCIsImludGVydmFsQ291bnQiLCJyZWN1cnJpbmciLCJpbnRlcnZhbF9jb3VudCIsInBsYW5faWQiLCJwdXJjaGFzZUlkIiwicHVyY2hhc2UiLCJwdXJjaGFzZUVycm9yIiwic3RyaXBlX3N1YnNjcmlwdGlvbl9pZCIsInN1YnNjcmlwdGlvbnMiLCJjYW5jZWwiLCJ1cGRhdGUiLCJzdHJpcGVFcnJvciIsInBheW1lbnRUeXBlIiwiY291cG9uQ29kZSIsInNlc3Npb25Db25maWciLCJwdXNoIiwiY291cG9ucyIsImxpc3QiLCJsaW1pdCIsInZhbGlkQ291cG9uIiwiZmluZCIsInRvTG93ZXJDYXNlIiwiZGlzY291bnRzIiwiY291cG9uIiwic3RyaXBlIiwiaXNBY3RpdmUiLCJjcnlwdG8iLCJjYXJkSWQiLCJjcmVhdGVIYXNoIiwibm93IiwicmFuZG9tIiwiZGlnZXN0IiwiZGVzY3JpcHRpb25TaG9ydCIsInRhZ2xpbmUiLCJ0b3BpY3MiLCJwcmljZUlkIiwiY29sb3JQYWxldHRlIiwiYm94UGF0aCIsImRpc3BsYXlPcmRlciIsImlzU2FtcGxlIiwiZnVsbEJveElkIiwiY29sbGVjdGlvblNlcmllc0lkIiwic2xpY2UiLCJkZXNjcmlwdGlvbl9zaG9ydCIsImNvbG9yX3BhbGV0dGUiLCJkaXNwbGF5X29yZGVyIiwiZnVsbF9ib3hfaWQiLCJsYWJlbCIsInBheW1lbnRJbmZvIiwiaG9va0luZm8iLCJhbW91bnQiLCJwcm9tb0Ftb3VudCIsInByb21vRW5hYmxlZCIsIm1lbWJlcnNoaXBEYXlzIiwic3RyaXBlUHJpY2VJZCIsInBheW1lbnRfaW5mbyIsImhvb2tfaW5mbyIsInByb21vX2Ftb3VudCIsInByb21vX2VuYWJsZWQiLCJtZW1iZXJzaGlwX2RheXMiLCJzdHJpcGVfcHJpY2VfaWQiLCJidW5kbGUiLCJib3hfaWRzIiwiZGVsZXRlUmVzdWx0IiwiZGVsZXRlIiwiZGVsZXRlZCIsInF1ZXJ5IiwiaW1hZ2VQYXRocyIsIlBVVCIsInN0YXJ0c1dpdGgiLCJ1cGRhdGVEYXRhIiwidW5kZWZpbmVkIiwic2VyaWVzSWQiLCJidW5kbGVJZCIsIkRFTEVURSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./app/api/[[...path]]/route.js\n");

/***/ }),

/***/ "(rsc)/./lib/db-local.js":
/*!*************************!*\
  !*** ./lib/db-local.js ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createLocalClient: () => (/* binding */ createLocalClient),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   getPool: () => (/* binding */ getPool),\n/* harmony export */   query: () => (/* binding */ query)\n/* harmony export */ });\n/* harmony import */ var pg__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! pg */ \"pg\");\n/* harmony import */ var pg__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(pg__WEBPACK_IMPORTED_MODULE_0__);\n// Local PostgreSQL Database Client\n// Used when LOCAL_MODE=true\n\nlet pool = null;\nfunction getPool() {\n    if (!pool) {\n        const connectionString = process.env.DATABASE_URL || \"postgresql://postgres:postgres@localhost:5432/asweallare\";\n        console.log(\"[DB-LOCAL] Creating pool with:\", connectionString.replace(/:[^:@]+@/, \":***@\"));\n        pool = new pg__WEBPACK_IMPORTED_MODULE_0__.Pool({\n            connectionString\n        });\n        pool.on(\"error\", (err)=>{\n            console.error(\"[DB-LOCAL] Pool error:\", err.message);\n        });\n    }\n    return pool;\n}\nasync function query(text, params) {\n    const pool = getPool();\n    try {\n        const result = await pool.query(text, params);\n        return result;\n    } catch (error) {\n        console.error(\"[DB-LOCAL] Query error:\", error.message);\n        console.error(\"[DB-LOCAL] Query was:\", text);\n        throw error;\n    }\n}\n// Helper to mimic Supabase response format\nfunction createLocalClient() {\n    return {\n        from: (table)=>new QueryBuilder(table),\n        auth: {\n            getUser: async ()=>{\n                // In local mode, return a mock admin user\n                return {\n                    data: {\n                        user: {\n                            id: \"00000000-0000-0000-0000-000000000001\",\n                            email: \"admin@local.dev\"\n                        }\n                    },\n                    error: null\n                };\n            },\n            getSession: async ()=>{\n                return {\n                    data: {\n                        session: {\n                            user: {\n                                id: \"00000000-0000-0000-0000-000000000001\",\n                                email: \"admin@local.dev\"\n                            }\n                        }\n                    },\n                    error: null\n                };\n            },\n            signOut: async ()=>({\n                    error: null\n                }),\n            onAuthStateChange: ()=>({\n                    data: {\n                        subscription: {\n                            unsubscribe: ()=>{}\n                        }\n                    }\n                })\n        }\n    };\n}\nclass QueryBuilder {\n    constructor(table){\n        this.table = table;\n        this._select = \"*\";\n        this._where = [];\n        this._whereParams = [];\n        this._order = null;\n        this._single = false;\n        this._limit = null;\n        this._returnData = true;\n        this._operation = null // 'update', 'delete', or null for select\n        ;\n        this._updateData = null;\n    }\n    select(columns = \"*\") {\n        // Handle Supabase-style nested selects by stripping them\n        // e.g., '*, piles(slug, name)' becomes '*'\n        if (columns.includes(\"(\")) {\n            this._select = columns.split(\",\").filter((c)=>!c.includes(\"(\")).map((c)=>c.trim()).join(\", \") || \"*\";\n        } else {\n            this._select = columns;\n        }\n        return this;\n    }\n    eq(column, value) {\n        this._whereParams.push(value);\n        this._where.push(`\"${column}\" = $${this._whereParams.length}`);\n        return this;\n    }\n    neq(column, value) {\n        this._whereParams.push(value);\n        this._where.push(`\"${column}\" != $${this._whereParams.length}`);\n        return this;\n    }\n    in(column, values) {\n        if (values && values.length > 0) {\n            const placeholders = values.map((_, i)=>`$${this._whereParams.length + i + 1}`).join(\", \");\n            this._whereParams.push(...values);\n            this._where.push(`\"${column}\" IN (${placeholders})`);\n        }\n        // If empty array, don't add any condition (will return all or be filtered by other conditions)\n        return this;\n    }\n    order(column, { ascending = true } = {}) {\n        this._order = `\"${column}\" ${ascending ? \"ASC\" : \"DESC\"}`;\n        return this;\n    }\n    limit(count) {\n        this._limit = count;\n        return this;\n    }\n    single() {\n        this._single = true;\n        this._limit = 1;\n        return this;\n    }\n    // Execute SELECT query\n    async then(resolve, reject) {\n        try {\n            let sql = `SELECT ${this._select} FROM \"${this.table}\"`;\n            if (this._where.length > 0) {\n                sql += ` WHERE ${this._where.join(\" AND \")}`;\n            }\n            if (this._order) {\n                sql += ` ORDER BY ${this._order}`;\n            }\n            if (this._limit) {\n                sql += ` LIMIT ${this._limit}`;\n            }\n            console.log(\"[DB-LOCAL] Executing:\", sql, \"with params:\", this._whereParams);\n            const result = await query(sql, this._whereParams);\n            if (this._single) {\n                resolve({\n                    data: result.rows[0] || null,\n                    error: null\n                });\n            } else {\n                resolve({\n                    data: result.rows,\n                    error: null\n                });\n            }\n        } catch (error) {\n            console.error(\"[DB-LOCAL] Query failed:\", error.message);\n            if (reject) {\n                reject(error);\n            } else {\n                resolve({\n                    data: null,\n                    error\n                });\n            }\n        }\n    }\n    async insert(data) {\n        try {\n            // Handle array of objects\n            const records = Array.isArray(data) ? data : [\n                data\n            ];\n            const results = [];\n            for (const record of records){\n                const keys = Object.keys(record);\n                const values = Object.values(record);\n                const placeholders = values.map((_, i)=>`$${i + 1}`).join(\", \");\n                const quotedKeys = keys.map((k)=>`\"${k}\"`).join(\", \");\n                const sql = `INSERT INTO \"${this.table}\" (${quotedKeys}) VALUES (${placeholders}) RETURNING *`;\n                console.log(\"[DB-LOCAL] Insert:\", sql);\n                const result = await query(sql, values);\n                results.push(result.rows[0]);\n            }\n            // Return a chainable object that mimics Supabase behavior\n            const insertResult = {\n                data: results,\n                error: null\n            };\n            return {\n                ...insertResult,\n                select: ()=>({\n                        single: ()=>Promise.resolve({\n                                data: results[0],\n                                error: null\n                            }),\n                        then: (resolve)=>resolve({\n                                data: results,\n                                error: null\n                            })\n                    }),\n                then: (resolve)=>resolve(insertResult)\n            };\n        } catch (error) {\n            console.error(\"[DB-LOCAL] Insert failed:\", error.message);\n            const errorResult = {\n                data: null,\n                error\n            };\n            return {\n                ...errorResult,\n                select: ()=>({\n                        single: ()=>Promise.resolve(errorResult),\n                        then: (resolve)=>resolve(errorResult)\n                    }),\n                then: (resolve)=>resolve(errorResult)\n            };\n        }\n    }\n    // Store update data for later execution\n    update(data) {\n        this._updateData = data;\n        this._operation = \"update\";\n        return this;\n    }\n    // Execute UPDATE query\n    async _executeUpdate() {\n        try {\n            const keys = Object.keys(this._updateData);\n            const values = Object.values(this._updateData);\n            const setClause = keys.map((k, i)=>`\"${k}\" = $${i + 1}`).join(\", \");\n            let sql = `UPDATE \"${this.table}\" SET ${setClause}`;\n            const params = [\n                ...values\n            ];\n            if (this._where.length > 0) {\n                // Adjust parameter indices for where clause\n                const whereWithOffset = this._where.map((w)=>{\n                    return w.replace(/\\$(\\d+)/g, (match, num)=>`$${parseInt(num) + values.length}`);\n                });\n                sql += ` WHERE ${whereWithOffset.join(\" AND \")}`;\n                params.push(...this._whereParams);\n            }\n            sql += \" RETURNING *\";\n            console.log(\"[DB-LOCAL] Update:\", sql, \"params:\", params);\n            const result = await query(sql, params);\n            return {\n                data: result.rows,\n                error: null\n            };\n        } catch (error) {\n            console.error(\"[DB-LOCAL] Update failed:\", error.message);\n            return {\n                data: null,\n                error\n            };\n        }\n    }\n    // Execute DELETE query\n    async _executeDelete() {\n        try {\n            let sql = `DELETE FROM \"${this.table}\"`;\n            if (this._where.length > 0) {\n                sql += ` WHERE ${this._where.join(\" AND \")}`;\n            }\n            sql += \" RETURNING *\";\n            console.log(\"[DB-LOCAL] Delete:\", sql);\n            const result = await query(sql, this._whereParams);\n            return {\n                data: result.rows,\n                error: null\n            };\n        } catch (error) {\n            console.error(\"[DB-LOCAL] Delete failed:\", error.message);\n            return {\n                data: null,\n                error\n            };\n        }\n    }\n    // Mark as delete operation\n    delete() {\n        this._operation = \"delete\";\n        return this;\n    }\n    // Execute SELECT query (and UPDATE/DELETE if flagged)\n    async then(resolve, reject) {\n        try {\n            // Handle update operation\n            if (this._operation === \"update\") {\n                const result = await this._executeUpdate();\n                resolve(result);\n                return;\n            }\n            // Handle delete operation\n            if (this._operation === \"delete\") {\n                const result = await this._executeDelete();\n                resolve(result);\n                return;\n            }\n            // Default: SELECT\n            let sql = `SELECT ${this._select} FROM \"${this.table}\"`;\n            if (this._where.length > 0) {\n                sql += ` WHERE ${this._where.join(\" AND \")}`;\n            }\n            if (this._order) {\n                sql += ` ORDER BY ${this._order}`;\n            }\n            if (this._limit) {\n                sql += ` LIMIT ${this._limit}`;\n            }\n            console.log(\"[DB-LOCAL] Executing:\", sql, \"with params:\", this._whereParams);\n            const result = await query(sql, this._whereParams);\n            if (this._single) {\n                resolve({\n                    data: result.rows[0] || null,\n                    error: null\n                });\n            } else {\n                resolve({\n                    data: result.rows,\n                    error: null\n                });\n            }\n        } catch (error) {\n            console.error(\"[DB-LOCAL] Query failed:\", error.message);\n            if (reject) {\n                reject(error);\n            } else {\n                resolve({\n                    data: null,\n                    error\n                });\n            }\n        }\n    }\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({\n    query,\n    getPool,\n    createLocalClient\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RUFBRTtnQkFDZmtDLE9BQU8sQ0FBQyxVQUFVLEVBQUUsSUFBSSxDQUFDbEMsTUFBTSxDQUFDLENBQUM7WUFDbkM7WUFFQSxJQUFJLElBQUksQ0FBQ0UsTUFBTSxFQUFFO2dCQUNmZ0MsT0FBTyxDQUFDLE9BQU8sRUFBRSxJQUFJLENBQUNoQyxNQUFNLENBQUMsQ0FBQztZQUNoQztZQUVBakMsUUFBUUMsR0FBRyxDQUFDLHlCQUF5QmdFLEtBQUssZ0JBQWdCLElBQUksQ0FBQ25DLFlBQVk7WUFDM0UsTUFBTXBCLFNBQVMsTUFBTUgsTUFBTTBELEtBQUssSUFBSSxDQUFDbkMsWUFBWTtZQUVqRCxJQUFJLElBQUksQ0FBQ0UsT0FBTyxFQUFFO2dCQUNoQitCLFFBQVE7b0JBQUU5QyxNQUFNUCxPQUFPd0QsSUFBSSxDQUFDLEVBQUUsSUFBSTtvQkFBTTdELE9BQU87Z0JBQUs7WUFDdEQsT0FBTztnQkFDTDBELFFBQVE7b0JBQUU5QyxNQUFNUCxPQUFPd0QsSUFBSTtvQkFBRTdELE9BQU87Z0JBQUs7WUFDM0M7UUFDRixFQUFFLE9BQU9BLE9BQU87WUFDZEwsUUFBUUssS0FBSyxDQUFDLDRCQUE0QkEsTUFBTUMsT0FBTztZQUN2RCxJQUFJMEQsUUFBUTtnQkFDVkEsT0FBTzNEO1lBQ1QsT0FBTztnQkFDTDBELFFBQVE7b0JBQUU5QyxNQUFNO29CQUFNWjtnQkFBTTtZQUM5QjtRQUNGO0lBQ0Y7QUFFRjtBQUVBLGlFQUFlO0lBQUVFO0lBQU9aO0lBQVNnQjtBQUFrQixDQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYXN3ZWFsbGFyZS1hZG1pbi8uL2xpYi9kYi1sb2NhbC5qcz82MTM2Il0sInNvdXJjZXNDb250ZW50IjpbIi8vIExvY2FsIFBvc3RncmVTUUwgRGF0YWJhc2UgQ2xpZW50XG4vLyBVc2VkIHdoZW4gTE9DQUxfTU9ERT10cnVlXG5cbmltcG9ydCB7IFBvb2wgfSBmcm9tICdwZydcblxubGV0IHBvb2wgPSBudWxsXG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRQb29sKCkge1xuICBpZiAoIXBvb2wpIHtcbiAgICBjb25zdCBjb25uZWN0aW9uU3RyaW5nID0gcHJvY2Vzcy5lbnYuREFUQUJBU0VfVVJMIHx8ICdwb3N0Z3Jlc3FsOi8vcG9zdGdyZXM6cG9zdGdyZXNAbG9jYWxob3N0OjU0MzIvYXN3ZWFsbGFyZSdcbiAgICBjb25zb2xlLmxvZygnW0RCLUxPQ0FMXSBDcmVhdGluZyBwb29sIHdpdGg6JywgY29ubmVjdGlvblN0cmluZy5yZXBsYWNlKC86W146QF0rQC8sICc6KioqQCcpKVxuICAgIHBvb2wgPSBuZXcgUG9vbCh7IGNvbm5lY3Rpb25TdHJpbmcgfSlcbiAgICBcbiAgICBwb29sLm9uKCdlcnJvcicsIChlcnIpID0+IHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1tEQi1MT0NBTF0gUG9vbCBlcnJvcjonLCBlcnIubWVzc2FnZSlcbiAgICB9KVxuICB9XG4gIHJldHVybiBwb29sXG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBxdWVyeSh0ZXh0LCBwYXJhbXMpIHtcbiAgY29uc3QgcG9vbCA9IGdldFBvb2woKVxuICB0cnkge1xuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHBvb2wucXVlcnkodGV4dCwgcGFyYW1zKVxuICAgIHJldHVybiByZXN1bHRcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdbREItTE9DQUxdIFF1ZXJ5IGVycm9yOicsIGVycm9yLm1lc3NhZ2UpXG4gICAgY29uc29sZS5lcnJvcignW0RCLUxPQ0FMXSBRdWVyeSB3YXM6JywgdGV4dClcbiAgICB0aHJvdyBlcnJvclxuICB9XG59XG5cbi8vIEhlbHBlciB0byBtaW1pYyBTdXBhYmFzZSByZXNwb25zZSBmb3JtYXRcbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVMb2NhbENsaWVudCgpIHtcbiAgcmV0dXJuIHtcbiAgICBmcm9tOiAodGFibGUpID0+IG5ldyBRdWVyeUJ1aWxkZXIodGFibGUpLFxuICAgIGF1dGg6IHtcbiAgICAgIGdldFVzZXI6IGFzeW5jICgpID0+IHtcbiAgICAgICAgLy8gSW4gbG9jYWwgbW9kZSwgcmV0dXJuIGEgbW9jayBhZG1pbiB1c2VyXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgdXNlcjoge1xuICAgICAgICAgICAgICBpZDogJzAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMScsXG4gICAgICAgICAgICAgIGVtYWlsOiAnYWRtaW5AbG9jYWwuZGV2J1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sXG4gICAgICAgICAgZXJyb3I6IG51bGxcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIGdldFNlc3Npb246IGFzeW5jICgpID0+IHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICBzZXNzaW9uOiB7XG4gICAgICAgICAgICAgIHVzZXI6IHtcbiAgICAgICAgICAgICAgICBpZDogJzAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMScsXG4gICAgICAgICAgICAgICAgZW1haWw6ICdhZG1pbkBsb2NhbC5kZXYnXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9LFxuICAgICAgICAgIGVycm9yOiBudWxsXG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBzaWduT3V0OiBhc3luYyAoKSA9PiAoeyBlcnJvcjogbnVsbCB9KSxcbiAgICAgIG9uQXV0aFN0YXRlQ2hhbmdlOiAoKSA9PiAoeyBkYXRhOiB7IHN1YnNjcmlwdGlvbjogeyB1bnN1YnNjcmliZTogKCkgPT4ge30gfSB9IH0pXG4gICAgfVxuICB9XG59XG5cbmNsYXNzIFF1ZXJ5QnVpbGRlciB7XG4gIGNvbnN0cnVjdG9yKHRhYmxlKSB7XG4gICAgdGhpcy50YWJsZSA9IHRhYmxlXG4gICAgdGhpcy5fc2VsZWN0ID0gJyonXG4gICAgdGhpcy5fd2hlcmUgPSBbXVxuICAgIHRoaXMuX3doZXJlUGFyYW1zID0gW11cbiAgICB0aGlzLl9vcmRlciA9IG51bGxcbiAgICB0aGlzLl9zaW5nbGUgPSBmYWxzZVxuICAgIHRoaXMuX2xpbWl0ID0gbnVsbFxuICAgIHRoaXMuX3JldHVybkRhdGEgPSB0cnVlXG4gICAgdGhpcy5fb3BlcmF0aW9uID0gbnVsbCAvLyAndXBkYXRlJywgJ2RlbGV0ZScsIG9yIG51bGwgZm9yIHNlbGVjdFxuICAgIHRoaXMuX3VwZGF0ZURhdGEgPSBudWxsXG4gIH1cblxuICBzZWxlY3QoY29sdW1ucyA9ICcqJykge1xuICAgIC8vIEhhbmRsZSBTdXBhYmFzZS1zdHlsZSBuZXN0ZWQgc2VsZWN0cyBieSBzdHJpcHBpbmcgdGhlbVxuICAgIC8vIGUuZy4sICcqLCBwaWxlcyhzbHVnLCBuYW1lKScgYmVjb21lcyAnKidcbiAgICBpZiAoY29sdW1ucy5pbmNsdWRlcygnKCcpKSB7XG4gICAgICB0aGlzLl9zZWxlY3QgPSBjb2x1bW5zLnNwbGl0KCcsJykuZmlsdGVyKGMgPT4gIWMuaW5jbHVkZXMoJygnKSkubWFwKGMgPT4gYy50cmltKCkpLmpvaW4oJywgJykgfHwgJyonXG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX3NlbGVjdCA9IGNvbHVtbnNcbiAgICB9XG4gICAgcmV0dXJuIHRoaXNcbiAgfVxuXG4gIGVxKGNvbHVtbiwgdmFsdWUpIHtcbiAgICB0aGlzLl93aGVyZVBhcmFtcy5wdXNoKHZhbHVlKVxuICAgIHRoaXMuX3doZXJlLnB1c2goYFwiJHtjb2x1bW59XCIgPSAkJHt0aGlzLl93aGVyZVBhcmFtcy5sZW5ndGh9YClcbiAgICByZXR1cm4gdGhpc1xuICB9XG5cbiAgbmVxKGNvbHVtbiwgdmFsdWUpIHtcbiAgICB0aGlzLl93aGVyZVBhcmFtcy5wdXNoKHZhbHVlKVxuICAgIHRoaXMuX3doZXJlLnB1c2goYFwiJHtjb2x1bW59XCIgIT0gJCR7dGhpcy5fd2hlcmVQYXJhbXMubGVuZ3RofWApXG4gICAgcmV0dXJuIHRoaXNcbiAgfVxuXG4gIGluKGNvbHVtbiwgdmFsdWVzKSB7XG4gICAgaWYgKHZhbHVlcyAmJiB2YWx1ZXMubGVuZ3RoID4gMCkge1xuICAgICAgY29uc3QgcGxhY2Vob2xkZXJzID0gdmFsdWVzLm1hcCgoXywgaSkgPT4gYCQke3RoaXMuX3doZXJlUGFyYW1zLmxlbmd0aCArIGkgKyAxfWApLmpvaW4oJywgJylcbiAgICAgIHRoaXMuX3doZXJlUGFyYW1zLnB1c2goLi4udmFsdWVzKVxuICAgICAgdGhpcy5fd2hlcmUucHVzaChgXCIke2NvbHVtbn1cIiBJTiAoJHtwbGFjZWhvbGRlcnN9KWApXG4gICAgfVxuICAgIC8vIElmIGVtcHR5IGFycmF5LCBkb24ndCBhZGQgYW55IGNvbmRpdGlvbiAod2lsbCByZXR1cm4gYWxsIG9yIGJlIGZpbHRlcmVkIGJ5IG90aGVyIGNvbmRpdGlvbnMpXG4gICAgcmV0dXJuIHRoaXNcbiAgfVxuXG4gIG9yZGVyKGNvbHVtbiwgeyBhc2NlbmRpbmcgPSB0cnVlIH0gPSB7fSkge1xuICAgIHRoaXMuX29yZGVyID0gYFwiJHtjb2x1bW59XCIgJHthc2NlbmRpbmcgPyAnQVNDJyA6ICdERVNDJ31gXG4gICAgcmV0dXJuIHRoaXNcbiAgfVxuXG4gIGxpbWl0KGNvdW50KSB7XG4gICAgdGhpcy5fbGltaXQgPSBjb3VudFxuICAgIHJldHVybiB0aGlzXG4gIH1cblxuICBzaW5nbGUoKSB7XG4gICAgdGhpcy5fc2luZ2xlID0gdHJ1ZVxuICAgIHRoaXMuX2xpbWl0ID0gMVxuICAgIHJldHVybiB0aGlzXG4gIH1cblxuICAvLyBFeGVjdXRlIFNFTEVDVCBxdWVyeVxuICBhc3luYyB0aGVuKHJlc29sdmUsIHJlamVjdCkge1xuICAgIHRyeSB7XG4gICAgICBsZXQgc3FsID0gYFNFTEVDVCAke3RoaXMuX3NlbGVjdH0gRlJPTSBcIiR7dGhpcy50YWJsZX1cImBcbiAgICAgIFxuICAgICAgaWYgKHRoaXMuX3doZXJlLmxlbmd0aCA+IDApIHtcbiAgICAgICAgc3FsICs9IGAgV0hFUkUgJHt0aGlzLl93aGVyZS5qb2luKCcgQU5EICcpfWBcbiAgICAgIH1cbiAgICAgIFxuICAgICAgaWYgKHRoaXMuX29yZGVyKSB7XG4gICAgICAgIHNxbCArPSBgIE9SREVSIEJZICR7dGhpcy5fb3JkZXJ9YFxuICAgICAgfVxuICAgICAgXG4gICAgICBpZiAodGhpcy5fbGltaXQpIHtcbiAgICAgICAgc3FsICs9IGAgTElNSVQgJHt0aGlzLl9saW1pdH1gXG4gICAgICB9XG5cbiAgICAgIGNvbnNvbGUubG9nKCdbREItTE9DQUxdIEV4ZWN1dGluZzonLCBzcWwsICd3aXRoIHBhcmFtczonLCB0aGlzLl93aGVyZVBhcmFtcylcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHF1ZXJ5KHNxbCwgdGhpcy5fd2hlcmVQYXJhbXMpXG4gICAgICBcbiAgICAgIGlmICh0aGlzLl9zaW5nbGUpIHtcbiAgICAgICAgcmVzb2x2ZSh7IGRhdGE6IHJlc3VsdC5yb3dzWzBdIHx8IG51bGwsIGVycm9yOiBudWxsIH0pXG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXNvbHZlKHsgZGF0YTogcmVzdWx0LnJvd3MsIGVycm9yOiBudWxsIH0pXG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1tEQi1MT0NBTF0gUXVlcnkgZmFpbGVkOicsIGVycm9yLm1lc3NhZ2UpXG4gICAgICBpZiAocmVqZWN0KSB7XG4gICAgICAgIHJlamVjdChlcnJvcilcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlc29sdmUoeyBkYXRhOiBudWxsLCBlcnJvciB9KVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGluc2VydChkYXRhKSB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIEhhbmRsZSBhcnJheSBvZiBvYmplY3RzXG4gICAgICBjb25zdCByZWNvcmRzID0gQXJyYXkuaXNBcnJheShkYXRhKSA/IGRhdGEgOiBbZGF0YV1cbiAgICAgIGNvbnN0IHJlc3VsdHMgPSBbXVxuICAgICAgXG4gICAgICBmb3IgKGNvbnN0IHJlY29yZCBvZiByZWNvcmRzKSB7XG4gICAgICAgIGNvbnN0IGtleXMgPSBPYmplY3Qua2V5cyhyZWNvcmQpXG4gICAgICAgIGNvbnN0IHZhbHVlcyA9IE9iamVjdC52YWx1ZXMocmVjb3JkKVxuICAgICAgICBjb25zdCBwbGFjZWhvbGRlcnMgPSB2YWx1ZXMubWFwKChfLCBpKSA9PiBgJCR7aSArIDF9YCkuam9pbignLCAnKVxuICAgICAgICBjb25zdCBxdW90ZWRLZXlzID0ga2V5cy5tYXAoayA9PiBgXCIke2t9XCJgKS5qb2luKCcsICcpXG4gICAgICAgIFxuICAgICAgICBjb25zdCBzcWwgPSBgSU5TRVJUIElOVE8gXCIke3RoaXMudGFibGV9XCIgKCR7cXVvdGVkS2V5c30pIFZBTFVFUyAoJHtwbGFjZWhvbGRlcnN9KSBSRVRVUk5JTkcgKmBcbiAgICAgICAgY29uc29sZS5sb2coJ1tEQi1MT0NBTF0gSW5zZXJ0OicsIHNxbClcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcXVlcnkoc3FsLCB2YWx1ZXMpXG4gICAgICAgIHJlc3VsdHMucHVzaChyZXN1bHQucm93c1swXSlcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8gUmV0dXJuIGEgY2hhaW5hYmxlIG9iamVjdCB0aGF0IG1pbWljcyBTdXBhYmFzZSBiZWhhdmlvclxuICAgICAgY29uc3QgaW5zZXJ0UmVzdWx0ID0geyBkYXRhOiByZXN1bHRzLCBlcnJvcjogbnVsbCB9XG4gICAgICByZXR1cm4ge1xuICAgICAgICAuLi5pbnNlcnRSZXN1bHQsXG4gICAgICAgIHNlbGVjdDogKCkgPT4gKHtcbiAgICAgICAgICBzaW5nbGU6ICgpID0+IFByb21pc2UucmVzb2x2ZSh7IGRhdGE6IHJlc3VsdHNbMF0sIGVycm9yOiBudWxsIH0pLFxuICAgICAgICAgIHRoZW46IChyZXNvbHZlKSA9PiByZXNvbHZlKHsgZGF0YTogcmVzdWx0cywgZXJyb3I6IG51bGwgfSlcbiAgICAgICAgfSksXG4gICAgICAgIHRoZW46IChyZXNvbHZlKSA9PiByZXNvbHZlKGluc2VydFJlc3VsdClcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignW0RCLUxPQ0FMXSBJbnNlcnQgZmFpbGVkOicsIGVycm9yLm1lc3NhZ2UpXG4gICAgICBjb25zdCBlcnJvclJlc3VsdCA9IHsgZGF0YTogbnVsbCwgZXJyb3IgfVxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgLi4uZXJyb3JSZXN1bHQsXG4gICAgICAgIHNlbGVjdDogKCkgPT4gKHtcbiAgICAgICAgICBzaW5nbGU6ICgpID0+IFByb21pc2UucmVzb2x2ZShlcnJvclJlc3VsdCksXG4gICAgICAgICAgdGhlbjogKHJlc29sdmUpID0+IHJlc29sdmUoZXJyb3JSZXN1bHQpXG4gICAgICAgIH0pLFxuICAgICAgICB0aGVuOiAocmVzb2x2ZSkgPT4gcmVzb2x2ZShlcnJvclJlc3VsdClcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvLyBTdG9yZSB1cGRhdGUgZGF0YSBmb3IgbGF0ZXIgZXhlY3V0aW9uXG4gIHVwZGF0ZShkYXRhKSB7XG4gICAgdGhpcy5fdXBkYXRlRGF0YSA9IGRhdGFcbiAgICB0aGlzLl9vcGVyYXRpb24gPSAndXBkYXRlJ1xuICAgIHJldHVybiB0aGlzXG4gIH1cblxuICAvLyBFeGVjdXRlIFVQREFURSBxdWVyeVxuICBhc3luYyBfZXhlY3V0ZVVwZGF0ZSgpIHtcbiAgICB0cnkge1xuICAgICAgY29uc3Qga2V5cyA9IE9iamVjdC5rZXlzKHRoaXMuX3VwZGF0ZURhdGEpXG4gICAgICBjb25zdCB2YWx1ZXMgPSBPYmplY3QudmFsdWVzKHRoaXMuX3VwZGF0ZURhdGEpXG4gICAgICBjb25zdCBzZXRDbGF1c2UgPSBrZXlzLm1hcCgoaywgaSkgPT4gYFwiJHtrfVwiID0gJCR7aSArIDF9YCkuam9pbignLCAnKVxuICAgICAgXG4gICAgICBsZXQgc3FsID0gYFVQREFURSBcIiR7dGhpcy50YWJsZX1cIiBTRVQgJHtzZXRDbGF1c2V9YFxuICAgICAgY29uc3QgcGFyYW1zID0gWy4uLnZhbHVlc11cbiAgICAgIFxuICAgICAgaWYgKHRoaXMuX3doZXJlLmxlbmd0aCA+IDApIHtcbiAgICAgICAgLy8gQWRqdXN0IHBhcmFtZXRlciBpbmRpY2VzIGZvciB3aGVyZSBjbGF1c2VcbiAgICAgICAgY29uc3Qgd2hlcmVXaXRoT2Zmc2V0ID0gdGhpcy5fd2hlcmUubWFwKHcgPT4ge1xuICAgICAgICAgIHJldHVybiB3LnJlcGxhY2UoL1xcJChcXGQrKS9nLCAobWF0Y2gsIG51bSkgPT4gYCQke3BhcnNlSW50KG51bSkgKyB2YWx1ZXMubGVuZ3RofWApXG4gICAgICAgIH0pXG4gICAgICAgIHNxbCArPSBgIFdIRVJFICR7d2hlcmVXaXRoT2Zmc2V0LmpvaW4oJyBBTkQgJyl9YFxuICAgICAgICBwYXJhbXMucHVzaCguLi50aGlzLl93aGVyZVBhcmFtcylcbiAgICAgIH1cbiAgICAgIFxuICAgICAgc3FsICs9ICcgUkVUVVJOSU5HIConXG4gICAgICBjb25zb2xlLmxvZygnW0RCLUxPQ0FMXSBVcGRhdGU6Jywgc3FsLCAncGFyYW1zOicsIHBhcmFtcylcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHF1ZXJ5KHNxbCwgcGFyYW1zKVxuICAgICAgXG4gICAgICByZXR1cm4geyBkYXRhOiByZXN1bHQucm93cywgZXJyb3I6IG51bGwgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdbREItTE9DQUxdIFVwZGF0ZSBmYWlsZWQ6JywgZXJyb3IubWVzc2FnZSlcbiAgICAgIHJldHVybiB7IGRhdGE6IG51bGwsIGVycm9yIH1cbiAgICB9XG4gIH1cblxuICAvLyBFeGVjdXRlIERFTEVURSBxdWVyeVxuICBhc3luYyBfZXhlY3V0ZURlbGV0ZSgpIHtcbiAgICB0cnkge1xuICAgICAgbGV0IHNxbCA9IGBERUxFVEUgRlJPTSBcIiR7dGhpcy50YWJsZX1cImBcbiAgICAgIFxuICAgICAgaWYgKHRoaXMuX3doZXJlLmxlbmd0aCA+IDApIHtcbiAgICAgICAgc3FsICs9IGAgV0hFUkUgJHt0aGlzLl93aGVyZS5qb2luKCcgQU5EICcpfWBcbiAgICAgIH1cbiAgICAgIFxuICAgICAgc3FsICs9ICcgUkVUVVJOSU5HIConXG4gICAgICBjb25zb2xlLmxvZygnW0RCLUxPQ0FMXSBEZWxldGU6Jywgc3FsKVxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcXVlcnkoc3FsLCB0aGlzLl93aGVyZVBhcmFtcylcbiAgICAgIFxuICAgICAgcmV0dXJuIHsgZGF0YTogcmVzdWx0LnJvd3MsIGVycm9yOiBudWxsIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignW0RCLUxPQ0FMXSBEZWxldGUgZmFpbGVkOicsIGVycm9yLm1lc3NhZ2UpXG4gICAgICByZXR1cm4geyBkYXRhOiBudWxsLCBlcnJvciB9XG4gICAgfVxuICB9XG5cbiAgLy8gTWFyayBhcyBkZWxldGUgb3BlcmF0aW9uXG4gIGRlbGV0ZSgpIHtcbiAgICB0aGlzLl9vcGVyYXRpb24gPSAnZGVsZXRlJ1xuICAgIHJldHVybiB0aGlzXG4gIH1cblxuICAvLyBFeGVjdXRlIFNFTEVDVCBxdWVyeSAoYW5kIFVQREFURS9ERUxFVEUgaWYgZmxhZ2dlZClcbiAgYXN5bmMgdGhlbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICB0cnkge1xuICAgICAgLy8gSGFuZGxlIHVwZGF0ZSBvcGVyYXRpb25cbiAgICAgIGlmICh0aGlzLl9vcGVyYXRpb24gPT09ICd1cGRhdGUnKSB7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuX2V4ZWN1dGVVcGRhdGUoKVxuICAgICAgICByZXNvbHZlKHJlc3VsdClcbiAgICAgICAgcmV0dXJuXG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIEhhbmRsZSBkZWxldGUgb3BlcmF0aW9uXG4gICAgICBpZiAodGhpcy5fb3BlcmF0aW9uID09PSAnZGVsZXRlJykge1xuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLl9leGVjdXRlRGVsZXRlKClcbiAgICAgICAgcmVzb2x2ZShyZXN1bHQpXG4gICAgICAgIHJldHVyblxuICAgICAgfVxuICAgICAgXG4gICAgICAvLyBEZWZhdWx0OiBTRUxFQ1RcbiAgICAgIGxldCBzcWwgPSBgU0VMRUNUICR7dGhpcy5fc2VsZWN0fSBGUk9NIFwiJHt0aGlzLnRhYmxlfVwiYFxuICAgICAgXG4gICAgICBpZiAodGhpcy5fd2hlcmUubGVuZ3RoID4gMCkge1xuICAgICAgICBzcWwgKz0gYCBXSEVSRSAke3RoaXMuX3doZXJlLmpvaW4oJyBBTkQgJyl9YFxuICAgICAgfVxuICAgICAgXG4gICAgICBpZiAodGhpcy5fb3JkZXIpIHtcbiAgICAgICAgc3FsICs9IGAgT1JERVIgQlkgJHt0aGlzLl9vcmRlcn1gXG4gICAgICB9XG4gICAgICBcbiAgICAgIGlmICh0aGlzLl9saW1pdCkge1xuICAgICAgICBzcWwgKz0gYCBMSU1JVCAke3RoaXMuX2xpbWl0fWBcbiAgICAgIH1cblxuICAgICAgY29uc29sZS5sb2coJ1tEQi1MT0NBTF0gRXhlY3V0aW5nOicsIHNxbCwgJ3dpdGggcGFyYW1zOicsIHRoaXMuX3doZXJlUGFyYW1zKVxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcXVlcnkoc3FsLCB0aGlzLl93aGVyZVBhcmFtcylcbiAgICAgIFxuICAgICAgaWYgKHRoaXMuX3NpbmdsZSkge1xuICAgICAgICByZXNvbHZlKHsgZGF0YTogcmVzdWx0LnJvd3NbMF0gfHwgbnVsbCwgZXJyb3I6IG51bGwgfSlcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlc29sdmUoeyBkYXRhOiByZXN1bHQucm93cywgZXJyb3I6IG51bGwgfSlcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignW0RCLUxPQ0FMXSBRdWVyeSBmYWlsZWQ6JywgZXJyb3IubWVzc2FnZSlcbiAgICAgIGlmIChyZWplY3QpIHtcbiAgICAgICAgcmVqZWN0KGVycm9yKVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmVzb2x2ZSh7IGRhdGE6IG51bGwsIGVycm9yIH0pXG4gICAgICB9XG4gICAgfVxuICB9XG5cbn1cblxuZXhwb3J0IGRlZmF1bHQgeyBxdWVyeSwgZ2V0UG9vbCwgY3JlYXRlTG9jYWxDbGllbnQgfSJdLCJuYW1lcyI6WyJQb29sIiwicG9vbCIsImdldFBvb2wiLCJjb25uZWN0aW9uU3RyaW5nIiwicHJvY2VzcyIsImVudiIsIkRBVEFCQVNFX1VSTCIsImNvbnNvbGUiLCJsb2ciLCJyZXBsYWNlIiwib24iLCJlcnIiLCJlcnJvciIsIm1lc3NhZ2UiLCJxdWVyeSIsInRleHQiLCJwYXJhbXMiLCJyZXN1bHQiLCJjcmVhdGVMb2NhbENsaWVudCIsImZyb20iLCJ0YWJsZSIsIlF1ZXJ5QnVpbGRlciIsImF1dGgiLCJnZXRVc2VyIiwiZGF0YSIsInVzZXIiLCJpZCIsImVtYWlsIiwiZ2V0U2Vzc2lvbiIsInNlc3Npb24iLCJzaWduT3V0Iiwib25BdXRoU3RhdGVDaGFuZ2UiLCJzdWJzY3JpcHRpb24iLCJ1bnN1YnNjcmliZSIsImNvbnN0cnVjdG9yIiwiX3NlbGVjdCIsIl93aGVyZSIsIl93aGVyZVBhcmFtcyIsIl9vcmRlciIsIl9zaW5nbGUiLCJfbGltaXQiLCJfcmV0dXJuRGF0YSIsIl9vcGVyYXRpb24iLCJfdXBkYXRlRGF0YSIsInNlbGVjdCIsImNvbHVtbnMiLCJpbmNsdWRlcyIsInNwbGl0IiwiZmlsdGVyIiwiYyIsIm1hcCIsInRyaW0iLCJqb2luIiwiZXEiLCJjb2x1bW4iLCJ2YWx1ZSIsInB1c2giLCJsZW5ndGgiLCJuZXEiLCJpbiIsInZhbHVlcyIsInBsYWNlaG9sZGVycyIsIl8iLCJpIiwib3JkZXIiLCJhc2NlbmRpbmciLCJsaW1pdCIsImNvdW50Iiwic2luZ2xlIiwidGhlbiIsInJlc29sdmUiLCJyZWplY3QiLCJzcWwiLCJyb3dzIiwiaW5zZXJ0IiwicmVjb3JkcyIsIkFycmF5IiwiaXNBcnJheSIsInJlc3VsdHMiLCJyZWNvcmQiLCJrZXlzIiwiT2JqZWN0IiwicXVvdGVkS2V5cyIsImsiLCJpbnNlcnRSZXN1bHQiLCJQcm9taXNlIiwiZXJyb3JSZXN1bHQiLCJ1cGRhdGUiLCJfZXhlY3V0ZVVwZGF0ZSIsInNldENsYXVzZSIsIndoZXJlV2l0aE9mZnNldCIsInciLCJtYXRjaCIsIm51bSIsInBhcnNlSW50IiwiX2V4ZWN1dGVEZWxldGUiLCJkZWxldGUiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/db-local.js\n");

/***/ }),

/***/ "(rsc)/./lib/entitlements.js":
/*!*****************************!*\
  !*** ./lib/entitlements.js ***!
  \*****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   getBoxesWithVisibility: () => (/* binding */ getBoxesWithVisibility),\n/* harmony export */   getUserEntitledBoxIds: () => (/* binding */ getUserEntitledBoxIds),\n/* harmony export */   userHasBoxAccess: () => (/* binding */ userHasBoxAccess)\n/* harmony export */ });\n/* harmony import */ var _supabase_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./supabase-server */ \"(rsc)/./lib/supabase-server.js\");\n// Entitlements Helper - Single source of truth for user access\n// Determines which boxes a user can access based on their purchases and memberships\n\n/**\n * Get all box IDs that a user is entitled to access\n * @param {string|null} userId - The user's ID (null for unauthenticated users)\n * @returns {Promise<{boxIds: string[], hasMembership: boolean, membershipExpiry: Date|null}>}\n */ async function getUserEntitledBoxIds(userId) {\n    const supabase = (0,_supabase_server__WEBPACK_IMPORTED_MODULE_0__.createSupabaseServer)();\n    const entitledBoxIds = new Set();\n    let hasMembership = false;\n    let membershipExpiry = null;\n    // Sample boxes are always accessible to everyone\n    const { data: sampleBoxes } = await supabase.from(\"boxes\").select(\"id\").eq(\"is_sample\", true).eq(\"is_active\", true);\n    if (sampleBoxes) {\n        sampleBoxes.forEach((box)=>entitledBoxIds.add(box.id));\n    }\n    // If no user, only sample boxes are accessible\n    if (!userId) {\n        return {\n            boxIds: Array.from(entitledBoxIds),\n            hasMembership: false,\n            membershipExpiry: null\n        };\n    }\n    // Check user_products for direct box purchases\n    const { data: userProducts } = await supabase.from(\"user_products\").select(\"box_id, expires_at\").eq(\"user_id\", userId).eq(\"is_active\", true);\n    if (userProducts) {\n        const now = new Date();\n        userProducts.forEach((product)=>{\n            // Check if not expired (null expires_at means permanent access)\n            if (!product.expires_at || new Date(product.expires_at) > now) {\n                if (product.box_id) {\n                    entitledBoxIds.add(product.box_id);\n                }\n            }\n        });\n    }\n    // Check user_memberships for bundle/membership access\n    const { data: userMemberships } = await supabase.from(\"user_memberships\").select(\"bundle_id, price_id, expires_at\").eq(\"user_id\", userId).eq(\"is_active\", true);\n    if (userMemberships) {\n        const now = new Date();\n        for (const membership of userMemberships){\n            // Check if not expired\n            if (membership.expires_at && new Date(membership.expires_at) > now) {\n                hasMembership = true;\n                // Track the latest expiry\n                const expiryDate = new Date(membership.expires_at);\n                if (!membershipExpiry || expiryDate > membershipExpiry) {\n                    membershipExpiry = expiryDate;\n                }\n                // Get boxes from bundle\n                if (membership.bundle_id) {\n                    const { data: bundle } = await supabase.from(\"bundles\").select(\"box_ids\").eq(\"id\", membership.bundle_id).single();\n                    if (bundle?.box_ids) {\n                        bundle.box_ids.forEach((boxId)=>entitledBoxIds.add(boxId));\n                    }\n                }\n                // If membership has a price with all-access, add all active boxes\n                if (membership.price_id) {\n                    const { data: price } = await supabase.from(\"prices\").select(\"membership_days\").eq(\"id\", membership.price_id).single();\n                    // If it's a membership price, it grants all-access\n                    if (price?.membership_days) {\n                        const { data: allBoxes } = await supabase.from(\"boxes\").select(\"id\").eq(\"is_active\", true);\n                        if (allBoxes) {\n                            allBoxes.forEach((box)=>entitledBoxIds.add(box.id));\n                        }\n                    }\n                }\n            }\n        }\n    }\n    return {\n        boxIds: Array.from(entitledBoxIds),\n        hasMembership,\n        membershipExpiry\n    };\n}\n/**\n * Check if a user has access to a specific box\n * @param {string|null} userId - The user's ID\n * @param {string} boxId - The box ID to check\n * @returns {Promise<boolean>}\n */ async function userHasBoxAccess(userId, boxId) {\n    const { boxIds } = await getUserEntitledBoxIds(userId);\n    return boxIds.includes(boxId);\n}\n/**\n * Get boxes with visibility rules applied\n * Hide sample boxes if user owns the related full box (via full_box_id)\n * @param {string|null} userId - The user's ID\n * @returns {Promise<{boxes: any[], entitledBoxIds: string[], hasMembership: boolean}>}\n */ async function getBoxesWithVisibility(userId) {\n    const supabase = (0,_supabase_server__WEBPACK_IMPORTED_MODULE_0__.createSupabaseServer)();\n    // Get user entitlements\n    const { boxIds: entitledBoxIds, hasMembership, membershipExpiry } = await getUserEntitledBoxIds(userId);\n    // Get all active boxes\n    const { data: boxes } = await supabase.from(\"boxes\").select(\"*\").eq(\"is_active\", true).order(\"display_order\", {\n        ascending: true\n    });\n    if (!boxes) {\n        return {\n            boxes: [],\n            entitledBoxIds,\n            hasMembership,\n            membershipExpiry\n        };\n    }\n    // Build a set of full box IDs that user owns\n    const ownedFullBoxIds = new Set();\n    boxes.forEach((box)=>{\n        if (!box.is_sample && entitledBoxIds.includes(box.id)) {\n            ownedFullBoxIds.add(box.id);\n        }\n    });\n    // Filter boxes based on visibility rules:\n    // Hide sample box if user owns its related full box (full_box_id)\n    const visibleBoxes = boxes.filter((box)=>{\n        // Non-sample boxes are always visible\n        if (!box.is_sample) return true;\n        // Sample boxes: hide if user owns the related full box\n        if (box.full_box_id && ownedFullBoxIds.has(box.full_box_id)) {\n            return false;\n        }\n        return true;\n    });\n    // Mark boxes with access info\n    const boxesWithAccess = visibleBoxes.map((box)=>({\n            ...box,\n            hasAccess: entitledBoxIds.includes(box.id)\n        }));\n    return {\n        boxes: boxesWithAccess,\n        entitledBoxIds,\n        hasMembership,\n        membershipExpiry\n    };\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({\n    getUserEntitledBoxIds,\n    userHasBoxAccess,\n    getBoxesWithVisibility\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QyxDQUFBQTtRQUNaLElBQUksQ0FBQ0EsSUFBSThCLFNBQVMsSUFBSXhDLGVBQWVrQyxRQUFRLENBQUN4QixJQUFJRSxFQUFFLEdBQUc7WUFDckQyQixnQkFBZ0I1QixHQUFHLENBQUNELElBQUlFLEVBQUU7UUFDNUI7SUFDRjtJQUVBLDBDQUEwQztJQUMxQyxrRUFBa0U7SUFDbEUsTUFBTTZCLGVBQWVMLE1BQU1NLE1BQU0sQ0FBQ2hDLENBQUFBO1FBQ2hDLHNDQUFzQztRQUN0QyxJQUFJLENBQUNBLElBQUk4QixTQUFTLEVBQUUsT0FBTztRQUUzQix1REFBdUQ7UUFDdkQsSUFBSTlCLElBQUlpQyxXQUFXLElBQUlKLGdCQUFnQkssR0FBRyxDQUFDbEMsSUFBSWlDLFdBQVcsR0FBRztZQUMzRCxPQUFPO1FBQ1Q7UUFFQSxPQUFPO0lBQ1Q7SUFFQSw4QkFBOEI7SUFDOUIsTUFBTUUsa0JBQWtCSixhQUFhSyxHQUFHLENBQUNwQyxDQUFBQSxNQUFRO1lBQy9DLEdBQUdBLEdBQUc7WUFDTnFDLFdBQVcvQyxlQUFla0MsUUFBUSxDQUFDeEIsSUFBSUUsRUFBRTtRQUMzQztJQUVBLE9BQU87UUFDTHdCLE9BQU9TO1FBQ1A3QztRQUNBRTtRQUNBQztJQUNGO0FBQ0Y7QUFFQSxpRUFBZTtJQUNiTjtJQUNBb0M7SUFDQUU7QUFDRixDQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYXN3ZWFsbGFyZS1hZG1pbi8uL2xpYi9lbnRpdGxlbWVudHMuanM/YzJmMiJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBFbnRpdGxlbWVudHMgSGVscGVyIC0gU2luZ2xlIHNvdXJjZSBvZiB0cnV0aCBmb3IgdXNlciBhY2Nlc3Ncbi8vIERldGVybWluZXMgd2hpY2ggYm94ZXMgYSB1c2VyIGNhbiBhY2Nlc3MgYmFzZWQgb24gdGhlaXIgcHVyY2hhc2VzIGFuZCBtZW1iZXJzaGlwc1xuXG5pbXBvcnQgeyBjcmVhdGVTdXBhYmFzZVNlcnZlciB9IGZyb20gJy4vc3VwYWJhc2Utc2VydmVyJ1xuXG4vKipcbiAqIEdldCBhbGwgYm94IElEcyB0aGF0IGEgdXNlciBpcyBlbnRpdGxlZCB0byBhY2Nlc3NcbiAqIEBwYXJhbSB7c3RyaW5nfG51bGx9IHVzZXJJZCAtIFRoZSB1c2VyJ3MgSUQgKG51bGwgZm9yIHVuYXV0aGVudGljYXRlZCB1c2VycylcbiAqIEByZXR1cm5zIHtQcm9taXNlPHtib3hJZHM6IHN0cmluZ1tdLCBoYXNNZW1iZXJzaGlwOiBib29sZWFuLCBtZW1iZXJzaGlwRXhwaXJ5OiBEYXRlfG51bGx9Pn1cbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFVzZXJFbnRpdGxlZEJveElkcyh1c2VySWQpIHtcbiAgY29uc3Qgc3VwYWJhc2UgPSBjcmVhdGVTdXBhYmFzZVNlcnZlcigpXG4gIGNvbnN0IGVudGl0bGVkQm94SWRzID0gbmV3IFNldCgpXG4gIGxldCBoYXNNZW1iZXJzaGlwID0gZmFsc2VcbiAgbGV0IG1lbWJlcnNoaXBFeHBpcnkgPSBudWxsXG4gIFxuICAvLyBTYW1wbGUgYm94ZXMgYXJlIGFsd2F5cyBhY2Nlc3NpYmxlIHRvIGV2ZXJ5b25lXG4gIGNvbnN0IHsgZGF0YTogc2FtcGxlQm94ZXMgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgLmZyb20oJ2JveGVzJylcbiAgICAuc2VsZWN0KCdpZCcpXG4gICAgLmVxKCdpc19zYW1wbGUnLCB0cnVlKVxuICAgIC5lcSgnaXNfYWN0aXZlJywgdHJ1ZSlcbiAgXG4gIGlmIChzYW1wbGVCb3hlcykge1xuICAgIHNhbXBsZUJveGVzLmZvckVhY2goYm94ID0+IGVudGl0bGVkQm94SWRzLmFkZChib3guaWQpKVxuICB9XG4gIFxuICAvLyBJZiBubyB1c2VyLCBvbmx5IHNhbXBsZSBib3hlcyBhcmUgYWNjZXNzaWJsZVxuICBpZiAoIXVzZXJJZCkge1xuICAgIHJldHVybiB7XG4gICAgICBib3hJZHM6IEFycmF5LmZyb20oZW50aXRsZWRCb3hJZHMpLFxuICAgICAgaGFzTWVtYmVyc2hpcDogZmFsc2UsXG4gICAgICBtZW1iZXJzaGlwRXhwaXJ5OiBudWxsXG4gICAgfVxuICB9XG4gIFxuICAvLyBDaGVjayB1c2VyX3Byb2R1Y3RzIGZvciBkaXJlY3QgYm94IHB1cmNoYXNlc1xuICBjb25zdCB7IGRhdGE6IHVzZXJQcm9kdWN0cyB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAuZnJvbSgndXNlcl9wcm9kdWN0cycpXG4gICAgLnNlbGVjdCgnYm94X2lkLCBleHBpcmVzX2F0JylcbiAgICAuZXEoJ3VzZXJfaWQnLCB1c2VySWQpXG4gICAgLmVxKCdpc19hY3RpdmUnLCB0cnVlKVxuICBcbiAgaWYgKHVzZXJQcm9kdWN0cykge1xuICAgIGNvbnN0IG5vdyA9IG5ldyBEYXRlKClcbiAgICB1c2VyUHJvZHVjdHMuZm9yRWFjaChwcm9kdWN0ID0+IHtcbiAgICAgIC8vIENoZWNrIGlmIG5vdCBleHBpcmVkIChudWxsIGV4cGlyZXNfYXQgbWVhbnMgcGVybWFuZW50IGFjY2VzcylcbiAgICAgIGlmICghcHJvZHVjdC5leHBpcmVzX2F0IHx8IG5ldyBEYXRlKHByb2R1Y3QuZXhwaXJlc19hdCkgPiBub3cpIHtcbiAgICAgICAgaWYgKHByb2R1Y3QuYm94X2lkKSB7XG4gICAgICAgICAgZW50aXRsZWRCb3hJZHMuYWRkKHByb2R1Y3QuYm94X2lkKVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSlcbiAgfVxuICBcbiAgLy8gQ2hlY2sgdXNlcl9tZW1iZXJzaGlwcyBmb3IgYnVuZGxlL21lbWJlcnNoaXAgYWNjZXNzXG4gIGNvbnN0IHsgZGF0YTogdXNlck1lbWJlcnNoaXBzIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgIC5mcm9tKCd1c2VyX21lbWJlcnNoaXBzJylcbiAgICAuc2VsZWN0KCdidW5kbGVfaWQsIHByaWNlX2lkLCBleHBpcmVzX2F0JylcbiAgICAuZXEoJ3VzZXJfaWQnLCB1c2VySWQpXG4gICAgLmVxKCdpc19hY3RpdmUnLCB0cnVlKVxuICBcbiAgaWYgKHVzZXJNZW1iZXJzaGlwcykge1xuICAgIGNvbnN0IG5vdyA9IG5ldyBEYXRlKClcbiAgICBcbiAgICBmb3IgKGNvbnN0IG1lbWJlcnNoaXAgb2YgdXNlck1lbWJlcnNoaXBzKSB7XG4gICAgICAvLyBDaGVjayBpZiBub3QgZXhwaXJlZFxuICAgICAgaWYgKG1lbWJlcnNoaXAuZXhwaXJlc19hdCAmJiBuZXcgRGF0ZShtZW1iZXJzaGlwLmV4cGlyZXNfYXQpID4gbm93KSB7XG4gICAgICAgIGhhc01lbWJlcnNoaXAgPSB0cnVlXG4gICAgICAgIFxuICAgICAgICAvLyBUcmFjayB0aGUgbGF0ZXN0IGV4cGlyeVxuICAgICAgICBjb25zdCBleHBpcnlEYXRlID0gbmV3IERhdGUobWVtYmVyc2hpcC5leHBpcmVzX2F0KVxuICAgICAgICBpZiAoIW1lbWJlcnNoaXBFeHBpcnkgfHwgZXhwaXJ5RGF0ZSA+IG1lbWJlcnNoaXBFeHBpcnkpIHtcbiAgICAgICAgICBtZW1iZXJzaGlwRXhwaXJ5ID0gZXhwaXJ5RGF0ZVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBHZXQgYm94ZXMgZnJvbSBidW5kbGVcbiAgICAgICAgaWYgKG1lbWJlcnNoaXAuYnVuZGxlX2lkKSB7XG4gICAgICAgICAgY29uc3QgeyBkYXRhOiBidW5kbGUgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgICAgICAuZnJvbSgnYnVuZGxlcycpXG4gICAgICAgICAgICAuc2VsZWN0KCdib3hfaWRzJylcbiAgICAgICAgICAgIC5lcSgnaWQnLCBtZW1iZXJzaGlwLmJ1bmRsZV9pZClcbiAgICAgICAgICAgIC5zaW5nbGUoKVxuICAgICAgICAgIFxuICAgICAgICAgIGlmIChidW5kbGU/LmJveF9pZHMpIHtcbiAgICAgICAgICAgIGJ1bmRsZS5ib3hfaWRzLmZvckVhY2goYm94SWQgPT4gZW50aXRsZWRCb3hJZHMuYWRkKGJveElkKSlcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIElmIG1lbWJlcnNoaXAgaGFzIGEgcHJpY2Ugd2l0aCBhbGwtYWNjZXNzLCBhZGQgYWxsIGFjdGl2ZSBib3hlc1xuICAgICAgICBpZiAobWVtYmVyc2hpcC5wcmljZV9pZCkge1xuICAgICAgICAgIGNvbnN0IHsgZGF0YTogcHJpY2UgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgICAgICAuZnJvbSgncHJpY2VzJylcbiAgICAgICAgICAgIC5zZWxlY3QoJ21lbWJlcnNoaXBfZGF5cycpXG4gICAgICAgICAgICAuZXEoJ2lkJywgbWVtYmVyc2hpcC5wcmljZV9pZClcbiAgICAgICAgICAgIC5zaW5nbGUoKVxuICAgICAgICAgIFxuICAgICAgICAgIC8vIElmIGl0J3MgYSBtZW1iZXJzaGlwIHByaWNlLCBpdCBncmFudHMgYWxsLWFjY2Vzc1xuICAgICAgICAgIGlmIChwcmljZT8ubWVtYmVyc2hpcF9kYXlzKSB7XG4gICAgICAgICAgICBjb25zdCB7IGRhdGE6IGFsbEJveGVzIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAgICAgICAuZnJvbSgnYm94ZXMnKVxuICAgICAgICAgICAgICAuc2VsZWN0KCdpZCcpXG4gICAgICAgICAgICAgIC5lcSgnaXNfYWN0aXZlJywgdHJ1ZSlcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKGFsbEJveGVzKSB7XG4gICAgICAgICAgICAgIGFsbEJveGVzLmZvckVhY2goYm94ID0+IGVudGl0bGVkQm94SWRzLmFkZChib3guaWQpKVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxuICBcbiAgcmV0dXJuIHtcbiAgICBib3hJZHM6IEFycmF5LmZyb20oZW50aXRsZWRCb3hJZHMpLFxuICAgIGhhc01lbWJlcnNoaXAsXG4gICAgbWVtYmVyc2hpcEV4cGlyeVxuICB9XG59XG5cbi8qKlxuICogQ2hlY2sgaWYgYSB1c2VyIGhhcyBhY2Nlc3MgdG8gYSBzcGVjaWZpYyBib3hcbiAqIEBwYXJhbSB7c3RyaW5nfG51bGx9IHVzZXJJZCAtIFRoZSB1c2VyJ3MgSURcbiAqIEBwYXJhbSB7c3RyaW5nfSBib3hJZCAtIFRoZSBib3ggSUQgdG8gY2hlY2tcbiAqIEByZXR1cm5zIHtQcm9taXNlPGJvb2xlYW4+fVxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXNlckhhc0JveEFjY2Vzcyh1c2VySWQsIGJveElkKSB7XG4gIGNvbnN0IHsgYm94SWRzIH0gPSBhd2FpdCBnZXRVc2VyRW50aXRsZWRCb3hJZHModXNlcklkKVxuICByZXR1cm4gYm94SWRzLmluY2x1ZGVzKGJveElkKVxufVxuXG4vKipcbiAqIEdldCBib3hlcyB3aXRoIHZpc2liaWxpdHkgcnVsZXMgYXBwbGllZFxuICogSGlkZSBzYW1wbGUgYm94ZXMgaWYgdXNlciBvd25zIHRoZSByZWxhdGVkIGZ1bGwgYm94ICh2aWEgZnVsbF9ib3hfaWQpXG4gKiBAcGFyYW0ge3N0cmluZ3xudWxsfSB1c2VySWQgLSBUaGUgdXNlcidzIElEXG4gKiBAcmV0dXJucyB7UHJvbWlzZTx7Ym94ZXM6IGFueVtdLCBlbnRpdGxlZEJveElkczogc3RyaW5nW10sIGhhc01lbWJlcnNoaXA6IGJvb2xlYW59Pn1cbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEJveGVzV2l0aFZpc2liaWxpdHkodXNlcklkKSB7XG4gIGNvbnN0IHN1cGFiYXNlID0gY3JlYXRlU3VwYWJhc2VTZXJ2ZXIoKVxuICBcbiAgLy8gR2V0IHVzZXIgZW50aXRsZW1lbnRzXG4gIGNvbnN0IHsgYm94SWRzOiBlbnRpdGxlZEJveElkcywgaGFzTWVtYmVyc2hpcCwgbWVtYmVyc2hpcEV4cGlyeSB9ID0gYXdhaXQgZ2V0VXNlckVudGl0bGVkQm94SWRzKHVzZXJJZClcbiAgXG4gIC8vIEdldCBhbGwgYWN0aXZlIGJveGVzXG4gIGNvbnN0IHsgZGF0YTogYm94ZXMgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgLmZyb20oJ2JveGVzJylcbiAgICAuc2VsZWN0KCcqJylcbiAgICAuZXEoJ2lzX2FjdGl2ZScsIHRydWUpXG4gICAgLm9yZGVyKCdkaXNwbGF5X29yZGVyJywgeyBhc2NlbmRpbmc6IHRydWUgfSlcbiAgXG4gIGlmICghYm94ZXMpIHtcbiAgICByZXR1cm4geyBib3hlczogW10sIGVudGl0bGVkQm94SWRzLCBoYXNNZW1iZXJzaGlwLCBtZW1iZXJzaGlwRXhwaXJ5IH1cbiAgfVxuICBcbiAgLy8gQnVpbGQgYSBzZXQgb2YgZnVsbCBib3ggSURzIHRoYXQgdXNlciBvd25zXG4gIGNvbnN0IG93bmVkRnVsbEJveElkcyA9IG5ldyBTZXQoKVxuICBib3hlcy5mb3JFYWNoKGJveCA9PiB7XG4gICAgaWYgKCFib3guaXNfc2FtcGxlICYmIGVudGl0bGVkQm94SWRzLmluY2x1ZGVzKGJveC5pZCkpIHtcbiAgICAgIG93bmVkRnVsbEJveElkcy5hZGQoYm94LmlkKVxuICAgIH1cbiAgfSlcbiAgXG4gIC8vIEZpbHRlciBib3hlcyBiYXNlZCBvbiB2aXNpYmlsaXR5IHJ1bGVzOlxuICAvLyBIaWRlIHNhbXBsZSBib3ggaWYgdXNlciBvd25zIGl0cyByZWxhdGVkIGZ1bGwgYm94IChmdWxsX2JveF9pZClcbiAgY29uc3QgdmlzaWJsZUJveGVzID0gYm94ZXMuZmlsdGVyKGJveCA9PiB7XG4gICAgLy8gTm9uLXNhbXBsZSBib3hlcyBhcmUgYWx3YXlzIHZpc2libGVcbiAgICBpZiAoIWJveC5pc19zYW1wbGUpIHJldHVybiB0cnVlXG4gICAgXG4gICAgLy8gU2FtcGxlIGJveGVzOiBoaWRlIGlmIHVzZXIgb3ducyB0aGUgcmVsYXRlZCBmdWxsIGJveFxuICAgIGlmIChib3guZnVsbF9ib3hfaWQgJiYgb3duZWRGdWxsQm94SWRzLmhhcyhib3guZnVsbF9ib3hfaWQpKSB7XG4gICAgICByZXR1cm4gZmFsc2VcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIHRydWVcbiAgfSlcbiAgXG4gIC8vIE1hcmsgYm94ZXMgd2l0aCBhY2Nlc3MgaW5mb1xuICBjb25zdCBib3hlc1dpdGhBY2Nlc3MgPSB2aXNpYmxlQm94ZXMubWFwKGJveCA9PiAoe1xuICAgIC4uLmJveCxcbiAgICBoYXNBY2Nlc3M6IGVudGl0bGVkQm94SWRzLmluY2x1ZGVzKGJveC5pZClcbiAgfSkpXG4gIFxuICByZXR1cm4ge1xuICAgIGJveGVzOiBib3hlc1dpdGhBY2Nlc3MsXG4gICAgZW50aXRsZWRCb3hJZHMsXG4gICAgaGFzTWVtYmVyc2hpcCxcbiAgICBtZW1iZXJzaGlwRXhwaXJ5XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQge1xuICBnZXRVc2VyRW50aXRsZWRCb3hJZHMsXG4gIHVzZXJIYXNCb3hBY2Nlc3MsXG4gIGdldEJveGVzV2l0aFZpc2liaWxpdHlcbn1cbiJdLCJuYW1lcyI6WyJjcmVhdGVTdXBhYmFzZVNlcnZlciIsImdldFVzZXJFbnRpdGxlZEJveElkcyIsInVzZXJJZCIsInN1cGFiYXNlIiwiZW50aXRsZWRCb3hJZHMiLCJTZXQiLCJoYXNNZW1iZXJzaGlwIiwibWVtYmVyc2hpcEV4cGlyeSIsImRhdGEiLCJzYW1wbGVCb3hlcyIsImZyb20iLCJzZWxlY3QiLCJlcSIsImZvckVhY2giLCJib3giLCJhZGQiLCJpZCIsImJveElkcyIsIkFycmF5IiwidXNlclByb2R1Y3RzIiwibm93IiwiRGF0ZSIsInByb2R1Y3QiLCJleHBpcmVzX2F0IiwiYm94X2lkIiwidXNlck1lbWJlcnNoaXBzIiwibWVtYmVyc2hpcCIsImV4cGlyeURhdGUiLCJidW5kbGVfaWQiLCJidW5kbGUiLCJzaW5nbGUiLCJib3hfaWRzIiwiYm94SWQiLCJwcmljZV9pZCIsInByaWNlIiwibWVtYmVyc2hpcF9kYXlzIiwiYWxsQm94ZXMiLCJ1c2VySGFzQm94QWNjZXNzIiwiaW5jbHVkZXMiLCJnZXRCb3hlc1dpdGhWaXNpYmlsaXR5IiwiYm94ZXMiLCJvcmRlciIsImFzY2VuZGluZyIsIm93bmVkRnVsbEJveElkcyIsImlzX3NhbXBsZSIsInZpc2libGVCb3hlcyIsImZpbHRlciIsImZ1bGxfYm94X2lkIiwiaGFzIiwiYm94ZXNXaXRoQWNjZXNzIiwibWFwIiwiaGFzQWNjZXNzIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/entitlements.js\n");

/***/ }),

/***/ "(rsc)/./lib/stripe.js":
/*!***********************!*\
  !*** ./lib/stripe.js ***!
  \***********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getStripe: () => (/* binding */ getStripe),\n/* harmony export */   stripe: () => (/* binding */ stripe)\n/* harmony export */ });\n/* harmony import */ var stripe__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! stripe */ \"(rsc)/./node_modules/stripe/esm/stripe.esm.node.js\");\n\n// Lazy initialization to avoid build-time errors\nlet stripeInstance = null;\nfunction getStripe() {\n    if (!stripeInstance) {\n        if (!process.env.STRIPE_SECRET_KEY) {\n            throw new Error(\"STRIPE_SECRET_KEY is not set\");\n        }\n        stripeInstance = new stripe__WEBPACK_IMPORTED_MODULE_0__[\"default\"](process.env.STRIPE_SECRET_KEY, {\n            apiVersion: \"2024-12-18.acacia\"\n        });\n    }\n    return stripeInstance;\n}\n// For backward compatibility - but this will fail at build time if imported directly\n// Use getStripe() instead\nconst stripe = typeof process !== \"undefined\" && process.env.STRIPE_SECRET_KEY ? new stripe__WEBPACK_IMPORTED_MODULE_0__[\"default\"](process.env.STRIPE_SECRET_KEY, {\n    apiVersion: \"2024-12-18.acacia\"\n}) : null;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvc3RyaXBlLmpzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUEyQjtBQUUzQixpREFBaUQ7QUFDakQsSUFBSUMsaUJBQWlCO0FBRWQsU0FBU0M7SUFDZCxJQUFJLENBQUNELGdCQUFnQjtRQUNuQixJQUFJLENBQUNFLFFBQVFDLEdBQUcsQ0FBQ0MsaUJBQWlCLEVBQUU7WUFDbEMsTUFBTSxJQUFJQyxNQUFNO1FBQ2xCO1FBQ0FMLGlCQUFpQixJQUFJRCw4Q0FBTUEsQ0FBQ0csUUFBUUMsR0FBRyxDQUFDQyxpQkFBaUIsRUFBRTtZQUN6REUsWUFBWTtRQUNkO0lBQ0Y7SUFDQSxPQUFPTjtBQUNUO0FBRUEscUZBQXFGO0FBQ3JGLDBCQUEwQjtBQUNuQixNQUFNTyxTQUFTLE9BQU9MLFlBQVksZUFBZUEsUUFBUUMsR0FBRyxDQUFDQyxpQkFBaUIsR0FDakYsSUFBSUwsOENBQU1BLENBQUNHLFFBQVFDLEdBQUcsQ0FBQ0MsaUJBQWlCLEVBQUU7SUFBRUUsWUFBWTtBQUFvQixLQUM1RSxLQUFJIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYXN3ZWFsbGFyZS1hZG1pbi8uL2xpYi9zdHJpcGUuanM/NTA0ZCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgU3RyaXBlIGZyb20gJ3N0cmlwZSdcblxuLy8gTGF6eSBpbml0aWFsaXphdGlvbiB0byBhdm9pZCBidWlsZC10aW1lIGVycm9yc1xubGV0IHN0cmlwZUluc3RhbmNlID0gbnVsbFxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0U3RyaXBlKCkge1xuICBpZiAoIXN0cmlwZUluc3RhbmNlKSB7XG4gICAgaWYgKCFwcm9jZXNzLmVudi5TVFJJUEVfU0VDUkVUX0tFWSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdTVFJJUEVfU0VDUkVUX0tFWSBpcyBub3Qgc2V0JylcbiAgICB9XG4gICAgc3RyaXBlSW5zdGFuY2UgPSBuZXcgU3RyaXBlKHByb2Nlc3MuZW52LlNUUklQRV9TRUNSRVRfS0VZLCB7XG4gICAgICBhcGlWZXJzaW9uOiAnMjAyNC0xMi0xOC5hY2FjaWEnLFxuICAgIH0pXG4gIH1cbiAgcmV0dXJuIHN0cmlwZUluc3RhbmNlXG59XG5cbi8vIEZvciBiYWNrd2FyZCBjb21wYXRpYmlsaXR5IC0gYnV0IHRoaXMgd2lsbCBmYWlsIGF0IGJ1aWxkIHRpbWUgaWYgaW1wb3J0ZWQgZGlyZWN0bHlcbi8vIFVzZSBnZXRTdHJpcGUoKSBpbnN0ZWFkXG5leHBvcnQgY29uc3Qgc3RyaXBlID0gdHlwZW9mIHByb2Nlc3MgIT09ICd1bmRlZmluZWQnICYmIHByb2Nlc3MuZW52LlNUUklQRV9TRUNSRVRfS0VZIFxuICA/IG5ldyBTdHJpcGUocHJvY2Vzcy5lbnYuU1RSSVBFX1NFQ1JFVF9LRVksIHsgYXBpVmVyc2lvbjogJzIwMjQtMTItMTguYWNhY2lhJyB9KVxuICA6IG51bGxcbiJdLCJuYW1lcyI6WyJTdHJpcGUiLCJzdHJpcGVJbnN0YW5jZSIsImdldFN0cmlwZSIsInByb2Nlc3MiLCJlbnYiLCJTVFJJUEVfU0VDUkVUX0tFWSIsIkVycm9yIiwiYXBpVmVyc2lvbiIsInN0cmlwZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/stripe.js\n");

/***/ }),

/***/ "(rsc)/./lib/supabase-server.js":
/*!********************************!*\
  !*** ./lib/supabase-server.js ***!
  \********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createSupabaseServer: () => (/* binding */ createSupabaseServer)\n/* harmony export */ });\n/* harmony import */ var _supabase_ssr__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @supabase/ssr */ \"(rsc)/./node_modules/@supabase/ssr/dist/module/index.js\");\n/* harmony import */ var next_headers__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/headers */ \"(rsc)/./node_modules/next/dist/api/headers.js\");\n/* harmony import */ var _db_local__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./db-local */ \"(rsc)/./lib/db-local.js\");\n\n\n\nfunction createSupabaseServer() {\n    // Check if running in local mode\n    if (process.env.LOCAL_MODE === \"true\") {\n        return (0,_db_local__WEBPACK_IMPORTED_MODULE_2__.createLocalClient)();\n    }\n    const cookieStore = (0,next_headers__WEBPACK_IMPORTED_MODULE_1__.cookies)();\n    return (0,_supabase_ssr__WEBPACK_IMPORTED_MODULE_0__.createServerClient)(\"https://pwdwemakaozxmutwswqa.supabase.co\", \"sb_publishable_K-L2v83yXtTeHkSWtFX_ag_ZbjbDq8p\", {\n        cookies: {\n            getAll () {\n                return cookieStore.getAll();\n            },\n            setAll (cookiesToSet) {\n                try {\n                    cookiesToSet.forEach(({ name, value, options })=>cookieStore.set(name, value, options));\n                } catch  {\n                // Server component, ignore\n                }\n            }\n        }\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvc3VwYWJhc2Utc2VydmVyLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBa0Q7QUFDWjtBQUNRO0FBRXZDLFNBQVNHO0lBQ2QsaUNBQWlDO0lBQ2pDLElBQUlDLFFBQVFDLEdBQUcsQ0FBQ0MsVUFBVSxLQUFLLFFBQVE7UUFDckMsT0FBT0osNERBQWlCQTtJQUMxQjtJQUVBLE1BQU1LLGNBQWNOLHFEQUFPQTtJQUUzQixPQUFPRCxpRUFBa0JBLENBQ3ZCSSwwQ0FBb0MsRUFDcENBLGdEQUF5QyxFQUN6QztRQUNFSCxTQUFTO1lBQ1BTO2dCQUNFLE9BQU9ILFlBQVlHLE1BQU07WUFDM0I7WUFDQUMsUUFBT0MsWUFBWTtnQkFDakIsSUFBSTtvQkFDRkEsYUFBYUMsT0FBTyxDQUFDLENBQUMsRUFBRUMsSUFBSSxFQUFFQyxLQUFLLEVBQUVDLE9BQU8sRUFBRSxHQUM1Q1QsWUFBWVUsR0FBRyxDQUFDSCxNQUFNQyxPQUFPQztnQkFFakMsRUFBRSxPQUFNO2dCQUNOLDJCQUEyQjtnQkFDN0I7WUFDRjtRQUNGO0lBQ0Y7QUFFSiIsInNvdXJjZXMiOlsid2VicGFjazovL2Fzd2VhbGxhcmUtYWRtaW4vLi9saWIvc3VwYWJhc2Utc2VydmVyLmpzP2RiYWMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY3JlYXRlU2VydmVyQ2xpZW50IH0gZnJvbSAnQHN1cGFiYXNlL3NzcidcbmltcG9ydCB7IGNvb2tpZXMgfSBmcm9tICduZXh0L2hlYWRlcnMnXG5pbXBvcnQgeyBjcmVhdGVMb2NhbENsaWVudCB9IGZyb20gJy4vZGItbG9jYWwnXG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVTdXBhYmFzZVNlcnZlcigpIHtcbiAgLy8gQ2hlY2sgaWYgcnVubmluZyBpbiBsb2NhbCBtb2RlXG4gIGlmIChwcm9jZXNzLmVudi5MT0NBTF9NT0RFID09PSAndHJ1ZScpIHtcbiAgICByZXR1cm4gY3JlYXRlTG9jYWxDbGllbnQoKVxuICB9XG5cbiAgY29uc3QgY29va2llU3RvcmUgPSBjb29raWVzKClcbiAgXG4gIHJldHVybiBjcmVhdGVTZXJ2ZXJDbGllbnQoXG4gICAgcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMLFxuICAgIHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX0FOT05fS0VZLFxuICAgIHtcbiAgICAgIGNvb2tpZXM6IHtcbiAgICAgICAgZ2V0QWxsKCkge1xuICAgICAgICAgIHJldHVybiBjb29raWVTdG9yZS5nZXRBbGwoKVxuICAgICAgICB9LFxuICAgICAgICBzZXRBbGwoY29va2llc1RvU2V0KSB7XG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvb2tpZXNUb1NldC5mb3JFYWNoKCh7IG5hbWUsIHZhbHVlLCBvcHRpb25zIH0pID0+XG4gICAgICAgICAgICAgIGNvb2tpZVN0b3JlLnNldChuYW1lLCB2YWx1ZSwgb3B0aW9ucylcbiAgICAgICAgICAgIClcbiAgICAgICAgICB9IGNhdGNoIHtcbiAgICAgICAgICAgIC8vIFNlcnZlciBjb21wb25lbnQsIGlnbm9yZVxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgfVxuICApXG59XG4iXSwibmFtZXMiOlsiY3JlYXRlU2VydmVyQ2xpZW50IiwiY29va2llcyIsImNyZWF0ZUxvY2FsQ2xpZW50IiwiY3JlYXRlU3VwYWJhc2VTZXJ2ZXIiLCJwcm9jZXNzIiwiZW52IiwiTE9DQUxfTU9ERSIsImNvb2tpZVN0b3JlIiwiTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMIiwiTkVYVF9QVUJMSUNfU1VQQUJBU0VfQU5PTl9LRVkiLCJnZXRBbGwiLCJzZXRBbGwiLCJjb29raWVzVG9TZXQiLCJmb3JFYWNoIiwibmFtZSIsInZhbHVlIiwib3B0aW9ucyIsInNldCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/supabase-server.js\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/@supabase","vendor-chunks/next","vendor-chunks/tslib","vendor-chunks/iceberg-js","vendor-chunks/cookie","vendor-chunks/stripe","vendor-chunks/math-intrinsics","vendor-chunks/es-errors","vendor-chunks/uuid","vendor-chunks/qs","vendor-chunks/call-bind-apply-helpers","vendor-chunks/get-proto","vendor-chunks/object-inspect","vendor-chunks/has-symbols","vendor-chunks/gopd","vendor-chunks/function-bind","vendor-chunks/side-channel","vendor-chunks/side-channel-weakmap","vendor-chunks/side-channel-map","vendor-chunks/side-channel-list","vendor-chunks/hasown","vendor-chunks/get-intrinsic","vendor-chunks/es-object-atoms","vendor-chunks/es-define-property","vendor-chunks/dunder-proto","vendor-chunks/call-bound"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2F%5B%5B...path%5D%5D%2Froute&page=%2Fapi%2F%5B%5B...path%5D%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2F%5B%5B...path%5D%5D%2Froute.js&appDir=%2Fapp%2Fapps%2Fadmin%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fapp%2Fapps%2Fadmin&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();