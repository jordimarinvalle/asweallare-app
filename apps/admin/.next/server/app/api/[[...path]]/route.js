"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/[[...path]]/route";
exports.ids = ["app/api/[[...path]]/route"];
exports.modules = {

/***/ "../../client/components/action-async-storage.external":
/*!*******************************************************************************!*\
  !*** external "next/dist/client/components/action-async-storage.external.js" ***!
  \*******************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/action-async-storage.external.js");

/***/ }),

/***/ "../../client/components/request-async-storage.external":
/*!********************************************************************************!*\
  !*** external "next/dist/client/components/request-async-storage.external.js" ***!
  \********************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/request-async-storage.external.js");

/***/ }),

/***/ "../../client/components/static-generation-async-storage.external":
/*!******************************************************************************************!*\
  !*** external "next/dist/client/components/static-generation-async-storage.external.js" ***!
  \******************************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/static-generation-async-storage.external.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "pg":
/*!*********************!*\
  !*** external "pg" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("pg");

/***/ }),

/***/ "buffer":
/*!*************************!*\
  !*** external "buffer" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("buffer");

/***/ }),

/***/ "child_process":
/*!********************************!*\
  !*** external "child_process" ***!
  \********************************/
/***/ ((module) => {

module.exports = require("child_process");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "events":
/*!*************************!*\
  !*** external "events" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("events");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

module.exports = require("https");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("stream");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("util");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2F%5B%5B...path%5D%5D%2Froute&page=%2Fapi%2F%5B%5B...path%5D%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2F%5B%5B...path%5D%5D%2Froute.js&appDir=%2Fapp%2Fapps%2Fadmin%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fapp%2Fapps%2Fadmin&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D!":
/*!*****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2F%5B%5B...path%5D%5D%2Froute&page=%2Fapi%2F%5B%5B...path%5D%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2F%5B%5B...path%5D%5D%2Froute.js&appDir=%2Fapp%2Fapps%2Fadmin%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fapp%2Fapps%2Fadmin&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _app_apps_admin_app_api_path_route_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/[[...path]]/route.js */ \"(rsc)/./app/api/[[...path]]/route.js\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"standalone\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/[[...path]]/route\",\n        pathname: \"/api/[[...path]]\",\n        filename: \"route\",\n        bundlePath: \"app/api/[[...path]]/route\"\n    },\n    resolvedPagePath: \"/app/apps/admin/app/api/[[...path]]/route.js\",\n    nextConfigOutput,\n    userland: _app_apps_admin_app_api_path_route_js__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/[[...path]]/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkYlNUIlNUIuLi5wYXRoJTVEJTVEJTJGcm91dGUmcGFnZT0lMkZhcGklMkYlNUIlNUIuLi5wYXRoJTVEJTVEJTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGJTVCJTVCLi4ucGF0aCU1RCU1RCUyRnJvdXRlLmpzJmFwcERpcj0lMkZhcHAlMkZhcHBzJTJGYWRtaW4lMkZhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPSUyRmFwcCUyRmFwcHMlMkZhZG1pbiZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD1zdGFuZGFsb25lJnByZWZlcnJlZFJlZ2lvbj0mbWlkZGxld2FyZUNvbmZpZz1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNjO0FBQ0o7QUFDekU7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGdIQUFtQjtBQUMzQztBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLFlBQVk7QUFDWixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsUUFBUSxpRUFBaUU7QUFDekU7QUFDQTtBQUNBLFdBQVcsNEVBQVc7QUFDdEI7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUN1SDs7QUFFdkgiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9hc3dlYWxsYXJlLWFkbWluLz8yMmFjIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgcGF0Y2hGZXRjaCBhcyBfcGF0Y2hGZXRjaCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi9wYXRjaC1mZXRjaFwiO1xuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi9hcHAvYXBwcy9hZG1pbi9hcHAvYXBpL1tbLi4ucGF0aF1dL3JvdXRlLmpzXCI7XG4vLyBXZSBpbmplY3QgdGhlIG5leHRDb25maWdPdXRwdXQgaGVyZSBzbyB0aGF0IHdlIGNhbiB1c2UgdGhlbSBpbiB0aGUgcm91dGVcbi8vIG1vZHVsZS5cbmNvbnN0IG5leHRDb25maWdPdXRwdXQgPSBcInN0YW5kYWxvbmVcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvW1suLi5wYXRoXV0vcm91dGVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9bWy4uLnBhdGhdXVwiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvW1suLi5wYXRoXV0vcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCIvYXBwL2FwcHMvYWRtaW4vYXBwL2FwaS9bWy4uLnBhdGhdXS9yb3V0ZS5qc1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzIH0gPSByb3V0ZU1vZHVsZTtcbmNvbnN0IG9yaWdpbmFsUGF0aG5hbWUgPSBcIi9hcGkvW1suLi5wYXRoXV0vcm91dGVcIjtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgc2VydmVySG9va3MsXG4gICAgICAgIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2F%5B%5B...path%5D%5D%2Froute&page=%2Fapi%2F%5B%5B...path%5D%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2F%5B%5B...path%5D%5D%2Froute.js&appDir=%2Fapp%2Fapps%2Fadmin%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fapp%2Fapps%2Fadmin&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/[[...path]]/route.js":
/*!**************************************!*\
  !*** ./app/api/[[...path]]/route.js ***!
  \**************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   DELETE: () => (/* binding */ DELETE),\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   OPTIONS: () => (/* binding */ OPTIONS),\n/* harmony export */   POST: () => (/* binding */ POST),\n/* harmony export */   PUT: () => (/* binding */ PUT)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_supabase_server__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../lib/supabase-server */ \"(rsc)/./lib/supabase-server.js\");\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @supabase/supabase-js */ \"(rsc)/./node_modules/@supabase/supabase-js/dist/index.mjs\");\n/* harmony import */ var _lib_stripe__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../lib/stripe */ \"(rsc)/./lib/stripe.js\");\n/* harmony import */ var uuid__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! uuid */ \"(rsc)/./node_modules/uuid/dist/esm-node/v4.js\");\n/* harmony import */ var _lib_entitlements__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../lib/entitlements */ \"(rsc)/./lib/entitlements.js\");\n\n\n\n\n\n// Create Supabase admin client with service role for admin operations\nfunction getSupabaseAdmin() {\n    return (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_3__.createClient)(\"https://pwdwemakaozxmutwswqa.supabase.co\", process.env.SUPABASE_SERVICE_ROLE_KEY);\n}\n// CORS helper\nfunction handleCORS(response) {\n    response.headers.set(\"Access-Control-Allow-Origin\", \"*\");\n    response.headers.set(\"Access-Control-Allow-Methods\", \"GET, POST, PUT, DELETE, OPTIONS\");\n    response.headers.set(\"Access-Control-Allow-Headers\", \"Content-Type, Authorization\");\n    return response;\n}\n// OPTIONS handler for CORS\nasync function OPTIONS() {\n    return handleCORS(new next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse(null, {\n        status: 200\n    }));\n}\n// Helper to get authenticated user\nasync function getAuthenticatedUser() {\n    // In local mode, check the auth-token cookie\n    if (process.env.LOCAL_MODE === \"true\") {\n        const { cookies } = await Promise.resolve(/*! import() */).then(__webpack_require__.bind(__webpack_require__, /*! next/headers */ \"(rsc)/./node_modules/next/dist/api/headers.js\"));\n        const { getUserFromToken } = await Promise.all(/*! import() */[__webpack_require__.e(\"vendor-chunks/semver\"), __webpack_require__.e(\"vendor-chunks/bcryptjs\"), __webpack_require__.e(\"vendor-chunks/jsonwebtoken\"), __webpack_require__.e(\"vendor-chunks/lodash.includes\"), __webpack_require__.e(\"vendor-chunks/jws\"), __webpack_require__.e(\"vendor-chunks/lodash.once\"), __webpack_require__.e(\"vendor-chunks/jwa\"), __webpack_require__.e(\"vendor-chunks/lodash.isinteger\"), __webpack_require__.e(\"vendor-chunks/ecdsa-sig-formatter\"), __webpack_require__.e(\"vendor-chunks/lodash.isplainobject\"), __webpack_require__.e(\"vendor-chunks/ms\"), __webpack_require__.e(\"vendor-chunks/lodash.isstring\"), __webpack_require__.e(\"vendor-chunks/lodash.isnumber\"), __webpack_require__.e(\"vendor-chunks/lodash.isboolean\"), __webpack_require__.e(\"vendor-chunks/safe-buffer\"), __webpack_require__.e(\"vendor-chunks/buffer-equal-constant-time\"), __webpack_require__.e(\"_rsc_lib_auth-local_js\")]).then(__webpack_require__.bind(__webpack_require__, /*! ../../../lib/auth-local */ \"(rsc)/./lib/auth-local.js\"));\n        const cookieStore = cookies();\n        const token = cookieStore.get(\"auth-token\")?.value;\n        if (token) {\n            const user = await getUserFromToken(token);\n            if (user) {\n                return {\n                    user,\n                    error: null\n                };\n            }\n        }\n        return {\n            user: null,\n            error: null\n        };\n    }\n    // Supabase mode\n    const supabase = (0,_lib_supabase_server__WEBPACK_IMPORTED_MODULE_1__.createSupabaseServer)();\n    const { data: { user }, error } = await supabase.auth.getUser();\n    return {\n        user,\n        error\n    };\n}\n// Import entitlements helper\n\n// Helper to get user's accessible boxes - uses entitlements as source of truth\nasync function getUserAccessibleBoxes(userId) {\n    const supabase = (0,_lib_supabase_server__WEBPACK_IMPORTED_MODULE_1__.createSupabaseServer)();\n    // Get all active boxes\n    const { data: boxes, error: boxError } = await supabase.from(\"boxes\").select(\"*\").eq(\"is_active\", true).order(\"display_order\", {\n        ascending: true\n    });\n    if (boxError || !boxes) {\n        return {\n            boxes: [],\n            accessibleBoxIds: []\n        };\n    }\n    // Use entitlements helper as the single source of truth\n    const { boxIds: accessibleBoxIds, hasMembership } = await (0,_lib_entitlements__WEBPACK_IMPORTED_MODULE_4__.getUserEntitledBoxIds)(userId);\n    return {\n        boxes,\n        accessibleBoxIds,\n        hasAllAccess: hasMembership\n    };\n}\n// Helper to check if user has paid access\nasync function checkUserAccess(userId) {\n    const { accessibleBoxIds, hasAllAccess } = await getUserAccessibleBoxes(userId);\n    // User has paid access if they have access to any non-sample box\n    const supabase = (0,_lib_supabase_server__WEBPACK_IMPORTED_MODULE_1__.createSupabaseServer)();\n    const { data: sampleBoxes } = await supabase.from(\"boxes\").select(\"id\").eq(\"is_sample\", true);\n    const sampleBoxIds = (sampleBoxes || []).map((b)=>b.id);\n    const hasPaidAccess = hasAllAccess || accessibleBoxIds.some((id)=>!sampleBoxIds.includes(id));\n    return {\n        hasPaidAccess,\n        accessibleBoxIds,\n        hasAllAccess\n    };\n}\n// Main request handler\nasync function GET(request) {\n    const url = new URL(request.url);\n    const path = url.pathname.replace(\"/api/\", \"\");\n    const supabase = (0,_lib_supabase_server__WEBPACK_IMPORTED_MODULE_1__.createSupabaseServer)();\n    try {\n        // AUTH ROUTES\n        if (path === \"auth/user\") {\n            const { user, error } = await getAuthenticatedUser();\n            if (error || !user) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    user: null\n                }, {\n                    status: 200\n                }));\n            }\n            // Check user access\n            const { hasPaidAccess, accessibleBoxIds, hasAllAccess } = await checkUserAccess(user.id);\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                user: {\n                    id: user.id,\n                    email: user.email,\n                    hasPaidAccess,\n                    accessibleBoxIds,\n                    hasAllAccess\n                }\n            }));\n        }\n        // BOXES ROUTES - Get all boxes with user access info\n        if (path === \"boxes\") {\n            const { user } = await getAuthenticatedUser();\n            const userId = user?.id || null;\n            const { boxes, accessibleBoxIds, hasAllAccess } = await getUserAccessibleBoxes(userId);\n            // Add hasAccess flag to each box\n            const boxesWithAccess = boxes.map((box)=>({\n                    ...box,\n                    hasAccess: accessibleBoxIds.includes(box.id)\n                }));\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                boxes: boxesWithAccess,\n                hasAllAccess\n            }));\n        }\n        // CARDS ROUTES - Now supports box filtering\n        if (path === \"cards\") {\n            const { user } = await getAuthenticatedUser();\n            const boxIds = url.searchParams.get(\"box_ids\")?.split(\",\").filter(Boolean) || [];\n            // Get user's accessible boxes\n            const { accessibleBoxIds } = await getUserAccessibleBoxes(user?.id || null);\n            // Determine which boxes to query\n            let queryBoxIds = [];\n            if (boxIds.length > 0) {\n                queryBoxIds = boxIds.filter((id)=>accessibleBoxIds.includes(id));\n                if (queryBoxIds.length === 0) {\n                    return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                        cards: [],\n                        message: \"No accessible boxes\"\n                    }));\n                }\n            } else if (accessibleBoxIds.length > 0) {\n                queryBoxIds = accessibleBoxIds;\n            } else {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    cards: [],\n                    message: \"No accessible boxes\"\n                }));\n            }\n            // Query cards\n            const { data: cards, error } = await supabase.from(\"cards\").select(\"*\").in(\"box_id\", queryBoxIds).eq(\"is_active\", true).order(\"created_at\", {\n                ascending: false\n            });\n            if (error) {\n                console.error(\"[CARDS API] Error fetching cards:\", error);\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            // If we have cards, fetch piles separately for card back images\n            let pilesMap = {};\n            if (cards && cards.length > 0) {\n                const pileIds = [\n                    ...new Set(cards.map((c)=>c.pile_id).filter(Boolean))\n                ];\n                if (pileIds.length > 0) {\n                    const { data: piles } = await supabase.from(\"piles\").select(\"*\").in(\"id\", pileIds);\n                    if (piles) {\n                        piles.forEach((p)=>{\n                            pilesMap[p.id] = p;\n                        });\n                    }\n                }\n            }\n            // Transform cards to include pile info for the frontend\n            const transformedCards = (cards || []).map((card)=>{\n                const pile = pilesMap[card.pile_id] || {};\n                return {\n                    id: card.id,\n                    box_id: card.box_id,\n                    pile_id: card.pile_id,\n                    text: card.text,\n                    image_path: card.image_path,\n                    is_active: card.is_active,\n                    created_at: card.created_at,\n                    // Add pile info for card back images\n                    color: pile.slug || \"black\",\n                    pile_name: pile.name,\n                    pile_image: pile.image_path,\n                    // Legacy fields for compatibility\n                    title: card.text,\n                    imagePath: card.image_path\n                };\n            });\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                cards: transformedCards\n            }));\n        }\n        // SUBSCRIPTION PLANS\n        if (path === \"plans\") {\n            const { data: plans, error } = await supabase.from(\"subscription_plans\").select(\"*\").eq(\"is_active\", true).order(\"price\", {\n                ascending: true\n            });\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                plans: plans || []\n            }));\n        }\n        // COLLECTION SERIES - Public endpoint\n        if (path === \"collection-series\") {\n            const { data: series, error } = await supabase.from(\"collection_series\").select(\"*\").eq(\"is_active\", true).order(\"display_order\", {\n                ascending: true\n            });\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                series: series || []\n            }));\n        }\n        // USER PURCHASES - Get user's purchase history\n        if (path === \"purchases\") {\n            const { user, error: authError } = await getAuthenticatedUser();\n            if (authError || !user) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Unauthorized\"\n                }, {\n                    status: 401\n                }));\n            }\n            const { data: purchases, error } = await supabase.from(\"user_products\").select(\"*, boxes(name, color, price)\").eq(\"user_id\", user.id).order(\"created_at\", {\n                ascending: false\n            });\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                purchases: purchases || []\n            }));\n        }\n        // SAVED DRAWS ROUTES\n        if (path === \"draws\") {\n            const { user, error: authError } = await getAuthenticatedUser();\n            if (authError || !user) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Unauthorized\"\n                }, {\n                    status: 401\n                }));\n            }\n            const { data: draws, error } = await supabase.from(\"saved_draws\").select(\"*\").eq(\"userid\", user.id).order(\"timestamp\", {\n                ascending: false\n            });\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                draws: draws || []\n            }));\n        }\n        // ADMIN ROUTES - Get all cards\n        if (path === \"admin/cards\") {\n            const { user, error: authError } = await getAuthenticatedUser();\n            if (authError || !user) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Unauthorized\"\n                }, {\n                    status: 401\n                }));\n            }\n            // Get cards\n            const { data: cards, error } = await supabase.from(\"cards\").select(\"*\").order(\"created_at\", {\n                ascending: false\n            });\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            // Get boxes, piles and series for enrichment - use Promise.all for reliability\n            const [boxesResult, pilesResult, seriesResult] = await Promise.all([\n                supabase.from(\"boxes\").select(\"*\"),\n                supabase.from(\"piles\").select(\"*\"),\n                supabase.from(\"collection_series\").select(\"*\")\n            ]);\n            const boxes = boxesResult.data || [];\n            const piles = pilesResult.data || [];\n            const series = seriesResult.data || [];\n            const boxMap = {};\n            const pileMap = {};\n            const seriesMap = {};\n            boxes.forEach((b)=>{\n                if (b && b.id) boxMap[b.id] = b;\n            });\n            piles.forEach((p)=>{\n                if (p && p.id) pileMap[p.id] = p;\n            });\n            series.forEach((s)=>{\n                if (s && s.id) seriesMap[s.id] = s;\n            });\n            // Enrich cards with box/pile info\n            const enrichedCards = (cards || []).map((card)=>{\n                const box = boxMap[card.box_id];\n                const pile = pileMap[card.pile_id];\n                const collectionSeries = box ? seriesMap[box.collection_series_id] : null;\n                return {\n                    ...card,\n                    boxes: box ? {\n                        name: box.name,\n                        color: box.color,\n                        collection_series_id: box.collection_series_id,\n                        collection_series: collectionSeries ? {\n                            name: collectionSeries.name\n                        } : null\n                    } : null,\n                    piles: pile ? {\n                        name: pile.name,\n                        slug: pile.slug\n                    } : null\n                };\n            });\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                cards: enrichedCards\n            }));\n        }\n        // ADMIN ROUTES - Get all boxes\n        if (path === \"admin/boxes\") {\n            const { user, error: authError } = await getAuthenticatedUser();\n            if (authError || !user) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Unauthorized\"\n                }, {\n                    status: 401\n                }));\n            }\n            // Get boxes\n            const { data: boxes, error } = await supabase.from(\"boxes\").select(\"*\").order(\"display_order\", {\n                ascending: true\n            });\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            // Get all related data - use Promise.all for parallel fetching\n            const [cardsResult, pilesResult, seriesResult, pricesResult] = await Promise.all([\n                supabase.from(\"cards\").select(\"*\"),\n                supabase.from(\"piles\").select(\"*\"),\n                supabase.from(\"collection_series\").select(\"*\"),\n                supabase.from(\"prices\").select(\"*\")\n            ]);\n            const cards = cardsResult.data || [];\n            const piles = pilesResult.data || [];\n            const series = seriesResult.data || [];\n            const prices = pricesResult.data || [];\n            // Log for debugging\n            console.log(`[admin/boxes] Loaded ${boxes?.length || 0} boxes, ${series.length} series, ${piles.length} piles, ${prices.length} prices`);\n            const seriesMap = {};\n            const priceMap = {};\n            const pileMap = {};\n            series.forEach((s)=>{\n                if (s && s.id) seriesMap[s.id] = s;\n            });\n            prices.forEach((p)=>{\n                if (p && p.id) priceMap[p.id] = p;\n            });\n            piles.forEach((p)=>{\n                if (p && p.id) pileMap[p.id] = p;\n            });\n            // Count cards per box per pile\n            const cardCounts = {};\n            if (cards) {\n                cards.forEach((card)=>{\n                    const key = `${card.box_id}`;\n                    if (!cardCounts[key]) {\n                        cardCounts[key] = {\n                            total: 0,\n                            byPile: {}\n                        };\n                    }\n                    cardCounts[key].total++;\n                    const pileId = card.pile_id;\n                    if (!cardCounts[key].byPile[pileId]) {\n                        cardCounts[key].byPile[pileId] = {\n                            count: 0,\n                            pileName: pileMap[pileId]?.name || \"Unknown\",\n                            pileSlug: pileMap[pileId]?.slug || \"\"\n                        };\n                    }\n                    cardCounts[key].byPile[pileId].count++;\n                });\n            }\n            // Enrich boxes with related data\n            const enrichedBoxes = (boxes || []).map((box)=>({\n                    ...box,\n                    collection_series: seriesMap[box.collection_series_id] || null,\n                    prices: priceMap[box.price_id] || null,\n                    cardStats: cardCounts[box.id] || {\n                        total: 0,\n                        byPile: {}\n                    }\n                }));\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                boxes: enrichedBoxes,\n                piles: piles || []\n            }));\n        }\n        // ADMIN ROUTES - Get all collection series\n        if (path === \"admin/collection-series\") {\n            const { user, error: authError } = await getAuthenticatedUser();\n            if (authError || !user) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Unauthorized\"\n                }, {\n                    status: 401\n                }));\n            }\n            const { data: series, error } = await supabase.from(\"collection_series\").select(\"*\").order(\"display_order\", {\n                ascending: true\n            });\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                series: series || []\n            }));\n        }\n        // ADMIN ROUTES - Get all prices\n        if (path === \"admin/prices\") {\n            const { user, error: authError } = await getAuthenticatedUser();\n            if (authError || !user) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Unauthorized\"\n                }, {\n                    status: 401\n                }));\n            }\n            const { data: prices, error } = await supabase.from(\"prices\").select(\"*\").order(\"display_order\", {\n                ascending: true\n            });\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                prices: prices || []\n            }));\n        }\n        // ADMIN ROUTES - Get all piles\n        if (path === \"admin/piles\") {\n            const { user, error: authError } = await getAuthenticatedUser();\n            if (authError || !user) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Unauthorized\"\n                }, {\n                    status: 401\n                }));\n            }\n            // Get piles first\n            const { data: piles, error: pilesError } = await supabase.from(\"piles\").select(\"*\").order(\"display_order\", {\n                ascending: true\n            });\n            if (pilesError) {\n                console.error(\"Failed to load piles:\", pilesError);\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: pilesError.message\n                }, {\n                    status: 500\n                }));\n            }\n            // Get all series for mapping - do this as a separate guaranteed query\n            const { data: series, error: seriesError } = await supabase.from(\"collection_series\").select(\"*\");\n            if (seriesError) {\n                console.error(\"Failed to load collection_series:\", seriesError);\n            }\n            // Build series lookup map\n            const seriesMap = {};\n            if (series && Array.isArray(series)) {\n                series.forEach((s)=>{\n                    if (s && s.id) {\n                        seriesMap[s.id] = s;\n                    }\n                });\n            }\n            // Log for debugging\n            console.log(`[admin/piles] Loaded ${(piles || []).length} piles, ${Object.keys(seriesMap).length} series`);\n            // Enrich piles with series data\n            const enrichedPiles = (piles || []).map((p)=>{\n                const seriesData = p.collection_series_id ? seriesMap[p.collection_series_id] : null;\n                return {\n                    ...p,\n                    collection_series: seriesData || null\n                };\n            });\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                piles: enrichedPiles\n            }));\n        }\n        // ADMIN ROUTES - Get all bundles\n        if (path === \"admin/bundles\") {\n            const { user, error: authError } = await getAuthenticatedUser();\n            if (authError || !user) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Unauthorized\"\n                }, {\n                    status: 401\n                }));\n            }\n            const { data: bundles, error } = await supabase.from(\"bundles\").select(\"*\").order(\"display_order\", {\n                ascending: true\n            });\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            // Enrich with price info\n            const { data: prices } = await supabase.from(\"prices\").select(\"*\");\n            const priceMap = {};\n            if (prices) prices.forEach((p)=>{\n                priceMap[p.id] = p;\n            });\n            const enrichedBundles = (bundles || []).map((b)=>({\n                    ...b,\n                    prices: priceMap[b.price_id] || null\n                }));\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                bundles: enrichedBundles\n            }));\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                bundles: bundles || []\n            }));\n        }\n        // PUBLIC ROUTES - Get active prices for store\n        if (path === \"store/prices\") {\n            const { data: prices, error } = await supabase.from(\"prices\").select(\"*\").eq(\"is_active\", true).order(\"display_order\", {\n                ascending: true\n            });\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                prices: prices || []\n            }));\n        }\n        // PUBLIC ROUTES - Get active bundles for store\n        if (path === \"store/bundles\") {\n            const { data: bundles, error } = await supabase.from(\"bundles\").select(\"*, prices(id, label, amount, currency, is_membership, membership_days)\").eq(\"is_active\", true).order(\"display_order\", {\n                ascending: true\n            });\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                bundles: bundles || []\n            }));\n        }\n        return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Route not found\"\n        }, {\n            status: 404\n        }));\n    } catch (error) {\n        console.error(\"API Error:\", error);\n        return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: error.message\n        }, {\n            status: 500\n        }));\n    }\n}\nasync function POST(request) {\n    const url = new URL(request.url);\n    const path = url.pathname.replace(\"/api/\", \"\");\n    const supabase = (0,_lib_supabase_server__WEBPACK_IMPORTED_MODULE_1__.createSupabaseServer)();\n    const supabaseAdmin = getSupabaseAdmin() // Service role client for admin operations\n    ;\n    try {\n        const body = await request.json();\n        // AUTH ROUTES\n        if (path === \"auth/signup\") {\n            const { email, password } = body;\n            const { data, error } = await supabase.auth.signUp({\n                email,\n                password\n            });\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 400\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                user: data.user\n            }));\n        }\n        if (path === \"auth/signin\") {\n            const { email, password } = body;\n            const { data, error } = await supabase.auth.signInWithPassword({\n                email,\n                password\n            });\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 400\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                user: data.user\n            }));\n        }\n        if (path === \"auth/signout\") {\n            const { error } = await supabase.auth.signOut();\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 400\n                }));\n            }\n            // Create response and clear auth cookies\n            const response = next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true\n            });\n            // Clear Supabase auth cookies by setting them to expire\n            const cookieOptions = {\n                path: \"/\",\n                expires: new Date(0),\n                maxAge: 0\n            };\n            response.cookies.set(\"sb-access-token\", \"\", cookieOptions);\n            response.cookies.set(\"sb-refresh-token\", \"\", cookieOptions);\n            // Also try to clear any Supabase project-specific cookies\n            const supabaseUrl = \"https://pwdwemakaozxmutwswqa.supabase.co\" || 0;\n            const projectRef = supabaseUrl.match(/https:\\/\\/([^.]+)/)?.[1];\n            if (projectRef) {\n                response.cookies.set(`sb-${projectRef}-auth-token`, \"\", cookieOptions);\n                response.cookies.set(`sb-${projectRef}-auth-token-code-verifier`, \"\", cookieOptions);\n            }\n            return handleCORS(response);\n        }\n        if (path === \"auth/google\") {\n            const { data, error } = await supabase.auth.signInWithOAuth({\n                provider: \"google\",\n                options: {\n                    redirectTo: `${\"https://appsmono.preview.emergentagent.com\"}/auth/callback`\n                }\n            });\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 400\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                url: data.url\n            }));\n        }\n        // Password Reset Request\n        if (path === \"auth/reset-password\") {\n            const { email } = body;\n            if (!email) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Email is required\"\n                }, {\n                    status: 400\n                }));\n            }\n            const { error } = await supabase.auth.resetPasswordForEmail(email, {\n                redirectTo: `${\"https://appsmono.preview.emergentagent.com\"}/auth/reset-callback`\n            });\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 400\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true,\n                message: \"Password reset email sent\"\n            }));\n        }\n        // SAVED DRAWS\n        if (path === \"draws/save\") {\n            const { user, error: authError } = await getAuthenticatedUser();\n            if (authError || !user) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Unauthorized\"\n                }, {\n                    status: 401\n                }));\n            }\n            const { blackCardId, whiteCardId, blackCardTitle, whiteCardTitle } = body;\n            const draw = {\n                id: (0,uuid__WEBPACK_IMPORTED_MODULE_5__[\"default\"])(),\n                userid: user.id,\n                useremail: user.email,\n                blackcardid: blackCardId,\n                whitecardid: whiteCardId,\n                blackcardtitle: blackCardTitle,\n                whitecardtitle: whiteCardTitle,\n                timestamp: new Date().toISOString()\n            };\n            const { data, error } = await supabaseAdmin.from(\"saved_draws\").insert([\n                draw\n            ]).select().single();\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                draw: data\n            }));\n        }\n        // PAYMENT ROUTES - Purchase a single box\n        if (path === \"payment/purchase-box\") {\n            const { user, error: authError } = await getAuthenticatedUser();\n            if (authError || !user) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Unauthorized\"\n                }, {\n                    status: 401\n                }));\n            }\n            const { boxId } = body;\n            // Get box details\n            const { data: box, error: boxError } = await supabase.from(\"boxes\").select(\"*\").eq(\"id\", boxId).single();\n            if (boxError || !box) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Box not found\"\n                }, {\n                    status: 404\n                }));\n            }\n            if (box.is_sample) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Sample box is free\"\n                }, {\n                    status: 400\n                }));\n            }\n            const session = await (0,_lib_stripe__WEBPACK_IMPORTED_MODULE_2__.getStripe)().checkout.sessions.create({\n                payment_method_types: [\n                    \"card\"\n                ],\n                line_items: [\n                    {\n                        price_data: {\n                            currency: \"usd\",\n                            product_data: {\n                                name: `AS WE ALL ARE - ${box.name}`,\n                                description: box.description || `Unlock the ${box.name} card collection`\n                            },\n                            unit_amount: Math.round(box.price * 100)\n                        },\n                        quantity: 1\n                    }\n                ],\n                mode: \"payment\",\n                success_url: `${\"https://appsmono.preview.emergentagent.com\"}?payment=success&box=${boxId}`,\n                cancel_url: `${\"https://appsmono.preview.emergentagent.com\"}?payment=cancelled`,\n                client_reference_id: user.id,\n                customer_email: user.email,\n                metadata: {\n                    box_id: boxId,\n                    purchase_type: \"one_time\"\n                }\n            });\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                url: session.url\n            }));\n        }\n        // PAYMENT ROUTES - Subscribe to all access\n        if (path === \"payment/subscribe-all\") {\n            const { user, error: authError } = await getAuthenticatedUser();\n            if (authError || !user) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Unauthorized\"\n                }, {\n                    status: 401\n                }));\n            }\n            const { planId } = body;\n            // Get plan details\n            const { data: plan, error: planError } = await supabase.from(\"subscription_plans\").select(\"*\").eq(\"id\", planId).single();\n            if (planError || !plan) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Plan not found\"\n                }, {\n                    status: 404\n                }));\n            }\n            // Calculate interval\n            let interval = \"month\";\n            let intervalCount = 1;\n            if (plan.interval === \"quarter\") {\n                interval = \"month\";\n                intervalCount = 3;\n            } else if (plan.interval === \"year\") {\n                interval = \"year\";\n                intervalCount = 1;\n            }\n            const session = await (0,_lib_stripe__WEBPACK_IMPORTED_MODULE_2__.getStripe)().checkout.sessions.create({\n                payment_method_types: [\n                    \"card\"\n                ],\n                line_items: [\n                    {\n                        price_data: {\n                            currency: \"usd\",\n                            product_data: {\n                                name: `AS WE ALL ARE - ${plan.name}`,\n                                description: plan.description || \"Full access to all card boxes\"\n                            },\n                            unit_amount: Math.round(plan.price * 100),\n                            recurring: {\n                                interval,\n                                interval_count: intervalCount\n                            }\n                        },\n                        quantity: 1\n                    }\n                ],\n                mode: \"subscription\",\n                success_url: `${\"https://appsmono.preview.emergentagent.com\"}?payment=success&subscription=true`,\n                cancel_url: `${\"https://appsmono.preview.emergentagent.com\"}?payment=cancelled`,\n                client_reference_id: user.id,\n                customer_email: user.email,\n                metadata: {\n                    plan_id: planId,\n                    purchase_type: \"all_access\"\n                }\n            });\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                url: session.url\n            }));\n        }\n        // CANCEL SUBSCRIPTION\n        if (path === \"payment/cancel-subscription\") {\n            const { user, error: authError } = await getAuthenticatedUser();\n            if (authError || !user) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Unauthorized\"\n                }, {\n                    status: 401\n                }));\n            }\n            const { purchaseId } = body;\n            // Get the purchase record\n            const { data: purchase, error: purchaseError } = await supabase.from(\"user_products\").select(\"*\").eq(\"id\", purchaseId).eq(\"user_id\", user.id).single();\n            if (purchaseError || !purchase) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Purchase not found\"\n                }, {\n                    status: 404\n                }));\n            }\n            if (!purchase.stripe_subscription_id) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"This is not a subscription\"\n                }, {\n                    status: 400\n                }));\n            }\n            try {\n                // Cancel the subscription in Stripe\n                await (0,_lib_stripe__WEBPACK_IMPORTED_MODULE_2__.getStripe)().subscriptions.cancel(purchase.stripe_subscription_id);\n                // Update our database\n                await supabase.from(\"user_products\").update({\n                    is_active: false\n                }).eq(\"id\", purchaseId);\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    success: true,\n                    message: \"Subscription cancelled\"\n                }));\n            } catch (stripeError) {\n                console.error(\"Stripe cancellation error:\", stripeError);\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Failed to cancel subscription\"\n                }, {\n                    status: 500\n                }));\n            }\n        }\n        // Legacy payment route (for backward compatibility)\n        if (path === \"payment/create-checkout\") {\n            const { user, error: authError } = await getAuthenticatedUser();\n            if (authError || !user) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Unauthorized\"\n                }, {\n                    status: 401\n                }));\n            }\n            const { paymentType, couponCode } = body;\n            let sessionConfig = {\n                payment_method_types: [\n                    \"card\"\n                ],\n                line_items: [],\n                mode: paymentType === \"subscription\" ? \"subscription\" : \"payment\",\n                success_url: `${\"https://appsmono.preview.emergentagent.com\"}?payment=success`,\n                cancel_url: `${\"https://appsmono.preview.emergentagent.com\"}?payment=cancelled`,\n                client_reference_id: user.id,\n                customer_email: user.email,\n                metadata: {\n                    purchase_type: paymentType === \"subscription\" ? \"all_access\" : \"legacy_full\"\n                }\n            };\n            if (paymentType === \"onetime\") {\n                sessionConfig.line_items.push({\n                    price_data: {\n                        currency: \"usd\",\n                        product_data: {\n                            name: \"AS WE ALL ARE - Full Access\",\n                            description: \"One-time unlock of all cards\"\n                        },\n                        unit_amount: 2000\n                    },\n                    quantity: 1\n                });\n            } else {\n                sessionConfig.line_items.push({\n                    price_data: {\n                        currency: \"usd\",\n                        product_data: {\n                            name: \"AS WE ALL ARE - Subscription\",\n                            description: \"Full access subscription\"\n                        },\n                        unit_amount: 300,\n                        recurring: {\n                            interval: \"month\",\n                            interval_count: 3\n                        }\n                    },\n                    quantity: 1\n                });\n            }\n            if (couponCode) {\n                try {\n                    const coupons = await (0,_lib_stripe__WEBPACK_IMPORTED_MODULE_2__.getStripe)().coupons.list({\n                        limit: 100\n                    });\n                    const validCoupon = coupons.data.find((c)=>c.id.toLowerCase() === couponCode.toLowerCase());\n                    if (validCoupon) {\n                        sessionConfig.discounts = [\n                            {\n                                coupon: validCoupon.id\n                            }\n                        ];\n                    }\n                } catch (error) {\n                    console.error(\"Coupon validation error:\", error);\n                }\n            }\n            const session = await stripe.checkout.sessions.create(sessionConfig);\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                url: session.url\n            }));\n        }\n        // ADMIN ROUTES - Create card\n        if (path === \"admin/cards\") {\n            const { user, error: authError } = await getAuthenticatedUser();\n            if (authError || !user) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Unauthorized\"\n                }, {\n                    status: 401\n                }));\n            }\n            const { boxId, pileId, text, imagePath, isActive } = body;\n            // Generate MD5 hash ID\n            const crypto = await Promise.resolve(/*! import() */).then(__webpack_require__.t.bind(__webpack_require__, /*! crypto */ \"crypto\", 23));\n            const cardId = crypto.createHash(\"md5\").update(`${Date.now()}-${Math.random()}`).digest(\"hex\");\n            const card = {\n                id: cardId,\n                box_id: boxId,\n                pile_id: pileId,\n                text: text || null,\n                image_path: imagePath || \"\",\n                is_active: isActive !== false,\n                created_at: new Date().toISOString()\n            };\n            const { data, error } = await supabaseAdmin.from(\"cards\").insert([\n                card\n            ]).select().single();\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                card: data\n            }));\n        }\n        // ADMIN ROUTES - Create box (enhanced with new fields)\n        if (path === \"admin/boxes\") {\n            const { user, error: authError } = await getAuthenticatedUser();\n            if (authError || !user) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Unauthorized\"\n                }, {\n                    status: 401\n                }));\n            }\n            const { id: boxId, name, description, descriptionShort, tagline, topics, priceId, color, colorPalette, path: boxPath, displayOrder, isSample, fullBoxId, isActive, collectionSeriesId } = body;\n            const box = {\n                id: boxId || `box_${(0,uuid__WEBPACK_IMPORTED_MODULE_5__[\"default\"])().slice(0, 8)}`,\n                name,\n                description: description || \"\",\n                description_short: descriptionShort || \"\",\n                tagline: tagline || \"\",\n                topics: topics || [],\n                price_id: priceId || null,\n                color: color || \"#000000\",\n                color_palette: colorPalette || [],\n                path: boxPath || \"\",\n                display_order: displayOrder || 0,\n                is_sample: isSample || false,\n                full_box_id: isSample ? fullBoxId || null : null,\n                is_active: isActive !== false,\n                collection_series_id: collectionSeriesId || \"unscripted_conversations\",\n                created_at: new Date().toISOString()\n            };\n            const { data, error } = await supabaseAdmin.from(\"boxes\").insert([\n                box\n            ]).select().single();\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                box: data\n            }));\n        }\n        // ADMIN ROUTES - Create collection series\n        if (path === \"admin/collection-series\") {\n            const { user, error: authError } = await getAuthenticatedUser();\n            if (authError || !user) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Unauthorized\"\n                }, {\n                    status: 401\n                }));\n            }\n            const { id, name, description, displayOrder, isActive } = body;\n            const series = {\n                id: id || `series_${(0,uuid__WEBPACK_IMPORTED_MODULE_5__[\"default\"])().slice(0, 8)}`,\n                name,\n                description: description || \"\",\n                display_order: displayOrder || 0,\n                is_active: isActive !== false,\n                created_at: new Date().toISOString()\n            };\n            const { data, error } = await supabaseAdmin.from(\"collection_series\").insert([\n                series\n            ]).select().single();\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                series: data\n            }));\n        }\n        // ADMIN ROUTES - Create price\n        if (path === \"admin/prices\") {\n            const { user, error: authError } = await getAuthenticatedUser();\n            if (authError || !user) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Unauthorized\"\n                }, {\n                    status: 401\n                }));\n            }\n            const { id, label, paymentInfo, hookInfo, amount, promoAmount, promoEnabled, currency, membershipDays, stripePriceId, displayOrder, isActive } = body;\n            const price = {\n                id: id || `price_${(0,uuid__WEBPACK_IMPORTED_MODULE_5__[\"default\"])().slice(0, 8)}`,\n                label,\n                payment_info: paymentInfo || \"\",\n                hook_info: hookInfo || \"\",\n                amount: amount || 0,\n                promo_amount: promoAmount || null,\n                promo_enabled: promoEnabled || false,\n                currency: currency || \"USD\",\n                membership_days: membershipDays || null,\n                stripe_price_id: stripePriceId || null,\n                display_order: displayOrder || 0,\n                is_active: isActive !== false,\n                created_at: new Date().toISOString()\n            };\n            const { data, error } = await supabaseAdmin.from(\"prices\").insert([\n                price\n            ]).select().single();\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                price: data\n            }));\n        }\n        // ADMIN ROUTES - Create pile\n        if (path === \"admin/piles\") {\n            const { user, error: authError } = await getAuthenticatedUser();\n            if (authError || !user) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Unauthorized\"\n                }, {\n                    status: 401\n                }));\n            }\n            const { id, slug, name, imagePath, collectionSeriesId, displayOrder, isActive } = body;\n            const pile = {\n                id: id || `pile_${(0,uuid__WEBPACK_IMPORTED_MODULE_5__[\"default\"])().slice(0, 8)}`,\n                slug: slug || name.toLowerCase().replace(/\\s+/g, \"_\"),\n                name,\n                image_path: imagePath || \"\",\n                collection_series_id: collectionSeriesId || null,\n                display_order: displayOrder || 0,\n                is_active: isActive !== false,\n                created_at: new Date().toISOString()\n            };\n            const { data, error } = await supabaseAdmin.from(\"piles\").insert([\n                pile\n            ]).select().single();\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                pile: data\n            }));\n        }\n        // ADMIN ROUTES - Create bundle\n        if (path === \"admin/bundles\") {\n            const { user, error: authError } = await getAuthenticatedUser();\n            if (authError || !user) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Unauthorized\"\n                }, {\n                    status: 401\n                }));\n            }\n            const { id, name, description, priceId, boxIds, displayOrder, isActive } = body;\n            const bundle = {\n                id: id || `bundle_${(0,uuid__WEBPACK_IMPORTED_MODULE_5__[\"default\"])().slice(0, 8)}`,\n                name,\n                description: description || \"\",\n                price_id: priceId || null,\n                box_ids: boxIds || [],\n                display_order: displayOrder || 0,\n                is_active: isActive !== false,\n                created_at: new Date().toISOString()\n            };\n            const { data, error } = await supabaseAdmin.from(\"bundles\").insert([\n                bundle\n            ]).select().single();\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                bundle: data\n            }));\n        }\n        // ADMIN ROUTES - Bulk delete cards\n        if (path === \"admin/cards/bulk-delete\") {\n            const { user, error: authError } = await getAuthenticatedUser();\n            if (authError || !user) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Unauthorized\"\n                }, {\n                    status: 401\n                }));\n            }\n            const { boxId, pileId } = body;\n            if (!boxId) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"boxId required\"\n                }, {\n                    status: 400\n                }));\n            }\n            // Build delete query\n            let deleteResult;\n            if (pileId) {\n                // Delete cards for specific box and pile\n                const { data: cards } = await supabase.from(\"cards\").select(\"*\").eq(\"box_id\", boxId).eq(\"pile_id\", pileId);\n                if (cards && cards.length > 0) {\n                    for (const card of cards){\n                        await supabase.from(\"cards\").delete().eq(\"id\", card.id);\n                    }\n                }\n                deleteResult = {\n                    deleted: cards?.length || 0\n                };\n            } else {\n                // Delete all cards for box\n                const { data: cards } = await supabase.from(\"cards\").select(\"*\").eq(\"box_id\", boxId);\n                if (cards && cards.length > 0) {\n                    for (const card of cards){\n                        await supabase.from(\"cards\").delete().eq(\"id\", card.id);\n                    }\n                }\n                deleteResult = {\n                    deleted: cards?.length || 0\n                };\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true,\n                ...deleteResult\n            }));\n        }\n        // ADMIN ROUTES - Export card paths\n        if (path === \"admin/cards/export\") {\n            const { user, error: authError } = await getAuthenticatedUser();\n            if (authError || !user) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Unauthorized\"\n                }, {\n                    status: 401\n                }));\n            }\n            const { boxId, pileId } = body;\n            if (!boxId) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"boxId required\"\n                }, {\n                    status: 400\n                }));\n            }\n            let query = supabase.from(\"cards\").select(\"*\").eq(\"box_id\", boxId);\n            if (pileId) {\n                query = query.eq(\"pile_id\", pileId);\n            }\n            const { data: cards, error } = await query;\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                cards: cards || [],\n                imagePaths: (cards || []).map((c)=>c.image_path)\n            }));\n        }\n        return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Route not found\"\n        }, {\n            status: 404\n        }));\n    } catch (error) {\n        console.error(\"API Error:\", error);\n        return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: error.message\n        }, {\n            status: 500\n        }));\n    }\n}\nasync function PUT(request) {\n    const url = new URL(request.url);\n    const path = url.pathname.replace(\"/api/\", \"\");\n    const supabase = (0,_lib_supabase_server__WEBPACK_IMPORTED_MODULE_1__.createSupabaseServer)();\n    const supabaseAdmin = getSupabaseAdmin() // Service role client for admin operations\n    ;\n    try {\n        const { user, error: authError } = await getAuthenticatedUser();\n        if (authError || !user) {\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Unauthorized\"\n            }, {\n                status: 401\n            }));\n        }\n        // ADMIN ROUTES - Update card\n        if (path.startsWith(\"admin/cards/\")) {\n            const cardId = path.split(\"/\")[2];\n            const body = await request.json();\n            const updateData = {};\n            if (body.boxId !== undefined) updateData.box_id = body.boxId;\n            if (body.pileId !== undefined) updateData.pile_id = body.pileId;\n            if (body.text !== undefined) updateData.text = body.text;\n            if (body.imagePath !== undefined) updateData.image_path = body.imagePath;\n            if (body.isActive !== undefined) updateData.is_active = body.isActive;\n            const { error } = await supabaseAdmin.from(\"cards\").update(updateData).eq(\"id\", cardId);\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true\n            }));\n        }\n        // ADMIN ROUTES - Update box (enhanced with new fields)\n        if (path.startsWith(\"admin/boxes/\")) {\n            const boxId = path.split(\"/\")[2];\n            const body = await request.json();\n            // Map camelCase to snake_case\n            const updateData = {};\n            if (body.name !== undefined) updateData.name = body.name;\n            if (body.description !== undefined) updateData.description = body.description;\n            if (body.descriptionShort !== undefined) updateData.description_short = body.descriptionShort;\n            if (body.tagline !== undefined) updateData.tagline = body.tagline;\n            if (body.topics !== undefined) updateData.topics = body.topics;\n            if (body.priceId !== undefined) updateData.price_id = body.priceId;\n            if (body.color !== undefined) updateData.color = body.color;\n            if (body.colorPalette !== undefined) updateData.color_palette = body.colorPalette;\n            if (body.path !== undefined) updateData.path = body.path;\n            if (body.displayOrder !== undefined) updateData.display_order = body.displayOrder;\n            if (body.collectionSeriesId !== undefined) updateData.collection_series_id = body.collectionSeriesId;\n            if (body.isActive !== undefined) updateData.is_active = body.isActive;\n            // Handle is_sample and full_box_id fields\n            if (body.isSample !== undefined) updateData.is_sample = body.isSample;\n            if (body.fullBoxId !== undefined) {\n                // Only set full_box_id if this is a sample box\n                updateData.full_box_id = body.isSample ? body.fullBoxId : null;\n            }\n            // If setting isSample to false, clear the full_box_id\n            if (body.isSample === false) {\n                updateData.full_box_id = null;\n            }\n            const { error } = await supabaseAdmin.from(\"boxes\").update(updateData).eq(\"id\", boxId);\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true\n            }));\n        }\n        // ADMIN ROUTES - Update collection series\n        if (path.startsWith(\"admin/collection-series/\")) {\n            const seriesId = path.split(\"/\")[2];\n            const body = await request.json();\n            const updateData = {};\n            if (body.name !== undefined) updateData.name = body.name;\n            if (body.description !== undefined) updateData.description = body.description;\n            if (body.displayOrder !== undefined) updateData.display_order = body.displayOrder;\n            if (body.isActive !== undefined) updateData.is_active = body.isActive;\n            const { error } = await supabaseAdmin.from(\"collection_series\").update(updateData).eq(\"id\", seriesId);\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true\n            }));\n        }\n        // ADMIN ROUTES - Update price\n        if (path.startsWith(\"admin/prices/\")) {\n            const priceId = path.split(\"/\")[2];\n            const body = await request.json();\n            const updateData = {};\n            if (body.label !== undefined) updateData.label = body.label;\n            if (body.paymentInfo !== undefined) updateData.payment_info = body.paymentInfo;\n            if (body.hookInfo !== undefined) updateData.hook_info = body.hookInfo;\n            if (body.amount !== undefined) updateData.amount = body.amount;\n            if (body.promoAmount !== undefined) updateData.promo_amount = body.promoAmount;\n            if (body.promoEnabled !== undefined) updateData.promo_enabled = body.promoEnabled;\n            if (body.currency !== undefined) updateData.currency = body.currency;\n            if (body.membershipDays !== undefined) updateData.membership_days = body.membershipDays;\n            if (body.stripePriceId !== undefined) updateData.stripe_price_id = body.stripePriceId;\n            if (body.displayOrder !== undefined) updateData.display_order = body.displayOrder;\n            if (body.isActive !== undefined) updateData.is_active = body.isActive;\n            const { error } = await supabaseAdmin.from(\"prices\").update(updateData).eq(\"id\", priceId);\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true\n            }));\n        }\n        // ADMIN ROUTES - Update pile\n        if (path.startsWith(\"admin/piles/\")) {\n            const pileId = path.split(\"/\")[2];\n            const body = await request.json();\n            console.log(\"[PILE UPDATE] pileId:\", pileId, \"body:\", JSON.stringify(body));\n            const updateData = {};\n            if (body.slug !== undefined) updateData.slug = body.slug;\n            if (body.name !== undefined) updateData.name = body.name;\n            if (body.imagePath !== undefined) updateData.image_path = body.imagePath;\n            if (body.collectionSeriesId !== undefined) updateData.collection_series_id = body.collectionSeriesId;\n            if (body.displayOrder !== undefined) updateData.display_order = body.displayOrder;\n            if (body.isActive !== undefined) updateData.is_active = body.isActive;\n            console.log(\"[PILE UPDATE] updateData:\", JSON.stringify(updateData));\n            // Use service role client for admin operations (bypasses RLS)\n            const supabaseAdmin = getSupabaseAdmin();\n            const { data, error } = await supabaseAdmin.from(\"piles\").update(updateData).eq(\"id\", pileId).select();\n            console.log(\"[PILE UPDATE] result:\", JSON.stringify({\n                data,\n                error\n            }));\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true,\n                data\n            }));\n        }\n        // ADMIN ROUTES - Update bundle\n        if (path.startsWith(\"admin/bundles/\")) {\n            const bundleId = path.split(\"/\")[2];\n            const body = await request.json();\n            const updateData = {};\n            if (body.name !== undefined) updateData.name = body.name;\n            if (body.description !== undefined) updateData.description = body.description;\n            if (body.priceId !== undefined) updateData.price_id = body.priceId;\n            if (body.boxIds !== undefined) updateData.box_ids = body.boxIds;\n            if (body.displayOrder !== undefined) updateData.display_order = body.displayOrder;\n            if (body.isActive !== undefined) updateData.is_active = body.isActive;\n            const { error } = await supabaseAdmin.from(\"bundles\").update(updateData).eq(\"id\", bundleId);\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true\n            }));\n        }\n        return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Route not found\"\n        }, {\n            status: 404\n        }));\n    } catch (error) {\n        console.error(\"API Error:\", error);\n        return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: error.message\n        }, {\n            status: 500\n        }));\n    }\n}\nasync function DELETE(request) {\n    const url = new URL(request.url);\n    const path = url.pathname.replace(\"/api/\", \"\");\n    const supabase = (0,_lib_supabase_server__WEBPACK_IMPORTED_MODULE_1__.createSupabaseServer)();\n    const supabaseAdmin = getSupabaseAdmin() // Service role client for admin operations\n    ;\n    try {\n        const { user, error: authError } = await getAuthenticatedUser();\n        if (authError || !user) {\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Unauthorized\"\n            }, {\n                status: 401\n            }));\n        }\n        // ADMIN ROUTES - Delete card\n        if (path.startsWith(\"admin/cards/\")) {\n            const cardId = path.split(\"/\")[2];\n            const { error } = await supabaseAdmin.from(\"cards\").delete().eq(\"id\", cardId);\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true\n            }));\n        }\n        // ADMIN ROUTES - Delete box\n        if (path.startsWith(\"admin/boxes/\")) {\n            const boxId = path.split(\"/\")[2];\n            // First check if any cards are assigned to this box\n            const { data: cards } = await supabase.from(\"cards\").select(\"id\").eq(\"box_id\", boxId).limit(1);\n            if (cards && cards.length > 0) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Cannot delete box with assigned cards. Remove cards first.\"\n                }, {\n                    status: 400\n                }));\n            }\n            const { error } = await supabaseAdmin.from(\"boxes\").delete().eq(\"id\", boxId);\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true\n            }));\n        }\n        // ADMIN ROUTES - Delete collection series\n        if (path.startsWith(\"admin/collection-series/\")) {\n            const seriesId = path.split(\"/\")[2];\n            const { error } = await supabaseAdmin.from(\"collection_series\").delete().eq(\"id\", seriesId);\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true\n            }));\n        }\n        // ADMIN ROUTES - Delete price\n        if (path.startsWith(\"admin/prices/\")) {\n            const priceId = path.split(\"/\")[2];\n            const { error } = await supabaseAdmin.from(\"prices\").delete().eq(\"id\", priceId);\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true\n            }));\n        }\n        // ADMIN ROUTES - Delete pile\n        if (path.startsWith(\"admin/piles/\")) {\n            const pileId = path.split(\"/\")[2];\n            const { error } = await supabaseAdmin.from(\"piles\").delete().eq(\"id\", pileId);\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true\n            }));\n        }\n        // ADMIN ROUTES - Delete bundle\n        if (path.startsWith(\"admin/bundles/\")) {\n            const bundleId = path.split(\"/\")[2];\n            const { error } = await supabaseAdmin.from(\"bundles\").delete().eq(\"id\", bundleId);\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true\n            }));\n        }\n        return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Route not found\"\n        }, {\n            status: 404\n        }));\n    } catch (error) {\n        console.error(\"API Error:\", error);\n        return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: error.message\n        }, {\n            status: 500\n        }));\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFDO2dCQUFFeUYsU0FBUztZQUFLO1FBQ3REO1FBRUEsK0JBQStCO1FBQy9CLElBQUk1RixLQUFLME4sVUFBVSxDQUFDLG1CQUFtQjtZQUNyQyxNQUFNTSxXQUFXaE8sS0FBS1MsS0FBSyxDQUFDLElBQUksQ0FBQyxFQUFFO1lBRW5DLE1BQU0sRUFBRTFDLEtBQUssRUFBRSxHQUFHLE1BQU11SCxjQUNyQjVHLElBQUksQ0FBQyxXQUNMMk8sTUFBTSxHQUNOek8sRUFBRSxDQUFDLE1BQU1vUDtZQUVaLElBQUlqUSxPQUFPO2dCQUNULE9BQU9mLFdBQVdYLHFEQUFZQSxDQUFDOEQsSUFBSSxDQUFDO29CQUFFcEMsT0FBT0EsTUFBTWdELE9BQU87Z0JBQUMsR0FBRztvQkFBRTFELFFBQVE7Z0JBQUk7WUFDOUU7WUFFQSxPQUFPTCxXQUFXWCxxREFBWUEsQ0FBQzhELElBQUksQ0FBQztnQkFBRXlGLFNBQVM7WUFBSztRQUN0RDtRQUVBLE9BQU81SSxXQUFXWCxxREFBWUEsQ0FBQzhELElBQUksQ0FBQztZQUFFcEMsT0FBTztRQUFrQixHQUFHO1lBQUVWLFFBQVE7UUFBSTtJQUVsRixFQUFFLE9BQU9VLE9BQU87UUFDZGtELFFBQVFsRCxLQUFLLENBQUMsY0FBY0E7UUFDNUIsT0FBT2YsV0FBV1gscURBQVlBLENBQUM4RCxJQUFJLENBQUM7WUFBRXBDLE9BQU9BLE1BQU1nRCxPQUFPO1FBQUMsR0FBRztZQUFFMUQsUUFBUTtRQUFJO0lBQzlFO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9hc3dlYWxsYXJlLWFkbWluLy4vYXBwL2FwaS9bWy4uLnBhdGhdXS9yb3V0ZS5qcz80OGYxIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRSZXNwb25zZSB9IGZyb20gJ25leHQvc2VydmVyJ1xuaW1wb3J0IHsgY3JlYXRlU3VwYWJhc2VTZXJ2ZXIgfSBmcm9tICcuLi8uLi8uLi9saWIvc3VwYWJhc2Utc2VydmVyJ1xuaW1wb3J0IHsgY3JlYXRlQ2xpZW50IH0gZnJvbSAnQHN1cGFiYXNlL3N1cGFiYXNlLWpzJ1xuaW1wb3J0IHsgZ2V0U3RyaXBlIH0gZnJvbSAnLi4vLi4vLi4vbGliL3N0cmlwZSdcbmltcG9ydCB7IHY0IGFzIHV1aWR2NCB9IGZyb20gJ3V1aWQnXG5cbi8vIENyZWF0ZSBTdXBhYmFzZSBhZG1pbiBjbGllbnQgd2l0aCBzZXJ2aWNlIHJvbGUgZm9yIGFkbWluIG9wZXJhdGlvbnNcbmZ1bmN0aW9uIGdldFN1cGFiYXNlQWRtaW4oKSB7XG4gIHJldHVybiBjcmVhdGVDbGllbnQoXG4gICAgcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMLFxuICAgIHByb2Nlc3MuZW52LlNVUEFCQVNFX1NFUlZJQ0VfUk9MRV9LRVlcbiAgKVxufVxuXG4vLyBDT1JTIGhlbHBlclxuZnVuY3Rpb24gaGFuZGxlQ09SUyhyZXNwb25zZSkge1xuICByZXNwb25zZS5oZWFkZXJzLnNldCgnQWNjZXNzLUNvbnRyb2wtQWxsb3ctT3JpZ2luJywgJyonKVxuICByZXNwb25zZS5oZWFkZXJzLnNldCgnQWNjZXNzLUNvbnRyb2wtQWxsb3ctTWV0aG9kcycsICdHRVQsIFBPU1QsIFBVVCwgREVMRVRFLCBPUFRJT05TJylcbiAgcmVzcG9uc2UuaGVhZGVycy5zZXQoJ0FjY2Vzcy1Db250cm9sLUFsbG93LUhlYWRlcnMnLCAnQ29udGVudC1UeXBlLCBBdXRob3JpemF0aW9uJylcbiAgcmV0dXJuIHJlc3BvbnNlXG59XG5cbi8vIE9QVElPTlMgaGFuZGxlciBmb3IgQ09SU1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIE9QVElPTlMoKSB7XG4gIHJldHVybiBoYW5kbGVDT1JTKG5ldyBOZXh0UmVzcG9uc2UobnVsbCwgeyBzdGF0dXM6IDIwMCB9KSlcbn1cblxuLy8gSGVscGVyIHRvIGdldCBhdXRoZW50aWNhdGVkIHVzZXJcbmFzeW5jIGZ1bmN0aW9uIGdldEF1dGhlbnRpY2F0ZWRVc2VyKCkge1xuICAvLyBJbiBsb2NhbCBtb2RlLCBjaGVjayB0aGUgYXV0aC10b2tlbiBjb29raWVcbiAgaWYgKHByb2Nlc3MuZW52LkxPQ0FMX01PREUgPT09ICd0cnVlJykge1xuICAgIGNvbnN0IHsgY29va2llcyB9ID0gYXdhaXQgaW1wb3J0KCduZXh0L2hlYWRlcnMnKVxuICAgIGNvbnN0IHsgZ2V0VXNlckZyb21Ub2tlbiB9ID0gYXdhaXQgaW1wb3J0KCcuLi8uLi8uLi9saWIvYXV0aC1sb2NhbCcpXG4gICAgXG4gICAgY29uc3QgY29va2llU3RvcmUgPSBjb29raWVzKClcbiAgICBjb25zdCB0b2tlbiA9IGNvb2tpZVN0b3JlLmdldCgnYXV0aC10b2tlbicpPy52YWx1ZVxuICAgIFxuICAgIGlmICh0b2tlbikge1xuICAgICAgY29uc3QgdXNlciA9IGF3YWl0IGdldFVzZXJGcm9tVG9rZW4odG9rZW4pXG4gICAgICBpZiAodXNlcikge1xuICAgICAgICByZXR1cm4geyB1c2VyLCBlcnJvcjogbnVsbCB9XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiB7IHVzZXI6IG51bGwsIGVycm9yOiBudWxsIH1cbiAgfVxuICBcbiAgLy8gU3VwYWJhc2UgbW9kZVxuICBjb25zdCBzdXBhYmFzZSA9IGNyZWF0ZVN1cGFiYXNlU2VydmVyKClcbiAgY29uc3QgeyBkYXRhOiB7IHVzZXIgfSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlLmF1dGguZ2V0VXNlcigpXG4gIHJldHVybiB7IHVzZXIsIGVycm9yIH1cbn1cblxuLy8gSW1wb3J0IGVudGl0bGVtZW50cyBoZWxwZXJcbmltcG9ydCB7IGdldFVzZXJFbnRpdGxlZEJveElkcywgZ2V0Qm94ZXNXaXRoVmlzaWJpbGl0eSB9IGZyb20gJy4uLy4uLy4uL2xpYi9lbnRpdGxlbWVudHMnXG5cbi8vIEhlbHBlciB0byBnZXQgdXNlcidzIGFjY2Vzc2libGUgYm94ZXMgLSB1c2VzIGVudGl0bGVtZW50cyBhcyBzb3VyY2Ugb2YgdHJ1dGhcbmFzeW5jIGZ1bmN0aW9uIGdldFVzZXJBY2Nlc3NpYmxlQm94ZXModXNlcklkKSB7XG4gIGNvbnN0IHN1cGFiYXNlID0gY3JlYXRlU3VwYWJhc2VTZXJ2ZXIoKVxuICBcbiAgLy8gR2V0IGFsbCBhY3RpdmUgYm94ZXNcbiAgY29uc3QgeyBkYXRhOiBib3hlcywgZXJyb3I6IGJveEVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgIC5mcm9tKCdib3hlcycpXG4gICAgLnNlbGVjdCgnKicpXG4gICAgLmVxKCdpc19hY3RpdmUnLCB0cnVlKVxuICAgIC5vcmRlcignZGlzcGxheV9vcmRlcicsIHsgYXNjZW5kaW5nOiB0cnVlIH0pXG4gIFxuICBpZiAoYm94RXJyb3IgfHwgIWJveGVzKSB7XG4gICAgcmV0dXJuIHsgYm94ZXM6IFtdLCBhY2Nlc3NpYmxlQm94SWRzOiBbXSB9XG4gIH1cbiAgXG4gIC8vIFVzZSBlbnRpdGxlbWVudHMgaGVscGVyIGFzIHRoZSBzaW5nbGUgc291cmNlIG9mIHRydXRoXG4gIGNvbnN0IHsgYm94SWRzOiBhY2Nlc3NpYmxlQm94SWRzLCBoYXNNZW1iZXJzaGlwIH0gPSBhd2FpdCBnZXRVc2VyRW50aXRsZWRCb3hJZHModXNlcklkKVxuICBcbiAgcmV0dXJuIHsgXG4gICAgYm94ZXMsIFxuICAgIGFjY2Vzc2libGVCb3hJZHMsIFxuICAgIGhhc0FsbEFjY2VzczogaGFzTWVtYmVyc2hpcCBcbiAgfVxufVxuXG4vLyBIZWxwZXIgdG8gY2hlY2sgaWYgdXNlciBoYXMgcGFpZCBhY2Nlc3NcbmFzeW5jIGZ1bmN0aW9uIGNoZWNrVXNlckFjY2Vzcyh1c2VySWQpIHtcbiAgY29uc3QgeyBhY2Nlc3NpYmxlQm94SWRzLCBoYXNBbGxBY2Nlc3MgfSA9IGF3YWl0IGdldFVzZXJBY2Nlc3NpYmxlQm94ZXModXNlcklkKVxuICBcbiAgLy8gVXNlciBoYXMgcGFpZCBhY2Nlc3MgaWYgdGhleSBoYXZlIGFjY2VzcyB0byBhbnkgbm9uLXNhbXBsZSBib3hcbiAgY29uc3Qgc3VwYWJhc2UgPSBjcmVhdGVTdXBhYmFzZVNlcnZlcigpXG4gIGNvbnN0IHsgZGF0YTogc2FtcGxlQm94ZXMgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgLmZyb20oJ2JveGVzJylcbiAgICAuc2VsZWN0KCdpZCcpXG4gICAgLmVxKCdpc19zYW1wbGUnLCB0cnVlKVxuICBcbiAgY29uc3Qgc2FtcGxlQm94SWRzID0gKHNhbXBsZUJveGVzIHx8IFtdKS5tYXAoYiA9PiBiLmlkKVxuICBjb25zdCBoYXNQYWlkQWNjZXNzID0gaGFzQWxsQWNjZXNzIHx8IGFjY2Vzc2libGVCb3hJZHMuc29tZShpZCA9PiAhc2FtcGxlQm94SWRzLmluY2x1ZGVzKGlkKSlcbiAgXG4gIHJldHVybiB7IGhhc1BhaWRBY2Nlc3MsIGFjY2Vzc2libGVCb3hJZHMsIGhhc0FsbEFjY2VzcyB9XG59XG5cbi8vIE1haW4gcmVxdWVzdCBoYW5kbGVyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gR0VUKHJlcXVlc3QpIHtcbiAgY29uc3QgdXJsID0gbmV3IFVSTChyZXF1ZXN0LnVybClcbiAgY29uc3QgcGF0aCA9IHVybC5wYXRobmFtZS5yZXBsYWNlKCcvYXBpLycsICcnKVxuICBjb25zdCBzdXBhYmFzZSA9IGNyZWF0ZVN1cGFiYXNlU2VydmVyKClcblxuICB0cnkge1xuICAgIC8vIEFVVEggUk9VVEVTXG4gICAgaWYgKHBhdGggPT09ICdhdXRoL3VzZXInKSB7XG4gICAgICBjb25zdCB7IHVzZXIsIGVycm9yIH0gPSBhd2FpdCBnZXRBdXRoZW50aWNhdGVkVXNlcigpXG4gICAgICBcbiAgICAgIGlmIChlcnJvciB8fCAhdXNlcikge1xuICAgICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IHVzZXI6IG51bGwgfSwgeyBzdGF0dXM6IDIwMCB9KSlcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8gQ2hlY2sgdXNlciBhY2Nlc3NcbiAgICAgIGNvbnN0IHsgaGFzUGFpZEFjY2VzcywgYWNjZXNzaWJsZUJveElkcywgaGFzQWxsQWNjZXNzIH0gPSBhd2FpdCBjaGVja1VzZXJBY2Nlc3ModXNlci5pZClcbiAgICAgIFxuICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBcbiAgICAgICAgdXNlcjoge1xuICAgICAgICAgIGlkOiB1c2VyLmlkLFxuICAgICAgICAgIGVtYWlsOiB1c2VyLmVtYWlsLFxuICAgICAgICAgIGhhc1BhaWRBY2Nlc3MsXG4gICAgICAgICAgYWNjZXNzaWJsZUJveElkcyxcbiAgICAgICAgICBoYXNBbGxBY2Nlc3NcbiAgICAgICAgfVxuICAgICAgfSkpXG4gICAgfVxuXG4gICAgLy8gQk9YRVMgUk9VVEVTIC0gR2V0IGFsbCBib3hlcyB3aXRoIHVzZXIgYWNjZXNzIGluZm9cbiAgICBpZiAocGF0aCA9PT0gJ2JveGVzJykge1xuICAgICAgY29uc3QgeyB1c2VyIH0gPSBhd2FpdCBnZXRBdXRoZW50aWNhdGVkVXNlcigpXG4gICAgICBjb25zdCB1c2VySWQgPSB1c2VyPy5pZCB8fCBudWxsXG4gICAgICBcbiAgICAgIGNvbnN0IHsgYm94ZXMsIGFjY2Vzc2libGVCb3hJZHMsIGhhc0FsbEFjY2VzcyB9ID0gYXdhaXQgZ2V0VXNlckFjY2Vzc2libGVCb3hlcyh1c2VySWQpXG4gICAgICBcbiAgICAgIC8vIEFkZCBoYXNBY2Nlc3MgZmxhZyB0byBlYWNoIGJveFxuICAgICAgY29uc3QgYm94ZXNXaXRoQWNjZXNzID0gYm94ZXMubWFwKGJveCA9PiAoe1xuICAgICAgICAuLi5ib3gsXG4gICAgICAgIGhhc0FjY2VzczogYWNjZXNzaWJsZUJveElkcy5pbmNsdWRlcyhib3guaWQpXG4gICAgICB9KSlcbiAgICAgIFxuICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBcbiAgICAgICAgYm94ZXM6IGJveGVzV2l0aEFjY2VzcyxcbiAgICAgICAgaGFzQWxsQWNjZXNzXG4gICAgICB9KSlcbiAgICB9XG5cbiAgICAvLyBDQVJEUyBST1VURVMgLSBOb3cgc3VwcG9ydHMgYm94IGZpbHRlcmluZ1xuICAgIGlmIChwYXRoID09PSAnY2FyZHMnKSB7XG4gICAgICBjb25zdCB7IHVzZXIgfSA9IGF3YWl0IGdldEF1dGhlbnRpY2F0ZWRVc2VyKClcbiAgICAgIGNvbnN0IGJveElkcyA9IHVybC5zZWFyY2hQYXJhbXMuZ2V0KCdib3hfaWRzJyk/LnNwbGl0KCcsJykuZmlsdGVyKEJvb2xlYW4pIHx8IFtdXG4gICAgICBcbiAgICAgIC8vIEdldCB1c2VyJ3MgYWNjZXNzaWJsZSBib3hlc1xuICAgICAgY29uc3QgeyBhY2Nlc3NpYmxlQm94SWRzIH0gPSBhd2FpdCBnZXRVc2VyQWNjZXNzaWJsZUJveGVzKHVzZXI/LmlkIHx8IG51bGwpXG4gICAgICBcbiAgICAgIC8vIERldGVybWluZSB3aGljaCBib3hlcyB0byBxdWVyeVxuICAgICAgbGV0IHF1ZXJ5Qm94SWRzID0gW11cbiAgICAgIGlmIChib3hJZHMubGVuZ3RoID4gMCkge1xuICAgICAgICBxdWVyeUJveElkcyA9IGJveElkcy5maWx0ZXIoaWQgPT4gYWNjZXNzaWJsZUJveElkcy5pbmNsdWRlcyhpZCkpXG4gICAgICAgIGlmIChxdWVyeUJveElkcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IGNhcmRzOiBbXSwgbWVzc2FnZTogJ05vIGFjY2Vzc2libGUgYm94ZXMnIH0pKVxuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYgKGFjY2Vzc2libGVCb3hJZHMubGVuZ3RoID4gMCkge1xuICAgICAgICBxdWVyeUJveElkcyA9IGFjY2Vzc2libGVCb3hJZHNcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgY2FyZHM6IFtdLCBtZXNzYWdlOiAnTm8gYWNjZXNzaWJsZSBib3hlcycgfSkpXG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIFF1ZXJ5IGNhcmRzXG4gICAgICBjb25zdCB7IGRhdGE6IGNhcmRzLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgLmZyb20oJ2NhcmRzJylcbiAgICAgICAgLnNlbGVjdCgnKicpXG4gICAgICAgIC5pbignYm94X2lkJywgcXVlcnlCb3hJZHMpXG4gICAgICAgIC5lcSgnaXNfYWN0aXZlJywgdHJ1ZSlcbiAgICAgICAgLm9yZGVyKCdjcmVhdGVkX2F0JywgeyBhc2NlbmRpbmc6IGZhbHNlIH0pXG4gICAgICBcbiAgICAgIGlmIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdbQ0FSRFMgQVBJXSBFcnJvciBmZXRjaGluZyBjYXJkczonLCBlcnJvcilcbiAgICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogZXJyb3IubWVzc2FnZSB9LCB7IHN0YXR1czogNTAwIH0pKVxuICAgICAgfVxuICAgICAgXG4gICAgICAvLyBJZiB3ZSBoYXZlIGNhcmRzLCBmZXRjaCBwaWxlcyBzZXBhcmF0ZWx5IGZvciBjYXJkIGJhY2sgaW1hZ2VzXG4gICAgICBsZXQgcGlsZXNNYXAgPSB7fVxuICAgICAgaWYgKGNhcmRzICYmIGNhcmRzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgY29uc3QgcGlsZUlkcyA9IFsuLi5uZXcgU2V0KGNhcmRzLm1hcChjID0+IGMucGlsZV9pZCkuZmlsdGVyKEJvb2xlYW4pKV1cbiAgICAgICAgaWYgKHBpbGVJZHMubGVuZ3RoID4gMCkge1xuICAgICAgICAgIGNvbnN0IHsgZGF0YTogcGlsZXMgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgICAgICAuZnJvbSgncGlsZXMnKVxuICAgICAgICAgICAgLnNlbGVjdCgnKicpXG4gICAgICAgICAgICAuaW4oJ2lkJywgcGlsZUlkcylcbiAgICAgICAgICBcbiAgICAgICAgICBpZiAocGlsZXMpIHtcbiAgICAgICAgICAgIHBpbGVzLmZvckVhY2gocCA9PiB7IHBpbGVzTWFwW3AuaWRdID0gcCB9KVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgXG4gICAgICAvLyBUcmFuc2Zvcm0gY2FyZHMgdG8gaW5jbHVkZSBwaWxlIGluZm8gZm9yIHRoZSBmcm9udGVuZFxuICAgICAgY29uc3QgdHJhbnNmb3JtZWRDYXJkcyA9IChjYXJkcyB8fCBbXSkubWFwKGNhcmQgPT4ge1xuICAgICAgICBjb25zdCBwaWxlID0gcGlsZXNNYXBbY2FyZC5waWxlX2lkXSB8fCB7fVxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGlkOiBjYXJkLmlkLFxuICAgICAgICAgIGJveF9pZDogY2FyZC5ib3hfaWQsXG4gICAgICAgICAgcGlsZV9pZDogY2FyZC5waWxlX2lkLFxuICAgICAgICAgIHRleHQ6IGNhcmQudGV4dCxcbiAgICAgICAgICBpbWFnZV9wYXRoOiBjYXJkLmltYWdlX3BhdGgsXG4gICAgICAgICAgaXNfYWN0aXZlOiBjYXJkLmlzX2FjdGl2ZSxcbiAgICAgICAgICBjcmVhdGVkX2F0OiBjYXJkLmNyZWF0ZWRfYXQsXG4gICAgICAgICAgLy8gQWRkIHBpbGUgaW5mbyBmb3IgY2FyZCBiYWNrIGltYWdlc1xuICAgICAgICAgIGNvbG9yOiBwaWxlLnNsdWcgfHwgJ2JsYWNrJywgLy8gJ2JsYWNrJyBvciAnd2hpdGUnIGZyb20gcGlsZSBzbHVnXG4gICAgICAgICAgcGlsZV9uYW1lOiBwaWxlLm5hbWUsXG4gICAgICAgICAgcGlsZV9pbWFnZTogcGlsZS5pbWFnZV9wYXRoLFxuICAgICAgICAgIC8vIExlZ2FjeSBmaWVsZHMgZm9yIGNvbXBhdGliaWxpdHlcbiAgICAgICAgICB0aXRsZTogY2FyZC50ZXh0LFxuICAgICAgICAgIGltYWdlUGF0aDogY2FyZC5pbWFnZV9wYXRoXG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgICBcbiAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgY2FyZHM6IHRyYW5zZm9ybWVkQ2FyZHMgfSkpXG4gICAgfVxuXG4gICAgLy8gU1VCU0NSSVBUSU9OIFBMQU5TXG4gICAgaWYgKHBhdGggPT09ICdwbGFucycpIHtcbiAgICAgIGNvbnN0IHsgZGF0YTogcGxhbnMsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAuZnJvbSgnc3Vic2NyaXB0aW9uX3BsYW5zJylcbiAgICAgICAgLnNlbGVjdCgnKicpXG4gICAgICAgIC5lcSgnaXNfYWN0aXZlJywgdHJ1ZSlcbiAgICAgICAgLm9yZGVyKCdwcmljZScsIHsgYXNjZW5kaW5nOiB0cnVlIH0pXG4gICAgICBcbiAgICAgIGlmIChlcnJvcikge1xuICAgICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiBlcnJvci5tZXNzYWdlIH0sIHsgc3RhdHVzOiA1MDAgfSkpXG4gICAgICB9XG4gICAgICBcbiAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgcGxhbnM6IHBsYW5zIHx8IFtdIH0pKVxuICAgIH1cblxuICAgIC8vIENPTExFQ1RJT04gU0VSSUVTIC0gUHVibGljIGVuZHBvaW50XG4gICAgaWYgKHBhdGggPT09ICdjb2xsZWN0aW9uLXNlcmllcycpIHtcbiAgICAgIGNvbnN0IHsgZGF0YTogc2VyaWVzLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgLmZyb20oJ2NvbGxlY3Rpb25fc2VyaWVzJylcbiAgICAgICAgLnNlbGVjdCgnKicpXG4gICAgICAgIC5lcSgnaXNfYWN0aXZlJywgdHJ1ZSlcbiAgICAgICAgLm9yZGVyKCdkaXNwbGF5X29yZGVyJywgeyBhc2NlbmRpbmc6IHRydWUgfSlcbiAgICAgIFxuICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfSwgeyBzdGF0dXM6IDUwMCB9KSlcbiAgICAgIH1cbiAgICAgIFxuICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBzZXJpZXM6IHNlcmllcyB8fCBbXSB9KSlcbiAgICB9XG5cbiAgICAvLyBVU0VSIFBVUkNIQVNFUyAtIEdldCB1c2VyJ3MgcHVyY2hhc2UgaGlzdG9yeVxuICAgIGlmIChwYXRoID09PSAncHVyY2hhc2VzJykge1xuICAgICAgY29uc3QgeyB1c2VyLCBlcnJvcjogYXV0aEVycm9yIH0gPSBhd2FpdCBnZXRBdXRoZW50aWNhdGVkVXNlcigpXG4gICAgICBcbiAgICAgIGlmIChhdXRoRXJyb3IgfHwgIXVzZXIpIHtcbiAgICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ1VuYXV0aG9yaXplZCcgfSwgeyBzdGF0dXM6IDQwMSB9KSlcbiAgICAgIH1cbiAgICAgIFxuICAgICAgY29uc3QgeyBkYXRhOiBwdXJjaGFzZXMsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAuZnJvbSgndXNlcl9wcm9kdWN0cycpXG4gICAgICAgIC5zZWxlY3QoJyosIGJveGVzKG5hbWUsIGNvbG9yLCBwcmljZSknKVxuICAgICAgICAuZXEoJ3VzZXJfaWQnLCB1c2VyLmlkKVxuICAgICAgICAub3JkZXIoJ2NyZWF0ZWRfYXQnLCB7IGFzY2VuZGluZzogZmFsc2UgfSlcbiAgICAgIFxuICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfSwgeyBzdGF0dXM6IDUwMCB9KSlcbiAgICAgIH1cbiAgICAgIFxuICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBwdXJjaGFzZXM6IHB1cmNoYXNlcyB8fCBbXSB9KSlcbiAgICB9XG5cbiAgICAvLyBTQVZFRCBEUkFXUyBST1VURVNcbiAgICBpZiAocGF0aCA9PT0gJ2RyYXdzJykge1xuICAgICAgY29uc3QgeyB1c2VyLCBlcnJvcjogYXV0aEVycm9yIH0gPSBhd2FpdCBnZXRBdXRoZW50aWNhdGVkVXNlcigpXG4gICAgICBcbiAgICAgIGlmIChhdXRoRXJyb3IgfHwgIXVzZXIpIHtcbiAgICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ1VuYXV0aG9yaXplZCcgfSwgeyBzdGF0dXM6IDQwMSB9KSlcbiAgICAgIH1cbiAgICAgIFxuICAgICAgY29uc3QgeyBkYXRhOiBkcmF3cywgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgIC5mcm9tKCdzYXZlZF9kcmF3cycpXG4gICAgICAgIC5zZWxlY3QoJyonKVxuICAgICAgICAuZXEoJ3VzZXJpZCcsIHVzZXIuaWQpXG4gICAgICAgIC5vcmRlcigndGltZXN0YW1wJywgeyBhc2NlbmRpbmc6IGZhbHNlIH0pXG4gICAgICBcbiAgICAgIGlmIChlcnJvcikge1xuICAgICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiBlcnJvci5tZXNzYWdlIH0sIHsgc3RhdHVzOiA1MDAgfSkpXG4gICAgICB9XG4gICAgICBcbiAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgZHJhd3M6IGRyYXdzIHx8IFtdIH0pKVxuICAgIH1cblxuICAgIC8vIEFETUlOIFJPVVRFUyAtIEdldCBhbGwgY2FyZHNcbiAgICBpZiAocGF0aCA9PT0gJ2FkbWluL2NhcmRzJykge1xuICAgICAgY29uc3QgeyB1c2VyLCBlcnJvcjogYXV0aEVycm9yIH0gPSBhd2FpdCBnZXRBdXRoZW50aWNhdGVkVXNlcigpXG4gICAgICBcbiAgICAgIGlmIChhdXRoRXJyb3IgfHwgIXVzZXIpIHtcbiAgICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ1VuYXV0aG9yaXplZCcgfSwgeyBzdGF0dXM6IDQwMSB9KSlcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8gR2V0IGNhcmRzXG4gICAgICBjb25zdCB7IGRhdGE6IGNhcmRzLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgLmZyb20oJ2NhcmRzJylcbiAgICAgICAgLnNlbGVjdCgnKicpXG4gICAgICAgIC5vcmRlcignY3JlYXRlZF9hdCcsIHsgYXNjZW5kaW5nOiBmYWxzZSB9KVxuICAgICAgXG4gICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogZXJyb3IubWVzc2FnZSB9LCB7IHN0YXR1czogNTAwIH0pKVxuICAgICAgfVxuICAgICAgXG4gICAgICAvLyBHZXQgYm94ZXMsIHBpbGVzIGFuZCBzZXJpZXMgZm9yIGVucmljaG1lbnQgLSB1c2UgUHJvbWlzZS5hbGwgZm9yIHJlbGlhYmlsaXR5XG4gICAgICBjb25zdCBbYm94ZXNSZXN1bHQsIHBpbGVzUmVzdWx0LCBzZXJpZXNSZXN1bHRdID0gYXdhaXQgUHJvbWlzZS5hbGwoW1xuICAgICAgICBzdXBhYmFzZS5mcm9tKCdib3hlcycpLnNlbGVjdCgnKicpLFxuICAgICAgICBzdXBhYmFzZS5mcm9tKCdwaWxlcycpLnNlbGVjdCgnKicpLFxuICAgICAgICBzdXBhYmFzZS5mcm9tKCdjb2xsZWN0aW9uX3NlcmllcycpLnNlbGVjdCgnKicpXG4gICAgICBdKVxuICAgICAgXG4gICAgICBjb25zdCBib3hlcyA9IGJveGVzUmVzdWx0LmRhdGEgfHwgW11cbiAgICAgIGNvbnN0IHBpbGVzID0gcGlsZXNSZXN1bHQuZGF0YSB8fCBbXVxuICAgICAgY29uc3Qgc2VyaWVzID0gc2VyaWVzUmVzdWx0LmRhdGEgfHwgW11cbiAgICAgIFxuICAgICAgY29uc3QgYm94TWFwID0ge31cbiAgICAgIGNvbnN0IHBpbGVNYXAgPSB7fVxuICAgICAgY29uc3Qgc2VyaWVzTWFwID0ge31cbiAgICAgIFxuICAgICAgYm94ZXMuZm9yRWFjaChiID0+IHsgaWYgKGIgJiYgYi5pZCkgYm94TWFwW2IuaWRdID0gYiB9KVxuICAgICAgcGlsZXMuZm9yRWFjaChwID0+IHsgaWYgKHAgJiYgcC5pZCkgcGlsZU1hcFtwLmlkXSA9IHAgfSlcbiAgICAgIHNlcmllcy5mb3JFYWNoKHMgPT4geyBpZiAocyAmJiBzLmlkKSBzZXJpZXNNYXBbcy5pZF0gPSBzIH0pXG4gICAgICBcbiAgICAgIC8vIEVucmljaCBjYXJkcyB3aXRoIGJveC9waWxlIGluZm9cbiAgICAgIGNvbnN0IGVucmljaGVkQ2FyZHMgPSAoY2FyZHMgfHwgW10pLm1hcChjYXJkID0+IHtcbiAgICAgICAgY29uc3QgYm94ID0gYm94TWFwW2NhcmQuYm94X2lkXVxuICAgICAgICBjb25zdCBwaWxlID0gcGlsZU1hcFtjYXJkLnBpbGVfaWRdXG4gICAgICAgIGNvbnN0IGNvbGxlY3Rpb25TZXJpZXMgPSBib3ggPyBzZXJpZXNNYXBbYm94LmNvbGxlY3Rpb25fc2VyaWVzX2lkXSA6IG51bGxcbiAgICAgICAgXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgLi4uY2FyZCxcbiAgICAgICAgICBib3hlczogYm94ID8ge1xuICAgICAgICAgICAgbmFtZTogYm94Lm5hbWUsXG4gICAgICAgICAgICBjb2xvcjogYm94LmNvbG9yLFxuICAgICAgICAgICAgY29sbGVjdGlvbl9zZXJpZXNfaWQ6IGJveC5jb2xsZWN0aW9uX3Nlcmllc19pZCxcbiAgICAgICAgICAgIGNvbGxlY3Rpb25fc2VyaWVzOiBjb2xsZWN0aW9uU2VyaWVzID8geyBuYW1lOiBjb2xsZWN0aW9uU2VyaWVzLm5hbWUgfSA6IG51bGxcbiAgICAgICAgICB9IDogbnVsbCxcbiAgICAgICAgICBwaWxlczogcGlsZSA/IHtcbiAgICAgICAgICAgIG5hbWU6IHBpbGUubmFtZSxcbiAgICAgICAgICAgIHNsdWc6IHBpbGUuc2x1Z1xuICAgICAgICAgIH0gOiBudWxsXG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgICBcbiAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgY2FyZHM6IGVucmljaGVkQ2FyZHMgfSkpXG4gICAgfVxuXG4gICAgLy8gQURNSU4gUk9VVEVTIC0gR2V0IGFsbCBib3hlc1xuICAgIGlmIChwYXRoID09PSAnYWRtaW4vYm94ZXMnKSB7XG4gICAgICBjb25zdCB7IHVzZXIsIGVycm9yOiBhdXRoRXJyb3IgfSA9IGF3YWl0IGdldEF1dGhlbnRpY2F0ZWRVc2VyKClcbiAgICAgIFxuICAgICAgaWYgKGF1dGhFcnJvciB8fCAhdXNlcikge1xuICAgICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnVW5hdXRob3JpemVkJyB9LCB7IHN0YXR1czogNDAxIH0pKVxuICAgICAgfVxuICAgICAgXG4gICAgICAvLyBHZXQgYm94ZXNcbiAgICAgIGNvbnN0IHsgZGF0YTogYm94ZXMsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAuZnJvbSgnYm94ZXMnKVxuICAgICAgICAuc2VsZWN0KCcqJylcbiAgICAgICAgLm9yZGVyKCdkaXNwbGF5X29yZGVyJywgeyBhc2NlbmRpbmc6IHRydWUgfSlcbiAgICAgIFxuICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfSwgeyBzdGF0dXM6IDUwMCB9KSlcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8gR2V0IGFsbCByZWxhdGVkIGRhdGEgLSB1c2UgUHJvbWlzZS5hbGwgZm9yIHBhcmFsbGVsIGZldGNoaW5nXG4gICAgICBjb25zdCBbY2FyZHNSZXN1bHQsIHBpbGVzUmVzdWx0LCBzZXJpZXNSZXN1bHQsIHByaWNlc1Jlc3VsdF0gPSBhd2FpdCBQcm9taXNlLmFsbChbXG4gICAgICAgIHN1cGFiYXNlLmZyb20oJ2NhcmRzJykuc2VsZWN0KCcqJyksXG4gICAgICAgIHN1cGFiYXNlLmZyb20oJ3BpbGVzJykuc2VsZWN0KCcqJyksXG4gICAgICAgIHN1cGFiYXNlLmZyb20oJ2NvbGxlY3Rpb25fc2VyaWVzJykuc2VsZWN0KCcqJyksXG4gICAgICAgIHN1cGFiYXNlLmZyb20oJ3ByaWNlcycpLnNlbGVjdCgnKicpXG4gICAgICBdKVxuICAgICAgXG4gICAgICBjb25zdCBjYXJkcyA9IGNhcmRzUmVzdWx0LmRhdGEgfHwgW11cbiAgICAgIGNvbnN0IHBpbGVzID0gcGlsZXNSZXN1bHQuZGF0YSB8fCBbXVxuICAgICAgY29uc3Qgc2VyaWVzID0gc2VyaWVzUmVzdWx0LmRhdGEgfHwgW11cbiAgICAgIGNvbnN0IHByaWNlcyA9IHByaWNlc1Jlc3VsdC5kYXRhIHx8IFtdXG4gICAgICBcbiAgICAgIC8vIExvZyBmb3IgZGVidWdnaW5nXG4gICAgICBjb25zb2xlLmxvZyhgW2FkbWluL2JveGVzXSBMb2FkZWQgJHtib3hlcz8ubGVuZ3RoIHx8IDB9IGJveGVzLCAke3Nlcmllcy5sZW5ndGh9IHNlcmllcywgJHtwaWxlcy5sZW5ndGh9IHBpbGVzLCAke3ByaWNlcy5sZW5ndGh9IHByaWNlc2ApXG4gICAgICBcbiAgICAgIGNvbnN0IHNlcmllc01hcCA9IHt9XG4gICAgICBjb25zdCBwcmljZU1hcCA9IHt9XG4gICAgICBjb25zdCBwaWxlTWFwID0ge31cbiAgICAgIFxuICAgICAgc2VyaWVzLmZvckVhY2gocyA9PiB7IGlmIChzICYmIHMuaWQpIHNlcmllc01hcFtzLmlkXSA9IHMgfSlcbiAgICAgIHByaWNlcy5mb3JFYWNoKHAgPT4geyBpZiAocCAmJiBwLmlkKSBwcmljZU1hcFtwLmlkXSA9IHAgfSlcbiAgICAgIHBpbGVzLmZvckVhY2gocCA9PiB7IGlmIChwICYmIHAuaWQpIHBpbGVNYXBbcC5pZF0gPSBwIH0pXG4gICAgICBcbiAgICAgIC8vIENvdW50IGNhcmRzIHBlciBib3ggcGVyIHBpbGVcbiAgICAgIGNvbnN0IGNhcmRDb3VudHMgPSB7fVxuICAgICAgaWYgKGNhcmRzKSB7XG4gICAgICAgIGNhcmRzLmZvckVhY2goY2FyZCA9PiB7XG4gICAgICAgICAgY29uc3Qga2V5ID0gYCR7Y2FyZC5ib3hfaWR9YFxuICAgICAgICAgIGlmICghY2FyZENvdW50c1trZXldKSB7XG4gICAgICAgICAgICBjYXJkQ291bnRzW2tleV0gPSB7IHRvdGFsOiAwLCBieVBpbGU6IHt9IH1cbiAgICAgICAgICB9XG4gICAgICAgICAgY2FyZENvdW50c1trZXldLnRvdGFsKytcbiAgICAgICAgICBcbiAgICAgICAgICBjb25zdCBwaWxlSWQgPSBjYXJkLnBpbGVfaWRcbiAgICAgICAgICBpZiAoIWNhcmRDb3VudHNba2V5XS5ieVBpbGVbcGlsZUlkXSkge1xuICAgICAgICAgICAgY2FyZENvdW50c1trZXldLmJ5UGlsZVtwaWxlSWRdID0geyBjb3VudDogMCwgcGlsZU5hbWU6IHBpbGVNYXBbcGlsZUlkXT8ubmFtZSB8fCAnVW5rbm93bicsIHBpbGVTbHVnOiBwaWxlTWFwW3BpbGVJZF0/LnNsdWcgfHwgJycgfVxuICAgICAgICAgIH1cbiAgICAgICAgICBjYXJkQ291bnRzW2tleV0uYnlQaWxlW3BpbGVJZF0uY291bnQrK1xuICAgICAgICB9KVxuICAgICAgfVxuICAgICAgXG4gICAgICAvLyBFbnJpY2ggYm94ZXMgd2l0aCByZWxhdGVkIGRhdGFcbiAgICAgIGNvbnN0IGVucmljaGVkQm94ZXMgPSAoYm94ZXMgfHwgW10pLm1hcChib3ggPT4gKHtcbiAgICAgICAgLi4uYm94LFxuICAgICAgICBjb2xsZWN0aW9uX3Nlcmllczogc2VyaWVzTWFwW2JveC5jb2xsZWN0aW9uX3Nlcmllc19pZF0gfHwgbnVsbCxcbiAgICAgICAgcHJpY2VzOiBwcmljZU1hcFtib3gucHJpY2VfaWRdIHx8IG51bGwsXG4gICAgICAgIGNhcmRTdGF0czogY2FyZENvdW50c1tib3guaWRdIHx8IHsgdG90YWw6IDAsIGJ5UGlsZToge30gfVxuICAgICAgfSkpXG4gICAgICBcbiAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgYm94ZXM6IGVucmljaGVkQm94ZXMsIHBpbGVzOiBwaWxlcyB8fCBbXSB9KSlcbiAgICB9XG5cbiAgICAvLyBBRE1JTiBST1VURVMgLSBHZXQgYWxsIGNvbGxlY3Rpb24gc2VyaWVzXG4gICAgaWYgKHBhdGggPT09ICdhZG1pbi9jb2xsZWN0aW9uLXNlcmllcycpIHtcbiAgICAgIGNvbnN0IHsgdXNlciwgZXJyb3I6IGF1dGhFcnJvciB9ID0gYXdhaXQgZ2V0QXV0aGVudGljYXRlZFVzZXIoKVxuICAgICAgXG4gICAgICBpZiAoYXV0aEVycm9yIHx8ICF1c2VyKSB7XG4gICAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdVbmF1dGhvcml6ZWQnIH0sIHsgc3RhdHVzOiA0MDEgfSkpXG4gICAgICB9XG4gICAgICBcbiAgICAgIGNvbnN0IHsgZGF0YTogc2VyaWVzLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgLmZyb20oJ2NvbGxlY3Rpb25fc2VyaWVzJylcbiAgICAgICAgLnNlbGVjdCgnKicpXG4gICAgICAgIC5vcmRlcignZGlzcGxheV9vcmRlcicsIHsgYXNjZW5kaW5nOiB0cnVlIH0pXG4gICAgICBcbiAgICAgIGlmIChlcnJvcikge1xuICAgICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiBlcnJvci5tZXNzYWdlIH0sIHsgc3RhdHVzOiA1MDAgfSkpXG4gICAgICB9XG4gICAgICBcbiAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgc2VyaWVzOiBzZXJpZXMgfHwgW10gfSkpXG4gICAgfVxuXG4gICAgLy8gQURNSU4gUk9VVEVTIC0gR2V0IGFsbCBwcmljZXNcbiAgICBpZiAocGF0aCA9PT0gJ2FkbWluL3ByaWNlcycpIHtcbiAgICAgIGNvbnN0IHsgdXNlciwgZXJyb3I6IGF1dGhFcnJvciB9ID0gYXdhaXQgZ2V0QXV0aGVudGljYXRlZFVzZXIoKVxuICAgICAgXG4gICAgICBpZiAoYXV0aEVycm9yIHx8ICF1c2VyKSB7XG4gICAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdVbmF1dGhvcml6ZWQnIH0sIHsgc3RhdHVzOiA0MDEgfSkpXG4gICAgICB9XG4gICAgICBcbiAgICAgIGNvbnN0IHsgZGF0YTogcHJpY2VzLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgLmZyb20oJ3ByaWNlcycpXG4gICAgICAgIC5zZWxlY3QoJyonKVxuICAgICAgICAub3JkZXIoJ2Rpc3BsYXlfb3JkZXInLCB7IGFzY2VuZGluZzogdHJ1ZSB9KVxuICAgICAgXG4gICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogZXJyb3IubWVzc2FnZSB9LCB7IHN0YXR1czogNTAwIH0pKVxuICAgICAgfVxuICAgICAgXG4gICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IHByaWNlczogcHJpY2VzIHx8IFtdIH0pKVxuICAgIH1cblxuICAgIC8vIEFETUlOIFJPVVRFUyAtIEdldCBhbGwgcGlsZXNcbiAgICBpZiAocGF0aCA9PT0gJ2FkbWluL3BpbGVzJykge1xuICAgICAgY29uc3QgeyB1c2VyLCBlcnJvcjogYXV0aEVycm9yIH0gPSBhd2FpdCBnZXRBdXRoZW50aWNhdGVkVXNlcigpXG4gICAgICBcbiAgICAgIGlmIChhdXRoRXJyb3IgfHwgIXVzZXIpIHtcbiAgICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ1VuYXV0aG9yaXplZCcgfSwgeyBzdGF0dXM6IDQwMSB9KSlcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8gR2V0IHBpbGVzIGZpcnN0XG4gICAgICBjb25zdCB7IGRhdGE6IHBpbGVzLCBlcnJvcjogcGlsZXNFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgLmZyb20oJ3BpbGVzJylcbiAgICAgICAgLnNlbGVjdCgnKicpXG4gICAgICAgIC5vcmRlcignZGlzcGxheV9vcmRlcicsIHsgYXNjZW5kaW5nOiB0cnVlIH0pXG4gICAgICBcbiAgICAgIGlmIChwaWxlc0Vycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBsb2FkIHBpbGVzOicsIHBpbGVzRXJyb3IpXG4gICAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IHBpbGVzRXJyb3IubWVzc2FnZSB9LCB7IHN0YXR1czogNTAwIH0pKVxuICAgICAgfVxuICAgICAgXG4gICAgICAvLyBHZXQgYWxsIHNlcmllcyBmb3IgbWFwcGluZyAtIGRvIHRoaXMgYXMgYSBzZXBhcmF0ZSBndWFyYW50ZWVkIHF1ZXJ5XG4gICAgICBjb25zdCB7IGRhdGE6IHNlcmllcywgZXJyb3I6IHNlcmllc0Vycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAuZnJvbSgnY29sbGVjdGlvbl9zZXJpZXMnKVxuICAgICAgICAuc2VsZWN0KCcqJylcbiAgICAgIFxuICAgICAgaWYgKHNlcmllc0Vycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBsb2FkIGNvbGxlY3Rpb25fc2VyaWVzOicsIHNlcmllc0Vycm9yKVxuICAgICAgfVxuICAgICAgXG4gICAgICAvLyBCdWlsZCBzZXJpZXMgbG9va3VwIG1hcFxuICAgICAgY29uc3Qgc2VyaWVzTWFwID0ge31cbiAgICAgIGlmIChzZXJpZXMgJiYgQXJyYXkuaXNBcnJheShzZXJpZXMpKSB7XG4gICAgICAgIHNlcmllcy5mb3JFYWNoKHMgPT4geyBcbiAgICAgICAgICBpZiAocyAmJiBzLmlkKSB7XG4gICAgICAgICAgICBzZXJpZXNNYXBbcy5pZF0gPSBzIFxuICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8gTG9nIGZvciBkZWJ1Z2dpbmdcbiAgICAgIGNvbnNvbGUubG9nKGBbYWRtaW4vcGlsZXNdIExvYWRlZCAkeyhwaWxlcyB8fCBbXSkubGVuZ3RofSBwaWxlcywgJHtPYmplY3Qua2V5cyhzZXJpZXNNYXApLmxlbmd0aH0gc2VyaWVzYClcbiAgICAgIFxuICAgICAgLy8gRW5yaWNoIHBpbGVzIHdpdGggc2VyaWVzIGRhdGFcbiAgICAgIGNvbnN0IGVucmljaGVkUGlsZXMgPSAocGlsZXMgfHwgW10pLm1hcChwID0+IHtcbiAgICAgICAgY29uc3Qgc2VyaWVzRGF0YSA9IHAuY29sbGVjdGlvbl9zZXJpZXNfaWQgPyBzZXJpZXNNYXBbcC5jb2xsZWN0aW9uX3Nlcmllc19pZF0gOiBudWxsXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgLi4ucCxcbiAgICAgICAgICBjb2xsZWN0aW9uX3Nlcmllczogc2VyaWVzRGF0YSB8fCBudWxsXG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgICBcbiAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgcGlsZXM6IGVucmljaGVkUGlsZXMgfSkpXG4gICAgfVxuXG4gICAgLy8gQURNSU4gUk9VVEVTIC0gR2V0IGFsbCBidW5kbGVzXG4gICAgaWYgKHBhdGggPT09ICdhZG1pbi9idW5kbGVzJykge1xuICAgICAgY29uc3QgeyB1c2VyLCBlcnJvcjogYXV0aEVycm9yIH0gPSBhd2FpdCBnZXRBdXRoZW50aWNhdGVkVXNlcigpXG4gICAgICBcbiAgICAgIGlmIChhdXRoRXJyb3IgfHwgIXVzZXIpIHtcbiAgICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ1VuYXV0aG9yaXplZCcgfSwgeyBzdGF0dXM6IDQwMSB9KSlcbiAgICAgIH1cbiAgICAgIFxuICAgICAgY29uc3QgeyBkYXRhOiBidW5kbGVzLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgLmZyb20oJ2J1bmRsZXMnKVxuICAgICAgICAuc2VsZWN0KCcqJylcbiAgICAgICAgLm9yZGVyKCdkaXNwbGF5X29yZGVyJywgeyBhc2NlbmRpbmc6IHRydWUgfSlcbiAgICAgIFxuICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfSwgeyBzdGF0dXM6IDUwMCB9KSlcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8gRW5yaWNoIHdpdGggcHJpY2UgaW5mb1xuICAgICAgY29uc3QgeyBkYXRhOiBwcmljZXMgfSA9IGF3YWl0IHN1cGFiYXNlLmZyb20oJ3ByaWNlcycpLnNlbGVjdCgnKicpXG4gICAgICBjb25zdCBwcmljZU1hcCA9IHt9XG4gICAgICBpZiAocHJpY2VzKSBwcmljZXMuZm9yRWFjaChwID0+IHsgcHJpY2VNYXBbcC5pZF0gPSBwIH0pXG4gICAgICBcbiAgICAgIGNvbnN0IGVucmljaGVkQnVuZGxlcyA9IChidW5kbGVzIHx8IFtdKS5tYXAoYiA9PiAoe1xuICAgICAgICAuLi5iLFxuICAgICAgICBwcmljZXM6IHByaWNlTWFwW2IucHJpY2VfaWRdIHx8IG51bGxcbiAgICAgIH0pKVxuICAgICAgXG4gICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IGJ1bmRsZXM6IGVucmljaGVkQnVuZGxlcyB9KSlcbiAgICAgIFxuICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBidW5kbGVzOiBidW5kbGVzIHx8IFtdIH0pKVxuICAgIH1cblxuICAgIC8vIFBVQkxJQyBST1VURVMgLSBHZXQgYWN0aXZlIHByaWNlcyBmb3Igc3RvcmVcbiAgICBpZiAocGF0aCA9PT0gJ3N0b3JlL3ByaWNlcycpIHtcbiAgICAgIGNvbnN0IHsgZGF0YTogcHJpY2VzLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgLmZyb20oJ3ByaWNlcycpXG4gICAgICAgIC5zZWxlY3QoJyonKVxuICAgICAgICAuZXEoJ2lzX2FjdGl2ZScsIHRydWUpXG4gICAgICAgIC5vcmRlcignZGlzcGxheV9vcmRlcicsIHsgYXNjZW5kaW5nOiB0cnVlIH0pXG4gICAgICBcbiAgICAgIGlmIChlcnJvcikge1xuICAgICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiBlcnJvci5tZXNzYWdlIH0sIHsgc3RhdHVzOiA1MDAgfSkpXG4gICAgICB9XG4gICAgICBcbiAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgcHJpY2VzOiBwcmljZXMgfHwgW10gfSkpXG4gICAgfVxuXG4gICAgLy8gUFVCTElDIFJPVVRFUyAtIEdldCBhY3RpdmUgYnVuZGxlcyBmb3Igc3RvcmVcbiAgICBpZiAocGF0aCA9PT0gJ3N0b3JlL2J1bmRsZXMnKSB7XG4gICAgICBjb25zdCB7IGRhdGE6IGJ1bmRsZXMsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAuZnJvbSgnYnVuZGxlcycpXG4gICAgICAgIC5zZWxlY3QoJyosIHByaWNlcyhpZCwgbGFiZWwsIGFtb3VudCwgY3VycmVuY3ksIGlzX21lbWJlcnNoaXAsIG1lbWJlcnNoaXBfZGF5cyknKVxuICAgICAgICAuZXEoJ2lzX2FjdGl2ZScsIHRydWUpXG4gICAgICAgIC5vcmRlcignZGlzcGxheV9vcmRlcicsIHsgYXNjZW5kaW5nOiB0cnVlIH0pXG4gICAgICBcbiAgICAgIGlmIChlcnJvcikge1xuICAgICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiBlcnJvci5tZXNzYWdlIH0sIHsgc3RhdHVzOiA1MDAgfSkpXG4gICAgICB9XG4gICAgICBcbiAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgYnVuZGxlczogYnVuZGxlcyB8fCBbXSB9KSlcbiAgICB9XG5cbiAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnUm91dGUgbm90IGZvdW5kJyB9LCB7IHN0YXR1czogNDA0IH0pKVxuICAgIFxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0FQSSBFcnJvcjonLCBlcnJvcilcbiAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiBlcnJvci5tZXNzYWdlIH0sIHsgc3RhdHVzOiA1MDAgfSkpXG4gIH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIFBPU1QocmVxdWVzdCkge1xuICBjb25zdCB1cmwgPSBuZXcgVVJMKHJlcXVlc3QudXJsKVxuICBjb25zdCBwYXRoID0gdXJsLnBhdGhuYW1lLnJlcGxhY2UoJy9hcGkvJywgJycpXG4gIGNvbnN0IHN1cGFiYXNlID0gY3JlYXRlU3VwYWJhc2VTZXJ2ZXIoKVxuICBjb25zdCBzdXBhYmFzZUFkbWluID0gZ2V0U3VwYWJhc2VBZG1pbigpIC8vIFNlcnZpY2Ugcm9sZSBjbGllbnQgZm9yIGFkbWluIG9wZXJhdGlvbnNcblxuICB0cnkge1xuICAgIGNvbnN0IGJvZHkgPSBhd2FpdCByZXF1ZXN0Lmpzb24oKVxuXG4gICAgLy8gQVVUSCBST1VURVNcbiAgICBpZiAocGF0aCA9PT0gJ2F1dGgvc2lnbnVwJykge1xuICAgICAgY29uc3QgeyBlbWFpbCwgcGFzc3dvcmQgfSA9IGJvZHlcbiAgICAgIFxuICAgICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2UuYXV0aC5zaWduVXAoe1xuICAgICAgICBlbWFpbCxcbiAgICAgICAgcGFzc3dvcmQsXG4gICAgICB9KVxuICAgICAgXG4gICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogZXJyb3IubWVzc2FnZSB9LCB7IHN0YXR1czogNDAwIH0pKVxuICAgICAgfVxuICAgICAgXG4gICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IHVzZXI6IGRhdGEudXNlciB9KSlcbiAgICB9XG5cbiAgICBpZiAocGF0aCA9PT0gJ2F1dGgvc2lnbmluJykge1xuICAgICAgY29uc3QgeyBlbWFpbCwgcGFzc3dvcmQgfSA9IGJvZHlcbiAgICAgIFxuICAgICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2UuYXV0aC5zaWduSW5XaXRoUGFzc3dvcmQoe1xuICAgICAgICBlbWFpbCxcbiAgICAgICAgcGFzc3dvcmQsXG4gICAgICB9KVxuICAgICAgXG4gICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogZXJyb3IubWVzc2FnZSB9LCB7IHN0YXR1czogNDAwIH0pKVxuICAgICAgfVxuICAgICAgXG4gICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IHVzZXI6IGRhdGEudXNlciB9KSlcbiAgICB9XG5cbiAgICBpZiAocGF0aCA9PT0gJ2F1dGgvc2lnbm91dCcpIHtcbiAgICAgIGNvbnN0IHsgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlLmF1dGguc2lnbk91dCgpXG4gICAgICBcbiAgICAgIGlmIChlcnJvcikge1xuICAgICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiBlcnJvci5tZXNzYWdlIH0sIHsgc3RhdHVzOiA0MDAgfSkpXG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIENyZWF0ZSByZXNwb25zZSBhbmQgY2xlYXIgYXV0aCBjb29raWVzXG4gICAgICBjb25zdCByZXNwb25zZSA9IE5leHRSZXNwb25zZS5qc29uKHsgc3VjY2VzczogdHJ1ZSB9KVxuICAgICAgXG4gICAgICAvLyBDbGVhciBTdXBhYmFzZSBhdXRoIGNvb2tpZXMgYnkgc2V0dGluZyB0aGVtIHRvIGV4cGlyZVxuICAgICAgY29uc3QgY29va2llT3B0aW9ucyA9IHtcbiAgICAgICAgcGF0aDogJy8nLFxuICAgICAgICBleHBpcmVzOiBuZXcgRGF0ZSgwKSxcbiAgICAgICAgbWF4QWdlOiAwXG4gICAgICB9XG4gICAgICBcbiAgICAgIHJlc3BvbnNlLmNvb2tpZXMuc2V0KCdzYi1hY2Nlc3MtdG9rZW4nLCAnJywgY29va2llT3B0aW9ucylcbiAgICAgIHJlc3BvbnNlLmNvb2tpZXMuc2V0KCdzYi1yZWZyZXNoLXRva2VuJywgJycsIGNvb2tpZU9wdGlvbnMpXG4gICAgICBcbiAgICAgIC8vIEFsc28gdHJ5IHRvIGNsZWFyIGFueSBTdXBhYmFzZSBwcm9qZWN0LXNwZWNpZmljIGNvb2tpZXNcbiAgICAgIGNvbnN0IHN1cGFiYXNlVXJsID0gcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMIHx8ICcnXG4gICAgICBjb25zdCBwcm9qZWN0UmVmID0gc3VwYWJhc2VVcmwubWF0Y2goL2h0dHBzOlxcL1xcLyhbXi5dKykvKT8uWzFdXG4gICAgICBpZiAocHJvamVjdFJlZikge1xuICAgICAgICByZXNwb25zZS5jb29raWVzLnNldChgc2ItJHtwcm9qZWN0UmVmfS1hdXRoLXRva2VuYCwgJycsIGNvb2tpZU9wdGlvbnMpXG4gICAgICAgIHJlc3BvbnNlLmNvb2tpZXMuc2V0KGBzYi0ke3Byb2plY3RSZWZ9LWF1dGgtdG9rZW4tY29kZS12ZXJpZmllcmAsICcnLCBjb29raWVPcHRpb25zKVxuICAgICAgfVxuICAgICAgXG4gICAgICByZXR1cm4gaGFuZGxlQ09SUyhyZXNwb25zZSlcbiAgICB9XG5cbiAgICBpZiAocGF0aCA9PT0gJ2F1dGgvZ29vZ2xlJykge1xuICAgICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2UuYXV0aC5zaWduSW5XaXRoT0F1dGgoe1xuICAgICAgICBwcm92aWRlcjogJ2dvb2dsZScsXG4gICAgICAgIG9wdGlvbnM6IHtcbiAgICAgICAgICByZWRpcmVjdFRvOiBgJHtwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19CQVNFX1VSTH0vYXV0aC9jYWxsYmFja2BcbiAgICAgICAgfVxuICAgICAgfSlcbiAgICAgIFxuICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfSwgeyBzdGF0dXM6IDQwMCB9KSlcbiAgICAgIH1cbiAgICAgIFxuICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyB1cmw6IGRhdGEudXJsIH0pKVxuICAgIH1cblxuICAgIC8vIFBhc3N3b3JkIFJlc2V0IFJlcXVlc3RcbiAgICBpZiAocGF0aCA9PT0gJ2F1dGgvcmVzZXQtcGFzc3dvcmQnKSB7XG4gICAgICBjb25zdCB7IGVtYWlsIH0gPSBib2R5XG4gICAgICBcbiAgICAgIGlmICghZW1haWwpIHtcbiAgICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ0VtYWlsIGlzIHJlcXVpcmVkJyB9LCB7IHN0YXR1czogNDAwIH0pKVxuICAgICAgfVxuICAgICAgXG4gICAgICBjb25zdCB7IGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZS5hdXRoLnJlc2V0UGFzc3dvcmRGb3JFbWFpbChlbWFpbCwge1xuICAgICAgICByZWRpcmVjdFRvOiBgJHtwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19CQVNFX1VSTH0vYXV0aC9yZXNldC1jYWxsYmFja2BcbiAgICAgIH0pXG4gICAgICBcbiAgICAgIGlmIChlcnJvcikge1xuICAgICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiBlcnJvci5tZXNzYWdlIH0sIHsgc3RhdHVzOiA0MDAgfSkpXG4gICAgICB9XG4gICAgICBcbiAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgc3VjY2VzczogdHJ1ZSwgbWVzc2FnZTogJ1Bhc3N3b3JkIHJlc2V0IGVtYWlsIHNlbnQnIH0pKVxuICAgIH1cblxuICAgIC8vIFNBVkVEIERSQVdTXG4gICAgaWYgKHBhdGggPT09ICdkcmF3cy9zYXZlJykge1xuICAgICAgY29uc3QgeyB1c2VyLCBlcnJvcjogYXV0aEVycm9yIH0gPSBhd2FpdCBnZXRBdXRoZW50aWNhdGVkVXNlcigpXG4gICAgICBcbiAgICAgIGlmIChhdXRoRXJyb3IgfHwgIXVzZXIpIHtcbiAgICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ1VuYXV0aG9yaXplZCcgfSwgeyBzdGF0dXM6IDQwMSB9KSlcbiAgICAgIH1cbiAgICAgIFxuICAgICAgY29uc3QgeyBibGFja0NhcmRJZCwgd2hpdGVDYXJkSWQsIGJsYWNrQ2FyZFRpdGxlLCB3aGl0ZUNhcmRUaXRsZSB9ID0gYm9keVxuICAgICAgXG4gICAgICBjb25zdCBkcmF3ID0ge1xuICAgICAgICBpZDogdXVpZHY0KCksXG4gICAgICAgIHVzZXJpZDogdXNlci5pZCxcbiAgICAgICAgdXNlcmVtYWlsOiB1c2VyLmVtYWlsLFxuICAgICAgICBibGFja2NhcmRpZDogYmxhY2tDYXJkSWQsXG4gICAgICAgIHdoaXRlY2FyZGlkOiB3aGl0ZUNhcmRJZCxcbiAgICAgICAgYmxhY2tjYXJkdGl0bGU6IGJsYWNrQ2FyZFRpdGxlLFxuICAgICAgICB3aGl0ZWNhcmR0aXRsZTogd2hpdGVDYXJkVGl0bGUsXG4gICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXG4gICAgICB9XG4gICAgICBcbiAgICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlQWRtaW5cbiAgICAgICAgLmZyb20oJ3NhdmVkX2RyYXdzJylcbiAgICAgICAgLmluc2VydChbZHJhd10pXG4gICAgICAgIC5zZWxlY3QoKVxuICAgICAgICAuc2luZ2xlKClcbiAgICAgIFxuICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfSwgeyBzdGF0dXM6IDUwMCB9KSlcbiAgICAgIH1cbiAgICAgIFxuICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBkcmF3OiBkYXRhIH0pKVxuICAgIH1cblxuICAgIC8vIFBBWU1FTlQgUk9VVEVTIC0gUHVyY2hhc2UgYSBzaW5nbGUgYm94XG4gICAgaWYgKHBhdGggPT09ICdwYXltZW50L3B1cmNoYXNlLWJveCcpIHtcbiAgICAgIGNvbnN0IHsgdXNlciwgZXJyb3I6IGF1dGhFcnJvciB9ID0gYXdhaXQgZ2V0QXV0aGVudGljYXRlZFVzZXIoKVxuICAgICAgXG4gICAgICBpZiAoYXV0aEVycm9yIHx8ICF1c2VyKSB7XG4gICAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdVbmF1dGhvcml6ZWQnIH0sIHsgc3RhdHVzOiA0MDEgfSkpXG4gICAgICB9XG4gICAgICBcbiAgICAgIGNvbnN0IHsgYm94SWQgfSA9IGJvZHlcbiAgICAgIFxuICAgICAgLy8gR2V0IGJveCBkZXRhaWxzXG4gICAgICBjb25zdCB7IGRhdGE6IGJveCwgZXJyb3I6IGJveEVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAuZnJvbSgnYm94ZXMnKVxuICAgICAgICAuc2VsZWN0KCcqJylcbiAgICAgICAgLmVxKCdpZCcsIGJveElkKVxuICAgICAgICAuc2luZ2xlKClcbiAgICAgIFxuICAgICAgaWYgKGJveEVycm9yIHx8ICFib3gpIHtcbiAgICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ0JveCBub3QgZm91bmQnIH0sIHsgc3RhdHVzOiA0MDQgfSkpXG4gICAgICB9XG4gICAgICBcbiAgICAgIGlmIChib3guaXNfc2FtcGxlKSB7XG4gICAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdTYW1wbGUgYm94IGlzIGZyZWUnIH0sIHsgc3RhdHVzOiA0MDAgfSkpXG4gICAgICB9XG4gICAgICBcbiAgICAgIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBnZXRTdHJpcGUoKS5jaGVja291dC5zZXNzaW9ucy5jcmVhdGUoe1xuICAgICAgICBwYXltZW50X21ldGhvZF90eXBlczogWydjYXJkJ10sXG4gICAgICAgIGxpbmVfaXRlbXM6IFt7XG4gICAgICAgICAgcHJpY2VfZGF0YToge1xuICAgICAgICAgICAgY3VycmVuY3k6ICd1c2QnLFxuICAgICAgICAgICAgcHJvZHVjdF9kYXRhOiB7XG4gICAgICAgICAgICAgIG5hbWU6IGBBUyBXRSBBTEwgQVJFIC0gJHtib3gubmFtZX1gLFxuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogYm94LmRlc2NyaXB0aW9uIHx8IGBVbmxvY2sgdGhlICR7Ym94Lm5hbWV9IGNhcmQgY29sbGVjdGlvbmBcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB1bml0X2Ftb3VudDogTWF0aC5yb3VuZChib3gucHJpY2UgKiAxMDApLFxuICAgICAgICAgIH0sXG4gICAgICAgICAgcXVhbnRpdHk6IDEsXG4gICAgICAgIH1dLFxuICAgICAgICBtb2RlOiAncGF5bWVudCcsXG4gICAgICAgIHN1Y2Nlc3NfdXJsOiBgJHtwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19CQVNFX1VSTH0/cGF5bWVudD1zdWNjZXNzJmJveD0ke2JveElkfWAsXG4gICAgICAgIGNhbmNlbF91cmw6IGAke3Byb2Nlc3MuZW52Lk5FWFRfUFVCTElDX0JBU0VfVVJMfT9wYXltZW50PWNhbmNlbGxlZGAsXG4gICAgICAgIGNsaWVudF9yZWZlcmVuY2VfaWQ6IHVzZXIuaWQsXG4gICAgICAgIGN1c3RvbWVyX2VtYWlsOiB1c2VyLmVtYWlsLFxuICAgICAgICBtZXRhZGF0YToge1xuICAgICAgICAgIGJveF9pZDogYm94SWQsXG4gICAgICAgICAgcHVyY2hhc2VfdHlwZTogJ29uZV90aW1lJ1xuICAgICAgICB9XG4gICAgICB9KVxuICAgICAgXG4gICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IHVybDogc2Vzc2lvbi51cmwgfSkpXG4gICAgfVxuXG4gICAgLy8gUEFZTUVOVCBST1VURVMgLSBTdWJzY3JpYmUgdG8gYWxsIGFjY2Vzc1xuICAgIGlmIChwYXRoID09PSAncGF5bWVudC9zdWJzY3JpYmUtYWxsJykge1xuICAgICAgY29uc3QgeyB1c2VyLCBlcnJvcjogYXV0aEVycm9yIH0gPSBhd2FpdCBnZXRBdXRoZW50aWNhdGVkVXNlcigpXG4gICAgICBcbiAgICAgIGlmIChhdXRoRXJyb3IgfHwgIXVzZXIpIHtcbiAgICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ1VuYXV0aG9yaXplZCcgfSwgeyBzdGF0dXM6IDQwMSB9KSlcbiAgICAgIH1cbiAgICAgIFxuICAgICAgY29uc3QgeyBwbGFuSWQgfSA9IGJvZHlcbiAgICAgIFxuICAgICAgLy8gR2V0IHBsYW4gZGV0YWlsc1xuICAgICAgY29uc3QgeyBkYXRhOiBwbGFuLCBlcnJvcjogcGxhbkVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAuZnJvbSgnc3Vic2NyaXB0aW9uX3BsYW5zJylcbiAgICAgICAgLnNlbGVjdCgnKicpXG4gICAgICAgIC5lcSgnaWQnLCBwbGFuSWQpXG4gICAgICAgIC5zaW5nbGUoKVxuICAgICAgXG4gICAgICBpZiAocGxhbkVycm9yIHx8ICFwbGFuKSB7XG4gICAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdQbGFuIG5vdCBmb3VuZCcgfSwgeyBzdGF0dXM6IDQwNCB9KSlcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8gQ2FsY3VsYXRlIGludGVydmFsXG4gICAgICBsZXQgaW50ZXJ2YWwgPSAnbW9udGgnXG4gICAgICBsZXQgaW50ZXJ2YWxDb3VudCA9IDFcbiAgICAgIGlmIChwbGFuLmludGVydmFsID09PSAncXVhcnRlcicpIHtcbiAgICAgICAgaW50ZXJ2YWwgPSAnbW9udGgnXG4gICAgICAgIGludGVydmFsQ291bnQgPSAzXG4gICAgICB9IGVsc2UgaWYgKHBsYW4uaW50ZXJ2YWwgPT09ICd5ZWFyJykge1xuICAgICAgICBpbnRlcnZhbCA9ICd5ZWFyJ1xuICAgICAgICBpbnRlcnZhbENvdW50ID0gMVxuICAgICAgfVxuICAgICAgXG4gICAgICBjb25zdCBzZXNzaW9uID0gYXdhaXQgZ2V0U3RyaXBlKCkuY2hlY2tvdXQuc2Vzc2lvbnMuY3JlYXRlKHtcbiAgICAgICAgcGF5bWVudF9tZXRob2RfdHlwZXM6IFsnY2FyZCddLFxuICAgICAgICBsaW5lX2l0ZW1zOiBbe1xuICAgICAgICAgIHByaWNlX2RhdGE6IHtcbiAgICAgICAgICAgIGN1cnJlbmN5OiAndXNkJyxcbiAgICAgICAgICAgIHByb2R1Y3RfZGF0YToge1xuICAgICAgICAgICAgICBuYW1lOiBgQVMgV0UgQUxMIEFSRSAtICR7cGxhbi5uYW1lfWAsXG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBwbGFuLmRlc2NyaXB0aW9uIHx8ICdGdWxsIGFjY2VzcyB0byBhbGwgY2FyZCBib3hlcydcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB1bml0X2Ftb3VudDogTWF0aC5yb3VuZChwbGFuLnByaWNlICogMTAwKSxcbiAgICAgICAgICAgIHJlY3VycmluZzoge1xuICAgICAgICAgICAgICBpbnRlcnZhbCxcbiAgICAgICAgICAgICAgaW50ZXJ2YWxfY291bnQ6IGludGVydmFsQ291bnQsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0sXG4gICAgICAgICAgcXVhbnRpdHk6IDEsXG4gICAgICAgIH1dLFxuICAgICAgICBtb2RlOiAnc3Vic2NyaXB0aW9uJyxcbiAgICAgICAgc3VjY2Vzc191cmw6IGAke3Byb2Nlc3MuZW52Lk5FWFRfUFVCTElDX0JBU0VfVVJMfT9wYXltZW50PXN1Y2Nlc3Mmc3Vic2NyaXB0aW9uPXRydWVgLFxuICAgICAgICBjYW5jZWxfdXJsOiBgJHtwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19CQVNFX1VSTH0/cGF5bWVudD1jYW5jZWxsZWRgLFxuICAgICAgICBjbGllbnRfcmVmZXJlbmNlX2lkOiB1c2VyLmlkLFxuICAgICAgICBjdXN0b21lcl9lbWFpbDogdXNlci5lbWFpbCxcbiAgICAgICAgbWV0YWRhdGE6IHtcbiAgICAgICAgICBwbGFuX2lkOiBwbGFuSWQsXG4gICAgICAgICAgcHVyY2hhc2VfdHlwZTogJ2FsbF9hY2Nlc3MnXG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgICBcbiAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgdXJsOiBzZXNzaW9uLnVybCB9KSlcbiAgICB9XG5cbiAgICAvLyBDQU5DRUwgU1VCU0NSSVBUSU9OXG4gICAgaWYgKHBhdGggPT09ICdwYXltZW50L2NhbmNlbC1zdWJzY3JpcHRpb24nKSB7XG4gICAgICBjb25zdCB7IHVzZXIsIGVycm9yOiBhdXRoRXJyb3IgfSA9IGF3YWl0IGdldEF1dGhlbnRpY2F0ZWRVc2VyKClcbiAgICAgIFxuICAgICAgaWYgKGF1dGhFcnJvciB8fCAhdXNlcikge1xuICAgICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnVW5hdXRob3JpemVkJyB9LCB7IHN0YXR1czogNDAxIH0pKVxuICAgICAgfVxuICAgICAgXG4gICAgICBjb25zdCB7IHB1cmNoYXNlSWQgfSA9IGJvZHlcbiAgICAgIFxuICAgICAgLy8gR2V0IHRoZSBwdXJjaGFzZSByZWNvcmRcbiAgICAgIGNvbnN0IHsgZGF0YTogcHVyY2hhc2UsIGVycm9yOiBwdXJjaGFzZUVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAuZnJvbSgndXNlcl9wcm9kdWN0cycpXG4gICAgICAgIC5zZWxlY3QoJyonKVxuICAgICAgICAuZXEoJ2lkJywgcHVyY2hhc2VJZClcbiAgICAgICAgLmVxKCd1c2VyX2lkJywgdXNlci5pZClcbiAgICAgICAgLnNpbmdsZSgpXG4gICAgICBcbiAgICAgIGlmIChwdXJjaGFzZUVycm9yIHx8ICFwdXJjaGFzZSkge1xuICAgICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnUHVyY2hhc2Ugbm90IGZvdW5kJyB9LCB7IHN0YXR1czogNDA0IH0pKVxuICAgICAgfVxuICAgICAgXG4gICAgICBpZiAoIXB1cmNoYXNlLnN0cmlwZV9zdWJzY3JpcHRpb25faWQpIHtcbiAgICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ1RoaXMgaXMgbm90IGEgc3Vic2NyaXB0aW9uJyB9LCB7IHN0YXR1czogNDAwIH0pKVxuICAgICAgfVxuICAgICAgXG4gICAgICB0cnkge1xuICAgICAgICAvLyBDYW5jZWwgdGhlIHN1YnNjcmlwdGlvbiBpbiBTdHJpcGVcbiAgICAgICAgYXdhaXQgZ2V0U3RyaXBlKCkuc3Vic2NyaXB0aW9ucy5jYW5jZWwocHVyY2hhc2Uuc3RyaXBlX3N1YnNjcmlwdGlvbl9pZClcbiAgICAgICAgXG4gICAgICAgIC8vIFVwZGF0ZSBvdXIgZGF0YWJhc2VcbiAgICAgICAgYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgICAuZnJvbSgndXNlcl9wcm9kdWN0cycpXG4gICAgICAgICAgLnVwZGF0ZSh7IGlzX2FjdGl2ZTogZmFsc2UgfSlcbiAgICAgICAgICAuZXEoJ2lkJywgcHVyY2hhc2VJZClcbiAgICAgICAgXG4gICAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgc3VjY2VzczogdHJ1ZSwgbWVzc2FnZTogJ1N1YnNjcmlwdGlvbiBjYW5jZWxsZWQnIH0pKVxuICAgICAgfSBjYXRjaCAoc3RyaXBlRXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignU3RyaXBlIGNhbmNlbGxhdGlvbiBlcnJvcjonLCBzdHJpcGVFcnJvcilcbiAgICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ0ZhaWxlZCB0byBjYW5jZWwgc3Vic2NyaXB0aW9uJyB9LCB7IHN0YXR1czogNTAwIH0pKVxuICAgICAgfVxuICAgIH1cblxuICAgIC8vIExlZ2FjeSBwYXltZW50IHJvdXRlIChmb3IgYmFja3dhcmQgY29tcGF0aWJpbGl0eSlcbiAgICBpZiAocGF0aCA9PT0gJ3BheW1lbnQvY3JlYXRlLWNoZWNrb3V0Jykge1xuICAgICAgY29uc3QgeyB1c2VyLCBlcnJvcjogYXV0aEVycm9yIH0gPSBhd2FpdCBnZXRBdXRoZW50aWNhdGVkVXNlcigpXG4gICAgICBcbiAgICAgIGlmIChhdXRoRXJyb3IgfHwgIXVzZXIpIHtcbiAgICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ1VuYXV0aG9yaXplZCcgfSwgeyBzdGF0dXM6IDQwMSB9KSlcbiAgICAgIH1cbiAgICAgIFxuICAgICAgY29uc3QgeyBwYXltZW50VHlwZSwgY291cG9uQ29kZSB9ID0gYm9keVxuICAgICAgXG4gICAgICBsZXQgc2Vzc2lvbkNvbmZpZyA9IHtcbiAgICAgICAgcGF5bWVudF9tZXRob2RfdHlwZXM6IFsnY2FyZCddLFxuICAgICAgICBsaW5lX2l0ZW1zOiBbXSxcbiAgICAgICAgbW9kZTogcGF5bWVudFR5cGUgPT09ICdzdWJzY3JpcHRpb24nID8gJ3N1YnNjcmlwdGlvbicgOiAncGF5bWVudCcsXG4gICAgICAgIHN1Y2Nlc3NfdXJsOiBgJHtwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19CQVNFX1VSTH0/cGF5bWVudD1zdWNjZXNzYCxcbiAgICAgICAgY2FuY2VsX3VybDogYCR7cHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfQkFTRV9VUkx9P3BheW1lbnQ9Y2FuY2VsbGVkYCxcbiAgICAgICAgY2xpZW50X3JlZmVyZW5jZV9pZDogdXNlci5pZCxcbiAgICAgICAgY3VzdG9tZXJfZW1haWw6IHVzZXIuZW1haWwsXG4gICAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgICAgcHVyY2hhc2VfdHlwZTogcGF5bWVudFR5cGUgPT09ICdzdWJzY3JpcHRpb24nID8gJ2FsbF9hY2Nlc3MnIDogJ2xlZ2FjeV9mdWxsJ1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBcbiAgICAgIGlmIChwYXltZW50VHlwZSA9PT0gJ29uZXRpbWUnKSB7XG4gICAgICAgIHNlc3Npb25Db25maWcubGluZV9pdGVtcy5wdXNoKHtcbiAgICAgICAgICBwcmljZV9kYXRhOiB7XG4gICAgICAgICAgICBjdXJyZW5jeTogJ3VzZCcsXG4gICAgICAgICAgICBwcm9kdWN0X2RhdGE6IHtcbiAgICAgICAgICAgICAgbmFtZTogJ0FTIFdFIEFMTCBBUkUgLSBGdWxsIEFjY2VzcycsXG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiAnT25lLXRpbWUgdW5sb2NrIG9mIGFsbCBjYXJkcydcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB1bml0X2Ftb3VudDogMjAwMCxcbiAgICAgICAgICB9LFxuICAgICAgICAgIHF1YW50aXR5OiAxLFxuICAgICAgICB9KVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgc2Vzc2lvbkNvbmZpZy5saW5lX2l0ZW1zLnB1c2goe1xuICAgICAgICAgIHByaWNlX2RhdGE6IHtcbiAgICAgICAgICAgIGN1cnJlbmN5OiAndXNkJyxcbiAgICAgICAgICAgIHByb2R1Y3RfZGF0YToge1xuICAgICAgICAgICAgICBuYW1lOiAnQVMgV0UgQUxMIEFSRSAtIFN1YnNjcmlwdGlvbicsXG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiAnRnVsbCBhY2Nlc3Mgc3Vic2NyaXB0aW9uJ1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHVuaXRfYW1vdW50OiAzMDAsXG4gICAgICAgICAgICByZWN1cnJpbmc6IHtcbiAgICAgICAgICAgICAgaW50ZXJ2YWw6ICdtb250aCcsXG4gICAgICAgICAgICAgIGludGVydmFsX2NvdW50OiAzLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9LFxuICAgICAgICAgIHF1YW50aXR5OiAxLFxuICAgICAgICB9KVxuICAgICAgfVxuICAgICAgXG4gICAgICBpZiAoY291cG9uQ29kZSkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGNvbnN0IGNvdXBvbnMgPSBhd2FpdCBnZXRTdHJpcGUoKS5jb3Vwb25zLmxpc3QoeyBsaW1pdDogMTAwIH0pXG4gICAgICAgICAgY29uc3QgdmFsaWRDb3Vwb24gPSBjb3Vwb25zLmRhdGEuZmluZChjID0+IGMuaWQudG9Mb3dlckNhc2UoKSA9PT0gY291cG9uQ29kZS50b0xvd2VyQ2FzZSgpKVxuICAgICAgICAgIFxuICAgICAgICAgIGlmICh2YWxpZENvdXBvbikge1xuICAgICAgICAgICAgc2Vzc2lvbkNvbmZpZy5kaXNjb3VudHMgPSBbeyBjb3Vwb246IHZhbGlkQ291cG9uLmlkIH1dXG4gICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0NvdXBvbiB2YWxpZGF0aW9uIGVycm9yOicsIGVycm9yKVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICBcbiAgICAgIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBzdHJpcGUuY2hlY2tvdXQuc2Vzc2lvbnMuY3JlYXRlKHNlc3Npb25Db25maWcpXG4gICAgICBcbiAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgdXJsOiBzZXNzaW9uLnVybCB9KSlcbiAgICB9XG5cbiAgICAvLyBBRE1JTiBST1VURVMgLSBDcmVhdGUgY2FyZFxuICAgIGlmIChwYXRoID09PSAnYWRtaW4vY2FyZHMnKSB7XG4gICAgICBjb25zdCB7IHVzZXIsIGVycm9yOiBhdXRoRXJyb3IgfSA9IGF3YWl0IGdldEF1dGhlbnRpY2F0ZWRVc2VyKClcbiAgICAgIFxuICAgICAgaWYgKGF1dGhFcnJvciB8fCAhdXNlcikge1xuICAgICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnVW5hdXRob3JpemVkJyB9LCB7IHN0YXR1czogNDAxIH0pKVxuICAgICAgfVxuICAgICAgXG4gICAgICBjb25zdCB7IGJveElkLCBwaWxlSWQsIHRleHQsIGltYWdlUGF0aCwgaXNBY3RpdmUgfSA9IGJvZHlcbiAgICAgIFxuICAgICAgLy8gR2VuZXJhdGUgTUQ1IGhhc2ggSURcbiAgICAgIGNvbnN0IGNyeXB0byA9IGF3YWl0IGltcG9ydCgnY3J5cHRvJylcbiAgICAgIGNvbnN0IGNhcmRJZCA9IGNyeXB0by5jcmVhdGVIYXNoKCdtZDUnKS51cGRhdGUoYCR7RGF0ZS5ub3coKX0tJHtNYXRoLnJhbmRvbSgpfWApLmRpZ2VzdCgnaGV4JylcbiAgICAgIFxuICAgICAgY29uc3QgY2FyZCA9IHtcbiAgICAgICAgaWQ6IGNhcmRJZCxcbiAgICAgICAgYm94X2lkOiBib3hJZCxcbiAgICAgICAgcGlsZV9pZDogcGlsZUlkLFxuICAgICAgICB0ZXh0OiB0ZXh0IHx8IG51bGwsXG4gICAgICAgIGltYWdlX3BhdGg6IGltYWdlUGF0aCB8fCAnJyxcbiAgICAgICAgaXNfYWN0aXZlOiBpc0FjdGl2ZSAhPT0gZmFsc2UsXG4gICAgICAgIGNyZWF0ZWRfYXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxuICAgICAgfVxuICAgICAgXG4gICAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZUFkbWluXG4gICAgICAgIC5mcm9tKCdjYXJkcycpXG4gICAgICAgIC5pbnNlcnQoW2NhcmRdKVxuICAgICAgICAuc2VsZWN0KClcbiAgICAgICAgLnNpbmdsZSgpXG4gICAgICBcbiAgICAgIGlmIChlcnJvcikge1xuICAgICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiBlcnJvci5tZXNzYWdlIH0sIHsgc3RhdHVzOiA1MDAgfSkpXG4gICAgICB9XG4gICAgICBcbiAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgY2FyZDogZGF0YSB9KSlcbiAgICB9XG5cbiAgICAvLyBBRE1JTiBST1VURVMgLSBDcmVhdGUgYm94IChlbmhhbmNlZCB3aXRoIG5ldyBmaWVsZHMpXG4gICAgaWYgKHBhdGggPT09ICdhZG1pbi9ib3hlcycpIHtcbiAgICAgIGNvbnN0IHsgdXNlciwgZXJyb3I6IGF1dGhFcnJvciB9ID0gYXdhaXQgZ2V0QXV0aGVudGljYXRlZFVzZXIoKVxuICAgICAgXG4gICAgICBpZiAoYXV0aEVycm9yIHx8ICF1c2VyKSB7XG4gICAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdVbmF1dGhvcml6ZWQnIH0sIHsgc3RhdHVzOiA0MDEgfSkpXG4gICAgICB9XG4gICAgICBcbiAgICAgIGNvbnN0IHsgXG4gICAgICAgIGlkOiBib3hJZCwgbmFtZSwgZGVzY3JpcHRpb24sIGRlc2NyaXB0aW9uU2hvcnQsIHRhZ2xpbmUsIHRvcGljcyxcbiAgICAgICAgcHJpY2VJZCwgY29sb3IsIGNvbG9yUGFsZXR0ZSwgcGF0aDogYm94UGF0aCwgZGlzcGxheU9yZGVyLCBcbiAgICAgICAgaXNTYW1wbGUsIGZ1bGxCb3hJZCwgaXNBY3RpdmUsIGNvbGxlY3Rpb25TZXJpZXNJZCBcbiAgICAgIH0gPSBib2R5XG4gICAgICBcbiAgICAgIGNvbnN0IGJveCA9IHtcbiAgICAgICAgaWQ6IGJveElkIHx8IGBib3hfJHt1dWlkdjQoKS5zbGljZSgwLCA4KX1gLFxuICAgICAgICBuYW1lLFxuICAgICAgICBkZXNjcmlwdGlvbjogZGVzY3JpcHRpb24gfHwgJycsXG4gICAgICAgIGRlc2NyaXB0aW9uX3Nob3J0OiBkZXNjcmlwdGlvblNob3J0IHx8ICcnLFxuICAgICAgICB0YWdsaW5lOiB0YWdsaW5lIHx8ICcnLFxuICAgICAgICB0b3BpY3M6IHRvcGljcyB8fCBbXSxcbiAgICAgICAgcHJpY2VfaWQ6IHByaWNlSWQgfHwgbnVsbCxcbiAgICAgICAgY29sb3I6IGNvbG9yIHx8ICcjMDAwMDAwJyxcbiAgICAgICAgY29sb3JfcGFsZXR0ZTogY29sb3JQYWxldHRlIHx8IFtdLFxuICAgICAgICBwYXRoOiBib3hQYXRoIHx8ICcnLFxuICAgICAgICBkaXNwbGF5X29yZGVyOiBkaXNwbGF5T3JkZXIgfHwgMCxcbiAgICAgICAgaXNfc2FtcGxlOiBpc1NhbXBsZSB8fCBmYWxzZSxcbiAgICAgICAgZnVsbF9ib3hfaWQ6IGlzU2FtcGxlID8gKGZ1bGxCb3hJZCB8fCBudWxsKSA6IG51bGwsICAvLyBPbmx5IHNldCBpZiBzYW1wbGVcbiAgICAgICAgaXNfYWN0aXZlOiBpc0FjdGl2ZSAhPT0gZmFsc2UsXG4gICAgICAgIGNvbGxlY3Rpb25fc2VyaWVzX2lkOiBjb2xsZWN0aW9uU2VyaWVzSWQgfHwgJ3Vuc2NyaXB0ZWRfY29udmVyc2F0aW9ucycsXG4gICAgICAgIGNyZWF0ZWRfYXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxuICAgICAgfVxuICAgICAgXG4gICAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZUFkbWluXG4gICAgICAgIC5mcm9tKCdib3hlcycpXG4gICAgICAgIC5pbnNlcnQoW2JveF0pXG4gICAgICAgIC5zZWxlY3QoKVxuICAgICAgICAuc2luZ2xlKClcbiAgICAgIFxuICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfSwgeyBzdGF0dXM6IDUwMCB9KSlcbiAgICAgIH1cbiAgICAgIFxuICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBib3g6IGRhdGEgfSkpXG4gICAgfVxuXG4gICAgLy8gQURNSU4gUk9VVEVTIC0gQ3JlYXRlIGNvbGxlY3Rpb24gc2VyaWVzXG4gICAgaWYgKHBhdGggPT09ICdhZG1pbi9jb2xsZWN0aW9uLXNlcmllcycpIHtcbiAgICAgIGNvbnN0IHsgdXNlciwgZXJyb3I6IGF1dGhFcnJvciB9ID0gYXdhaXQgZ2V0QXV0aGVudGljYXRlZFVzZXIoKVxuICAgICAgXG4gICAgICBpZiAoYXV0aEVycm9yIHx8ICF1c2VyKSB7XG4gICAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdVbmF1dGhvcml6ZWQnIH0sIHsgc3RhdHVzOiA0MDEgfSkpXG4gICAgICB9XG4gICAgICBcbiAgICAgIGNvbnN0IHsgaWQsIG5hbWUsIGRlc2NyaXB0aW9uLCBkaXNwbGF5T3JkZXIsIGlzQWN0aXZlIH0gPSBib2R5XG4gICAgICBcbiAgICAgIGNvbnN0IHNlcmllcyA9IHtcbiAgICAgICAgaWQ6IGlkIHx8IGBzZXJpZXNfJHt1dWlkdjQoKS5zbGljZSgwLCA4KX1gLFxuICAgICAgICBuYW1lLFxuICAgICAgICBkZXNjcmlwdGlvbjogZGVzY3JpcHRpb24gfHwgJycsXG4gICAgICAgIGRpc3BsYXlfb3JkZXI6IGRpc3BsYXlPcmRlciB8fCAwLFxuICAgICAgICBpc19hY3RpdmU6IGlzQWN0aXZlICE9PSBmYWxzZSxcbiAgICAgICAgY3JlYXRlZF9hdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXG4gICAgICB9XG4gICAgICBcbiAgICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlQWRtaW5cbiAgICAgICAgLmZyb20oJ2NvbGxlY3Rpb25fc2VyaWVzJylcbiAgICAgICAgLmluc2VydChbc2VyaWVzXSlcbiAgICAgICAgLnNlbGVjdCgpXG4gICAgICAgIC5zaW5nbGUoKVxuICAgICAgXG4gICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogZXJyb3IubWVzc2FnZSB9LCB7IHN0YXR1czogNTAwIH0pKVxuICAgICAgfVxuICAgICAgXG4gICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IHNlcmllczogZGF0YSB9KSlcbiAgICB9XG5cbiAgICAvLyBBRE1JTiBST1VURVMgLSBDcmVhdGUgcHJpY2VcbiAgICBpZiAocGF0aCA9PT0gJ2FkbWluL3ByaWNlcycpIHtcbiAgICAgIGNvbnN0IHsgdXNlciwgZXJyb3I6IGF1dGhFcnJvciB9ID0gYXdhaXQgZ2V0QXV0aGVudGljYXRlZFVzZXIoKVxuICAgICAgXG4gICAgICBpZiAoYXV0aEVycm9yIHx8ICF1c2VyKSB7XG4gICAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdVbmF1dGhvcml6ZWQnIH0sIHsgc3RhdHVzOiA0MDEgfSkpXG4gICAgICB9XG4gICAgICBcbiAgICAgIGNvbnN0IHsgXG4gICAgICAgIGlkLCBsYWJlbCwgcGF5bWVudEluZm8sIGhvb2tJbmZvLCBhbW91bnQsIHByb21vQW1vdW50LCBwcm9tb0VuYWJsZWQsIGN1cnJlbmN5LFxuICAgICAgICBtZW1iZXJzaGlwRGF5cywgc3RyaXBlUHJpY2VJZCwgZGlzcGxheU9yZGVyLCBpc0FjdGl2ZSBcbiAgICAgIH0gPSBib2R5XG4gICAgICBcbiAgICAgIGNvbnN0IHByaWNlID0ge1xuICAgICAgICBpZDogaWQgfHwgYHByaWNlXyR7dXVpZHY0KCkuc2xpY2UoMCwgOCl9YCxcbiAgICAgICAgbGFiZWwsXG4gICAgICAgIHBheW1lbnRfaW5mbzogcGF5bWVudEluZm8gfHwgJycsXG4gICAgICAgIGhvb2tfaW5mbzogaG9va0luZm8gfHwgJycsXG4gICAgICAgIGFtb3VudDogYW1vdW50IHx8IDAsXG4gICAgICAgIHByb21vX2Ftb3VudDogcHJvbW9BbW91bnQgfHwgbnVsbCxcbiAgICAgICAgcHJvbW9fZW5hYmxlZDogcHJvbW9FbmFibGVkIHx8IGZhbHNlLFxuICAgICAgICBjdXJyZW5jeTogY3VycmVuY3kgfHwgJ1VTRCcsXG4gICAgICAgIG1lbWJlcnNoaXBfZGF5czogbWVtYmVyc2hpcERheXMgfHwgbnVsbCxcbiAgICAgICAgc3RyaXBlX3ByaWNlX2lkOiBzdHJpcGVQcmljZUlkIHx8IG51bGwsXG4gICAgICAgIGRpc3BsYXlfb3JkZXI6IGRpc3BsYXlPcmRlciB8fCAwLFxuICAgICAgICBpc19hY3RpdmU6IGlzQWN0aXZlICE9PSBmYWxzZSxcbiAgICAgICAgY3JlYXRlZF9hdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXG4gICAgICB9XG4gICAgICBcbiAgICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlQWRtaW5cbiAgICAgICAgLmZyb20oJ3ByaWNlcycpXG4gICAgICAgIC5pbnNlcnQoW3ByaWNlXSlcbiAgICAgICAgLnNlbGVjdCgpXG4gICAgICAgIC5zaW5nbGUoKVxuICAgICAgXG4gICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogZXJyb3IubWVzc2FnZSB9LCB7IHN0YXR1czogNTAwIH0pKVxuICAgICAgfVxuICAgICAgXG4gICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IHByaWNlOiBkYXRhIH0pKVxuICAgIH1cblxuICAgIC8vIEFETUlOIFJPVVRFUyAtIENyZWF0ZSBwaWxlXG4gICAgaWYgKHBhdGggPT09ICdhZG1pbi9waWxlcycpIHtcbiAgICAgIGNvbnN0IHsgdXNlciwgZXJyb3I6IGF1dGhFcnJvciB9ID0gYXdhaXQgZ2V0QXV0aGVudGljYXRlZFVzZXIoKVxuICAgICAgXG4gICAgICBpZiAoYXV0aEVycm9yIHx8ICF1c2VyKSB7XG4gICAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdVbmF1dGhvcml6ZWQnIH0sIHsgc3RhdHVzOiA0MDEgfSkpXG4gICAgICB9XG4gICAgICBcbiAgICAgIGNvbnN0IHsgaWQsIHNsdWcsIG5hbWUsIGltYWdlUGF0aCwgY29sbGVjdGlvblNlcmllc0lkLCBkaXNwbGF5T3JkZXIsIGlzQWN0aXZlIH0gPSBib2R5XG4gICAgICBcbiAgICAgIGNvbnN0IHBpbGUgPSB7XG4gICAgICAgIGlkOiBpZCB8fCBgcGlsZV8ke3V1aWR2NCgpLnNsaWNlKDAsIDgpfWAsXG4gICAgICAgIHNsdWc6IHNsdWcgfHwgbmFtZS50b0xvd2VyQ2FzZSgpLnJlcGxhY2UoL1xccysvZywgJ18nKSxcbiAgICAgICAgbmFtZSxcbiAgICAgICAgaW1hZ2VfcGF0aDogaW1hZ2VQYXRoIHx8ICcnLFxuICAgICAgICBjb2xsZWN0aW9uX3Nlcmllc19pZDogY29sbGVjdGlvblNlcmllc0lkIHx8IG51bGwsXG4gICAgICAgIGRpc3BsYXlfb3JkZXI6IGRpc3BsYXlPcmRlciB8fCAwLFxuICAgICAgICBpc19hY3RpdmU6IGlzQWN0aXZlICE9PSBmYWxzZSxcbiAgICAgICAgY3JlYXRlZF9hdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXG4gICAgICB9XG4gICAgICBcbiAgICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlQWRtaW5cbiAgICAgICAgLmZyb20oJ3BpbGVzJylcbiAgICAgICAgLmluc2VydChbcGlsZV0pXG4gICAgICAgIC5zZWxlY3QoKVxuICAgICAgICAuc2luZ2xlKClcbiAgICAgIFxuICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfSwgeyBzdGF0dXM6IDUwMCB9KSlcbiAgICAgIH1cbiAgICAgIFxuICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBwaWxlOiBkYXRhIH0pKVxuICAgIH1cblxuICAgIC8vIEFETUlOIFJPVVRFUyAtIENyZWF0ZSBidW5kbGVcbiAgICBpZiAocGF0aCA9PT0gJ2FkbWluL2J1bmRsZXMnKSB7XG4gICAgICBjb25zdCB7IHVzZXIsIGVycm9yOiBhdXRoRXJyb3IgfSA9IGF3YWl0IGdldEF1dGhlbnRpY2F0ZWRVc2VyKClcbiAgICAgIFxuICAgICAgaWYgKGF1dGhFcnJvciB8fCAhdXNlcikge1xuICAgICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnVW5hdXRob3JpemVkJyB9LCB7IHN0YXR1czogNDAxIH0pKVxuICAgICAgfVxuICAgICAgXG4gICAgICBjb25zdCB7IGlkLCBuYW1lLCBkZXNjcmlwdGlvbiwgcHJpY2VJZCwgYm94SWRzLCBkaXNwbGF5T3JkZXIsIGlzQWN0aXZlIH0gPSBib2R5XG4gICAgICBcbiAgICAgIGNvbnN0IGJ1bmRsZSA9IHtcbiAgICAgICAgaWQ6IGlkIHx8IGBidW5kbGVfJHt1dWlkdjQoKS5zbGljZSgwLCA4KX1gLFxuICAgICAgICBuYW1lLFxuICAgICAgICBkZXNjcmlwdGlvbjogZGVzY3JpcHRpb24gfHwgJycsXG4gICAgICAgIHByaWNlX2lkOiBwcmljZUlkIHx8IG51bGwsXG4gICAgICAgIGJveF9pZHM6IGJveElkcyB8fCBbXSxcbiAgICAgICAgZGlzcGxheV9vcmRlcjogZGlzcGxheU9yZGVyIHx8IDAsXG4gICAgICAgIGlzX2FjdGl2ZTogaXNBY3RpdmUgIT09IGZhbHNlLFxuICAgICAgICBjcmVhdGVkX2F0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcbiAgICAgIH1cbiAgICAgIFxuICAgICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VBZG1pblxuICAgICAgICAuZnJvbSgnYnVuZGxlcycpXG4gICAgICAgIC5pbnNlcnQoW2J1bmRsZV0pXG4gICAgICAgIC5zZWxlY3QoKVxuICAgICAgICAuc2luZ2xlKClcbiAgICAgIFxuICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfSwgeyBzdGF0dXM6IDUwMCB9KSlcbiAgICAgIH1cbiAgICAgIFxuICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBidW5kbGU6IGRhdGEgfSkpXG4gICAgfVxuXG4gICAgLy8gQURNSU4gUk9VVEVTIC0gQnVsayBkZWxldGUgY2FyZHNcbiAgICBpZiAocGF0aCA9PT0gJ2FkbWluL2NhcmRzL2J1bGstZGVsZXRlJykge1xuICAgICAgY29uc3QgeyB1c2VyLCBlcnJvcjogYXV0aEVycm9yIH0gPSBhd2FpdCBnZXRBdXRoZW50aWNhdGVkVXNlcigpXG4gICAgICBcbiAgICAgIGlmIChhdXRoRXJyb3IgfHwgIXVzZXIpIHtcbiAgICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ1VuYXV0aG9yaXplZCcgfSwgeyBzdGF0dXM6IDQwMSB9KSlcbiAgICAgIH1cbiAgICAgIFxuICAgICAgY29uc3QgeyBib3hJZCwgcGlsZUlkIH0gPSBib2R5XG4gICAgICBcbiAgICAgIGlmICghYm94SWQpIHtcbiAgICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ2JveElkIHJlcXVpcmVkJyB9LCB7IHN0YXR1czogNDAwIH0pKVxuICAgICAgfVxuICAgICAgXG4gICAgICAvLyBCdWlsZCBkZWxldGUgcXVlcnlcbiAgICAgIGxldCBkZWxldGVSZXN1bHRcbiAgICAgIGlmIChwaWxlSWQpIHtcbiAgICAgICAgLy8gRGVsZXRlIGNhcmRzIGZvciBzcGVjaWZpYyBib3ggYW5kIHBpbGVcbiAgICAgICAgY29uc3QgeyBkYXRhOiBjYXJkcyB9ID0gYXdhaXQgc3VwYWJhc2UuZnJvbSgnY2FyZHMnKS5zZWxlY3QoJyonKS5lcSgnYm94X2lkJywgYm94SWQpLmVxKCdwaWxlX2lkJywgcGlsZUlkKVxuICAgICAgICBpZiAoY2FyZHMgJiYgY2FyZHMubGVuZ3RoID4gMCkge1xuICAgICAgICAgIGZvciAoY29uc3QgY2FyZCBvZiBjYXJkcykge1xuICAgICAgICAgICAgYXdhaXQgc3VwYWJhc2UuZnJvbSgnY2FyZHMnKS5kZWxldGUoKS5lcSgnaWQnLCBjYXJkLmlkKVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBkZWxldGVSZXN1bHQgPSB7IGRlbGV0ZWQ6IGNhcmRzPy5sZW5ndGggfHwgMCB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBEZWxldGUgYWxsIGNhcmRzIGZvciBib3hcbiAgICAgICAgY29uc3QgeyBkYXRhOiBjYXJkcyB9ID0gYXdhaXQgc3VwYWJhc2UuZnJvbSgnY2FyZHMnKS5zZWxlY3QoJyonKS5lcSgnYm94X2lkJywgYm94SWQpXG4gICAgICAgIGlmIChjYXJkcyAmJiBjYXJkcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgZm9yIChjb25zdCBjYXJkIG9mIGNhcmRzKSB7XG4gICAgICAgICAgICBhd2FpdCBzdXBhYmFzZS5mcm9tKCdjYXJkcycpLmRlbGV0ZSgpLmVxKCdpZCcsIGNhcmQuaWQpXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGRlbGV0ZVJlc3VsdCA9IHsgZGVsZXRlZDogY2FyZHM/Lmxlbmd0aCB8fCAwIH1cbiAgICAgIH1cbiAgICAgIFxuICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBzdWNjZXNzOiB0cnVlLCAuLi5kZWxldGVSZXN1bHQgfSkpXG4gICAgfVxuICAgIFxuICAgIC8vIEFETUlOIFJPVVRFUyAtIEV4cG9ydCBjYXJkIHBhdGhzXG4gICAgaWYgKHBhdGggPT09ICdhZG1pbi9jYXJkcy9leHBvcnQnKSB7XG4gICAgICBjb25zdCB7IHVzZXIsIGVycm9yOiBhdXRoRXJyb3IgfSA9IGF3YWl0IGdldEF1dGhlbnRpY2F0ZWRVc2VyKClcbiAgICAgIFxuICAgICAgaWYgKGF1dGhFcnJvciB8fCAhdXNlcikge1xuICAgICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnVW5hdXRob3JpemVkJyB9LCB7IHN0YXR1czogNDAxIH0pKVxuICAgICAgfVxuICAgICAgXG4gICAgICBjb25zdCB7IGJveElkLCBwaWxlSWQgfSA9IGJvZHlcbiAgICAgIFxuICAgICAgaWYgKCFib3hJZCkge1xuICAgICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnYm94SWQgcmVxdWlyZWQnIH0sIHsgc3RhdHVzOiA0MDAgfSkpXG4gICAgICB9XG4gICAgICBcbiAgICAgIGxldCBxdWVyeSA9IHN1cGFiYXNlLmZyb20oJ2NhcmRzJykuc2VsZWN0KCcqJykuZXEoJ2JveF9pZCcsIGJveElkKVxuICAgICAgXG4gICAgICBpZiAocGlsZUlkKSB7XG4gICAgICAgIHF1ZXJ5ID0gcXVlcnkuZXEoJ3BpbGVfaWQnLCBwaWxlSWQpXG4gICAgICB9XG4gICAgICBcbiAgICAgIGNvbnN0IHsgZGF0YTogY2FyZHMsIGVycm9yIH0gPSBhd2FpdCBxdWVyeVxuICAgICAgXG4gICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogZXJyb3IubWVzc2FnZSB9LCB7IHN0YXR1czogNTAwIH0pKVxuICAgICAgfVxuICAgICAgXG4gICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IFxuICAgICAgICBjYXJkczogY2FyZHMgfHwgW10sXG4gICAgICAgIGltYWdlUGF0aHM6IChjYXJkcyB8fCBbXSkubWFwKGMgPT4gYy5pbWFnZV9wYXRoKVxuICAgICAgfSkpXG4gICAgfVxuXG4gICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ1JvdXRlIG5vdCBmb3VuZCcgfSwgeyBzdGF0dXM6IDQwNCB9KSlcbiAgICBcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdBUEkgRXJyb3I6JywgZXJyb3IpXG4gICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogZXJyb3IubWVzc2FnZSB9LCB7IHN0YXR1czogNTAwIH0pKVxuICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBQVVQocmVxdWVzdCkge1xuICBjb25zdCB1cmwgPSBuZXcgVVJMKHJlcXVlc3QudXJsKVxuICBjb25zdCBwYXRoID0gdXJsLnBhdGhuYW1lLnJlcGxhY2UoJy9hcGkvJywgJycpXG4gIGNvbnN0IHN1cGFiYXNlID0gY3JlYXRlU3VwYWJhc2VTZXJ2ZXIoKVxuICBjb25zdCBzdXBhYmFzZUFkbWluID0gZ2V0U3VwYWJhc2VBZG1pbigpIC8vIFNlcnZpY2Ugcm9sZSBjbGllbnQgZm9yIGFkbWluIG9wZXJhdGlvbnNcblxuICB0cnkge1xuICAgIGNvbnN0IHsgdXNlciwgZXJyb3I6IGF1dGhFcnJvciB9ID0gYXdhaXQgZ2V0QXV0aGVudGljYXRlZFVzZXIoKVxuICAgIFxuICAgIGlmIChhdXRoRXJyb3IgfHwgIXVzZXIpIHtcbiAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdVbmF1dGhvcml6ZWQnIH0sIHsgc3RhdHVzOiA0MDEgfSkpXG4gICAgfVxuXG4gICAgLy8gQURNSU4gUk9VVEVTIC0gVXBkYXRlIGNhcmRcbiAgICBpZiAocGF0aC5zdGFydHNXaXRoKCdhZG1pbi9jYXJkcy8nKSkge1xuICAgICAgY29uc3QgY2FyZElkID0gcGF0aC5zcGxpdCgnLycpWzJdXG4gICAgICBjb25zdCBib2R5ID0gYXdhaXQgcmVxdWVzdC5qc29uKClcbiAgICAgIFxuICAgICAgY29uc3QgdXBkYXRlRGF0YSA9IHt9XG4gICAgICBpZiAoYm9keS5ib3hJZCAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLmJveF9pZCA9IGJvZHkuYm94SWRcbiAgICAgIGlmIChib2R5LnBpbGVJZCAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLnBpbGVfaWQgPSBib2R5LnBpbGVJZFxuICAgICAgaWYgKGJvZHkudGV4dCAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLnRleHQgPSBib2R5LnRleHRcbiAgICAgIGlmIChib2R5LmltYWdlUGF0aCAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLmltYWdlX3BhdGggPSBib2R5LmltYWdlUGF0aFxuICAgICAgaWYgKGJvZHkuaXNBY3RpdmUgIT09IHVuZGVmaW5lZCkgdXBkYXRlRGF0YS5pc19hY3RpdmUgPSBib2R5LmlzQWN0aXZlXG4gICAgICBcbiAgICAgIGNvbnN0IHsgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlQWRtaW5cbiAgICAgICAgLmZyb20oJ2NhcmRzJylcbiAgICAgICAgLnVwZGF0ZSh1cGRhdGVEYXRhKVxuICAgICAgICAuZXEoJ2lkJywgY2FyZElkKVxuICAgICAgXG4gICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogZXJyb3IubWVzc2FnZSB9LCB7IHN0YXR1czogNTAwIH0pKVxuICAgICAgfVxuICAgICAgXG4gICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IHN1Y2Nlc3M6IHRydWUgfSkpXG4gICAgfVxuXG4gICAgLy8gQURNSU4gUk9VVEVTIC0gVXBkYXRlIGJveCAoZW5oYW5jZWQgd2l0aCBuZXcgZmllbGRzKVxuICAgIGlmIChwYXRoLnN0YXJ0c1dpdGgoJ2FkbWluL2JveGVzLycpKSB7XG4gICAgICBjb25zdCBib3hJZCA9IHBhdGguc3BsaXQoJy8nKVsyXVxuICAgICAgY29uc3QgYm9keSA9IGF3YWl0IHJlcXVlc3QuanNvbigpXG4gICAgICBcbiAgICAgIC8vIE1hcCBjYW1lbENhc2UgdG8gc25ha2VfY2FzZVxuICAgICAgY29uc3QgdXBkYXRlRGF0YSA9IHt9XG4gICAgICBpZiAoYm9keS5uYW1lICE9PSB1bmRlZmluZWQpIHVwZGF0ZURhdGEubmFtZSA9IGJvZHkubmFtZVxuICAgICAgaWYgKGJvZHkuZGVzY3JpcHRpb24gIT09IHVuZGVmaW5lZCkgdXBkYXRlRGF0YS5kZXNjcmlwdGlvbiA9IGJvZHkuZGVzY3JpcHRpb25cbiAgICAgIGlmIChib2R5LmRlc2NyaXB0aW9uU2hvcnQgIT09IHVuZGVmaW5lZCkgdXBkYXRlRGF0YS5kZXNjcmlwdGlvbl9zaG9ydCA9IGJvZHkuZGVzY3JpcHRpb25TaG9ydFxuICAgICAgaWYgKGJvZHkudGFnbGluZSAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLnRhZ2xpbmUgPSBib2R5LnRhZ2xpbmVcbiAgICAgIGlmIChib2R5LnRvcGljcyAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLnRvcGljcyA9IGJvZHkudG9waWNzXG4gICAgICBpZiAoYm9keS5wcmljZUlkICE9PSB1bmRlZmluZWQpIHVwZGF0ZURhdGEucHJpY2VfaWQgPSBib2R5LnByaWNlSWRcbiAgICAgIGlmIChib2R5LmNvbG9yICE9PSB1bmRlZmluZWQpIHVwZGF0ZURhdGEuY29sb3IgPSBib2R5LmNvbG9yXG4gICAgICBpZiAoYm9keS5jb2xvclBhbGV0dGUgIT09IHVuZGVmaW5lZCkgdXBkYXRlRGF0YS5jb2xvcl9wYWxldHRlID0gYm9keS5jb2xvclBhbGV0dGVcbiAgICAgIGlmIChib2R5LnBhdGggIT09IHVuZGVmaW5lZCkgdXBkYXRlRGF0YS5wYXRoID0gYm9keS5wYXRoXG4gICAgICBpZiAoYm9keS5kaXNwbGF5T3JkZXIgIT09IHVuZGVmaW5lZCkgdXBkYXRlRGF0YS5kaXNwbGF5X29yZGVyID0gYm9keS5kaXNwbGF5T3JkZXJcbiAgICAgIGlmIChib2R5LmNvbGxlY3Rpb25TZXJpZXNJZCAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLmNvbGxlY3Rpb25fc2VyaWVzX2lkID0gYm9keS5jb2xsZWN0aW9uU2VyaWVzSWRcbiAgICAgIGlmIChib2R5LmlzQWN0aXZlICE9PSB1bmRlZmluZWQpIHVwZGF0ZURhdGEuaXNfYWN0aXZlID0gYm9keS5pc0FjdGl2ZVxuICAgICAgXG4gICAgICAvLyBIYW5kbGUgaXNfc2FtcGxlIGFuZCBmdWxsX2JveF9pZCBmaWVsZHNcbiAgICAgIGlmIChib2R5LmlzU2FtcGxlICE9PSB1bmRlZmluZWQpIHVwZGF0ZURhdGEuaXNfc2FtcGxlID0gYm9keS5pc1NhbXBsZVxuICAgICAgaWYgKGJvZHkuZnVsbEJveElkICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgLy8gT25seSBzZXQgZnVsbF9ib3hfaWQgaWYgdGhpcyBpcyBhIHNhbXBsZSBib3hcbiAgICAgICAgdXBkYXRlRGF0YS5mdWxsX2JveF9pZCA9IGJvZHkuaXNTYW1wbGUgPyBib2R5LmZ1bGxCb3hJZCA6IG51bGxcbiAgICAgIH1cbiAgICAgIC8vIElmIHNldHRpbmcgaXNTYW1wbGUgdG8gZmFsc2UsIGNsZWFyIHRoZSBmdWxsX2JveF9pZFxuICAgICAgaWYgKGJvZHkuaXNTYW1wbGUgPT09IGZhbHNlKSB7XG4gICAgICAgIHVwZGF0ZURhdGEuZnVsbF9ib3hfaWQgPSBudWxsXG4gICAgICB9XG4gICAgICBcbiAgICAgIGNvbnN0IHsgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlQWRtaW5cbiAgICAgICAgLmZyb20oJ2JveGVzJylcbiAgICAgICAgLnVwZGF0ZSh1cGRhdGVEYXRhKVxuICAgICAgICAuZXEoJ2lkJywgYm94SWQpXG4gICAgICBcbiAgICAgIGlmIChlcnJvcikge1xuICAgICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiBlcnJvci5tZXNzYWdlIH0sIHsgc3RhdHVzOiA1MDAgfSkpXG4gICAgICB9XG4gICAgICBcbiAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgc3VjY2VzczogdHJ1ZSB9KSlcbiAgICB9XG5cbiAgICAvLyBBRE1JTiBST1VURVMgLSBVcGRhdGUgY29sbGVjdGlvbiBzZXJpZXNcbiAgICBpZiAocGF0aC5zdGFydHNXaXRoKCdhZG1pbi9jb2xsZWN0aW9uLXNlcmllcy8nKSkge1xuICAgICAgY29uc3Qgc2VyaWVzSWQgPSBwYXRoLnNwbGl0KCcvJylbMl1cbiAgICAgIGNvbnN0IGJvZHkgPSBhd2FpdCByZXF1ZXN0Lmpzb24oKVxuICAgICAgXG4gICAgICBjb25zdCB1cGRhdGVEYXRhID0ge31cbiAgICAgIGlmIChib2R5Lm5hbWUgIT09IHVuZGVmaW5lZCkgdXBkYXRlRGF0YS5uYW1lID0gYm9keS5uYW1lXG4gICAgICBpZiAoYm9keS5kZXNjcmlwdGlvbiAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLmRlc2NyaXB0aW9uID0gYm9keS5kZXNjcmlwdGlvblxuICAgICAgaWYgKGJvZHkuZGlzcGxheU9yZGVyICE9PSB1bmRlZmluZWQpIHVwZGF0ZURhdGEuZGlzcGxheV9vcmRlciA9IGJvZHkuZGlzcGxheU9yZGVyXG4gICAgICBpZiAoYm9keS5pc0FjdGl2ZSAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLmlzX2FjdGl2ZSA9IGJvZHkuaXNBY3RpdmVcbiAgICAgIFxuICAgICAgY29uc3QgeyBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VBZG1pblxuICAgICAgICAuZnJvbSgnY29sbGVjdGlvbl9zZXJpZXMnKVxuICAgICAgICAudXBkYXRlKHVwZGF0ZURhdGEpXG4gICAgICAgIC5lcSgnaWQnLCBzZXJpZXNJZClcbiAgICAgIFxuICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfSwgeyBzdGF0dXM6IDUwMCB9KSlcbiAgICAgIH1cbiAgICAgIFxuICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBzdWNjZXNzOiB0cnVlIH0pKVxuICAgIH1cblxuICAgIC8vIEFETUlOIFJPVVRFUyAtIFVwZGF0ZSBwcmljZVxuICAgIGlmIChwYXRoLnN0YXJ0c1dpdGgoJ2FkbWluL3ByaWNlcy8nKSkge1xuICAgICAgY29uc3QgcHJpY2VJZCA9IHBhdGguc3BsaXQoJy8nKVsyXVxuICAgICAgY29uc3QgYm9keSA9IGF3YWl0IHJlcXVlc3QuanNvbigpXG4gICAgICBcbiAgICAgIGNvbnN0IHVwZGF0ZURhdGEgPSB7fVxuICAgICAgaWYgKGJvZHkubGFiZWwgIT09IHVuZGVmaW5lZCkgdXBkYXRlRGF0YS5sYWJlbCA9IGJvZHkubGFiZWxcbiAgICAgIGlmIChib2R5LnBheW1lbnRJbmZvICE9PSB1bmRlZmluZWQpIHVwZGF0ZURhdGEucGF5bWVudF9pbmZvID0gYm9keS5wYXltZW50SW5mb1xuICAgICAgaWYgKGJvZHkuaG9va0luZm8gIT09IHVuZGVmaW5lZCkgdXBkYXRlRGF0YS5ob29rX2luZm8gPSBib2R5Lmhvb2tJbmZvXG4gICAgICBpZiAoYm9keS5hbW91bnQgIT09IHVuZGVmaW5lZCkgdXBkYXRlRGF0YS5hbW91bnQgPSBib2R5LmFtb3VudFxuICAgICAgaWYgKGJvZHkucHJvbW9BbW91bnQgIT09IHVuZGVmaW5lZCkgdXBkYXRlRGF0YS5wcm9tb19hbW91bnQgPSBib2R5LnByb21vQW1vdW50XG4gICAgICBpZiAoYm9keS5wcm9tb0VuYWJsZWQgIT09IHVuZGVmaW5lZCkgdXBkYXRlRGF0YS5wcm9tb19lbmFibGVkID0gYm9keS5wcm9tb0VuYWJsZWRcbiAgICAgIGlmIChib2R5LmN1cnJlbmN5ICE9PSB1bmRlZmluZWQpIHVwZGF0ZURhdGEuY3VycmVuY3kgPSBib2R5LmN1cnJlbmN5XG4gICAgICBpZiAoYm9keS5tZW1iZXJzaGlwRGF5cyAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLm1lbWJlcnNoaXBfZGF5cyA9IGJvZHkubWVtYmVyc2hpcERheXNcbiAgICAgIGlmIChib2R5LnN0cmlwZVByaWNlSWQgIT09IHVuZGVmaW5lZCkgdXBkYXRlRGF0YS5zdHJpcGVfcHJpY2VfaWQgPSBib2R5LnN0cmlwZVByaWNlSWRcbiAgICAgIGlmIChib2R5LmRpc3BsYXlPcmRlciAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLmRpc3BsYXlfb3JkZXIgPSBib2R5LmRpc3BsYXlPcmRlclxuICAgICAgaWYgKGJvZHkuaXNBY3RpdmUgIT09IHVuZGVmaW5lZCkgdXBkYXRlRGF0YS5pc19hY3RpdmUgPSBib2R5LmlzQWN0aXZlXG4gICAgICBcbiAgICAgIGNvbnN0IHsgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlQWRtaW5cbiAgICAgICAgLmZyb20oJ3ByaWNlcycpXG4gICAgICAgIC51cGRhdGUodXBkYXRlRGF0YSlcbiAgICAgICAgLmVxKCdpZCcsIHByaWNlSWQpXG4gICAgICBcbiAgICAgIGlmIChlcnJvcikge1xuICAgICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiBlcnJvci5tZXNzYWdlIH0sIHsgc3RhdHVzOiA1MDAgfSkpXG4gICAgICB9XG4gICAgICBcbiAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgc3VjY2VzczogdHJ1ZSB9KSlcbiAgICB9XG5cbiAgICAvLyBBRE1JTiBST1VURVMgLSBVcGRhdGUgcGlsZVxuICAgIGlmIChwYXRoLnN0YXJ0c1dpdGgoJ2FkbWluL3BpbGVzLycpKSB7XG4gICAgICBjb25zdCBwaWxlSWQgPSBwYXRoLnNwbGl0KCcvJylbMl1cbiAgICAgIGNvbnN0IGJvZHkgPSBhd2FpdCByZXF1ZXN0Lmpzb24oKVxuICAgICAgXG4gICAgICBjb25zb2xlLmxvZygnW1BJTEUgVVBEQVRFXSBwaWxlSWQ6JywgcGlsZUlkLCAnYm9keTonLCBKU09OLnN0cmluZ2lmeShib2R5KSlcbiAgICAgIFxuICAgICAgY29uc3QgdXBkYXRlRGF0YSA9IHt9XG4gICAgICBpZiAoYm9keS5zbHVnICE9PSB1bmRlZmluZWQpIHVwZGF0ZURhdGEuc2x1ZyA9IGJvZHkuc2x1Z1xuICAgICAgaWYgKGJvZHkubmFtZSAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLm5hbWUgPSBib2R5Lm5hbWVcbiAgICAgIGlmIChib2R5LmltYWdlUGF0aCAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLmltYWdlX3BhdGggPSBib2R5LmltYWdlUGF0aFxuICAgICAgaWYgKGJvZHkuY29sbGVjdGlvblNlcmllc0lkICE9PSB1bmRlZmluZWQpIHVwZGF0ZURhdGEuY29sbGVjdGlvbl9zZXJpZXNfaWQgPSBib2R5LmNvbGxlY3Rpb25TZXJpZXNJZFxuICAgICAgaWYgKGJvZHkuZGlzcGxheU9yZGVyICE9PSB1bmRlZmluZWQpIHVwZGF0ZURhdGEuZGlzcGxheV9vcmRlciA9IGJvZHkuZGlzcGxheU9yZGVyXG4gICAgICBpZiAoYm9keS5pc0FjdGl2ZSAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLmlzX2FjdGl2ZSA9IGJvZHkuaXNBY3RpdmVcbiAgICAgIFxuICAgICAgY29uc29sZS5sb2coJ1tQSUxFIFVQREFURV0gdXBkYXRlRGF0YTonLCBKU09OLnN0cmluZ2lmeSh1cGRhdGVEYXRhKSlcbiAgICAgIFxuICAgICAgLy8gVXNlIHNlcnZpY2Ugcm9sZSBjbGllbnQgZm9yIGFkbWluIG9wZXJhdGlvbnMgKGJ5cGFzc2VzIFJMUylcbiAgICAgIGNvbnN0IHN1cGFiYXNlQWRtaW4gPSBnZXRTdXBhYmFzZUFkbWluKClcbiAgICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlQWRtaW5cbiAgICAgICAgLmZyb20oJ3BpbGVzJylcbiAgICAgICAgLnVwZGF0ZSh1cGRhdGVEYXRhKVxuICAgICAgICAuZXEoJ2lkJywgcGlsZUlkKVxuICAgICAgICAuc2VsZWN0KClcbiAgICAgIFxuICAgICAgY29uc29sZS5sb2coJ1tQSUxFIFVQREFURV0gcmVzdWx0OicsIEpTT04uc3RyaW5naWZ5KHsgZGF0YSwgZXJyb3IgfSkpXG4gICAgICBcbiAgICAgIGlmIChlcnJvcikge1xuICAgICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiBlcnJvci5tZXNzYWdlIH0sIHsgc3RhdHVzOiA1MDAgfSkpXG4gICAgICB9XG4gICAgICBcbiAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgc3VjY2VzczogdHJ1ZSwgZGF0YSB9KSlcbiAgICB9XG5cbiAgICAvLyBBRE1JTiBST1VURVMgLSBVcGRhdGUgYnVuZGxlXG4gICAgaWYgKHBhdGguc3RhcnRzV2l0aCgnYWRtaW4vYnVuZGxlcy8nKSkge1xuICAgICAgY29uc3QgYnVuZGxlSWQgPSBwYXRoLnNwbGl0KCcvJylbMl1cbiAgICAgIGNvbnN0IGJvZHkgPSBhd2FpdCByZXF1ZXN0Lmpzb24oKVxuICAgICAgXG4gICAgICBjb25zdCB1cGRhdGVEYXRhID0ge31cbiAgICAgIGlmIChib2R5Lm5hbWUgIT09IHVuZGVmaW5lZCkgdXBkYXRlRGF0YS5uYW1lID0gYm9keS5uYW1lXG4gICAgICBpZiAoYm9keS5kZXNjcmlwdGlvbiAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLmRlc2NyaXB0aW9uID0gYm9keS5kZXNjcmlwdGlvblxuICAgICAgaWYgKGJvZHkucHJpY2VJZCAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLnByaWNlX2lkID0gYm9keS5wcmljZUlkXG4gICAgICBpZiAoYm9keS5ib3hJZHMgIT09IHVuZGVmaW5lZCkgdXBkYXRlRGF0YS5ib3hfaWRzID0gYm9keS5ib3hJZHNcbiAgICAgIGlmIChib2R5LmRpc3BsYXlPcmRlciAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLmRpc3BsYXlfb3JkZXIgPSBib2R5LmRpc3BsYXlPcmRlclxuICAgICAgaWYgKGJvZHkuaXNBY3RpdmUgIT09IHVuZGVmaW5lZCkgdXBkYXRlRGF0YS5pc19hY3RpdmUgPSBib2R5LmlzQWN0aXZlXG4gICAgICBcbiAgICAgIGNvbnN0IHsgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlQWRtaW5cbiAgICAgICAgLmZyb20oJ2J1bmRsZXMnKVxuICAgICAgICAudXBkYXRlKHVwZGF0ZURhdGEpXG4gICAgICAgIC5lcSgnaWQnLCBidW5kbGVJZClcbiAgICAgIFxuICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfSwgeyBzdGF0dXM6IDUwMCB9KSlcbiAgICAgIH1cbiAgICAgIFxuICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBzdWNjZXNzOiB0cnVlIH0pKVxuICAgIH1cblxuICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdSb3V0ZSBub3QgZm91bmQnIH0sIHsgc3RhdHVzOiA0MDQgfSkpXG4gICAgXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignQVBJIEVycm9yOicsIGVycm9yKVxuICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfSwgeyBzdGF0dXM6IDUwMCB9KSlcbiAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gREVMRVRFKHJlcXVlc3QpIHtcbiAgY29uc3QgdXJsID0gbmV3IFVSTChyZXF1ZXN0LnVybClcbiAgY29uc3QgcGF0aCA9IHVybC5wYXRobmFtZS5yZXBsYWNlKCcvYXBpLycsICcnKVxuICBjb25zdCBzdXBhYmFzZSA9IGNyZWF0ZVN1cGFiYXNlU2VydmVyKClcbiAgY29uc3Qgc3VwYWJhc2VBZG1pbiA9IGdldFN1cGFiYXNlQWRtaW4oKSAvLyBTZXJ2aWNlIHJvbGUgY2xpZW50IGZvciBhZG1pbiBvcGVyYXRpb25zXG5cbiAgdHJ5IHtcbiAgICBjb25zdCB7IHVzZXIsIGVycm9yOiBhdXRoRXJyb3IgfSA9IGF3YWl0IGdldEF1dGhlbnRpY2F0ZWRVc2VyKClcbiAgICBcbiAgICBpZiAoYXV0aEVycm9yIHx8ICF1c2VyKSB7XG4gICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnVW5hdXRob3JpemVkJyB9LCB7IHN0YXR1czogNDAxIH0pKVxuICAgIH1cblxuICAgIC8vIEFETUlOIFJPVVRFUyAtIERlbGV0ZSBjYXJkXG4gICAgaWYgKHBhdGguc3RhcnRzV2l0aCgnYWRtaW4vY2FyZHMvJykpIHtcbiAgICAgIGNvbnN0IGNhcmRJZCA9IHBhdGguc3BsaXQoJy8nKVsyXVxuICAgICAgXG4gICAgICBjb25zdCB7IGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZUFkbWluXG4gICAgICAgIC5mcm9tKCdjYXJkcycpXG4gICAgICAgIC5kZWxldGUoKVxuICAgICAgICAuZXEoJ2lkJywgY2FyZElkKVxuICAgICAgXG4gICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogZXJyb3IubWVzc2FnZSB9LCB7IHN0YXR1czogNTAwIH0pKVxuICAgICAgfVxuICAgICAgXG4gICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IHN1Y2Nlc3M6IHRydWUgfSkpXG4gICAgfVxuXG4gICAgLy8gQURNSU4gUk9VVEVTIC0gRGVsZXRlIGJveFxuICAgIGlmIChwYXRoLnN0YXJ0c1dpdGgoJ2FkbWluL2JveGVzLycpKSB7XG4gICAgICBjb25zdCBib3hJZCA9IHBhdGguc3BsaXQoJy8nKVsyXVxuICAgICAgXG4gICAgICAvLyBGaXJzdCBjaGVjayBpZiBhbnkgY2FyZHMgYXJlIGFzc2lnbmVkIHRvIHRoaXMgYm94XG4gICAgICBjb25zdCB7IGRhdGE6IGNhcmRzIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAuZnJvbSgnY2FyZHMnKVxuICAgICAgICAuc2VsZWN0KCdpZCcpXG4gICAgICAgIC5lcSgnYm94X2lkJywgYm94SWQpXG4gICAgICAgIC5saW1pdCgxKVxuICAgICAgXG4gICAgICBpZiAoY2FyZHMgJiYgY2FyZHMubGVuZ3RoID4gMCkge1xuICAgICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IFxuICAgICAgICAgIGVycm9yOiAnQ2Fubm90IGRlbGV0ZSBib3ggd2l0aCBhc3NpZ25lZCBjYXJkcy4gUmVtb3ZlIGNhcmRzIGZpcnN0LicgXG4gICAgICAgIH0sIHsgc3RhdHVzOiA0MDAgfSkpXG4gICAgICB9XG4gICAgICBcbiAgICAgIGNvbnN0IHsgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlQWRtaW5cbiAgICAgICAgLmZyb20oJ2JveGVzJylcbiAgICAgICAgLmRlbGV0ZSgpXG4gICAgICAgIC5lcSgnaWQnLCBib3hJZClcbiAgICAgIFxuICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfSwgeyBzdGF0dXM6IDUwMCB9KSlcbiAgICAgIH1cbiAgICAgIFxuICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBzdWNjZXNzOiB0cnVlIH0pKVxuICAgIH1cblxuICAgIC8vIEFETUlOIFJPVVRFUyAtIERlbGV0ZSBjb2xsZWN0aW9uIHNlcmllc1xuICAgIGlmIChwYXRoLnN0YXJ0c1dpdGgoJ2FkbWluL2NvbGxlY3Rpb24tc2VyaWVzLycpKSB7XG4gICAgICBjb25zdCBzZXJpZXNJZCA9IHBhdGguc3BsaXQoJy8nKVsyXVxuICAgICAgXG4gICAgICBjb25zdCB7IGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZUFkbWluXG4gICAgICAgIC5mcm9tKCdjb2xsZWN0aW9uX3NlcmllcycpXG4gICAgICAgIC5kZWxldGUoKVxuICAgICAgICAuZXEoJ2lkJywgc2VyaWVzSWQpXG4gICAgICBcbiAgICAgIGlmIChlcnJvcikge1xuICAgICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiBlcnJvci5tZXNzYWdlIH0sIHsgc3RhdHVzOiA1MDAgfSkpXG4gICAgICB9XG4gICAgICBcbiAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgc3VjY2VzczogdHJ1ZSB9KSlcbiAgICB9XG5cbiAgICAvLyBBRE1JTiBST1VURVMgLSBEZWxldGUgcHJpY2VcbiAgICBpZiAocGF0aC5zdGFydHNXaXRoKCdhZG1pbi9wcmljZXMvJykpIHtcbiAgICAgIGNvbnN0IHByaWNlSWQgPSBwYXRoLnNwbGl0KCcvJylbMl1cbiAgICAgIFxuICAgICAgY29uc3QgeyBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VBZG1pblxuICAgICAgICAuZnJvbSgncHJpY2VzJylcbiAgICAgICAgLmRlbGV0ZSgpXG4gICAgICAgIC5lcSgnaWQnLCBwcmljZUlkKVxuICAgICAgXG4gICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogZXJyb3IubWVzc2FnZSB9LCB7IHN0YXR1czogNTAwIH0pKVxuICAgICAgfVxuICAgICAgXG4gICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IHN1Y2Nlc3M6IHRydWUgfSkpXG4gICAgfVxuXG4gICAgLy8gQURNSU4gUk9VVEVTIC0gRGVsZXRlIHBpbGVcbiAgICBpZiAocGF0aC5zdGFydHNXaXRoKCdhZG1pbi9waWxlcy8nKSkge1xuICAgICAgY29uc3QgcGlsZUlkID0gcGF0aC5zcGxpdCgnLycpWzJdXG4gICAgICBcbiAgICAgIGNvbnN0IHsgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlQWRtaW5cbiAgICAgICAgLmZyb20oJ3BpbGVzJylcbiAgICAgICAgLmRlbGV0ZSgpXG4gICAgICAgIC5lcSgnaWQnLCBwaWxlSWQpXG4gICAgICBcbiAgICAgIGlmIChlcnJvcikge1xuICAgICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiBlcnJvci5tZXNzYWdlIH0sIHsgc3RhdHVzOiA1MDAgfSkpXG4gICAgICB9XG4gICAgICBcbiAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgc3VjY2VzczogdHJ1ZSB9KSlcbiAgICB9XG5cbiAgICAvLyBBRE1JTiBST1VURVMgLSBEZWxldGUgYnVuZGxlXG4gICAgaWYgKHBhdGguc3RhcnRzV2l0aCgnYWRtaW4vYnVuZGxlcy8nKSkge1xuICAgICAgY29uc3QgYnVuZGxlSWQgPSBwYXRoLnNwbGl0KCcvJylbMl1cbiAgICAgIFxuICAgICAgY29uc3QgeyBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VBZG1pblxuICAgICAgICAuZnJvbSgnYnVuZGxlcycpXG4gICAgICAgIC5kZWxldGUoKVxuICAgICAgICAuZXEoJ2lkJywgYnVuZGxlSWQpXG4gICAgICBcbiAgICAgIGlmIChlcnJvcikge1xuICAgICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiBlcnJvci5tZXNzYWdlIH0sIHsgc3RhdHVzOiA1MDAgfSkpXG4gICAgICB9XG4gICAgICBcbiAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgc3VjY2VzczogdHJ1ZSB9KSlcbiAgICB9XG5cbiAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnUm91dGUgbm90IGZvdW5kJyB9LCB7IHN0YXR1czogNDA0IH0pKVxuICAgIFxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0FQSSBFcnJvcjonLCBlcnJvcilcbiAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiBlcnJvci5tZXNzYWdlIH0sIHsgc3RhdHVzOiA1MDAgfSkpXG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJjcmVhdGVTdXBhYmFzZVNlcnZlciIsImNyZWF0ZUNsaWVudCIsImdldFN0cmlwZSIsInY0IiwidXVpZHY0IiwiZ2V0U3VwYWJhc2VBZG1pbiIsInByb2Nlc3MiLCJlbnYiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwiLCJTVVBBQkFTRV9TRVJWSUNFX1JPTEVfS0VZIiwiaGFuZGxlQ09SUyIsInJlc3BvbnNlIiwiaGVhZGVycyIsInNldCIsIk9QVElPTlMiLCJzdGF0dXMiLCJnZXRBdXRoZW50aWNhdGVkVXNlciIsIkxPQ0FMX01PREUiLCJjb29raWVzIiwiZ2V0VXNlckZyb21Ub2tlbiIsImNvb2tpZVN0b3JlIiwidG9rZW4iLCJnZXQiLCJ2YWx1ZSIsInVzZXIiLCJlcnJvciIsInN1cGFiYXNlIiwiZGF0YSIsImF1dGgiLCJnZXRVc2VyIiwiZ2V0VXNlckVudGl0bGVkQm94SWRzIiwiZ2V0Qm94ZXNXaXRoVmlzaWJpbGl0eSIsImdldFVzZXJBY2Nlc3NpYmxlQm94ZXMiLCJ1c2VySWQiLCJib3hlcyIsImJveEVycm9yIiwiZnJvbSIsInNlbGVjdCIsImVxIiwib3JkZXIiLCJhc2NlbmRpbmciLCJhY2Nlc3NpYmxlQm94SWRzIiwiYm94SWRzIiwiaGFzTWVtYmVyc2hpcCIsImhhc0FsbEFjY2VzcyIsImNoZWNrVXNlckFjY2VzcyIsInNhbXBsZUJveGVzIiwic2FtcGxlQm94SWRzIiwibWFwIiwiYiIsImlkIiwiaGFzUGFpZEFjY2VzcyIsInNvbWUiLCJpbmNsdWRlcyIsIkdFVCIsInJlcXVlc3QiLCJ1cmwiLCJVUkwiLCJwYXRoIiwicGF0aG5hbWUiLCJyZXBsYWNlIiwianNvbiIsImVtYWlsIiwiYm94ZXNXaXRoQWNjZXNzIiwiYm94IiwiaGFzQWNjZXNzIiwic2VhcmNoUGFyYW1zIiwic3BsaXQiLCJmaWx0ZXIiLCJCb29sZWFuIiwicXVlcnlCb3hJZHMiLCJsZW5ndGgiLCJjYXJkcyIsIm1lc3NhZ2UiLCJpbiIsImNvbnNvbGUiLCJwaWxlc01hcCIsInBpbGVJZHMiLCJTZXQiLCJjIiwicGlsZV9pZCIsInBpbGVzIiwiZm9yRWFjaCIsInAiLCJ0cmFuc2Zvcm1lZENhcmRzIiwiY2FyZCIsInBpbGUiLCJib3hfaWQiLCJ0ZXh0IiwiaW1hZ2VfcGF0aCIsImlzX2FjdGl2ZSIsImNyZWF0ZWRfYXQiLCJjb2xvciIsInNsdWciLCJwaWxlX25hbWUiLCJuYW1lIiwicGlsZV9pbWFnZSIsInRpdGxlIiwiaW1hZ2VQYXRoIiwicGxhbnMiLCJzZXJpZXMiLCJhdXRoRXJyb3IiLCJwdXJjaGFzZXMiLCJkcmF3cyIsImJveGVzUmVzdWx0IiwicGlsZXNSZXN1bHQiLCJzZXJpZXNSZXN1bHQiLCJQcm9taXNlIiwiYWxsIiwiYm94TWFwIiwicGlsZU1hcCIsInNlcmllc01hcCIsInMiLCJlbnJpY2hlZENhcmRzIiwiY29sbGVjdGlvblNlcmllcyIsImNvbGxlY3Rpb25fc2VyaWVzX2lkIiwiY29sbGVjdGlvbl9zZXJpZXMiLCJjYXJkc1Jlc3VsdCIsInByaWNlc1Jlc3VsdCIsInByaWNlcyIsImxvZyIsInByaWNlTWFwIiwiY2FyZENvdW50cyIsImtleSIsInRvdGFsIiwiYnlQaWxlIiwicGlsZUlkIiwiY291bnQiLCJwaWxlTmFtZSIsInBpbGVTbHVnIiwiZW5yaWNoZWRCb3hlcyIsInByaWNlX2lkIiwiY2FyZFN0YXRzIiwicGlsZXNFcnJvciIsInNlcmllc0Vycm9yIiwiQXJyYXkiLCJpc0FycmF5IiwiT2JqZWN0Iiwia2V5cyIsImVucmljaGVkUGlsZXMiLCJzZXJpZXNEYXRhIiwiYnVuZGxlcyIsImVucmljaGVkQnVuZGxlcyIsIlBPU1QiLCJzdXBhYmFzZUFkbWluIiwiYm9keSIsInBhc3N3b3JkIiwic2lnblVwIiwic2lnbkluV2l0aFBhc3N3b3JkIiwic2lnbk91dCIsInN1Y2Nlc3MiLCJjb29raWVPcHRpb25zIiwiZXhwaXJlcyIsIkRhdGUiLCJtYXhBZ2UiLCJzdXBhYmFzZVVybCIsInByb2plY3RSZWYiLCJtYXRjaCIsInNpZ25JbldpdGhPQXV0aCIsInByb3ZpZGVyIiwib3B0aW9ucyIsInJlZGlyZWN0VG8iLCJORVhUX1BVQkxJQ19CQVNFX1VSTCIsInJlc2V0UGFzc3dvcmRGb3JFbWFpbCIsImJsYWNrQ2FyZElkIiwid2hpdGVDYXJkSWQiLCJibGFja0NhcmRUaXRsZSIsIndoaXRlQ2FyZFRpdGxlIiwiZHJhdyIsInVzZXJpZCIsInVzZXJlbWFpbCIsImJsYWNrY2FyZGlkIiwid2hpdGVjYXJkaWQiLCJibGFja2NhcmR0aXRsZSIsIndoaXRlY2FyZHRpdGxlIiwidGltZXN0YW1wIiwidG9JU09TdHJpbmciLCJpbnNlcnQiLCJzaW5nbGUiLCJib3hJZCIsImlzX3NhbXBsZSIsInNlc3Npb24iLCJjaGVja291dCIsInNlc3Npb25zIiwiY3JlYXRlIiwicGF5bWVudF9tZXRob2RfdHlwZXMiLCJsaW5lX2l0ZW1zIiwicHJpY2VfZGF0YSIsImN1cnJlbmN5IiwicHJvZHVjdF9kYXRhIiwiZGVzY3JpcHRpb24iLCJ1bml0X2Ftb3VudCIsIk1hdGgiLCJyb3VuZCIsInByaWNlIiwicXVhbnRpdHkiLCJtb2RlIiwic3VjY2Vzc191cmwiLCJjYW5jZWxfdXJsIiwiY2xpZW50X3JlZmVyZW5jZV9pZCIsImN1c3RvbWVyX2VtYWlsIiwibWV0YWRhdGEiLCJwdXJjaGFzZV90eXBlIiwicGxhbklkIiwicGxhbiIsInBsYW5FcnJvciIsImludGVydmFsIiwiaW50ZXJ2YWxDb3VudCIsInJlY3VycmluZyIsImludGVydmFsX2NvdW50IiwicGxhbl9pZCIsInB1cmNoYXNlSWQiLCJwdXJjaGFzZSIsInB1cmNoYXNlRXJyb3IiLCJzdHJpcGVfc3Vic2NyaXB0aW9uX2lkIiwic3Vic2NyaXB0aW9ucyIsImNhbmNlbCIsInVwZGF0ZSIsInN0cmlwZUVycm9yIiwicGF5bWVudFR5cGUiLCJjb3Vwb25Db2RlIiwic2Vzc2lvbkNvbmZpZyIsInB1c2giLCJjb3Vwb25zIiwibGlzdCIsImxpbWl0IiwidmFsaWRDb3Vwb24iLCJmaW5kIiwidG9Mb3dlckNhc2UiLCJkaXNjb3VudHMiLCJjb3Vwb24iLCJzdHJpcGUiLCJpc0FjdGl2ZSIsImNyeXB0byIsImNhcmRJZCIsImNyZWF0ZUhhc2giLCJub3ciLCJyYW5kb20iLCJkaWdlc3QiLCJkZXNjcmlwdGlvblNob3J0IiwidGFnbGluZSIsInRvcGljcyIsInByaWNlSWQiLCJjb2xvclBhbGV0dGUiLCJib3hQYXRoIiwiZGlzcGxheU9yZGVyIiwiaXNTYW1wbGUiLCJmdWxsQm94SWQiLCJjb2xsZWN0aW9uU2VyaWVzSWQiLCJzbGljZSIsImRlc2NyaXB0aW9uX3Nob3J0IiwiY29sb3JfcGFsZXR0ZSIsImRpc3BsYXlfb3JkZXIiLCJmdWxsX2JveF9pZCIsImxhYmVsIiwicGF5bWVudEluZm8iLCJob29rSW5mbyIsImFtb3VudCIsInByb21vQW1vdW50IiwicHJvbW9FbmFibGVkIiwibWVtYmVyc2hpcERheXMiLCJzdHJpcGVQcmljZUlkIiwicGF5bWVudF9pbmZvIiwiaG9va19pbmZvIiwicHJvbW9fYW1vdW50IiwicHJvbW9fZW5hYmxlZCIsIm1lbWJlcnNoaXBfZGF5cyIsInN0cmlwZV9wcmljZV9pZCIsImJ1bmRsZSIsImJveF9pZHMiLCJkZWxldGVSZXN1bHQiLCJkZWxldGUiLCJkZWxldGVkIiwicXVlcnkiLCJpbWFnZVBhdGhzIiwiUFVUIiwic3RhcnRzV2l0aCIsInVwZGF0ZURhdGEiLCJ1bmRlZmluZWQiLCJzZXJpZXNJZCIsIkpTT04iLCJzdHJpbmdpZnkiLCJidW5kbGVJZCIsIkRFTEVURSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./app/api/[[...path]]/route.js\n");

/***/ }),

/***/ "(rsc)/./lib/db-local.js":
/*!*************************!*\
  !*** ./lib/db-local.js ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createLocalClient: () => (/* binding */ createLocalClient),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   getPool: () => (/* binding */ getPool),\n/* harmony export */   query: () => (/* binding */ query)\n/* harmony export */ });\n/* harmony import */ var pg__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! pg */ \"pg\");\n/* harmony import */ var pg__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(pg__WEBPACK_IMPORTED_MODULE_0__);\n// Local PostgreSQL Database Client\n// Used when LOCAL_MODE=true\n\nlet pool = null;\nfunction getPool() {\n    if (!pool) {\n        const connectionString = process.env.DATABASE_URL || \"postgresql://postgres:postgres@localhost:5432/asweallare\";\n        console.log(\"[DB-LOCAL] Creating pool with:\", connectionString.replace(/:[^:@]+@/, \":***@\"));\n        pool = new pg__WEBPACK_IMPORTED_MODULE_0__.Pool({\n            connectionString\n        });\n        pool.on(\"error\", (err)=>{\n            console.error(\"[DB-LOCAL] Pool error:\", err.message);\n        });\n    }\n    return pool;\n}\nasync function query(text, params) {\n    const pool = getPool();\n    try {\n        const result = await pool.query(text, params);\n        return result;\n    } catch (error) {\n        console.error(\"[DB-LOCAL] Query error:\", error.message);\n        console.error(\"[DB-LOCAL] Query was:\", text);\n        throw error;\n    }\n}\n// Helper to mimic Supabase response format\nfunction createLocalClient() {\n    return {\n        from: (table)=>new QueryBuilder(table),\n        auth: {\n            getUser: async ()=>{\n                // In local mode, return a mock admin user\n                return {\n                    data: {\n                        user: {\n                            id: \"00000000-0000-0000-0000-000000000001\",\n                            email: \"admin@local.dev\"\n                        }\n                    },\n                    error: null\n                };\n            },\n            getSession: async ()=>{\n                return {\n                    data: {\n                        session: {\n                            user: {\n                                id: \"00000000-0000-0000-0000-000000000001\",\n                                email: \"admin@local.dev\"\n                            }\n                        }\n                    },\n                    error: null\n                };\n            },\n            signOut: async ()=>({\n                    error: null\n                }),\n            onAuthStateChange: ()=>({\n                    data: {\n                        subscription: {\n                            unsubscribe: ()=>{}\n                        }\n                    }\n                })\n        }\n    };\n}\nclass QueryBuilder {\n    constructor(table){\n        this.table = table;\n        this._select = \"*\";\n        this._where = [];\n        this._whereParams = [];\n        this._order = null;\n        this._single = false;\n        this._limit = null;\n        this._returnData = true;\n        this._operation = null // 'update', 'delete', or null for select\n        ;\n        this._updateData = null;\n    }\n    select(columns = \"*\") {\n        // Handle Supabase-style nested selects by stripping them\n        // e.g., '*, piles(slug, name)' becomes '*'\n        if (columns.includes(\"(\")) {\n            this._select = columns.split(\",\").filter((c)=>!c.includes(\"(\")).map((c)=>c.trim()).join(\", \") || \"*\";\n        } else {\n            this._select = columns;\n        }\n        return this;\n    }\n    eq(column, value) {\n        this._whereParams.push(value);\n        this._where.push(`\"${column}\" = $${this._whereParams.length}`);\n        return this;\n    }\n    neq(column, value) {\n        this._whereParams.push(value);\n        this._where.push(`\"${column}\" != $${this._whereParams.length}`);\n        return this;\n    }\n    in(column, values) {\n        if (values && values.length > 0) {\n            const placeholders = values.map((_, i)=>`$${this._whereParams.length + i + 1}`).join(\", \");\n            this._whereParams.push(...values);\n            this._where.push(`\"${column}\" IN (${placeholders})`);\n        }\n        // If empty array, don't add any condition (will return all or be filtered by other conditions)\n        return this;\n    }\n    order(column, { ascending = true } = {}) {\n        this._order = `\"${column}\" ${ascending ? \"ASC\" : \"DESC\"}`;\n        return this;\n    }\n    limit(count) {\n        this._limit = count;\n        return this;\n    }\n    single() {\n        this._single = true;\n        this._limit = 1;\n        return this;\n    }\n    // Execute SELECT query\n    async then(resolve, reject) {\n        try {\n            let sql = `SELECT ${this._select} FROM \"${this.table}\"`;\n            if (this._where.length > 0) {\n                sql += ` WHERE ${this._where.join(\" AND \")}`;\n            }\n            if (this._order) {\n                sql += ` ORDER BY ${this._order}`;\n            }\n            if (this._limit) {\n                sql += ` LIMIT ${this._limit}`;\n            }\n            console.log(\"[DB-LOCAL] Executing:\", sql, \"with params:\", this._whereParams);\n            const result = await query(sql, this._whereParams);\n            if (this._single) {\n                resolve({\n                    data: result.rows[0] || null,\n                    error: null\n                });\n            } else {\n                resolve({\n                    data: result.rows,\n                    error: null\n                });\n            }\n        } catch (error) {\n            console.error(\"[DB-LOCAL] Query failed:\", error.message);\n            if (reject) {\n                reject(error);\n            } else {\n                resolve({\n                    data: null,\n                    error\n                });\n            }\n        }\n    }\n    async insert(data) {\n        try {\n            // Handle array of objects\n            const records = Array.isArray(data) ? data : [\n                data\n            ];\n            const results = [];\n            for (const record of records){\n                const keys = Object.keys(record);\n                const values = Object.values(record);\n                const placeholders = values.map((_, i)=>`$${i + 1}`).join(\", \");\n                const quotedKeys = keys.map((k)=>`\"${k}\"`).join(\", \");\n                const sql = `INSERT INTO \"${this.table}\" (${quotedKeys}) VALUES (${placeholders}) RETURNING *`;\n                console.log(\"[DB-LOCAL] Insert:\", sql);\n                const result = await query(sql, values);\n                results.push(result.rows[0]);\n            }\n            // Return a chainable object that mimics Supabase behavior\n            const insertResult = {\n                data: results,\n                error: null\n            };\n            return {\n                ...insertResult,\n                select: ()=>({\n                        single: ()=>Promise.resolve({\n                                data: results[0],\n                                error: null\n                            }),\n                        then: (resolve)=>resolve({\n                                data: results,\n                                error: null\n                            })\n                    }),\n                then: (resolve)=>resolve(insertResult)\n            };\n        } catch (error) {\n            console.error(\"[DB-LOCAL] Insert failed:\", error.message);\n            const errorResult = {\n                data: null,\n                error\n            };\n            return {\n                ...errorResult,\n                select: ()=>({\n                        single: ()=>Promise.resolve(errorResult),\n                        then: (resolve)=>resolve(errorResult)\n                    }),\n                then: (resolve)=>resolve(errorResult)\n            };\n        }\n    }\n    // Store update data for later execution\n    update(data) {\n        this._updateData = data;\n        this._operation = \"update\";\n        return this;\n    }\n    // Execute UPDATE query\n    async _executeUpdate() {\n        try {\n            const keys = Object.keys(this._updateData);\n            const values = Object.values(this._updateData);\n            const setClause = keys.map((k, i)=>`\"${k}\" = $${i + 1}`).join(\", \");\n            let sql = `UPDATE \"${this.table}\" SET ${setClause}`;\n            const params = [\n                ...values\n            ];\n            if (this._where.length > 0) {\n                // Adjust parameter indices for where clause\n                const whereWithOffset = this._where.map((w)=>{\n                    return w.replace(/\\$(\\d+)/g, (match, num)=>`$${parseInt(num) + values.length}`);\n                });\n                sql += ` WHERE ${whereWithOffset.join(\" AND \")}`;\n                params.push(...this._whereParams);\n            }\n            sql += \" RETURNING *\";\n            console.log(\"[DB-LOCAL] Update:\", sql, \"params:\", params);\n            const result = await query(sql, params);\n            return {\n                data: result.rows,\n                error: null\n            };\n        } catch (error) {\n            console.error(\"[DB-LOCAL] Update failed:\", error.message);\n            return {\n                data: null,\n                error\n            };\n        }\n    }\n    // Execute DELETE query\n    async _executeDelete() {\n        try {\n            let sql = `DELETE FROM \"${this.table}\"`;\n            if (this._where.length > 0) {\n                sql += ` WHERE ${this._where.join(\" AND \")}`;\n            }\n            sql += \" RETURNING *\";\n            console.log(\"[DB-LOCAL] Delete:\", sql);\n            const result = await query(sql, this._whereParams);\n            return {\n                data: result.rows,\n                error: null\n            };\n        } catch (error) {\n            console.error(\"[DB-LOCAL] Delete failed:\", error.message);\n            return {\n                data: null,\n                error\n            };\n        }\n    }\n    // Mark as delete operation\n    delete() {\n        this._operation = \"delete\";\n        return this;\n    }\n    // Execute SELECT query (and UPDATE/DELETE if flagged)\n    async then(resolve, reject) {\n        try {\n            // Handle update operation\n            if (this._operation === \"update\") {\n                const result = await this._executeUpdate();\n                resolve(result);\n                return;\n            }\n            // Handle delete operation\n            if (this._operation === \"delete\") {\n                const result = await this._executeDelete();\n                resolve(result);\n                return;\n            }\n            // Default: SELECT\n            let sql = `SELECT ${this._select} FROM \"${this.table}\"`;\n            if (this._where.length > 0) {\n                sql += ` WHERE ${this._where.join(\" AND \")}`;\n            }\n            if (this._order) {\n                sql += ` ORDER BY ${this._order}`;\n            }\n            if (this._limit) {\n                sql += ` LIMIT ${this._limit}`;\n            }\n            console.log(\"[DB-LOCAL] Executing:\", sql, \"with params:\", this._whereParams);\n            const result = await query(sql, this._whereParams);\n            if (this._single) {\n                resolve({\n                    data: result.rows[0] || null,\n                    error: null\n                });\n            } else {\n                resolve({\n                    data: result.rows,\n                    error: null\n                });\n            }\n        } catch (error) {\n            console.error(\"[DB-LOCAL] Query failed:\", error.message);\n            if (reject) {\n                reject(error);\n            } else {\n                resolve({\n                    data: null,\n                    error\n                });\n            }\n        }\n    }\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({\n    query,\n    getPool,\n    createLocalClient\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RUFBRTtnQkFDZmtDLE9BQU8sQ0FBQyxVQUFVLEVBQUUsSUFBSSxDQUFDbEMsTUFBTSxDQUFDLENBQUM7WUFDbkM7WUFFQSxJQUFJLElBQUksQ0FBQ0UsTUFBTSxFQUFFO2dCQUNmZ0MsT0FBTyxDQUFDLE9BQU8sRUFBRSxJQUFJLENBQUNoQyxNQUFNLENBQUMsQ0FBQztZQUNoQztZQUVBakMsUUFBUUMsR0FBRyxDQUFDLHlCQUF5QmdFLEtBQUssZ0JBQWdCLElBQUksQ0FBQ25DLFlBQVk7WUFDM0UsTUFBTXBCLFNBQVMsTUFBTUgsTUFBTTBELEtBQUssSUFBSSxDQUFDbkMsWUFBWTtZQUVqRCxJQUFJLElBQUksQ0FBQ0UsT0FBTyxFQUFFO2dCQUNoQitCLFFBQVE7b0JBQUU5QyxNQUFNUCxPQUFPd0QsSUFBSSxDQUFDLEVBQUUsSUFBSTtvQkFBTTdELE9BQU87Z0JBQUs7WUFDdEQsT0FBTztnQkFDTDBELFFBQVE7b0JBQUU5QyxNQUFNUCxPQUFPd0QsSUFBSTtvQkFBRTdELE9BQU87Z0JBQUs7WUFDM0M7UUFDRixFQUFFLE9BQU9BLE9BQU87WUFDZEwsUUFBUUssS0FBSyxDQUFDLDRCQUE0QkEsTUFBTUMsT0FBTztZQUN2RCxJQUFJMEQsUUFBUTtnQkFDVkEsT0FBTzNEO1lBQ1QsT0FBTztnQkFDTDBELFFBQVE7b0JBQUU5QyxNQUFNO29CQUFNWjtnQkFBTTtZQUM5QjtRQUNGO0lBQ0Y7QUFFRjtBQUVBLGlFQUFlO0lBQUVFO0lBQU9aO0lBQVNnQjtBQUFrQixDQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYXN3ZWFsbGFyZS1hZG1pbi8uL2xpYi9kYi1sb2NhbC5qcz82MTM2Il0sInNvdXJjZXNDb250ZW50IjpbIi8vIExvY2FsIFBvc3RncmVTUUwgRGF0YWJhc2UgQ2xpZW50XG4vLyBVc2VkIHdoZW4gTE9DQUxfTU9ERT10cnVlXG5cbmltcG9ydCB7IFBvb2wgfSBmcm9tICdwZydcblxubGV0IHBvb2wgPSBudWxsXG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRQb29sKCkge1xuICBpZiAoIXBvb2wpIHtcbiAgICBjb25zdCBjb25uZWN0aW9uU3RyaW5nID0gcHJvY2Vzcy5lbnYuREFUQUJBU0VfVVJMIHx8ICdwb3N0Z3Jlc3FsOi8vcG9zdGdyZXM6cG9zdGdyZXNAbG9jYWxob3N0OjU0MzIvYXN3ZWFsbGFyZSdcbiAgICBjb25zb2xlLmxvZygnW0RCLUxPQ0FMXSBDcmVhdGluZyBwb29sIHdpdGg6JywgY29ubmVjdGlvblN0cmluZy5yZXBsYWNlKC86W146QF0rQC8sICc6KioqQCcpKVxuICAgIHBvb2wgPSBuZXcgUG9vbCh7IGNvbm5lY3Rpb25TdHJpbmcgfSlcbiAgICBcbiAgICBwb29sLm9uKCdlcnJvcicsIChlcnIpID0+IHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1tEQi1MT0NBTF0gUG9vbCBlcnJvcjonLCBlcnIubWVzc2FnZSlcbiAgICB9KVxuICB9XG4gIHJldHVybiBwb29sXG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBxdWVyeSh0ZXh0LCBwYXJhbXMpIHtcbiAgY29uc3QgcG9vbCA9IGdldFBvb2woKVxuICB0cnkge1xuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHBvb2wucXVlcnkodGV4dCwgcGFyYW1zKVxuICAgIHJldHVybiByZXN1bHRcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdbREItTE9DQUxdIFF1ZXJ5IGVycm9yOicsIGVycm9yLm1lc3NhZ2UpXG4gICAgY29uc29sZS5lcnJvcignW0RCLUxPQ0FMXSBRdWVyeSB3YXM6JywgdGV4dClcbiAgICB0aHJvdyBlcnJvclxuICB9XG59XG5cbi8vIEhlbHBlciB0byBtaW1pYyBTdXBhYmFzZSByZXNwb25zZSBmb3JtYXRcbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVMb2NhbENsaWVudCgpIHtcbiAgcmV0dXJuIHtcbiAgICBmcm9tOiAodGFibGUpID0+IG5ldyBRdWVyeUJ1aWxkZXIodGFibGUpLFxuICAgIGF1dGg6IHtcbiAgICAgIGdldFVzZXI6IGFzeW5jICgpID0+IHtcbiAgICAgICAgLy8gSW4gbG9jYWwgbW9kZSwgcmV0dXJuIGEgbW9jayBhZG1pbiB1c2VyXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgdXNlcjoge1xuICAgICAgICAgICAgICBpZDogJzAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMScsXG4gICAgICAgICAgICAgIGVtYWlsOiAnYWRtaW5AbG9jYWwuZGV2J1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sXG4gICAgICAgICAgZXJyb3I6IG51bGxcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIGdldFNlc3Npb246IGFzeW5jICgpID0+IHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICBzZXNzaW9uOiB7XG4gICAgICAgICAgICAgIHVzZXI6IHtcbiAgICAgICAgICAgICAgICBpZDogJzAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMScsXG4gICAgICAgICAgICAgICAgZW1haWw6ICdhZG1pbkBsb2NhbC5kZXYnXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9LFxuICAgICAgICAgIGVycm9yOiBudWxsXG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBzaWduT3V0OiBhc3luYyAoKSA9PiAoeyBlcnJvcjogbnVsbCB9KSxcbiAgICAgIG9uQXV0aFN0YXRlQ2hhbmdlOiAoKSA9PiAoeyBkYXRhOiB7IHN1YnNjcmlwdGlvbjogeyB1bnN1YnNjcmliZTogKCkgPT4ge30gfSB9IH0pXG4gICAgfVxuICB9XG59XG5cbmNsYXNzIFF1ZXJ5QnVpbGRlciB7XG4gIGNvbnN0cnVjdG9yKHRhYmxlKSB7XG4gICAgdGhpcy50YWJsZSA9IHRhYmxlXG4gICAgdGhpcy5fc2VsZWN0ID0gJyonXG4gICAgdGhpcy5fd2hlcmUgPSBbXVxuICAgIHRoaXMuX3doZXJlUGFyYW1zID0gW11cbiAgICB0aGlzLl9vcmRlciA9IG51bGxcbiAgICB0aGlzLl9zaW5nbGUgPSBmYWxzZVxuICAgIHRoaXMuX2xpbWl0ID0gbnVsbFxuICAgIHRoaXMuX3JldHVybkRhdGEgPSB0cnVlXG4gICAgdGhpcy5fb3BlcmF0aW9uID0gbnVsbCAvLyAndXBkYXRlJywgJ2RlbGV0ZScsIG9yIG51bGwgZm9yIHNlbGVjdFxuICAgIHRoaXMuX3VwZGF0ZURhdGEgPSBudWxsXG4gIH1cblxuICBzZWxlY3QoY29sdW1ucyA9ICcqJykge1xuICAgIC8vIEhhbmRsZSBTdXBhYmFzZS1zdHlsZSBuZXN0ZWQgc2VsZWN0cyBieSBzdHJpcHBpbmcgdGhlbVxuICAgIC8vIGUuZy4sICcqLCBwaWxlcyhzbHVnLCBuYW1lKScgYmVjb21lcyAnKidcbiAgICBpZiAoY29sdW1ucy5pbmNsdWRlcygnKCcpKSB7XG4gICAgICB0aGlzLl9zZWxlY3QgPSBjb2x1bW5zLnNwbGl0KCcsJykuZmlsdGVyKGMgPT4gIWMuaW5jbHVkZXMoJygnKSkubWFwKGMgPT4gYy50cmltKCkpLmpvaW4oJywgJykgfHwgJyonXG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX3NlbGVjdCA9IGNvbHVtbnNcbiAgICB9XG4gICAgcmV0dXJuIHRoaXNcbiAgfVxuXG4gIGVxKGNvbHVtbiwgdmFsdWUpIHtcbiAgICB0aGlzLl93aGVyZVBhcmFtcy5wdXNoKHZhbHVlKVxuICAgIHRoaXMuX3doZXJlLnB1c2goYFwiJHtjb2x1bW59XCIgPSAkJHt0aGlzLl93aGVyZVBhcmFtcy5sZW5ndGh9YClcbiAgICByZXR1cm4gdGhpc1xuICB9XG5cbiAgbmVxKGNvbHVtbiwgdmFsdWUpIHtcbiAgICB0aGlzLl93aGVyZVBhcmFtcy5wdXNoKHZhbHVlKVxuICAgIHRoaXMuX3doZXJlLnB1c2goYFwiJHtjb2x1bW59XCIgIT0gJCR7dGhpcy5fd2hlcmVQYXJhbXMubGVuZ3RofWApXG4gICAgcmV0dXJuIHRoaXNcbiAgfVxuXG4gIGluKGNvbHVtbiwgdmFsdWVzKSB7XG4gICAgaWYgKHZhbHVlcyAmJiB2YWx1ZXMubGVuZ3RoID4gMCkge1xuICAgICAgY29uc3QgcGxhY2Vob2xkZXJzID0gdmFsdWVzLm1hcCgoXywgaSkgPT4gYCQke3RoaXMuX3doZXJlUGFyYW1zLmxlbmd0aCArIGkgKyAxfWApLmpvaW4oJywgJylcbiAgICAgIHRoaXMuX3doZXJlUGFyYW1zLnB1c2goLi4udmFsdWVzKVxuICAgICAgdGhpcy5fd2hlcmUucHVzaChgXCIke2NvbHVtbn1cIiBJTiAoJHtwbGFjZWhvbGRlcnN9KWApXG4gICAgfVxuICAgIC8vIElmIGVtcHR5IGFycmF5LCBkb24ndCBhZGQgYW55IGNvbmRpdGlvbiAod2lsbCByZXR1cm4gYWxsIG9yIGJlIGZpbHRlcmVkIGJ5IG90aGVyIGNvbmRpdGlvbnMpXG4gICAgcmV0dXJuIHRoaXNcbiAgfVxuXG4gIG9yZGVyKGNvbHVtbiwgeyBhc2NlbmRpbmcgPSB0cnVlIH0gPSB7fSkge1xuICAgIHRoaXMuX29yZGVyID0gYFwiJHtjb2x1bW59XCIgJHthc2NlbmRpbmcgPyAnQVNDJyA6ICdERVNDJ31gXG4gICAgcmV0dXJuIHRoaXNcbiAgfVxuXG4gIGxpbWl0KGNvdW50KSB7XG4gICAgdGhpcy5fbGltaXQgPSBjb3VudFxuICAgIHJldHVybiB0aGlzXG4gIH1cblxuICBzaW5nbGUoKSB7XG4gICAgdGhpcy5fc2luZ2xlID0gdHJ1ZVxuICAgIHRoaXMuX2xpbWl0ID0gMVxuICAgIHJldHVybiB0aGlzXG4gIH1cblxuICAvLyBFeGVjdXRlIFNFTEVDVCBxdWVyeVxuICBhc3luYyB0aGVuKHJlc29sdmUsIHJlamVjdCkge1xuICAgIHRyeSB7XG4gICAgICBsZXQgc3FsID0gYFNFTEVDVCAke3RoaXMuX3NlbGVjdH0gRlJPTSBcIiR7dGhpcy50YWJsZX1cImBcbiAgICAgIFxuICAgICAgaWYgKHRoaXMuX3doZXJlLmxlbmd0aCA+IDApIHtcbiAgICAgICAgc3FsICs9IGAgV0hFUkUgJHt0aGlzLl93aGVyZS5qb2luKCcgQU5EICcpfWBcbiAgICAgIH1cbiAgICAgIFxuICAgICAgaWYgKHRoaXMuX29yZGVyKSB7XG4gICAgICAgIHNxbCArPSBgIE9SREVSIEJZICR7dGhpcy5fb3JkZXJ9YFxuICAgICAgfVxuICAgICAgXG4gICAgICBpZiAodGhpcy5fbGltaXQpIHtcbiAgICAgICAgc3FsICs9IGAgTElNSVQgJHt0aGlzLl9saW1pdH1gXG4gICAgICB9XG5cbiAgICAgIGNvbnNvbGUubG9nKCdbREItTE9DQUxdIEV4ZWN1dGluZzonLCBzcWwsICd3aXRoIHBhcmFtczonLCB0aGlzLl93aGVyZVBhcmFtcylcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHF1ZXJ5KHNxbCwgdGhpcy5fd2hlcmVQYXJhbXMpXG4gICAgICBcbiAgICAgIGlmICh0aGlzLl9zaW5nbGUpIHtcbiAgICAgICAgcmVzb2x2ZSh7IGRhdGE6IHJlc3VsdC5yb3dzWzBdIHx8IG51bGwsIGVycm9yOiBudWxsIH0pXG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXNvbHZlKHsgZGF0YTogcmVzdWx0LnJvd3MsIGVycm9yOiBudWxsIH0pXG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1tEQi1MT0NBTF0gUXVlcnkgZmFpbGVkOicsIGVycm9yLm1lc3NhZ2UpXG4gICAgICBpZiAocmVqZWN0KSB7XG4gICAgICAgIHJlamVjdChlcnJvcilcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlc29sdmUoeyBkYXRhOiBudWxsLCBlcnJvciB9KVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGluc2VydChkYXRhKSB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIEhhbmRsZSBhcnJheSBvZiBvYmplY3RzXG4gICAgICBjb25zdCByZWNvcmRzID0gQXJyYXkuaXNBcnJheShkYXRhKSA/IGRhdGEgOiBbZGF0YV1cbiAgICAgIGNvbnN0IHJlc3VsdHMgPSBbXVxuICAgICAgXG4gICAgICBmb3IgKGNvbnN0IHJlY29yZCBvZiByZWNvcmRzKSB7XG4gICAgICAgIGNvbnN0IGtleXMgPSBPYmplY3Qua2V5cyhyZWNvcmQpXG4gICAgICAgIGNvbnN0IHZhbHVlcyA9IE9iamVjdC52YWx1ZXMocmVjb3JkKVxuICAgICAgICBjb25zdCBwbGFjZWhvbGRlcnMgPSB2YWx1ZXMubWFwKChfLCBpKSA9PiBgJCR7aSArIDF9YCkuam9pbignLCAnKVxuICAgICAgICBjb25zdCBxdW90ZWRLZXlzID0ga2V5cy5tYXAoayA9PiBgXCIke2t9XCJgKS5qb2luKCcsICcpXG4gICAgICAgIFxuICAgICAgICBjb25zdCBzcWwgPSBgSU5TRVJUIElOVE8gXCIke3RoaXMudGFibGV9XCIgKCR7cXVvdGVkS2V5c30pIFZBTFVFUyAoJHtwbGFjZWhvbGRlcnN9KSBSRVRVUk5JTkcgKmBcbiAgICAgICAgY29uc29sZS5sb2coJ1tEQi1MT0NBTF0gSW5zZXJ0OicsIHNxbClcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcXVlcnkoc3FsLCB2YWx1ZXMpXG4gICAgICAgIHJlc3VsdHMucHVzaChyZXN1bHQucm93c1swXSlcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8gUmV0dXJuIGEgY2hhaW5hYmxlIG9iamVjdCB0aGF0IG1pbWljcyBTdXBhYmFzZSBiZWhhdmlvclxuICAgICAgY29uc3QgaW5zZXJ0UmVzdWx0ID0geyBkYXRhOiByZXN1bHRzLCBlcnJvcjogbnVsbCB9XG4gICAgICByZXR1cm4ge1xuICAgICAgICAuLi5pbnNlcnRSZXN1bHQsXG4gICAgICAgIHNlbGVjdDogKCkgPT4gKHtcbiAgICAgICAgICBzaW5nbGU6ICgpID0+IFByb21pc2UucmVzb2x2ZSh7IGRhdGE6IHJlc3VsdHNbMF0sIGVycm9yOiBudWxsIH0pLFxuICAgICAgICAgIHRoZW46IChyZXNvbHZlKSA9PiByZXNvbHZlKHsgZGF0YTogcmVzdWx0cywgZXJyb3I6IG51bGwgfSlcbiAgICAgICAgfSksXG4gICAgICAgIHRoZW46IChyZXNvbHZlKSA9PiByZXNvbHZlKGluc2VydFJlc3VsdClcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignW0RCLUxPQ0FMXSBJbnNlcnQgZmFpbGVkOicsIGVycm9yLm1lc3NhZ2UpXG4gICAgICBjb25zdCBlcnJvclJlc3VsdCA9IHsgZGF0YTogbnVsbCwgZXJyb3IgfVxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgLi4uZXJyb3JSZXN1bHQsXG4gICAgICAgIHNlbGVjdDogKCkgPT4gKHtcbiAgICAgICAgICBzaW5nbGU6ICgpID0+IFByb21pc2UucmVzb2x2ZShlcnJvclJlc3VsdCksXG4gICAgICAgICAgdGhlbjogKHJlc29sdmUpID0+IHJlc29sdmUoZXJyb3JSZXN1bHQpXG4gICAgICAgIH0pLFxuICAgICAgICB0aGVuOiAocmVzb2x2ZSkgPT4gcmVzb2x2ZShlcnJvclJlc3VsdClcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvLyBTdG9yZSB1cGRhdGUgZGF0YSBmb3IgbGF0ZXIgZXhlY3V0aW9uXG4gIHVwZGF0ZShkYXRhKSB7XG4gICAgdGhpcy5fdXBkYXRlRGF0YSA9IGRhdGFcbiAgICB0aGlzLl9vcGVyYXRpb24gPSAndXBkYXRlJ1xuICAgIHJldHVybiB0aGlzXG4gIH1cblxuICAvLyBFeGVjdXRlIFVQREFURSBxdWVyeVxuICBhc3luYyBfZXhlY3V0ZVVwZGF0ZSgpIHtcbiAgICB0cnkge1xuICAgICAgY29uc3Qga2V5cyA9IE9iamVjdC5rZXlzKHRoaXMuX3VwZGF0ZURhdGEpXG4gICAgICBjb25zdCB2YWx1ZXMgPSBPYmplY3QudmFsdWVzKHRoaXMuX3VwZGF0ZURhdGEpXG4gICAgICBjb25zdCBzZXRDbGF1c2UgPSBrZXlzLm1hcCgoaywgaSkgPT4gYFwiJHtrfVwiID0gJCR7aSArIDF9YCkuam9pbignLCAnKVxuICAgICAgXG4gICAgICBsZXQgc3FsID0gYFVQREFURSBcIiR7dGhpcy50YWJsZX1cIiBTRVQgJHtzZXRDbGF1c2V9YFxuICAgICAgY29uc3QgcGFyYW1zID0gWy4uLnZhbHVlc11cbiAgICAgIFxuICAgICAgaWYgKHRoaXMuX3doZXJlLmxlbmd0aCA+IDApIHtcbiAgICAgICAgLy8gQWRqdXN0IHBhcmFtZXRlciBpbmRpY2VzIGZvciB3aGVyZSBjbGF1c2VcbiAgICAgICAgY29uc3Qgd2hlcmVXaXRoT2Zmc2V0ID0gdGhpcy5fd2hlcmUubWFwKHcgPT4ge1xuICAgICAgICAgIHJldHVybiB3LnJlcGxhY2UoL1xcJChcXGQrKS9nLCAobWF0Y2gsIG51bSkgPT4gYCQke3BhcnNlSW50KG51bSkgKyB2YWx1ZXMubGVuZ3RofWApXG4gICAgICAgIH0pXG4gICAgICAgIHNxbCArPSBgIFdIRVJFICR7d2hlcmVXaXRoT2Zmc2V0LmpvaW4oJyBBTkQgJyl9YFxuICAgICAgICBwYXJhbXMucHVzaCguLi50aGlzLl93aGVyZVBhcmFtcylcbiAgICAgIH1cbiAgICAgIFxuICAgICAgc3FsICs9ICcgUkVUVVJOSU5HIConXG4gICAgICBjb25zb2xlLmxvZygnW0RCLUxPQ0FMXSBVcGRhdGU6Jywgc3FsLCAncGFyYW1zOicsIHBhcmFtcylcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHF1ZXJ5KHNxbCwgcGFyYW1zKVxuICAgICAgXG4gICAgICByZXR1cm4geyBkYXRhOiByZXN1bHQucm93cywgZXJyb3I6IG51bGwgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdbREItTE9DQUxdIFVwZGF0ZSBmYWlsZWQ6JywgZXJyb3IubWVzc2FnZSlcbiAgICAgIHJldHVybiB7IGRhdGE6IG51bGwsIGVycm9yIH1cbiAgICB9XG4gIH1cblxuICAvLyBFeGVjdXRlIERFTEVURSBxdWVyeVxuICBhc3luYyBfZXhlY3V0ZURlbGV0ZSgpIHtcbiAgICB0cnkge1xuICAgICAgbGV0IHNxbCA9IGBERUxFVEUgRlJPTSBcIiR7dGhpcy50YWJsZX1cImBcbiAgICAgIFxuICAgICAgaWYgKHRoaXMuX3doZXJlLmxlbmd0aCA+IDApIHtcbiAgICAgICAgc3FsICs9IGAgV0hFUkUgJHt0aGlzLl93aGVyZS5qb2luKCcgQU5EICcpfWBcbiAgICAgIH1cbiAgICAgIFxuICAgICAgc3FsICs9ICcgUkVUVVJOSU5HIConXG4gICAgICBjb25zb2xlLmxvZygnW0RCLUxPQ0FMXSBEZWxldGU6Jywgc3FsKVxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcXVlcnkoc3FsLCB0aGlzLl93aGVyZVBhcmFtcylcbiAgICAgIFxuICAgICAgcmV0dXJuIHsgZGF0YTogcmVzdWx0LnJvd3MsIGVycm9yOiBudWxsIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignW0RCLUxPQ0FMXSBEZWxldGUgZmFpbGVkOicsIGVycm9yLm1lc3NhZ2UpXG4gICAgICByZXR1cm4geyBkYXRhOiBudWxsLCBlcnJvciB9XG4gICAgfVxuICB9XG5cbiAgLy8gTWFyayBhcyBkZWxldGUgb3BlcmF0aW9uXG4gIGRlbGV0ZSgpIHtcbiAgICB0aGlzLl9vcGVyYXRpb24gPSAnZGVsZXRlJ1xuICAgIHJldHVybiB0aGlzXG4gIH1cblxuICAvLyBFeGVjdXRlIFNFTEVDVCBxdWVyeSAoYW5kIFVQREFURS9ERUxFVEUgaWYgZmxhZ2dlZClcbiAgYXN5bmMgdGhlbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICB0cnkge1xuICAgICAgLy8gSGFuZGxlIHVwZGF0ZSBvcGVyYXRpb25cbiAgICAgIGlmICh0aGlzLl9vcGVyYXRpb24gPT09ICd1cGRhdGUnKSB7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuX2V4ZWN1dGVVcGRhdGUoKVxuICAgICAgICByZXNvbHZlKHJlc3VsdClcbiAgICAgICAgcmV0dXJuXG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIEhhbmRsZSBkZWxldGUgb3BlcmF0aW9uXG4gICAgICBpZiAodGhpcy5fb3BlcmF0aW9uID09PSAnZGVsZXRlJykge1xuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLl9leGVjdXRlRGVsZXRlKClcbiAgICAgICAgcmVzb2x2ZShyZXN1bHQpXG4gICAgICAgIHJldHVyblxuICAgICAgfVxuICAgICAgXG4gICAgICAvLyBEZWZhdWx0OiBTRUxFQ1RcbiAgICAgIGxldCBzcWwgPSBgU0VMRUNUICR7dGhpcy5fc2VsZWN0fSBGUk9NIFwiJHt0aGlzLnRhYmxlfVwiYFxuICAgICAgXG4gICAgICBpZiAodGhpcy5fd2hlcmUubGVuZ3RoID4gMCkge1xuICAgICAgICBzcWwgKz0gYCBXSEVSRSAke3RoaXMuX3doZXJlLmpvaW4oJyBBTkQgJyl9YFxuICAgICAgfVxuICAgICAgXG4gICAgICBpZiAodGhpcy5fb3JkZXIpIHtcbiAgICAgICAgc3FsICs9IGAgT1JERVIgQlkgJHt0aGlzLl9vcmRlcn1gXG4gICAgICB9XG4gICAgICBcbiAgICAgIGlmICh0aGlzLl9saW1pdCkge1xuICAgICAgICBzcWwgKz0gYCBMSU1JVCAke3RoaXMuX2xpbWl0fWBcbiAgICAgIH1cblxuICAgICAgY29uc29sZS5sb2coJ1tEQi1MT0NBTF0gRXhlY3V0aW5nOicsIHNxbCwgJ3dpdGggcGFyYW1zOicsIHRoaXMuX3doZXJlUGFyYW1zKVxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcXVlcnkoc3FsLCB0aGlzLl93aGVyZVBhcmFtcylcbiAgICAgIFxuICAgICAgaWYgKHRoaXMuX3NpbmdsZSkge1xuICAgICAgICByZXNvbHZlKHsgZGF0YTogcmVzdWx0LnJvd3NbMF0gfHwgbnVsbCwgZXJyb3I6IG51bGwgfSlcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlc29sdmUoeyBkYXRhOiByZXN1bHQucm93cywgZXJyb3I6IG51bGwgfSlcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignW0RCLUxPQ0FMXSBRdWVyeSBmYWlsZWQ6JywgZXJyb3IubWVzc2FnZSlcbiAgICAgIGlmIChyZWplY3QpIHtcbiAgICAgICAgcmVqZWN0KGVycm9yKVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmVzb2x2ZSh7IGRhdGE6IG51bGwsIGVycm9yIH0pXG4gICAgICB9XG4gICAgfVxuICB9XG5cbn1cblxuZXhwb3J0IGRlZmF1bHQgeyBxdWVyeSwgZ2V0UG9vbCwgY3JlYXRlTG9jYWxDbGllbnQgfSJdLCJuYW1lcyI6WyJQb29sIiwicG9vbCIsImdldFBvb2wiLCJjb25uZWN0aW9uU3RyaW5nIiwicHJvY2VzcyIsImVudiIsIkRBVEFCQVNFX1VSTCIsImNvbnNvbGUiLCJsb2ciLCJyZXBsYWNlIiwib24iLCJlcnIiLCJlcnJvciIsIm1lc3NhZ2UiLCJxdWVyeSIsInRleHQiLCJwYXJhbXMiLCJyZXN1bHQiLCJjcmVhdGVMb2NhbENsaWVudCIsImZyb20iLCJ0YWJsZSIsIlF1ZXJ5QnVpbGRlciIsImF1dGgiLCJnZXRVc2VyIiwiZGF0YSIsInVzZXIiLCJpZCIsImVtYWlsIiwiZ2V0U2Vzc2lvbiIsInNlc3Npb24iLCJzaWduT3V0Iiwib25BdXRoU3RhdGVDaGFuZ2UiLCJzdWJzY3JpcHRpb24iLCJ1bnN1YnNjcmliZSIsImNvbnN0cnVjdG9yIiwiX3NlbGVjdCIsIl93aGVyZSIsIl93aGVyZVBhcmFtcyIsIl9vcmRlciIsIl9zaW5nbGUiLCJfbGltaXQiLCJfcmV0dXJuRGF0YSIsIl9vcGVyYXRpb24iLCJfdXBkYXRlRGF0YSIsInNlbGVjdCIsImNvbHVtbnMiLCJpbmNsdWRlcyIsInNwbGl0IiwiZmlsdGVyIiwiYyIsIm1hcCIsInRyaW0iLCJqb2luIiwiZXEiLCJjb2x1bW4iLCJ2YWx1ZSIsInB1c2giLCJsZW5ndGgiLCJuZXEiLCJpbiIsInZhbHVlcyIsInBsYWNlaG9sZGVycyIsIl8iLCJpIiwib3JkZXIiLCJhc2NlbmRpbmciLCJsaW1pdCIsImNvdW50Iiwic2luZ2xlIiwidGhlbiIsInJlc29sdmUiLCJyZWplY3QiLCJzcWwiLCJyb3dzIiwiaW5zZXJ0IiwicmVjb3JkcyIsIkFycmF5IiwiaXNBcnJheSIsInJlc3VsdHMiLCJyZWNvcmQiLCJrZXlzIiwiT2JqZWN0IiwicXVvdGVkS2V5cyIsImsiLCJpbnNlcnRSZXN1bHQiLCJQcm9taXNlIiwiZXJyb3JSZXN1bHQiLCJ1cGRhdGUiLCJfZXhlY3V0ZVVwZGF0ZSIsInNldENsYXVzZSIsIndoZXJlV2l0aE9mZnNldCIsInciLCJtYXRjaCIsIm51bSIsInBhcnNlSW50IiwiX2V4ZWN1dGVEZWxldGUiLCJkZWxldGUiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/db-local.js\n");

/***/ }),

/***/ "(rsc)/./lib/entitlements.js":
/*!*****************************!*\
  !*** ./lib/entitlements.js ***!
  \*****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   getBoxesWithVisibility: () => (/* binding */ getBoxesWithVisibility),\n/* harmony export */   getUserEntitledBoxIds: () => (/* binding */ getUserEntitledBoxIds),\n/* harmony export */   userHasBoxAccess: () => (/* binding */ userHasBoxAccess)\n/* harmony export */ });\n/* harmony import */ var _supabase_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./supabase-server */ \"(rsc)/./lib/supabase-server.js\");\n// Entitlements Helper - Single source of truth for user access\n// Determines which boxes a user can access based on their purchases and memberships\n\n/**\n * Get all box IDs that a user is entitled to access\n * @param {string|null} userId - The user's ID (null for unauthenticated users)\n * @returns {Promise<{boxIds: string[], hasMembership: boolean, membershipExpiry: Date|null}>}\n */ async function getUserEntitledBoxIds(userId) {\n    const supabase = (0,_supabase_server__WEBPACK_IMPORTED_MODULE_0__.createSupabaseServer)();\n    const entitledBoxIds = new Set();\n    let hasMembership = false;\n    let membershipExpiry = null;\n    // Sample boxes are always accessible to everyone\n    const { data: sampleBoxes } = await supabase.from(\"boxes\").select(\"id\").eq(\"is_sample\", true).eq(\"is_active\", true);\n    if (sampleBoxes) {\n        sampleBoxes.forEach((box)=>entitledBoxIds.add(box.id));\n    }\n    // If no user, only sample boxes are accessible\n    if (!userId) {\n        return {\n            boxIds: Array.from(entitledBoxIds),\n            hasMembership: false,\n            membershipExpiry: null\n        };\n    }\n    // Check user_products for direct box purchases\n    const { data: userProducts } = await supabase.from(\"user_products\").select(\"box_id, expires_at\").eq(\"user_id\", userId).eq(\"is_active\", true);\n    if (userProducts) {\n        const now = new Date();\n        userProducts.forEach((product)=>{\n            // Check if not expired (null expires_at means permanent access)\n            if (!product.expires_at || new Date(product.expires_at) > now) {\n                if (product.box_id) {\n                    entitledBoxIds.add(product.box_id);\n                }\n            }\n        });\n    }\n    // Check user_memberships for bundle/membership access\n    const { data: userMemberships } = await supabase.from(\"user_memberships\").select(\"bundle_id, price_id, expires_at\").eq(\"user_id\", userId).eq(\"is_active\", true);\n    if (userMemberships) {\n        const now = new Date();\n        for (const membership of userMemberships){\n            // Check if not expired\n            if (membership.expires_at && new Date(membership.expires_at) > now) {\n                hasMembership = true;\n                // Track the latest expiry\n                const expiryDate = new Date(membership.expires_at);\n                if (!membershipExpiry || expiryDate > membershipExpiry) {\n                    membershipExpiry = expiryDate;\n                }\n                // Get boxes from bundle\n                if (membership.bundle_id) {\n                    const { data: bundle } = await supabase.from(\"bundles\").select(\"box_ids\").eq(\"id\", membership.bundle_id).single();\n                    if (bundle?.box_ids) {\n                        bundle.box_ids.forEach((boxId)=>entitledBoxIds.add(boxId));\n                    }\n                }\n                // If membership has a price with all-access, add all active boxes\n                if (membership.price_id) {\n                    const { data: price } = await supabase.from(\"prices\").select(\"membership_days\").eq(\"id\", membership.price_id).single();\n                    // If it's a membership price, it grants all-access\n                    if (price?.membership_days) {\n                        const { data: allBoxes } = await supabase.from(\"boxes\").select(\"id\").eq(\"is_active\", true);\n                        if (allBoxes) {\n                            allBoxes.forEach((box)=>entitledBoxIds.add(box.id));\n                        }\n                    }\n                }\n            }\n        }\n    }\n    return {\n        boxIds: Array.from(entitledBoxIds),\n        hasMembership,\n        membershipExpiry\n    };\n}\n/**\n * Check if a user has access to a specific box\n * @param {string|null} userId - The user's ID\n * @param {string} boxId - The box ID to check\n * @returns {Promise<boolean>}\n */ async function userHasBoxAccess(userId, boxId) {\n    const { boxIds } = await getUserEntitledBoxIds(userId);\n    return boxIds.includes(boxId);\n}\n/**\n * Get boxes with visibility rules applied\n * Hide sample boxes if user owns the related full box (via full_box_id)\n * @param {string|null} userId - The user's ID\n * @returns {Promise<{boxes: any[], entitledBoxIds: string[], hasMembership: boolean}>}\n */ async function getBoxesWithVisibility(userId) {\n    const supabase = (0,_supabase_server__WEBPACK_IMPORTED_MODULE_0__.createSupabaseServer)();\n    // Get user entitlements\n    const { boxIds: entitledBoxIds, hasMembership, membershipExpiry } = await getUserEntitledBoxIds(userId);\n    // Get all active boxes\n    const { data: boxes } = await supabase.from(\"boxes\").select(\"*\").eq(\"is_active\", true).order(\"display_order\", {\n        ascending: true\n    });\n    if (!boxes) {\n        return {\n            boxes: [],\n            entitledBoxIds,\n            hasMembership,\n            membershipExpiry\n        };\n    }\n    // Build a set of full box IDs that user owns\n    const ownedFullBoxIds = new Set();\n    boxes.forEach((box)=>{\n        if (!box.is_sample && entitledBoxIds.includes(box.id)) {\n            ownedFullBoxIds.add(box.id);\n        }\n    });\n    // Filter boxes based on visibility rules:\n    // Hide sample box if user owns its related full box (full_box_id)\n    const visibleBoxes = boxes.filter((box)=>{\n        // Non-sample boxes are always visible\n        if (!box.is_sample) return true;\n        // Sample boxes: hide if user owns the related full box\n        if (box.full_box_id && ownedFullBoxIds.has(box.full_box_id)) {\n            return false;\n        }\n        return true;\n    });\n    // Mark boxes with access info\n    const boxesWithAccess = visibleBoxes.map((box)=>({\n            ...box,\n            hasAccess: entitledBoxIds.includes(box.id)\n        }));\n    return {\n        boxes: boxesWithAccess,\n        entitledBoxIds,\n        hasMembership,\n        membershipExpiry\n    };\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({\n    getUserEntitledBoxIds,\n    userHasBoxAccess,\n    getBoxesWithVisibility\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QyxDQUFBQTtRQUNaLElBQUksQ0FBQ0EsSUFBSThCLFNBQVMsSUFBSXhDLGVBQWVrQyxRQUFRLENBQUN4QixJQUFJRSxFQUFFLEdBQUc7WUFDckQyQixnQkFBZ0I1QixHQUFHLENBQUNELElBQUlFLEVBQUU7UUFDNUI7SUFDRjtJQUVBLDBDQUEwQztJQUMxQyxrRUFBa0U7SUFDbEUsTUFBTTZCLGVBQWVMLE1BQU1NLE1BQU0sQ0FBQ2hDLENBQUFBO1FBQ2hDLHNDQUFzQztRQUN0QyxJQUFJLENBQUNBLElBQUk4QixTQUFTLEVBQUUsT0FBTztRQUUzQix1REFBdUQ7UUFDdkQsSUFBSTlCLElBQUlpQyxXQUFXLElBQUlKLGdCQUFnQkssR0FBRyxDQUFDbEMsSUFBSWlDLFdBQVcsR0FBRztZQUMzRCxPQUFPO1FBQ1Q7UUFFQSxPQUFPO0lBQ1Q7SUFFQSw4QkFBOEI7SUFDOUIsTUFBTUUsa0JBQWtCSixhQUFhSyxHQUFHLENBQUNwQyxDQUFBQSxNQUFRO1lBQy9DLEdBQUdBLEdBQUc7WUFDTnFDLFdBQVcvQyxlQUFla0MsUUFBUSxDQUFDeEIsSUFBSUUsRUFBRTtRQUMzQztJQUVBLE9BQU87UUFDTHdCLE9BQU9TO1FBQ1A3QztRQUNBRTtRQUNBQztJQUNGO0FBQ0Y7QUFFQSxpRUFBZTtJQUNiTjtJQUNBb0M7SUFDQUU7QUFDRixDQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYXN3ZWFsbGFyZS1hZG1pbi8uL2xpYi9lbnRpdGxlbWVudHMuanM/YzJmMiJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBFbnRpdGxlbWVudHMgSGVscGVyIC0gU2luZ2xlIHNvdXJjZSBvZiB0cnV0aCBmb3IgdXNlciBhY2Nlc3Ncbi8vIERldGVybWluZXMgd2hpY2ggYm94ZXMgYSB1c2VyIGNhbiBhY2Nlc3MgYmFzZWQgb24gdGhlaXIgcHVyY2hhc2VzIGFuZCBtZW1iZXJzaGlwc1xuXG5pbXBvcnQgeyBjcmVhdGVTdXBhYmFzZVNlcnZlciB9IGZyb20gJy4vc3VwYWJhc2Utc2VydmVyJ1xuXG4vKipcbiAqIEdldCBhbGwgYm94IElEcyB0aGF0IGEgdXNlciBpcyBlbnRpdGxlZCB0byBhY2Nlc3NcbiAqIEBwYXJhbSB7c3RyaW5nfG51bGx9IHVzZXJJZCAtIFRoZSB1c2VyJ3MgSUQgKG51bGwgZm9yIHVuYXV0aGVudGljYXRlZCB1c2VycylcbiAqIEByZXR1cm5zIHtQcm9taXNlPHtib3hJZHM6IHN0cmluZ1tdLCBoYXNNZW1iZXJzaGlwOiBib29sZWFuLCBtZW1iZXJzaGlwRXhwaXJ5OiBEYXRlfG51bGx9Pn1cbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFVzZXJFbnRpdGxlZEJveElkcyh1c2VySWQpIHtcbiAgY29uc3Qgc3VwYWJhc2UgPSBjcmVhdGVTdXBhYmFzZVNlcnZlcigpXG4gIGNvbnN0IGVudGl0bGVkQm94SWRzID0gbmV3IFNldCgpXG4gIGxldCBoYXNNZW1iZXJzaGlwID0gZmFsc2VcbiAgbGV0IG1lbWJlcnNoaXBFeHBpcnkgPSBudWxsXG4gIFxuICAvLyBTYW1wbGUgYm94ZXMgYXJlIGFsd2F5cyBhY2Nlc3NpYmxlIHRvIGV2ZXJ5b25lXG4gIGNvbnN0IHsgZGF0YTogc2FtcGxlQm94ZXMgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgLmZyb20oJ2JveGVzJylcbiAgICAuc2VsZWN0KCdpZCcpXG4gICAgLmVxKCdpc19zYW1wbGUnLCB0cnVlKVxuICAgIC5lcSgnaXNfYWN0aXZlJywgdHJ1ZSlcbiAgXG4gIGlmIChzYW1wbGVCb3hlcykge1xuICAgIHNhbXBsZUJveGVzLmZvckVhY2goYm94ID0+IGVudGl0bGVkQm94SWRzLmFkZChib3guaWQpKVxuICB9XG4gIFxuICAvLyBJZiBubyB1c2VyLCBvbmx5IHNhbXBsZSBib3hlcyBhcmUgYWNjZXNzaWJsZVxuICBpZiAoIXVzZXJJZCkge1xuICAgIHJldHVybiB7XG4gICAgICBib3hJZHM6IEFycmF5LmZyb20oZW50aXRsZWRCb3hJZHMpLFxuICAgICAgaGFzTWVtYmVyc2hpcDogZmFsc2UsXG4gICAgICBtZW1iZXJzaGlwRXhwaXJ5OiBudWxsXG4gICAgfVxuICB9XG4gIFxuICAvLyBDaGVjayB1c2VyX3Byb2R1Y3RzIGZvciBkaXJlY3QgYm94IHB1cmNoYXNlc1xuICBjb25zdCB7IGRhdGE6IHVzZXJQcm9kdWN0cyB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAuZnJvbSgndXNlcl9wcm9kdWN0cycpXG4gICAgLnNlbGVjdCgnYm94X2lkLCBleHBpcmVzX2F0JylcbiAgICAuZXEoJ3VzZXJfaWQnLCB1c2VySWQpXG4gICAgLmVxKCdpc19hY3RpdmUnLCB0cnVlKVxuICBcbiAgaWYgKHVzZXJQcm9kdWN0cykge1xuICAgIGNvbnN0IG5vdyA9IG5ldyBEYXRlKClcbiAgICB1c2VyUHJvZHVjdHMuZm9yRWFjaChwcm9kdWN0ID0+IHtcbiAgICAgIC8vIENoZWNrIGlmIG5vdCBleHBpcmVkIChudWxsIGV4cGlyZXNfYXQgbWVhbnMgcGVybWFuZW50IGFjY2VzcylcbiAgICAgIGlmICghcHJvZHVjdC5leHBpcmVzX2F0IHx8IG5ldyBEYXRlKHByb2R1Y3QuZXhwaXJlc19hdCkgPiBub3cpIHtcbiAgICAgICAgaWYgKHByb2R1Y3QuYm94X2lkKSB7XG4gICAgICAgICAgZW50aXRsZWRCb3hJZHMuYWRkKHByb2R1Y3QuYm94X2lkKVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSlcbiAgfVxuICBcbiAgLy8gQ2hlY2sgdXNlcl9tZW1iZXJzaGlwcyBmb3IgYnVuZGxlL21lbWJlcnNoaXAgYWNjZXNzXG4gIGNvbnN0IHsgZGF0YTogdXNlck1lbWJlcnNoaXBzIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgIC5mcm9tKCd1c2VyX21lbWJlcnNoaXBzJylcbiAgICAuc2VsZWN0KCdidW5kbGVfaWQsIHByaWNlX2lkLCBleHBpcmVzX2F0JylcbiAgICAuZXEoJ3VzZXJfaWQnLCB1c2VySWQpXG4gICAgLmVxKCdpc19hY3RpdmUnLCB0cnVlKVxuICBcbiAgaWYgKHVzZXJNZW1iZXJzaGlwcykge1xuICAgIGNvbnN0IG5vdyA9IG5ldyBEYXRlKClcbiAgICBcbiAgICBmb3IgKGNvbnN0IG1lbWJlcnNoaXAgb2YgdXNlck1lbWJlcnNoaXBzKSB7XG4gICAgICAvLyBDaGVjayBpZiBub3QgZXhwaXJlZFxuICAgICAgaWYgKG1lbWJlcnNoaXAuZXhwaXJlc19hdCAmJiBuZXcgRGF0ZShtZW1iZXJzaGlwLmV4cGlyZXNfYXQpID4gbm93KSB7XG4gICAgICAgIGhhc01lbWJlcnNoaXAgPSB0cnVlXG4gICAgICAgIFxuICAgICAgICAvLyBUcmFjayB0aGUgbGF0ZXN0IGV4cGlyeVxuICAgICAgICBjb25zdCBleHBpcnlEYXRlID0gbmV3IERhdGUobWVtYmVyc2hpcC5leHBpcmVzX2F0KVxuICAgICAgICBpZiAoIW1lbWJlcnNoaXBFeHBpcnkgfHwgZXhwaXJ5RGF0ZSA+IG1lbWJlcnNoaXBFeHBpcnkpIHtcbiAgICAgICAgICBtZW1iZXJzaGlwRXhwaXJ5ID0gZXhwaXJ5RGF0ZVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBHZXQgYm94ZXMgZnJvbSBidW5kbGVcbiAgICAgICAgaWYgKG1lbWJlcnNoaXAuYnVuZGxlX2lkKSB7XG4gICAgICAgICAgY29uc3QgeyBkYXRhOiBidW5kbGUgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgICAgICAuZnJvbSgnYnVuZGxlcycpXG4gICAgICAgICAgICAuc2VsZWN0KCdib3hfaWRzJylcbiAgICAgICAgICAgIC5lcSgnaWQnLCBtZW1iZXJzaGlwLmJ1bmRsZV9pZClcbiAgICAgICAgICAgIC5zaW5nbGUoKVxuICAgICAgICAgIFxuICAgICAgICAgIGlmIChidW5kbGU/LmJveF9pZHMpIHtcbiAgICAgICAgICAgIGJ1bmRsZS5ib3hfaWRzLmZvckVhY2goYm94SWQgPT4gZW50aXRsZWRCb3hJZHMuYWRkKGJveElkKSlcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIElmIG1lbWJlcnNoaXAgaGFzIGEgcHJpY2Ugd2l0aCBhbGwtYWNjZXNzLCBhZGQgYWxsIGFjdGl2ZSBib3hlc1xuICAgICAgICBpZiAobWVtYmVyc2hpcC5wcmljZV9pZCkge1xuICAgICAgICAgIGNvbnN0IHsgZGF0YTogcHJpY2UgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgICAgICAuZnJvbSgncHJpY2VzJylcbiAgICAgICAgICAgIC5zZWxlY3QoJ21lbWJlcnNoaXBfZGF5cycpXG4gICAgICAgICAgICAuZXEoJ2lkJywgbWVtYmVyc2hpcC5wcmljZV9pZClcbiAgICAgICAgICAgIC5zaW5nbGUoKVxuICAgICAgICAgIFxuICAgICAgICAgIC8vIElmIGl0J3MgYSBtZW1iZXJzaGlwIHByaWNlLCBpdCBncmFudHMgYWxsLWFjY2Vzc1xuICAgICAgICAgIGlmIChwcmljZT8ubWVtYmVyc2hpcF9kYXlzKSB7XG4gICAgICAgICAgICBjb25zdCB7IGRhdGE6IGFsbEJveGVzIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAgICAgICAuZnJvbSgnYm94ZXMnKVxuICAgICAgICAgICAgICAuc2VsZWN0KCdpZCcpXG4gICAgICAgICAgICAgIC5lcSgnaXNfYWN0aXZlJywgdHJ1ZSlcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKGFsbEJveGVzKSB7XG4gICAgICAgICAgICAgIGFsbEJveGVzLmZvckVhY2goYm94ID0+IGVudGl0bGVkQm94SWRzLmFkZChib3guaWQpKVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxuICBcbiAgcmV0dXJuIHtcbiAgICBib3hJZHM6IEFycmF5LmZyb20oZW50aXRsZWRCb3hJZHMpLFxuICAgIGhhc01lbWJlcnNoaXAsXG4gICAgbWVtYmVyc2hpcEV4cGlyeVxuICB9XG59XG5cbi8qKlxuICogQ2hlY2sgaWYgYSB1c2VyIGhhcyBhY2Nlc3MgdG8gYSBzcGVjaWZpYyBib3hcbiAqIEBwYXJhbSB7c3RyaW5nfG51bGx9IHVzZXJJZCAtIFRoZSB1c2VyJ3MgSURcbiAqIEBwYXJhbSB7c3RyaW5nfSBib3hJZCAtIFRoZSBib3ggSUQgdG8gY2hlY2tcbiAqIEByZXR1cm5zIHtQcm9taXNlPGJvb2xlYW4+fVxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXNlckhhc0JveEFjY2Vzcyh1c2VySWQsIGJveElkKSB7XG4gIGNvbnN0IHsgYm94SWRzIH0gPSBhd2FpdCBnZXRVc2VyRW50aXRsZWRCb3hJZHModXNlcklkKVxuICByZXR1cm4gYm94SWRzLmluY2x1ZGVzKGJveElkKVxufVxuXG4vKipcbiAqIEdldCBib3hlcyB3aXRoIHZpc2liaWxpdHkgcnVsZXMgYXBwbGllZFxuICogSGlkZSBzYW1wbGUgYm94ZXMgaWYgdXNlciBvd25zIHRoZSByZWxhdGVkIGZ1bGwgYm94ICh2aWEgZnVsbF9ib3hfaWQpXG4gKiBAcGFyYW0ge3N0cmluZ3xudWxsfSB1c2VySWQgLSBUaGUgdXNlcidzIElEXG4gKiBAcmV0dXJucyB7UHJvbWlzZTx7Ym94ZXM6IGFueVtdLCBlbnRpdGxlZEJveElkczogc3RyaW5nW10sIGhhc01lbWJlcnNoaXA6IGJvb2xlYW59Pn1cbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEJveGVzV2l0aFZpc2liaWxpdHkodXNlcklkKSB7XG4gIGNvbnN0IHN1cGFiYXNlID0gY3JlYXRlU3VwYWJhc2VTZXJ2ZXIoKVxuICBcbiAgLy8gR2V0IHVzZXIgZW50aXRsZW1lbnRzXG4gIGNvbnN0IHsgYm94SWRzOiBlbnRpdGxlZEJveElkcywgaGFzTWVtYmVyc2hpcCwgbWVtYmVyc2hpcEV4cGlyeSB9ID0gYXdhaXQgZ2V0VXNlckVudGl0bGVkQm94SWRzKHVzZXJJZClcbiAgXG4gIC8vIEdldCBhbGwgYWN0aXZlIGJveGVzXG4gIGNvbnN0IHsgZGF0YTogYm94ZXMgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgLmZyb20oJ2JveGVzJylcbiAgICAuc2VsZWN0KCcqJylcbiAgICAuZXEoJ2lzX2FjdGl2ZScsIHRydWUpXG4gICAgLm9yZGVyKCdkaXNwbGF5X29yZGVyJywgeyBhc2NlbmRpbmc6IHRydWUgfSlcbiAgXG4gIGlmICghYm94ZXMpIHtcbiAgICByZXR1cm4geyBib3hlczogW10sIGVudGl0bGVkQm94SWRzLCBoYXNNZW1iZXJzaGlwLCBtZW1iZXJzaGlwRXhwaXJ5IH1cbiAgfVxuICBcbiAgLy8gQnVpbGQgYSBzZXQgb2YgZnVsbCBib3ggSURzIHRoYXQgdXNlciBvd25zXG4gIGNvbnN0IG93bmVkRnVsbEJveElkcyA9IG5ldyBTZXQoKVxuICBib3hlcy5mb3JFYWNoKGJveCA9PiB7XG4gICAgaWYgKCFib3guaXNfc2FtcGxlICYmIGVudGl0bGVkQm94SWRzLmluY2x1ZGVzKGJveC5pZCkpIHtcbiAgICAgIG93bmVkRnVsbEJveElkcy5hZGQoYm94LmlkKVxuICAgIH1cbiAgfSlcbiAgXG4gIC8vIEZpbHRlciBib3hlcyBiYXNlZCBvbiB2aXNpYmlsaXR5IHJ1bGVzOlxuICAvLyBIaWRlIHNhbXBsZSBib3ggaWYgdXNlciBvd25zIGl0cyByZWxhdGVkIGZ1bGwgYm94IChmdWxsX2JveF9pZClcbiAgY29uc3QgdmlzaWJsZUJveGVzID0gYm94ZXMuZmlsdGVyKGJveCA9PiB7XG4gICAgLy8gTm9uLXNhbXBsZSBib3hlcyBhcmUgYWx3YXlzIHZpc2libGVcbiAgICBpZiAoIWJveC5pc19zYW1wbGUpIHJldHVybiB0cnVlXG4gICAgXG4gICAgLy8gU2FtcGxlIGJveGVzOiBoaWRlIGlmIHVzZXIgb3ducyB0aGUgcmVsYXRlZCBmdWxsIGJveFxuICAgIGlmIChib3guZnVsbF9ib3hfaWQgJiYgb3duZWRGdWxsQm94SWRzLmhhcyhib3guZnVsbF9ib3hfaWQpKSB7XG4gICAgICByZXR1cm4gZmFsc2VcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIHRydWVcbiAgfSlcbiAgXG4gIC8vIE1hcmsgYm94ZXMgd2l0aCBhY2Nlc3MgaW5mb1xuICBjb25zdCBib3hlc1dpdGhBY2Nlc3MgPSB2aXNpYmxlQm94ZXMubWFwKGJveCA9PiAoe1xuICAgIC4uLmJveCxcbiAgICBoYXNBY2Nlc3M6IGVudGl0bGVkQm94SWRzLmluY2x1ZGVzKGJveC5pZClcbiAgfSkpXG4gIFxuICByZXR1cm4ge1xuICAgIGJveGVzOiBib3hlc1dpdGhBY2Nlc3MsXG4gICAgZW50aXRsZWRCb3hJZHMsXG4gICAgaGFzTWVtYmVyc2hpcCxcbiAgICBtZW1iZXJzaGlwRXhwaXJ5XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQge1xuICBnZXRVc2VyRW50aXRsZWRCb3hJZHMsXG4gIHVzZXJIYXNCb3hBY2Nlc3MsXG4gIGdldEJveGVzV2l0aFZpc2liaWxpdHlcbn1cbiJdLCJuYW1lcyI6WyJjcmVhdGVTdXBhYmFzZVNlcnZlciIsImdldFVzZXJFbnRpdGxlZEJveElkcyIsInVzZXJJZCIsInN1cGFiYXNlIiwiZW50aXRsZWRCb3hJZHMiLCJTZXQiLCJoYXNNZW1iZXJzaGlwIiwibWVtYmVyc2hpcEV4cGlyeSIsImRhdGEiLCJzYW1wbGVCb3hlcyIsImZyb20iLCJzZWxlY3QiLCJlcSIsImZvckVhY2giLCJib3giLCJhZGQiLCJpZCIsImJveElkcyIsIkFycmF5IiwidXNlclByb2R1Y3RzIiwibm93IiwiRGF0ZSIsInByb2R1Y3QiLCJleHBpcmVzX2F0IiwiYm94X2lkIiwidXNlck1lbWJlcnNoaXBzIiwibWVtYmVyc2hpcCIsImV4cGlyeURhdGUiLCJidW5kbGVfaWQiLCJidW5kbGUiLCJzaW5nbGUiLCJib3hfaWRzIiwiYm94SWQiLCJwcmljZV9pZCIsInByaWNlIiwibWVtYmVyc2hpcF9kYXlzIiwiYWxsQm94ZXMiLCJ1c2VySGFzQm94QWNjZXNzIiwiaW5jbHVkZXMiLCJnZXRCb3hlc1dpdGhWaXNpYmlsaXR5IiwiYm94ZXMiLCJvcmRlciIsImFzY2VuZGluZyIsIm93bmVkRnVsbEJveElkcyIsImlzX3NhbXBsZSIsInZpc2libGVCb3hlcyIsImZpbHRlciIsImZ1bGxfYm94X2lkIiwiaGFzIiwiYm94ZXNXaXRoQWNjZXNzIiwibWFwIiwiaGFzQWNjZXNzIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/entitlements.js\n");

/***/ }),

/***/ "(rsc)/./lib/stripe.js":
/*!***********************!*\
  !*** ./lib/stripe.js ***!
  \***********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getStripe: () => (/* binding */ getStripe),\n/* harmony export */   stripe: () => (/* binding */ stripe)\n/* harmony export */ });\n/* harmony import */ var stripe__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! stripe */ \"(rsc)/./node_modules/stripe/esm/stripe.esm.node.js\");\n\n// Lazy initialization to avoid build-time errors\nlet stripeInstance = null;\nfunction getStripe() {\n    if (!stripeInstance) {\n        if (!process.env.STRIPE_SECRET_KEY) {\n            throw new Error(\"STRIPE_SECRET_KEY is not set\");\n        }\n        stripeInstance = new stripe__WEBPACK_IMPORTED_MODULE_0__[\"default\"](process.env.STRIPE_SECRET_KEY, {\n            apiVersion: \"2024-12-18.acacia\"\n        });\n    }\n    return stripeInstance;\n}\n// For backward compatibility - but this will fail at build time if imported directly\n// Use getStripe() instead\nconst stripe = typeof process !== \"undefined\" && process.env.STRIPE_SECRET_KEY ? new stripe__WEBPACK_IMPORTED_MODULE_0__[\"default\"](process.env.STRIPE_SECRET_KEY, {\n    apiVersion: \"2024-12-18.acacia\"\n}) : null;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvc3RyaXBlLmpzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUEyQjtBQUUzQixpREFBaUQ7QUFDakQsSUFBSUMsaUJBQWlCO0FBRWQsU0FBU0M7SUFDZCxJQUFJLENBQUNELGdCQUFnQjtRQUNuQixJQUFJLENBQUNFLFFBQVFDLEdBQUcsQ0FBQ0MsaUJBQWlCLEVBQUU7WUFDbEMsTUFBTSxJQUFJQyxNQUFNO1FBQ2xCO1FBQ0FMLGlCQUFpQixJQUFJRCw4Q0FBTUEsQ0FBQ0csUUFBUUMsR0FBRyxDQUFDQyxpQkFBaUIsRUFBRTtZQUN6REUsWUFBWTtRQUNkO0lBQ0Y7SUFDQSxPQUFPTjtBQUNUO0FBRUEscUZBQXFGO0FBQ3JGLDBCQUEwQjtBQUNuQixNQUFNTyxTQUFTLE9BQU9MLFlBQVksZUFBZUEsUUFBUUMsR0FBRyxDQUFDQyxpQkFBaUIsR0FDakYsSUFBSUwsOENBQU1BLENBQUNHLFFBQVFDLEdBQUcsQ0FBQ0MsaUJBQWlCLEVBQUU7SUFBRUUsWUFBWTtBQUFvQixLQUM1RSxLQUFJIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYXN3ZWFsbGFyZS1hZG1pbi8uL2xpYi9zdHJpcGUuanM/NTA0ZCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgU3RyaXBlIGZyb20gJ3N0cmlwZSdcblxuLy8gTGF6eSBpbml0aWFsaXphdGlvbiB0byBhdm9pZCBidWlsZC10aW1lIGVycm9yc1xubGV0IHN0cmlwZUluc3RhbmNlID0gbnVsbFxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0U3RyaXBlKCkge1xuICBpZiAoIXN0cmlwZUluc3RhbmNlKSB7XG4gICAgaWYgKCFwcm9jZXNzLmVudi5TVFJJUEVfU0VDUkVUX0tFWSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdTVFJJUEVfU0VDUkVUX0tFWSBpcyBub3Qgc2V0JylcbiAgICB9XG4gICAgc3RyaXBlSW5zdGFuY2UgPSBuZXcgU3RyaXBlKHByb2Nlc3MuZW52LlNUUklQRV9TRUNSRVRfS0VZLCB7XG4gICAgICBhcGlWZXJzaW9uOiAnMjAyNC0xMi0xOC5hY2FjaWEnLFxuICAgIH0pXG4gIH1cbiAgcmV0dXJuIHN0cmlwZUluc3RhbmNlXG59XG5cbi8vIEZvciBiYWNrd2FyZCBjb21wYXRpYmlsaXR5IC0gYnV0IHRoaXMgd2lsbCBmYWlsIGF0IGJ1aWxkIHRpbWUgaWYgaW1wb3J0ZWQgZGlyZWN0bHlcbi8vIFVzZSBnZXRTdHJpcGUoKSBpbnN0ZWFkXG5leHBvcnQgY29uc3Qgc3RyaXBlID0gdHlwZW9mIHByb2Nlc3MgIT09ICd1bmRlZmluZWQnICYmIHByb2Nlc3MuZW52LlNUUklQRV9TRUNSRVRfS0VZIFxuICA/IG5ldyBTdHJpcGUocHJvY2Vzcy5lbnYuU1RSSVBFX1NFQ1JFVF9LRVksIHsgYXBpVmVyc2lvbjogJzIwMjQtMTItMTguYWNhY2lhJyB9KVxuICA6IG51bGxcbiJdLCJuYW1lcyI6WyJTdHJpcGUiLCJzdHJpcGVJbnN0YW5jZSIsImdldFN0cmlwZSIsInByb2Nlc3MiLCJlbnYiLCJTVFJJUEVfU0VDUkVUX0tFWSIsIkVycm9yIiwiYXBpVmVyc2lvbiIsInN0cmlwZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/stripe.js\n");

/***/ }),

/***/ "(rsc)/./lib/supabase-server.js":
/*!********************************!*\
  !*** ./lib/supabase-server.js ***!
  \********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createSupabaseServer: () => (/* binding */ createSupabaseServer)\n/* harmony export */ });\n/* harmony import */ var _supabase_ssr__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @supabase/ssr */ \"(rsc)/./node_modules/@supabase/ssr/dist/module/index.js\");\n/* harmony import */ var next_headers__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/headers */ \"(rsc)/./node_modules/next/dist/api/headers.js\");\n/* harmony import */ var _db_local__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./db-local */ \"(rsc)/./lib/db-local.js\");\n\n\n\nfunction createSupabaseServer() {\n    // Check if running in local mode\n    if (process.env.LOCAL_MODE === \"true\") {\n        return (0,_db_local__WEBPACK_IMPORTED_MODULE_2__.createLocalClient)();\n    }\n    const cookieStore = (0,next_headers__WEBPACK_IMPORTED_MODULE_1__.cookies)();\n    return (0,_supabase_ssr__WEBPACK_IMPORTED_MODULE_0__.createServerClient)(\"https://pwdwemakaozxmutwswqa.supabase.co\", \"sb_publishable_K-L2v83yXtTeHkSWtFX_ag_ZbjbDq8p\", {\n        cookies: {\n            getAll () {\n                return cookieStore.getAll();\n            },\n            setAll (cookiesToSet) {\n                try {\n                    cookiesToSet.forEach(({ name, value, options })=>cookieStore.set(name, value, options));\n                } catch  {\n                // Server component, ignore\n                }\n            }\n        }\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvc3VwYWJhc2Utc2VydmVyLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBa0Q7QUFDWjtBQUNRO0FBRXZDLFNBQVNHO0lBQ2QsaUNBQWlDO0lBQ2pDLElBQUlDLFFBQVFDLEdBQUcsQ0FBQ0MsVUFBVSxLQUFLLFFBQVE7UUFDckMsT0FBT0osNERBQWlCQTtJQUMxQjtJQUVBLE1BQU1LLGNBQWNOLHFEQUFPQTtJQUUzQixPQUFPRCxpRUFBa0JBLENBQ3ZCSSwwQ0FBb0MsRUFDcENBLGdEQUF5QyxFQUN6QztRQUNFSCxTQUFTO1lBQ1BTO2dCQUNFLE9BQU9ILFlBQVlHLE1BQU07WUFDM0I7WUFDQUMsUUFBT0MsWUFBWTtnQkFDakIsSUFBSTtvQkFDRkEsYUFBYUMsT0FBTyxDQUFDLENBQUMsRUFBRUMsSUFBSSxFQUFFQyxLQUFLLEVBQUVDLE9BQU8sRUFBRSxHQUM1Q1QsWUFBWVUsR0FBRyxDQUFDSCxNQUFNQyxPQUFPQztnQkFFakMsRUFBRSxPQUFNO2dCQUNOLDJCQUEyQjtnQkFDN0I7WUFDRjtRQUNGO0lBQ0Y7QUFFSiIsInNvdXJjZXMiOlsid2VicGFjazovL2Fzd2VhbGxhcmUtYWRtaW4vLi9saWIvc3VwYWJhc2Utc2VydmVyLmpzP2RiYWMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY3JlYXRlU2VydmVyQ2xpZW50IH0gZnJvbSAnQHN1cGFiYXNlL3NzcidcbmltcG9ydCB7IGNvb2tpZXMgfSBmcm9tICduZXh0L2hlYWRlcnMnXG5pbXBvcnQgeyBjcmVhdGVMb2NhbENsaWVudCB9IGZyb20gJy4vZGItbG9jYWwnXG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVTdXBhYmFzZVNlcnZlcigpIHtcbiAgLy8gQ2hlY2sgaWYgcnVubmluZyBpbiBsb2NhbCBtb2RlXG4gIGlmIChwcm9jZXNzLmVudi5MT0NBTF9NT0RFID09PSAndHJ1ZScpIHtcbiAgICByZXR1cm4gY3JlYXRlTG9jYWxDbGllbnQoKVxuICB9XG5cbiAgY29uc3QgY29va2llU3RvcmUgPSBjb29raWVzKClcbiAgXG4gIHJldHVybiBjcmVhdGVTZXJ2ZXJDbGllbnQoXG4gICAgcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMLFxuICAgIHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX0FOT05fS0VZLFxuICAgIHtcbiAgICAgIGNvb2tpZXM6IHtcbiAgICAgICAgZ2V0QWxsKCkge1xuICAgICAgICAgIHJldHVybiBjb29raWVTdG9yZS5nZXRBbGwoKVxuICAgICAgICB9LFxuICAgICAgICBzZXRBbGwoY29va2llc1RvU2V0KSB7XG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvb2tpZXNUb1NldC5mb3JFYWNoKCh7IG5hbWUsIHZhbHVlLCBvcHRpb25zIH0pID0+XG4gICAgICAgICAgICAgIGNvb2tpZVN0b3JlLnNldChuYW1lLCB2YWx1ZSwgb3B0aW9ucylcbiAgICAgICAgICAgIClcbiAgICAgICAgICB9IGNhdGNoIHtcbiAgICAgICAgICAgIC8vIFNlcnZlciBjb21wb25lbnQsIGlnbm9yZVxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgfVxuICApXG59XG4iXSwibmFtZXMiOlsiY3JlYXRlU2VydmVyQ2xpZW50IiwiY29va2llcyIsImNyZWF0ZUxvY2FsQ2xpZW50IiwiY3JlYXRlU3VwYWJhc2VTZXJ2ZXIiLCJwcm9jZXNzIiwiZW52IiwiTE9DQUxfTU9ERSIsImNvb2tpZVN0b3JlIiwiTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMIiwiTkVYVF9QVUJMSUNfU1VQQUJBU0VfQU5PTl9LRVkiLCJnZXRBbGwiLCJzZXRBbGwiLCJjb29raWVzVG9TZXQiLCJmb3JFYWNoIiwibmFtZSIsInZhbHVlIiwib3B0aW9ucyIsInNldCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/supabase-server.js\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/@supabase","vendor-chunks/tslib","vendor-chunks/iceberg-js","vendor-chunks/cookie","vendor-chunks/stripe","vendor-chunks/math-intrinsics","vendor-chunks/es-errors","vendor-chunks/uuid","vendor-chunks/qs","vendor-chunks/call-bind-apply-helpers","vendor-chunks/get-proto","vendor-chunks/object-inspect","vendor-chunks/has-symbols","vendor-chunks/gopd","vendor-chunks/function-bind","vendor-chunks/side-channel","vendor-chunks/side-channel-weakmap","vendor-chunks/side-channel-map","vendor-chunks/side-channel-list","vendor-chunks/hasown","vendor-chunks/get-intrinsic","vendor-chunks/es-object-atoms","vendor-chunks/es-define-property","vendor-chunks/dunder-proto","vendor-chunks/call-bound"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2F%5B%5B...path%5D%5D%2Froute&page=%2Fapi%2F%5B%5B...path%5D%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2F%5B%5B...path%5D%5D%2Froute.js&appDir=%2Fapp%2Fapps%2Fadmin%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fapp%2Fapps%2Fadmin&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();