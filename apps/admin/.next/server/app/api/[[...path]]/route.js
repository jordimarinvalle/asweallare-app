"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/[[...path]]/route";
exports.ids = ["app/api/[[...path]]/route"];
exports.modules = {

/***/ "../../client/components/action-async-storage.external":
/*!*******************************************************************************!*\
  !*** external "next/dist/client/components/action-async-storage.external.js" ***!
  \*******************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/action-async-storage.external.js");

/***/ }),

/***/ "../../client/components/request-async-storage.external":
/*!********************************************************************************!*\
  !*** external "next/dist/client/components/request-async-storage.external.js" ***!
  \********************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/request-async-storage.external.js");

/***/ }),

/***/ "../../client/components/static-generation-async-storage.external":
/*!******************************************************************************************!*\
  !*** external "next/dist/client/components/static-generation-async-storage.external.js" ***!
  \******************************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/static-generation-async-storage.external.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "pg":
/*!*********************!*\
  !*** external "pg" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("pg");

/***/ }),

/***/ "buffer":
/*!*************************!*\
  !*** external "buffer" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("buffer");

/***/ }),

/***/ "child_process":
/*!********************************!*\
  !*** external "child_process" ***!
  \********************************/
/***/ ((module) => {

module.exports = require("child_process");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "events":
/*!*************************!*\
  !*** external "events" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("events");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

module.exports = require("https");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("stream");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("util");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2F%5B%5B...path%5D%5D%2Froute&page=%2Fapi%2F%5B%5B...path%5D%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2F%5B%5B...path%5D%5D%2Froute.js&appDir=%2Fapp%2Fapps%2Fadmin%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fapp%2Fapps%2Fadmin&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D!":
/*!*****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2F%5B%5B...path%5D%5D%2Froute&page=%2Fapi%2F%5B%5B...path%5D%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2F%5B%5B...path%5D%5D%2Froute.js&appDir=%2Fapp%2Fapps%2Fadmin%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fapp%2Fapps%2Fadmin&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _app_apps_admin_app_api_path_route_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/[[...path]]/route.js */ \"(rsc)/./app/api/[[...path]]/route.js\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"standalone\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/[[...path]]/route\",\n        pathname: \"/api/[[...path]]\",\n        filename: \"route\",\n        bundlePath: \"app/api/[[...path]]/route\"\n    },\n    resolvedPagePath: \"/app/apps/admin/app/api/[[...path]]/route.js\",\n    nextConfigOutput,\n    userland: _app_apps_admin_app_api_path_route_js__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/[[...path]]/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkYlNUIlNUIuLi5wYXRoJTVEJTVEJTJGcm91dGUmcGFnZT0lMkZhcGklMkYlNUIlNUIuLi5wYXRoJTVEJTVEJTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGJTVCJTVCLi4ucGF0aCU1RCU1RCUyRnJvdXRlLmpzJmFwcERpcj0lMkZhcHAlMkZhcHBzJTJGYWRtaW4lMkZhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPSUyRmFwcCUyRmFwcHMlMkZhZG1pbiZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD1zdGFuZGFsb25lJnByZWZlcnJlZFJlZ2lvbj0mbWlkZGxld2FyZUNvbmZpZz1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNjO0FBQ0o7QUFDekU7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGdIQUFtQjtBQUMzQztBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLFlBQVk7QUFDWixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsUUFBUSxpRUFBaUU7QUFDekU7QUFDQTtBQUNBLFdBQVcsNEVBQVc7QUFDdEI7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUN1SDs7QUFFdkgiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9hc3dlYWxsYXJlLWFkbWluLz8yMmFjIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgcGF0Y2hGZXRjaCBhcyBfcGF0Y2hGZXRjaCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi9wYXRjaC1mZXRjaFwiO1xuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi9hcHAvYXBwcy9hZG1pbi9hcHAvYXBpL1tbLi4ucGF0aF1dL3JvdXRlLmpzXCI7XG4vLyBXZSBpbmplY3QgdGhlIG5leHRDb25maWdPdXRwdXQgaGVyZSBzbyB0aGF0IHdlIGNhbiB1c2UgdGhlbSBpbiB0aGUgcm91dGVcbi8vIG1vZHVsZS5cbmNvbnN0IG5leHRDb25maWdPdXRwdXQgPSBcInN0YW5kYWxvbmVcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvW1suLi5wYXRoXV0vcm91dGVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9bWy4uLnBhdGhdXVwiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvW1suLi5wYXRoXV0vcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCIvYXBwL2FwcHMvYWRtaW4vYXBwL2FwaS9bWy4uLnBhdGhdXS9yb3V0ZS5qc1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzIH0gPSByb3V0ZU1vZHVsZTtcbmNvbnN0IG9yaWdpbmFsUGF0aG5hbWUgPSBcIi9hcGkvW1suLi5wYXRoXV0vcm91dGVcIjtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgc2VydmVySG9va3MsXG4gICAgICAgIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2F%5B%5B...path%5D%5D%2Froute&page=%2Fapi%2F%5B%5B...path%5D%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2F%5B%5B...path%5D%5D%2Froute.js&appDir=%2Fapp%2Fapps%2Fadmin%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fapp%2Fapps%2Fadmin&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/[[...path]]/route.js":
/*!**************************************!*\
  !*** ./app/api/[[...path]]/route.js ***!
  \**************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   DELETE: () => (/* binding */ DELETE),\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   OPTIONS: () => (/* binding */ OPTIONS),\n/* harmony export */   POST: () => (/* binding */ POST),\n/* harmony export */   PUT: () => (/* binding */ PUT)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_supabase_server__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../lib/supabase-server */ \"(rsc)/./lib/supabase-server.js\");\n/* harmony import */ var _lib_stripe__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../lib/stripe */ \"(rsc)/./lib/stripe.js\");\n/* harmony import */ var uuid__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! uuid */ \"(rsc)/./node_modules/uuid/dist/esm-node/v4.js\");\n/* harmony import */ var _lib_entitlements__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../lib/entitlements */ \"(rsc)/./lib/entitlements.js\");\n\n\n\n\n// CORS helper\nfunction handleCORS(response) {\n    response.headers.set(\"Access-Control-Allow-Origin\", \"*\");\n    response.headers.set(\"Access-Control-Allow-Methods\", \"GET, POST, PUT, DELETE, OPTIONS\");\n    response.headers.set(\"Access-Control-Allow-Headers\", \"Content-Type, Authorization\");\n    return response;\n}\n// OPTIONS handler for CORS\nasync function OPTIONS() {\n    return handleCORS(new next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse(null, {\n        status: 200\n    }));\n}\n// Helper to get authenticated user\nasync function getAuthenticatedUser() {\n    // In local mode, check the auth-token cookie\n    if (process.env.LOCAL_MODE === \"true\") {\n        const { cookies } = await Promise.resolve(/*! import() */).then(__webpack_require__.bind(__webpack_require__, /*! next/headers */ \"(rsc)/./node_modules/next/dist/api/headers.js\"));\n        const { getUserFromToken } = await Promise.all(/*! import() */[__webpack_require__.e(\"vendor-chunks/semver\"), __webpack_require__.e(\"vendor-chunks/bcryptjs\"), __webpack_require__.e(\"vendor-chunks/jsonwebtoken\"), __webpack_require__.e(\"vendor-chunks/lodash.includes\"), __webpack_require__.e(\"vendor-chunks/jws\"), __webpack_require__.e(\"vendor-chunks/lodash.once\"), __webpack_require__.e(\"vendor-chunks/jwa\"), __webpack_require__.e(\"vendor-chunks/lodash.isinteger\"), __webpack_require__.e(\"vendor-chunks/ecdsa-sig-formatter\"), __webpack_require__.e(\"vendor-chunks/lodash.isplainobject\"), __webpack_require__.e(\"vendor-chunks/ms\"), __webpack_require__.e(\"vendor-chunks/lodash.isstring\"), __webpack_require__.e(\"vendor-chunks/lodash.isnumber\"), __webpack_require__.e(\"vendor-chunks/lodash.isboolean\"), __webpack_require__.e(\"vendor-chunks/safe-buffer\"), __webpack_require__.e(\"vendor-chunks/buffer-equal-constant-time\"), __webpack_require__.e(\"_rsc_lib_auth-local_js\")]).then(__webpack_require__.bind(__webpack_require__, /*! ../../../lib/auth-local */ \"(rsc)/./lib/auth-local.js\"));\n        const cookieStore = cookies();\n        const token = cookieStore.get(\"auth-token\")?.value;\n        if (token) {\n            const user = await getUserFromToken(token);\n            if (user) {\n                return {\n                    user,\n                    error: null\n                };\n            }\n        }\n        return {\n            user: null,\n            error: null\n        };\n    }\n    // Supabase mode\n    const supabase = (0,_lib_supabase_server__WEBPACK_IMPORTED_MODULE_1__.createSupabaseServer)();\n    const { data: { user }, error } = await supabase.auth.getUser();\n    return {\n        user,\n        error\n    };\n}\n// Import entitlements helper\n\n// Helper to get user's accessible boxes - uses entitlements as source of truth\nasync function getUserAccessibleBoxes(userId) {\n    const supabase = (0,_lib_supabase_server__WEBPACK_IMPORTED_MODULE_1__.createSupabaseServer)();\n    // Get all active boxes\n    const { data: boxes, error: boxError } = await supabase.from(\"boxes\").select(\"*\").eq(\"is_active\", true).order(\"display_order\", {\n        ascending: true\n    });\n    if (boxError || !boxes) {\n        return {\n            boxes: [],\n            accessibleBoxIds: []\n        };\n    }\n    // Use entitlements helper as the single source of truth\n    const { boxIds: accessibleBoxIds, hasMembership } = await (0,_lib_entitlements__WEBPACK_IMPORTED_MODULE_3__.getUserEntitledBoxIds)(userId);\n    return {\n        boxes,\n        accessibleBoxIds,\n        hasAllAccess: hasMembership\n    };\n}\n// Helper to check if user has paid access\nasync function checkUserAccess(userId) {\n    const { accessibleBoxIds, hasAllAccess } = await getUserAccessibleBoxes(userId);\n    // User has paid access if they have access to any non-sample box\n    const supabase = (0,_lib_supabase_server__WEBPACK_IMPORTED_MODULE_1__.createSupabaseServer)();\n    const { data: sampleBoxes } = await supabase.from(\"boxes\").select(\"id\").eq(\"is_sample\", true);\n    const sampleBoxIds = (sampleBoxes || []).map((b)=>b.id);\n    const hasPaidAccess = hasAllAccess || accessibleBoxIds.some((id)=>!sampleBoxIds.includes(id));\n    return {\n        hasPaidAccess,\n        accessibleBoxIds,\n        hasAllAccess\n    };\n}\n// Main request handler\nasync function GET(request) {\n    const url = new URL(request.url);\n    const path = url.pathname.replace(\"/api/\", \"\");\n    const supabase = (0,_lib_supabase_server__WEBPACK_IMPORTED_MODULE_1__.createSupabaseServer)();\n    try {\n        // AUTH ROUTES\n        if (path === \"auth/user\") {\n            const { user, error } = await getAuthenticatedUser();\n            if (error || !user) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    user: null\n                }, {\n                    status: 200\n                }));\n            }\n            // Check user access\n            const { hasPaidAccess, accessibleBoxIds, hasAllAccess } = await checkUserAccess(user.id);\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                user: {\n                    id: user.id,\n                    email: user.email,\n                    hasPaidAccess,\n                    accessibleBoxIds,\n                    hasAllAccess\n                }\n            }));\n        }\n        // BOXES ROUTES - Get all boxes with user access info\n        if (path === \"boxes\") {\n            const { user } = await getAuthenticatedUser();\n            const userId = user?.id || null;\n            const { boxes, accessibleBoxIds, hasAllAccess } = await getUserAccessibleBoxes(userId);\n            // Add hasAccess flag to each box\n            const boxesWithAccess = boxes.map((box)=>({\n                    ...box,\n                    hasAccess: accessibleBoxIds.includes(box.id)\n                }));\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                boxes: boxesWithAccess,\n                hasAllAccess\n            }));\n        }\n        // CARDS ROUTES - Now supports box filtering\n        if (path === \"cards\") {\n            const { user } = await getAuthenticatedUser();\n            const boxIds = url.searchParams.get(\"box_ids\")?.split(\",\").filter(Boolean) || [];\n            // Get user's accessible boxes\n            const { accessibleBoxIds } = await getUserAccessibleBoxes(user?.id || null);\n            // Determine which boxes to query\n            let queryBoxIds = [];\n            if (boxIds.length > 0) {\n                queryBoxIds = boxIds.filter((id)=>accessibleBoxIds.includes(id));\n                if (queryBoxIds.length === 0) {\n                    return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                        cards: [],\n                        message: \"No accessible boxes\"\n                    }));\n                }\n            } else if (accessibleBoxIds.length > 0) {\n                queryBoxIds = accessibleBoxIds;\n            } else {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    cards: [],\n                    message: \"No accessible boxes\"\n                }));\n            }\n            // Query cards\n            const { data: cards, error } = await supabase.from(\"cards\").select(\"*\").in(\"box_id\", queryBoxIds).eq(\"is_active\", true).order(\"created_at\", {\n                ascending: false\n            });\n            if (error) {\n                console.error(\"[CARDS API] Error fetching cards:\", error);\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            // If we have cards, fetch piles separately for card back images\n            let pilesMap = {};\n            if (cards && cards.length > 0) {\n                const pileIds = [\n                    ...new Set(cards.map((c)=>c.pile_id).filter(Boolean))\n                ];\n                if (pileIds.length > 0) {\n                    const { data: piles } = await supabase.from(\"piles\").select(\"*\").in(\"id\", pileIds);\n                    if (piles) {\n                        piles.forEach((p)=>{\n                            pilesMap[p.id] = p;\n                        });\n                    }\n                }\n            }\n            // Transform cards to include pile info for the frontend\n            const transformedCards = (cards || []).map((card)=>{\n                const pile = pilesMap[card.pile_id] || {};\n                return {\n                    id: card.id,\n                    box_id: card.box_id,\n                    pile_id: card.pile_id,\n                    text: card.text,\n                    image_path: card.image_path,\n                    is_active: card.is_active,\n                    created_at: card.created_at,\n                    // Add pile info for card back images\n                    color: pile.slug || \"black\",\n                    pile_name: pile.name,\n                    pile_image: pile.image_path,\n                    // Legacy fields for compatibility\n                    title: card.text,\n                    imagePath: card.image_path\n                };\n            });\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                cards: transformedCards\n            }));\n        }\n        // SUBSCRIPTION PLANS\n        if (path === \"plans\") {\n            const { data: plans, error } = await supabase.from(\"subscription_plans\").select(\"*\").eq(\"is_active\", true).order(\"price\", {\n                ascending: true\n            });\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                plans: plans || []\n            }));\n        }\n        // COLLECTION SERIES - Public endpoint\n        if (path === \"collection-series\") {\n            const { data: series, error } = await supabase.from(\"collection_series\").select(\"*\").eq(\"is_active\", true).order(\"display_order\", {\n                ascending: true\n            });\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                series: series || []\n            }));\n        }\n        // USER PURCHASES - Get user's purchase history\n        if (path === \"purchases\") {\n            const { user, error: authError } = await getAuthenticatedUser();\n            if (authError || !user) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Unauthorized\"\n                }, {\n                    status: 401\n                }));\n            }\n            const { data: purchases, error } = await supabase.from(\"user_products\").select(\"*, boxes(name, color, price)\").eq(\"user_id\", user.id).order(\"created_at\", {\n                ascending: false\n            });\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                purchases: purchases || []\n            }));\n        }\n        // SAVED DRAWS ROUTES\n        if (path === \"draws\") {\n            const { user, error: authError } = await getAuthenticatedUser();\n            if (authError || !user) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Unauthorized\"\n                }, {\n                    status: 401\n                }));\n            }\n            const { data: draws, error } = await supabase.from(\"saved_draws\").select(\"*\").eq(\"userid\", user.id).order(\"timestamp\", {\n                ascending: false\n            });\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                draws: draws || []\n            }));\n        }\n        // ADMIN ROUTES - Get all cards\n        if (path === \"admin/cards\") {\n            const { user, error: authError } = await getAuthenticatedUser();\n            if (authError || !user) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Unauthorized\"\n                }, {\n                    status: 401\n                }));\n            }\n            // Get cards\n            const { data: cards, error } = await supabase.from(\"cards\").select(\"*\").order(\"created_at\", {\n                ascending: false\n            });\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            // Get boxes, piles and series for enrichment - use Promise.all for reliability\n            const [boxesResult, pilesResult, seriesResult] = await Promise.all([\n                supabase.from(\"boxes\").select(\"*\"),\n                supabase.from(\"piles\").select(\"*\"),\n                supabase.from(\"collection_series\").select(\"*\")\n            ]);\n            const boxes = boxesResult.data || [];\n            const piles = pilesResult.data || [];\n            const series = seriesResult.data || [];\n            const boxMap = {};\n            const pileMap = {};\n            const seriesMap = {};\n            boxes.forEach((b)=>{\n                if (b && b.id) boxMap[b.id] = b;\n            });\n            piles.forEach((p)=>{\n                if (p && p.id) pileMap[p.id] = p;\n            });\n            series.forEach((s)=>{\n                if (s && s.id) seriesMap[s.id] = s;\n            });\n            // Enrich cards with box/pile info\n            const enrichedCards = (cards || []).map((card)=>{\n                const box = boxMap[card.box_id];\n                const pile = pileMap[card.pile_id];\n                const collectionSeries = box ? seriesMap[box.collection_series_id] : null;\n                return {\n                    ...card,\n                    boxes: box ? {\n                        name: box.name,\n                        color: box.color,\n                        collection_series_id: box.collection_series_id,\n                        collection_series: collectionSeries ? {\n                            name: collectionSeries.name\n                        } : null\n                    } : null,\n                    piles: pile ? {\n                        name: pile.name,\n                        slug: pile.slug\n                    } : null\n                };\n            });\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                cards: enrichedCards\n            }));\n        }\n        // ADMIN ROUTES - Get all boxes\n        if (path === \"admin/boxes\") {\n            const { user, error: authError } = await getAuthenticatedUser();\n            if (authError || !user) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Unauthorized\"\n                }, {\n                    status: 401\n                }));\n            }\n            // Get boxes\n            const { data: boxes, error } = await supabase.from(\"boxes\").select(\"*\").order(\"display_order\", {\n                ascending: true\n            });\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            // Get all related data - use Promise.all for parallel fetching\n            const [cardsResult, pilesResult, seriesResult, pricesResult] = await Promise.all([\n                supabase.from(\"cards\").select(\"*\"),\n                supabase.from(\"piles\").select(\"*\"),\n                supabase.from(\"collection_series\").select(\"*\"),\n                supabase.from(\"prices\").select(\"*\")\n            ]);\n            const cards = cardsResult.data || [];\n            const piles = pilesResult.data || [];\n            const series = seriesResult.data || [];\n            const prices = pricesResult.data || [];\n            // Log for debugging\n            console.log(`[admin/boxes] Loaded ${boxes?.length || 0} boxes, ${series.length} series, ${piles.length} piles, ${prices.length} prices`);\n            const seriesMap = {};\n            const priceMap = {};\n            const pileMap = {};\n            series.forEach((s)=>{\n                if (s && s.id) seriesMap[s.id] = s;\n            });\n            prices.forEach((p)=>{\n                if (p && p.id) priceMap[p.id] = p;\n            });\n            piles.forEach((p)=>{\n                if (p && p.id) pileMap[p.id] = p;\n            });\n            // Count cards per box per pile\n            const cardCounts = {};\n            if (cards) {\n                cards.forEach((card)=>{\n                    const key = `${card.box_id}`;\n                    if (!cardCounts[key]) {\n                        cardCounts[key] = {\n                            total: 0,\n                            byPile: {}\n                        };\n                    }\n                    cardCounts[key].total++;\n                    const pileId = card.pile_id;\n                    if (!cardCounts[key].byPile[pileId]) {\n                        cardCounts[key].byPile[pileId] = {\n                            count: 0,\n                            pileName: pileMap[pileId]?.name || \"Unknown\",\n                            pileSlug: pileMap[pileId]?.slug || \"\"\n                        };\n                    }\n                    cardCounts[key].byPile[pileId].count++;\n                });\n            }\n            // Enrich boxes with related data\n            const enrichedBoxes = (boxes || []).map((box)=>({\n                    ...box,\n                    collection_series: seriesMap[box.collection_series_id] || null,\n                    prices: priceMap[box.price_id] || null,\n                    cardStats: cardCounts[box.id] || {\n                        total: 0,\n                        byPile: {}\n                    }\n                }));\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                boxes: enrichedBoxes,\n                piles: piles || []\n            }));\n        }\n        // ADMIN ROUTES - Get all collection series\n        if (path === \"admin/collection-series\") {\n            const { user, error: authError } = await getAuthenticatedUser();\n            if (authError || !user) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Unauthorized\"\n                }, {\n                    status: 401\n                }));\n            }\n            const { data: series, error } = await supabase.from(\"collection_series\").select(\"*\").order(\"display_order\", {\n                ascending: true\n            });\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                series: series || []\n            }));\n        }\n        // ADMIN ROUTES - Get all prices\n        if (path === \"admin/prices\") {\n            const { user, error: authError } = await getAuthenticatedUser();\n            if (authError || !user) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Unauthorized\"\n                }, {\n                    status: 401\n                }));\n            }\n            const { data: prices, error } = await supabase.from(\"prices\").select(\"*\").order(\"display_order\", {\n                ascending: true\n            });\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                prices: prices || []\n            }));\n        }\n        // ADMIN ROUTES - Get all piles\n        if (path === \"admin/piles\") {\n            const { user, error: authError } = await getAuthenticatedUser();\n            if (authError || !user) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Unauthorized\"\n                }, {\n                    status: 401\n                }));\n            }\n            // Get piles first\n            const { data: piles, error: pilesError } = await supabase.from(\"piles\").select(\"*\").order(\"display_order\", {\n                ascending: true\n            });\n            if (pilesError) {\n                console.error(\"Failed to load piles:\", pilesError);\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: pilesError.message\n                }, {\n                    status: 500\n                }));\n            }\n            // Get all series for mapping - do this as a separate guaranteed query\n            const { data: series, error: seriesError } = await supabase.from(\"collection_series\").select(\"*\");\n            if (seriesError) {\n                console.error(\"Failed to load collection_series:\", seriesError);\n            }\n            // Build series lookup map\n            const seriesMap = {};\n            if (series && Array.isArray(series)) {\n                series.forEach((s)=>{\n                    if (s && s.id) {\n                        seriesMap[s.id] = s;\n                    }\n                });\n            }\n            // Log for debugging\n            console.log(`[admin/piles] Loaded ${(piles || []).length} piles, ${Object.keys(seriesMap).length} series`);\n            // Enrich piles with series data\n            const enrichedPiles = (piles || []).map((p)=>{\n                const seriesData = p.collection_series_id ? seriesMap[p.collection_series_id] : null;\n                return {\n                    ...p,\n                    collection_series: seriesData || null\n                };\n            });\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                piles: enrichedPiles\n            }));\n        }\n        // ADMIN ROUTES - Get all bundles\n        if (path === \"admin/bundles\") {\n            const { user, error: authError } = await getAuthenticatedUser();\n            if (authError || !user) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Unauthorized\"\n                }, {\n                    status: 401\n                }));\n            }\n            const { data: bundles, error } = await supabase.from(\"bundles\").select(\"*\").order(\"display_order\", {\n                ascending: true\n            });\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            // Enrich with price info\n            const { data: prices } = await supabase.from(\"prices\").select(\"*\");\n            const priceMap = {};\n            if (prices) prices.forEach((p)=>{\n                priceMap[p.id] = p;\n            });\n            const enrichedBundles = (bundles || []).map((b)=>({\n                    ...b,\n                    prices: priceMap[b.price_id] || null\n                }));\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                bundles: enrichedBundles\n            }));\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                bundles: bundles || []\n            }));\n        }\n        // PUBLIC ROUTES - Get active prices for store\n        if (path === \"store/prices\") {\n            const { data: prices, error } = await supabase.from(\"prices\").select(\"*\").eq(\"is_active\", true).order(\"display_order\", {\n                ascending: true\n            });\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                prices: prices || []\n            }));\n        }\n        // PUBLIC ROUTES - Get active bundles for store\n        if (path === \"store/bundles\") {\n            const { data: bundles, error } = await supabase.from(\"bundles\").select(\"*, prices(id, label, amount, currency, is_membership, membership_days)\").eq(\"is_active\", true).order(\"display_order\", {\n                ascending: true\n            });\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                bundles: bundles || []\n            }));\n        }\n        return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Route not found\"\n        }, {\n            status: 404\n        }));\n    } catch (error) {\n        console.error(\"API Error:\", error);\n        return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: error.message\n        }, {\n            status: 500\n        }));\n    }\n}\nasync function POST(request) {\n    const url = new URL(request.url);\n    const path = url.pathname.replace(\"/api/\", \"\");\n    const supabase = (0,_lib_supabase_server__WEBPACK_IMPORTED_MODULE_1__.createSupabaseServer)();\n    try {\n        const body = await request.json();\n        // AUTH ROUTES\n        if (path === \"auth/signup\") {\n            const { email, password } = body;\n            const { data, error } = await supabase.auth.signUp({\n                email,\n                password\n            });\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 400\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                user: data.user\n            }));\n        }\n        if (path === \"auth/signin\") {\n            const { email, password } = body;\n            const { data, error } = await supabase.auth.signInWithPassword({\n                email,\n                password\n            });\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 400\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                user: data.user\n            }));\n        }\n        if (path === \"auth/signout\") {\n            const { error } = await supabase.auth.signOut();\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 400\n                }));\n            }\n            // Create response and clear auth cookies\n            const response = next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true\n            });\n            // Clear Supabase auth cookies by setting them to expire\n            const cookieOptions = {\n                path: \"/\",\n                expires: new Date(0),\n                maxAge: 0\n            };\n            response.cookies.set(\"sb-access-token\", \"\", cookieOptions);\n            response.cookies.set(\"sb-refresh-token\", \"\", cookieOptions);\n            // Also try to clear any Supabase project-specific cookies\n            const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL || \"\";\n            const projectRef = supabaseUrl.match(/https:\\/\\/([^.]+)/)?.[1];\n            if (projectRef) {\n                response.cookies.set(`sb-${projectRef}-auth-token`, \"\", cookieOptions);\n                response.cookies.set(`sb-${projectRef}-auth-token-code-verifier`, \"\", cookieOptions);\n            }\n            return handleCORS(response);\n        }\n        if (path === \"auth/google\") {\n            const { data, error } = await supabase.auth.signInWithOAuth({\n                provider: \"google\",\n                options: {\n                    redirectTo: `${process.env.NEXT_PUBLIC_BASE_URL}/auth/callback`\n                }\n            });\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 400\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                url: data.url\n            }));\n        }\n        // Password Reset Request\n        if (path === \"auth/reset-password\") {\n            const { email } = body;\n            if (!email) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Email is required\"\n                }, {\n                    status: 400\n                }));\n            }\n            const { error } = await supabase.auth.resetPasswordForEmail(email, {\n                redirectTo: `${process.env.NEXT_PUBLIC_BASE_URL}/auth/reset-callback`\n            });\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 400\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true,\n                message: \"Password reset email sent\"\n            }));\n        }\n        // SAVED DRAWS\n        if (path === \"draws/save\") {\n            const { user, error: authError } = await getAuthenticatedUser();\n            if (authError || !user) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Unauthorized\"\n                }, {\n                    status: 401\n                }));\n            }\n            const { blackCardId, whiteCardId, blackCardTitle, whiteCardTitle } = body;\n            const draw = {\n                id: (0,uuid__WEBPACK_IMPORTED_MODULE_4__[\"default\"])(),\n                userid: user.id,\n                useremail: user.email,\n                blackcardid: blackCardId,\n                whitecardid: whiteCardId,\n                blackcardtitle: blackCardTitle,\n                whitecardtitle: whiteCardTitle,\n                timestamp: new Date().toISOString()\n            };\n            const { data, error } = await supabase.from(\"saved_draws\").insert([\n                draw\n            ]).select().single();\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                draw: data\n            }));\n        }\n        // PAYMENT ROUTES - Purchase a single box\n        if (path === \"payment/purchase-box\") {\n            const { user, error: authError } = await getAuthenticatedUser();\n            if (authError || !user) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Unauthorized\"\n                }, {\n                    status: 401\n                }));\n            }\n            const { boxId } = body;\n            // Get box details\n            const { data: box, error: boxError } = await supabase.from(\"boxes\").select(\"*\").eq(\"id\", boxId).single();\n            if (boxError || !box) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Box not found\"\n                }, {\n                    status: 404\n                }));\n            }\n            if (box.is_sample) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Sample box is free\"\n                }, {\n                    status: 400\n                }));\n            }\n            const session = await (0,_lib_stripe__WEBPACK_IMPORTED_MODULE_2__.getStripe)().checkout.sessions.create({\n                payment_method_types: [\n                    \"card\"\n                ],\n                line_items: [\n                    {\n                        price_data: {\n                            currency: \"usd\",\n                            product_data: {\n                                name: `AS WE ALL ARE - ${box.name}`,\n                                description: box.description || `Unlock the ${box.name} card collection`\n                            },\n                            unit_amount: Math.round(box.price * 100)\n                        },\n                        quantity: 1\n                    }\n                ],\n                mode: \"payment\",\n                success_url: `${process.env.NEXT_PUBLIC_BASE_URL}?payment=success&box=${boxId}`,\n                cancel_url: `${process.env.NEXT_PUBLIC_BASE_URL}?payment=cancelled`,\n                client_reference_id: user.id,\n                customer_email: user.email,\n                metadata: {\n                    box_id: boxId,\n                    purchase_type: \"one_time\"\n                }\n            });\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                url: session.url\n            }));\n        }\n        // PAYMENT ROUTES - Subscribe to all access\n        if (path === \"payment/subscribe-all\") {\n            const { user, error: authError } = await getAuthenticatedUser();\n            if (authError || !user) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Unauthorized\"\n                }, {\n                    status: 401\n                }));\n            }\n            const { planId } = body;\n            // Get plan details\n            const { data: plan, error: planError } = await supabase.from(\"subscription_plans\").select(\"*\").eq(\"id\", planId).single();\n            if (planError || !plan) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Plan not found\"\n                }, {\n                    status: 404\n                }));\n            }\n            // Calculate interval\n            let interval = \"month\";\n            let intervalCount = 1;\n            if (plan.interval === \"quarter\") {\n                interval = \"month\";\n                intervalCount = 3;\n            } else if (plan.interval === \"year\") {\n                interval = \"year\";\n                intervalCount = 1;\n            }\n            const session = await (0,_lib_stripe__WEBPACK_IMPORTED_MODULE_2__.getStripe)().checkout.sessions.create({\n                payment_method_types: [\n                    \"card\"\n                ],\n                line_items: [\n                    {\n                        price_data: {\n                            currency: \"usd\",\n                            product_data: {\n                                name: `AS WE ALL ARE - ${plan.name}`,\n                                description: plan.description || \"Full access to all card boxes\"\n                            },\n                            unit_amount: Math.round(plan.price * 100),\n                            recurring: {\n                                interval,\n                                interval_count: intervalCount\n                            }\n                        },\n                        quantity: 1\n                    }\n                ],\n                mode: \"subscription\",\n                success_url: `${process.env.NEXT_PUBLIC_BASE_URL}?payment=success&subscription=true`,\n                cancel_url: `${process.env.NEXT_PUBLIC_BASE_URL}?payment=cancelled`,\n                client_reference_id: user.id,\n                customer_email: user.email,\n                metadata: {\n                    plan_id: planId,\n                    purchase_type: \"all_access\"\n                }\n            });\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                url: session.url\n            }));\n        }\n        // CANCEL SUBSCRIPTION\n        if (path === \"payment/cancel-subscription\") {\n            const { user, error: authError } = await getAuthenticatedUser();\n            if (authError || !user) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Unauthorized\"\n                }, {\n                    status: 401\n                }));\n            }\n            const { purchaseId } = body;\n            // Get the purchase record\n            const { data: purchase, error: purchaseError } = await supabase.from(\"user_products\").select(\"*\").eq(\"id\", purchaseId).eq(\"user_id\", user.id).single();\n            if (purchaseError || !purchase) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Purchase not found\"\n                }, {\n                    status: 404\n                }));\n            }\n            if (!purchase.stripe_subscription_id) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"This is not a subscription\"\n                }, {\n                    status: 400\n                }));\n            }\n            try {\n                // Cancel the subscription in Stripe\n                await (0,_lib_stripe__WEBPACK_IMPORTED_MODULE_2__.getStripe)().subscriptions.cancel(purchase.stripe_subscription_id);\n                // Update our database\n                await supabase.from(\"user_products\").update({\n                    is_active: false\n                }).eq(\"id\", purchaseId);\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    success: true,\n                    message: \"Subscription cancelled\"\n                }));\n            } catch (stripeError) {\n                console.error(\"Stripe cancellation error:\", stripeError);\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Failed to cancel subscription\"\n                }, {\n                    status: 500\n                }));\n            }\n        }\n        // Legacy payment route (for backward compatibility)\n        if (path === \"payment/create-checkout\") {\n            const { user, error: authError } = await getAuthenticatedUser();\n            if (authError || !user) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Unauthorized\"\n                }, {\n                    status: 401\n                }));\n            }\n            const { paymentType, couponCode } = body;\n            let sessionConfig = {\n                payment_method_types: [\n                    \"card\"\n                ],\n                line_items: [],\n                mode: paymentType === \"subscription\" ? \"subscription\" : \"payment\",\n                success_url: `${process.env.NEXT_PUBLIC_BASE_URL}?payment=success`,\n                cancel_url: `${process.env.NEXT_PUBLIC_BASE_URL}?payment=cancelled`,\n                client_reference_id: user.id,\n                customer_email: user.email,\n                metadata: {\n                    purchase_type: paymentType === \"subscription\" ? \"all_access\" : \"legacy_full\"\n                }\n            };\n            if (paymentType === \"onetime\") {\n                sessionConfig.line_items.push({\n                    price_data: {\n                        currency: \"usd\",\n                        product_data: {\n                            name: \"AS WE ALL ARE - Full Access\",\n                            description: \"One-time unlock of all cards\"\n                        },\n                        unit_amount: 2000\n                    },\n                    quantity: 1\n                });\n            } else {\n                sessionConfig.line_items.push({\n                    price_data: {\n                        currency: \"usd\",\n                        product_data: {\n                            name: \"AS WE ALL ARE - Subscription\",\n                            description: \"Full access subscription\"\n                        },\n                        unit_amount: 300,\n                        recurring: {\n                            interval: \"month\",\n                            interval_count: 3\n                        }\n                    },\n                    quantity: 1\n                });\n            }\n            if (couponCode) {\n                try {\n                    const coupons = await (0,_lib_stripe__WEBPACK_IMPORTED_MODULE_2__.getStripe)().coupons.list({\n                        limit: 100\n                    });\n                    const validCoupon = coupons.data.find((c)=>c.id.toLowerCase() === couponCode.toLowerCase());\n                    if (validCoupon) {\n                        sessionConfig.discounts = [\n                            {\n                                coupon: validCoupon.id\n                            }\n                        ];\n                    }\n                } catch (error) {\n                    console.error(\"Coupon validation error:\", error);\n                }\n            }\n            const session = await stripe.checkout.sessions.create(sessionConfig);\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                url: session.url\n            }));\n        }\n        // ADMIN ROUTES - Create card\n        if (path === \"admin/cards\") {\n            const { user, error: authError } = await getAuthenticatedUser();\n            if (authError || !user) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Unauthorized\"\n                }, {\n                    status: 401\n                }));\n            }\n            const { boxId, pileId, text, imagePath, isActive } = body;\n            // Generate MD5 hash ID\n            const crypto = await Promise.resolve(/*! import() */).then(__webpack_require__.t.bind(__webpack_require__, /*! crypto */ \"crypto\", 23));\n            const cardId = crypto.createHash(\"md5\").update(`${Date.now()}-${Math.random()}`).digest(\"hex\");\n            const card = {\n                id: cardId,\n                box_id: boxId,\n                pile_id: pileId,\n                text: text || null,\n                image_path: imagePath || \"\",\n                is_active: isActive !== false,\n                created_at: new Date().toISOString()\n            };\n            const { data, error } = await supabase.from(\"cards\").insert([\n                card\n            ]).select().single();\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                card: data\n            }));\n        }\n        // ADMIN ROUTES - Create box (enhanced with new fields)\n        if (path === \"admin/boxes\") {\n            const { user, error: authError } = await getAuthenticatedUser();\n            if (authError || !user) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Unauthorized\"\n                }, {\n                    status: 401\n                }));\n            }\n            const { id: boxId, name, description, descriptionShort, tagline, topics, priceId, color, colorPalette, path: boxPath, displayOrder, isSample, fullBoxId, isActive, collectionSeriesId } = body;\n            const box = {\n                id: boxId || `box_${(0,uuid__WEBPACK_IMPORTED_MODULE_4__[\"default\"])().slice(0, 8)}`,\n                name,\n                description: description || \"\",\n                description_short: descriptionShort || \"\",\n                tagline: tagline || \"\",\n                topics: topics || [],\n                price_id: priceId || null,\n                color: color || \"#000000\",\n                color_palette: colorPalette || [],\n                path: boxPath || \"\",\n                display_order: displayOrder || 0,\n                is_sample: isSample || false,\n                full_box_id: isSample ? fullBoxId || null : null,\n                is_active: isActive !== false,\n                collection_series_id: collectionSeriesId || \"unscripted_conversations\",\n                created_at: new Date().toISOString()\n            };\n            const { data, error } = await supabase.from(\"boxes\").insert([\n                box\n            ]).select().single();\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                box: data\n            }));\n        }\n        // ADMIN ROUTES - Create collection series\n        if (path === \"admin/collection-series\") {\n            const { user, error: authError } = await getAuthenticatedUser();\n            if (authError || !user) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Unauthorized\"\n                }, {\n                    status: 401\n                }));\n            }\n            const { id, name, description, displayOrder, isActive } = body;\n            const series = {\n                id: id || `series_${(0,uuid__WEBPACK_IMPORTED_MODULE_4__[\"default\"])().slice(0, 8)}`,\n                name,\n                description: description || \"\",\n                display_order: displayOrder || 0,\n                is_active: isActive !== false,\n                created_at: new Date().toISOString()\n            };\n            const { data, error } = await supabase.from(\"collection_series\").insert([\n                series\n            ]).select().single();\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                series: data\n            }));\n        }\n        // ADMIN ROUTES - Create price\n        if (path === \"admin/prices\") {\n            const { user, error: authError } = await getAuthenticatedUser();\n            if (authError || !user) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Unauthorized\"\n                }, {\n                    status: 401\n                }));\n            }\n            const { id, label, paymentInfo, hookInfo, amount, promoAmount, promoEnabled, currency, membershipDays, stripePriceId, displayOrder, isActive } = body;\n            const price = {\n                id: id || `price_${(0,uuid__WEBPACK_IMPORTED_MODULE_4__[\"default\"])().slice(0, 8)}`,\n                label,\n                payment_info: paymentInfo || \"\",\n                hook_info: hookInfo || \"\",\n                amount: amount || 0,\n                promo_amount: promoAmount || null,\n                promo_enabled: promoEnabled || false,\n                currency: currency || \"USD\",\n                membership_days: membershipDays || null,\n                stripe_price_id: stripePriceId || null,\n                display_order: displayOrder || 0,\n                is_active: isActive !== false,\n                created_at: new Date().toISOString()\n            };\n            const { data, error } = await supabase.from(\"prices\").insert([\n                price\n            ]).select().single();\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                price: data\n            }));\n        }\n        // ADMIN ROUTES - Create pile\n        if (path === \"admin/piles\") {\n            const { user, error: authError } = await getAuthenticatedUser();\n            if (authError || !user) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Unauthorized\"\n                }, {\n                    status: 401\n                }));\n            }\n            const { id, slug, name, imagePath, collectionSeriesId, displayOrder, isActive } = body;\n            const pile = {\n                id: id || `pile_${(0,uuid__WEBPACK_IMPORTED_MODULE_4__[\"default\"])().slice(0, 8)}`,\n                slug: slug || name.toLowerCase().replace(/\\s+/g, \"_\"),\n                name,\n                image_path: imagePath || \"\",\n                collection_series_id: collectionSeriesId || null,\n                display_order: displayOrder || 0,\n                is_active: isActive !== false,\n                created_at: new Date().toISOString()\n            };\n            const { data, error } = await supabase.from(\"piles\").insert([\n                pile\n            ]).select().single();\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                pile: data\n            }));\n        }\n        // ADMIN ROUTES - Create bundle\n        if (path === \"admin/bundles\") {\n            const { user, error: authError } = await getAuthenticatedUser();\n            if (authError || !user) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Unauthorized\"\n                }, {\n                    status: 401\n                }));\n            }\n            const { id, name, description, priceId, boxIds, displayOrder, isActive } = body;\n            const bundle = {\n                id: id || `bundle_${(0,uuid__WEBPACK_IMPORTED_MODULE_4__[\"default\"])().slice(0, 8)}`,\n                name,\n                description: description || \"\",\n                price_id: priceId || null,\n                box_ids: boxIds || [],\n                display_order: displayOrder || 0,\n                is_active: isActive !== false,\n                created_at: new Date().toISOString()\n            };\n            const { data, error } = await supabase.from(\"bundles\").insert([\n                bundle\n            ]).select().single();\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                bundle: data\n            }));\n        }\n        // ADMIN ROUTES - Bulk delete cards\n        if (path === \"admin/cards/bulk-delete\") {\n            const { user, error: authError } = await getAuthenticatedUser();\n            if (authError || !user) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Unauthorized\"\n                }, {\n                    status: 401\n                }));\n            }\n            const { boxId, pileId } = body;\n            if (!boxId) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"boxId required\"\n                }, {\n                    status: 400\n                }));\n            }\n            // Build delete query\n            let deleteResult;\n            if (pileId) {\n                // Delete cards for specific box and pile\n                const { data: cards } = await supabase.from(\"cards\").select(\"*\").eq(\"box_id\", boxId).eq(\"pile_id\", pileId);\n                if (cards && cards.length > 0) {\n                    for (const card of cards){\n                        await supabase.from(\"cards\").delete().eq(\"id\", card.id);\n                    }\n                }\n                deleteResult = {\n                    deleted: cards?.length || 0\n                };\n            } else {\n                // Delete all cards for box\n                const { data: cards } = await supabase.from(\"cards\").select(\"*\").eq(\"box_id\", boxId);\n                if (cards && cards.length > 0) {\n                    for (const card of cards){\n                        await supabase.from(\"cards\").delete().eq(\"id\", card.id);\n                    }\n                }\n                deleteResult = {\n                    deleted: cards?.length || 0\n                };\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true,\n                ...deleteResult\n            }));\n        }\n        // ADMIN ROUTES - Export card paths\n        if (path === \"admin/cards/export\") {\n            const { user, error: authError } = await getAuthenticatedUser();\n            if (authError || !user) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Unauthorized\"\n                }, {\n                    status: 401\n                }));\n            }\n            const { boxId, pileId } = body;\n            if (!boxId) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"boxId required\"\n                }, {\n                    status: 400\n                }));\n            }\n            let query = supabase.from(\"cards\").select(\"*\").eq(\"box_id\", boxId);\n            if (pileId) {\n                query = query.eq(\"pile_id\", pileId);\n            }\n            const { data: cards, error } = await query;\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                cards: cards || [],\n                imagePaths: (cards || []).map((c)=>c.image_path)\n            }));\n        }\n        return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Route not found\"\n        }, {\n            status: 404\n        }));\n    } catch (error) {\n        console.error(\"API Error:\", error);\n        return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: error.message\n        }, {\n            status: 500\n        }));\n    }\n}\nasync function PUT(request) {\n    const url = new URL(request.url);\n    const path = url.pathname.replace(\"/api/\", \"\");\n    const supabase = (0,_lib_supabase_server__WEBPACK_IMPORTED_MODULE_1__.createSupabaseServer)();\n    try {\n        const { user, error: authError } = await getAuthenticatedUser();\n        if (authError || !user) {\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Unauthorized\"\n            }, {\n                status: 401\n            }));\n        }\n        // ADMIN ROUTES - Update card\n        if (path.startsWith(\"admin/cards/\")) {\n            const cardId = path.split(\"/\")[2];\n            const body = await request.json();\n            const updateData = {};\n            if (body.boxId !== undefined) updateData.box_id = body.boxId;\n            if (body.pileId !== undefined) updateData.pile_id = body.pileId;\n            if (body.text !== undefined) updateData.text = body.text;\n            if (body.imagePath !== undefined) updateData.image_path = body.imagePath;\n            if (body.isActive !== undefined) updateData.is_active = body.isActive;\n            const { error } = await supabase.from(\"cards\").update(updateData).eq(\"id\", cardId);\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true\n            }));\n        }\n        // ADMIN ROUTES - Update box (enhanced with new fields)\n        if (path.startsWith(\"admin/boxes/\")) {\n            const boxId = path.split(\"/\")[2];\n            const body = await request.json();\n            // Map camelCase to snake_case\n            const updateData = {};\n            if (body.name !== undefined) updateData.name = body.name;\n            if (body.description !== undefined) updateData.description = body.description;\n            if (body.descriptionShort !== undefined) updateData.description_short = body.descriptionShort;\n            if (body.tagline !== undefined) updateData.tagline = body.tagline;\n            if (body.topics !== undefined) updateData.topics = body.topics;\n            if (body.priceId !== undefined) updateData.price_id = body.priceId;\n            if (body.color !== undefined) updateData.color = body.color;\n            if (body.colorPalette !== undefined) updateData.color_palette = body.colorPalette;\n            if (body.path !== undefined) updateData.path = body.path;\n            if (body.displayOrder !== undefined) updateData.display_order = body.displayOrder;\n            if (body.collectionSeriesId !== undefined) updateData.collection_series_id = body.collectionSeriesId;\n            if (body.isActive !== undefined) updateData.is_active = body.isActive;\n            // Handle is_sample and full_box_id fields\n            if (body.isSample !== undefined) updateData.is_sample = body.isSample;\n            if (body.fullBoxId !== undefined) {\n                // Only set full_box_id if this is a sample box\n                updateData.full_box_id = body.isSample ? body.fullBoxId : null;\n            }\n            // If setting isSample to false, clear the full_box_id\n            if (body.isSample === false) {\n                updateData.full_box_id = null;\n            }\n            const { error } = await supabase.from(\"boxes\").update(updateData).eq(\"id\", boxId);\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true\n            }));\n        }\n        // ADMIN ROUTES - Update collection series\n        if (path.startsWith(\"admin/collection-series/\")) {\n            const seriesId = path.split(\"/\")[2];\n            const body = await request.json();\n            const updateData = {};\n            if (body.name !== undefined) updateData.name = body.name;\n            if (body.description !== undefined) updateData.description = body.description;\n            if (body.displayOrder !== undefined) updateData.display_order = body.displayOrder;\n            if (body.isActive !== undefined) updateData.is_active = body.isActive;\n            const { error } = await supabase.from(\"collection_series\").update(updateData).eq(\"id\", seriesId);\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true\n            }));\n        }\n        // ADMIN ROUTES - Update price\n        if (path.startsWith(\"admin/prices/\")) {\n            const priceId = path.split(\"/\")[2];\n            const body = await request.json();\n            const updateData = {};\n            if (body.label !== undefined) updateData.label = body.label;\n            if (body.paymentInfo !== undefined) updateData.payment_info = body.paymentInfo;\n            if (body.hookInfo !== undefined) updateData.hook_info = body.hookInfo;\n            if (body.amount !== undefined) updateData.amount = body.amount;\n            if (body.promoAmount !== undefined) updateData.promo_amount = body.promoAmount;\n            if (body.promoEnabled !== undefined) updateData.promo_enabled = body.promoEnabled;\n            if (body.currency !== undefined) updateData.currency = body.currency;\n            if (body.membershipDays !== undefined) updateData.membership_days = body.membershipDays;\n            if (body.stripePriceId !== undefined) updateData.stripe_price_id = body.stripePriceId;\n            if (body.displayOrder !== undefined) updateData.display_order = body.displayOrder;\n            if (body.isActive !== undefined) updateData.is_active = body.isActive;\n            const { error } = await supabase.from(\"prices\").update(updateData).eq(\"id\", priceId);\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true\n            }));\n        }\n        // ADMIN ROUTES - Update pile\n        if (path.startsWith(\"admin/piles/\")) {\n            const pileId = path.split(\"/\")[2];\n            const body = await request.json();\n            const updateData = {};\n            if (body.slug !== undefined) updateData.slug = body.slug;\n            if (body.name !== undefined) updateData.name = body.name;\n            if (body.imagePath !== undefined) updateData.image_path = body.imagePath;\n            if (body.collectionSeriesId !== undefined) updateData.collection_series_id = body.collectionSeriesId;\n            if (body.displayOrder !== undefined) updateData.display_order = body.displayOrder;\n            if (body.isActive !== undefined) updateData.is_active = body.isActive;\n            const { error } = await supabase.from(\"piles\").update(updateData).eq(\"id\", pileId);\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true\n            }));\n        }\n        // ADMIN ROUTES - Update bundle\n        if (path.startsWith(\"admin/bundles/\")) {\n            const bundleId = path.split(\"/\")[2];\n            const body = await request.json();\n            const updateData = {};\n            if (body.name !== undefined) updateData.name = body.name;\n            if (body.description !== undefined) updateData.description = body.description;\n            if (body.priceId !== undefined) updateData.price_id = body.priceId;\n            if (body.boxIds !== undefined) updateData.box_ids = body.boxIds;\n            if (body.displayOrder !== undefined) updateData.display_order = body.displayOrder;\n            if (body.isActive !== undefined) updateData.is_active = body.isActive;\n            const { error } = await supabase.from(\"bundles\").update(updateData).eq(\"id\", bundleId);\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true\n            }));\n        }\n        return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Route not found\"\n        }, {\n            status: 404\n        }));\n    } catch (error) {\n        console.error(\"API Error:\", error);\n        return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: error.message\n        }, {\n            status: 500\n        }));\n    }\n}\nasync function DELETE(request) {\n    const url = new URL(request.url);\n    const path = url.pathname.replace(\"/api/\", \"\");\n    const supabase = (0,_lib_supabase_server__WEBPACK_IMPORTED_MODULE_1__.createSupabaseServer)();\n    try {\n        const { user, error: authError } = await getAuthenticatedUser();\n        if (authError || !user) {\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Unauthorized\"\n            }, {\n                status: 401\n            }));\n        }\n        // ADMIN ROUTES - Delete card\n        if (path.startsWith(\"admin/cards/\")) {\n            const cardId = path.split(\"/\")[2];\n            const { error } = await supabase.from(\"cards\").delete().eq(\"id\", cardId);\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true\n            }));\n        }\n        // ADMIN ROUTES - Delete box\n        if (path.startsWith(\"admin/boxes/\")) {\n            const boxId = path.split(\"/\")[2];\n            // First check if any cards are assigned to this box\n            const { data: cards } = await supabase.from(\"cards\").select(\"id\").eq(\"box_id\", boxId).limit(1);\n            if (cards && cards.length > 0) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Cannot delete box with assigned cards. Remove cards first.\"\n                }, {\n                    status: 400\n                }));\n            }\n            const { error } = await supabase.from(\"boxes\").delete().eq(\"id\", boxId);\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true\n            }));\n        }\n        // ADMIN ROUTES - Delete collection series\n        if (path.startsWith(\"admin/collection-series/\")) {\n            const seriesId = path.split(\"/\")[2];\n            const { error } = await supabase.from(\"collection_series\").delete().eq(\"id\", seriesId);\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true\n            }));\n        }\n        // ADMIN ROUTES - Delete price\n        if (path.startsWith(\"admin/prices/\")) {\n            const priceId = path.split(\"/\")[2];\n            const { error } = await supabase.from(\"prices\").delete().eq(\"id\", priceId);\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true\n            }));\n        }\n        // ADMIN ROUTES - Delete pile\n        if (path.startsWith(\"admin/piles/\")) {\n            const pileId = path.split(\"/\")[2];\n            const { error } = await supabase.from(\"piles\").delete().eq(\"id\", pileId);\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true\n            }));\n        }\n        // ADMIN ROUTES - Delete bundle\n        if (path.startsWith(\"admin/bundles/\")) {\n            const bundleId = path.split(\"/\")[2];\n            const { error } = await supabase.from(\"bundles\").delete().eq(\"id\", bundleId);\n            if (error) {\n                return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: error.message\n                }, {\n                    status: 500\n                }));\n            }\n            return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true\n            }));\n        }\n        return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Route not found\"\n        }, {\n            status: 404\n        }));\n    } catch (error) {\n        console.error(\"API Error:\", error);\n        return handleCORS(next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: error.message\n        }, {\n            status: 500\n        }));\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFJLENBQUM7b0JBQUVwQyxPQUFPQSxNQUFNZ0QsT0FBTztnQkFBQyxHQUFHO29CQUFFNUQsUUFBUTtnQkFBSTtZQUM5RTtZQUVBLE9BQU9MLFdBQVdMLHFEQUFZQSxDQUFDMEQsSUFBSSxDQUFDO2dCQUFFd0YsU0FBUztZQUFLO1FBQ3REO1FBRUEsT0FBTzdJLFdBQVdMLHFEQUFZQSxDQUFDMEQsSUFBSSxDQUFDO1lBQUVwQyxPQUFPO1FBQWtCLEdBQUc7WUFBRVosUUFBUTtRQUFJO0lBRWxGLEVBQUUsT0FBT1ksT0FBTztRQUNka0QsUUFBUWxELEtBQUssQ0FBQyxjQUFjQTtRQUM1QixPQUFPakIsV0FBV0wscURBQVlBLENBQUMwRCxJQUFJLENBQUM7WUFBRXBDLE9BQU9BLE1BQU1nRCxPQUFPO1FBQUMsR0FBRztZQUFFNUQsUUFBUTtRQUFJO0lBQzlFO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9hc3dlYWxsYXJlLWFkbWluLy4vYXBwL2FwaS9bWy4uLnBhdGhdXS9yb3V0ZS5qcz80OGYxIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRSZXNwb25zZSB9IGZyb20gJ25leHQvc2VydmVyJ1xuaW1wb3J0IHsgY3JlYXRlU3VwYWJhc2VTZXJ2ZXIgfSBmcm9tICcuLi8uLi8uLi9saWIvc3VwYWJhc2Utc2VydmVyJ1xuaW1wb3J0IHsgZ2V0U3RyaXBlIH0gZnJvbSAnLi4vLi4vLi4vbGliL3N0cmlwZSdcbmltcG9ydCB7IHY0IGFzIHV1aWR2NCB9IGZyb20gJ3V1aWQnXG5cbi8vIENPUlMgaGVscGVyXG5mdW5jdGlvbiBoYW5kbGVDT1JTKHJlc3BvbnNlKSB7XG4gIHJlc3BvbnNlLmhlYWRlcnMuc2V0KCdBY2Nlc3MtQ29udHJvbC1BbGxvdy1PcmlnaW4nLCAnKicpXG4gIHJlc3BvbnNlLmhlYWRlcnMuc2V0KCdBY2Nlc3MtQ29udHJvbC1BbGxvdy1NZXRob2RzJywgJ0dFVCwgUE9TVCwgUFVULCBERUxFVEUsIE9QVElPTlMnKVxuICByZXNwb25zZS5oZWFkZXJzLnNldCgnQWNjZXNzLUNvbnRyb2wtQWxsb3ctSGVhZGVycycsICdDb250ZW50LVR5cGUsIEF1dGhvcml6YXRpb24nKVxuICByZXR1cm4gcmVzcG9uc2Vcbn1cblxuLy8gT1BUSU9OUyBoYW5kbGVyIGZvciBDT1JTXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gT1BUSU9OUygpIHtcbiAgcmV0dXJuIGhhbmRsZUNPUlMobmV3IE5leHRSZXNwb25zZShudWxsLCB7IHN0YXR1czogMjAwIH0pKVxufVxuXG4vLyBIZWxwZXIgdG8gZ2V0IGF1dGhlbnRpY2F0ZWQgdXNlclxuYXN5bmMgZnVuY3Rpb24gZ2V0QXV0aGVudGljYXRlZFVzZXIoKSB7XG4gIC8vIEluIGxvY2FsIG1vZGUsIGNoZWNrIHRoZSBhdXRoLXRva2VuIGNvb2tpZVxuICBpZiAocHJvY2Vzcy5lbnYuTE9DQUxfTU9ERSA9PT0gJ3RydWUnKSB7XG4gICAgY29uc3QgeyBjb29raWVzIH0gPSBhd2FpdCBpbXBvcnQoJ25leHQvaGVhZGVycycpXG4gICAgY29uc3QgeyBnZXRVc2VyRnJvbVRva2VuIH0gPSBhd2FpdCBpbXBvcnQoJy4uLy4uLy4uL2xpYi9hdXRoLWxvY2FsJylcbiAgICBcbiAgICBjb25zdCBjb29raWVTdG9yZSA9IGNvb2tpZXMoKVxuICAgIGNvbnN0IHRva2VuID0gY29va2llU3RvcmUuZ2V0KCdhdXRoLXRva2VuJyk/LnZhbHVlXG4gICAgXG4gICAgaWYgKHRva2VuKSB7XG4gICAgICBjb25zdCB1c2VyID0gYXdhaXQgZ2V0VXNlckZyb21Ub2tlbih0b2tlbilcbiAgICAgIGlmICh1c2VyKSB7XG4gICAgICAgIHJldHVybiB7IHVzZXIsIGVycm9yOiBudWxsIH1cbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHsgdXNlcjogbnVsbCwgZXJyb3I6IG51bGwgfVxuICB9XG4gIFxuICAvLyBTdXBhYmFzZSBtb2RlXG4gIGNvbnN0IHN1cGFiYXNlID0gY3JlYXRlU3VwYWJhc2VTZXJ2ZXIoKVxuICBjb25zdCB7IGRhdGE6IHsgdXNlciB9LCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2UuYXV0aC5nZXRVc2VyKClcbiAgcmV0dXJuIHsgdXNlciwgZXJyb3IgfVxufVxuXG4vLyBJbXBvcnQgZW50aXRsZW1lbnRzIGhlbHBlclxuaW1wb3J0IHsgZ2V0VXNlckVudGl0bGVkQm94SWRzLCBnZXRCb3hlc1dpdGhWaXNpYmlsaXR5IH0gZnJvbSAnLi4vLi4vLi4vbGliL2VudGl0bGVtZW50cydcblxuLy8gSGVscGVyIHRvIGdldCB1c2VyJ3MgYWNjZXNzaWJsZSBib3hlcyAtIHVzZXMgZW50aXRsZW1lbnRzIGFzIHNvdXJjZSBvZiB0cnV0aFxuYXN5bmMgZnVuY3Rpb24gZ2V0VXNlckFjY2Vzc2libGVCb3hlcyh1c2VySWQpIHtcbiAgY29uc3Qgc3VwYWJhc2UgPSBjcmVhdGVTdXBhYmFzZVNlcnZlcigpXG4gIFxuICAvLyBHZXQgYWxsIGFjdGl2ZSBib3hlc1xuICBjb25zdCB7IGRhdGE6IGJveGVzLCBlcnJvcjogYm94RXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgLmZyb20oJ2JveGVzJylcbiAgICAuc2VsZWN0KCcqJylcbiAgICAuZXEoJ2lzX2FjdGl2ZScsIHRydWUpXG4gICAgLm9yZGVyKCdkaXNwbGF5X29yZGVyJywgeyBhc2NlbmRpbmc6IHRydWUgfSlcbiAgXG4gIGlmIChib3hFcnJvciB8fCAhYm94ZXMpIHtcbiAgICByZXR1cm4geyBib3hlczogW10sIGFjY2Vzc2libGVCb3hJZHM6IFtdIH1cbiAgfVxuICBcbiAgLy8gVXNlIGVudGl0bGVtZW50cyBoZWxwZXIgYXMgdGhlIHNpbmdsZSBzb3VyY2Ugb2YgdHJ1dGhcbiAgY29uc3QgeyBib3hJZHM6IGFjY2Vzc2libGVCb3hJZHMsIGhhc01lbWJlcnNoaXAgfSA9IGF3YWl0IGdldFVzZXJFbnRpdGxlZEJveElkcyh1c2VySWQpXG4gIFxuICByZXR1cm4geyBcbiAgICBib3hlcywgXG4gICAgYWNjZXNzaWJsZUJveElkcywgXG4gICAgaGFzQWxsQWNjZXNzOiBoYXNNZW1iZXJzaGlwIFxuICB9XG59XG5cbi8vIEhlbHBlciB0byBjaGVjayBpZiB1c2VyIGhhcyBwYWlkIGFjY2Vzc1xuYXN5bmMgZnVuY3Rpb24gY2hlY2tVc2VyQWNjZXNzKHVzZXJJZCkge1xuICBjb25zdCB7IGFjY2Vzc2libGVCb3hJZHMsIGhhc0FsbEFjY2VzcyB9ID0gYXdhaXQgZ2V0VXNlckFjY2Vzc2libGVCb3hlcyh1c2VySWQpXG4gIFxuICAvLyBVc2VyIGhhcyBwYWlkIGFjY2VzcyBpZiB0aGV5IGhhdmUgYWNjZXNzIHRvIGFueSBub24tc2FtcGxlIGJveFxuICBjb25zdCBzdXBhYmFzZSA9IGNyZWF0ZVN1cGFiYXNlU2VydmVyKClcbiAgY29uc3QgeyBkYXRhOiBzYW1wbGVCb3hlcyB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAuZnJvbSgnYm94ZXMnKVxuICAgIC5zZWxlY3QoJ2lkJylcbiAgICAuZXEoJ2lzX3NhbXBsZScsIHRydWUpXG4gIFxuICBjb25zdCBzYW1wbGVCb3hJZHMgPSAoc2FtcGxlQm94ZXMgfHwgW10pLm1hcChiID0+IGIuaWQpXG4gIGNvbnN0IGhhc1BhaWRBY2Nlc3MgPSBoYXNBbGxBY2Nlc3MgfHwgYWNjZXNzaWJsZUJveElkcy5zb21lKGlkID0+ICFzYW1wbGVCb3hJZHMuaW5jbHVkZXMoaWQpKVxuICBcbiAgcmV0dXJuIHsgaGFzUGFpZEFjY2VzcywgYWNjZXNzaWJsZUJveElkcywgaGFzQWxsQWNjZXNzIH1cbn1cblxuLy8gTWFpbiByZXF1ZXN0IGhhbmRsZXJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBHRVQocmVxdWVzdCkge1xuICBjb25zdCB1cmwgPSBuZXcgVVJMKHJlcXVlc3QudXJsKVxuICBjb25zdCBwYXRoID0gdXJsLnBhdGhuYW1lLnJlcGxhY2UoJy9hcGkvJywgJycpXG4gIGNvbnN0IHN1cGFiYXNlID0gY3JlYXRlU3VwYWJhc2VTZXJ2ZXIoKVxuXG4gIHRyeSB7XG4gICAgLy8gQVVUSCBST1VURVNcbiAgICBpZiAocGF0aCA9PT0gJ2F1dGgvdXNlcicpIHtcbiAgICAgIGNvbnN0IHsgdXNlciwgZXJyb3IgfSA9IGF3YWl0IGdldEF1dGhlbnRpY2F0ZWRVc2VyKClcbiAgICAgIFxuICAgICAgaWYgKGVycm9yIHx8ICF1c2VyKSB7XG4gICAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgdXNlcjogbnVsbCB9LCB7IHN0YXR1czogMjAwIH0pKVxuICAgICAgfVxuICAgICAgXG4gICAgICAvLyBDaGVjayB1c2VyIGFjY2Vzc1xuICAgICAgY29uc3QgeyBoYXNQYWlkQWNjZXNzLCBhY2Nlc3NpYmxlQm94SWRzLCBoYXNBbGxBY2Nlc3MgfSA9IGF3YWl0IGNoZWNrVXNlckFjY2Vzcyh1c2VyLmlkKVxuICAgICAgXG4gICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IFxuICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgaWQ6IHVzZXIuaWQsXG4gICAgICAgICAgZW1haWw6IHVzZXIuZW1haWwsXG4gICAgICAgICAgaGFzUGFpZEFjY2VzcyxcbiAgICAgICAgICBhY2Nlc3NpYmxlQm94SWRzLFxuICAgICAgICAgIGhhc0FsbEFjY2Vzc1xuICAgICAgICB9XG4gICAgICB9KSlcbiAgICB9XG5cbiAgICAvLyBCT1hFUyBST1VURVMgLSBHZXQgYWxsIGJveGVzIHdpdGggdXNlciBhY2Nlc3MgaW5mb1xuICAgIGlmIChwYXRoID09PSAnYm94ZXMnKSB7XG4gICAgICBjb25zdCB7IHVzZXIgfSA9IGF3YWl0IGdldEF1dGhlbnRpY2F0ZWRVc2VyKClcbiAgICAgIGNvbnN0IHVzZXJJZCA9IHVzZXI/LmlkIHx8IG51bGxcbiAgICAgIFxuICAgICAgY29uc3QgeyBib3hlcywgYWNjZXNzaWJsZUJveElkcywgaGFzQWxsQWNjZXNzIH0gPSBhd2FpdCBnZXRVc2VyQWNjZXNzaWJsZUJveGVzKHVzZXJJZClcbiAgICAgIFxuICAgICAgLy8gQWRkIGhhc0FjY2VzcyBmbGFnIHRvIGVhY2ggYm94XG4gICAgICBjb25zdCBib3hlc1dpdGhBY2Nlc3MgPSBib3hlcy5tYXAoYm94ID0+ICh7XG4gICAgICAgIC4uLmJveCxcbiAgICAgICAgaGFzQWNjZXNzOiBhY2Nlc3NpYmxlQm94SWRzLmluY2x1ZGVzKGJveC5pZClcbiAgICAgIH0pKVxuICAgICAgXG4gICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IFxuICAgICAgICBib3hlczogYm94ZXNXaXRoQWNjZXNzLFxuICAgICAgICBoYXNBbGxBY2Nlc3NcbiAgICAgIH0pKVxuICAgIH1cblxuICAgIC8vIENBUkRTIFJPVVRFUyAtIE5vdyBzdXBwb3J0cyBib3ggZmlsdGVyaW5nXG4gICAgaWYgKHBhdGggPT09ICdjYXJkcycpIHtcbiAgICAgIGNvbnN0IHsgdXNlciB9ID0gYXdhaXQgZ2V0QXV0aGVudGljYXRlZFVzZXIoKVxuICAgICAgY29uc3QgYm94SWRzID0gdXJsLnNlYXJjaFBhcmFtcy5nZXQoJ2JveF9pZHMnKT8uc3BsaXQoJywnKS5maWx0ZXIoQm9vbGVhbikgfHwgW11cbiAgICAgIFxuICAgICAgLy8gR2V0IHVzZXIncyBhY2Nlc3NpYmxlIGJveGVzXG4gICAgICBjb25zdCB7IGFjY2Vzc2libGVCb3hJZHMgfSA9IGF3YWl0IGdldFVzZXJBY2Nlc3NpYmxlQm94ZXModXNlcj8uaWQgfHwgbnVsbClcbiAgICAgIFxuICAgICAgLy8gRGV0ZXJtaW5lIHdoaWNoIGJveGVzIHRvIHF1ZXJ5XG4gICAgICBsZXQgcXVlcnlCb3hJZHMgPSBbXVxuICAgICAgaWYgKGJveElkcy5sZW5ndGggPiAwKSB7XG4gICAgICAgIHF1ZXJ5Qm94SWRzID0gYm94SWRzLmZpbHRlcihpZCA9PiBhY2Nlc3NpYmxlQm94SWRzLmluY2x1ZGVzKGlkKSlcbiAgICAgICAgaWYgKHF1ZXJ5Qm94SWRzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgY2FyZHM6IFtdLCBtZXNzYWdlOiAnTm8gYWNjZXNzaWJsZSBib3hlcycgfSkpXG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAoYWNjZXNzaWJsZUJveElkcy5sZW5ndGggPiAwKSB7XG4gICAgICAgIHF1ZXJ5Qm94SWRzID0gYWNjZXNzaWJsZUJveElkc1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBjYXJkczogW10sIG1lc3NhZ2U6ICdObyBhY2Nlc3NpYmxlIGJveGVzJyB9KSlcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8gUXVlcnkgY2FyZHNcbiAgICAgIGNvbnN0IHsgZGF0YTogY2FyZHMsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAuZnJvbSgnY2FyZHMnKVxuICAgICAgICAuc2VsZWN0KCcqJylcbiAgICAgICAgLmluKCdib3hfaWQnLCBxdWVyeUJveElkcylcbiAgICAgICAgLmVxKCdpc19hY3RpdmUnLCB0cnVlKVxuICAgICAgICAub3JkZXIoJ2NyZWF0ZWRfYXQnLCB7IGFzY2VuZGluZzogZmFsc2UgfSlcbiAgICAgIFxuICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ1tDQVJEUyBBUEldIEVycm9yIGZldGNoaW5nIGNhcmRzOicsIGVycm9yKVxuICAgICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiBlcnJvci5tZXNzYWdlIH0sIHsgc3RhdHVzOiA1MDAgfSkpXG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIElmIHdlIGhhdmUgY2FyZHMsIGZldGNoIHBpbGVzIHNlcGFyYXRlbHkgZm9yIGNhcmQgYmFjayBpbWFnZXNcbiAgICAgIGxldCBwaWxlc01hcCA9IHt9XG4gICAgICBpZiAoY2FyZHMgJiYgY2FyZHMubGVuZ3RoID4gMCkge1xuICAgICAgICBjb25zdCBwaWxlSWRzID0gWy4uLm5ldyBTZXQoY2FyZHMubWFwKGMgPT4gYy5waWxlX2lkKS5maWx0ZXIoQm9vbGVhbikpXVxuICAgICAgICBpZiAocGlsZUlkcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgY29uc3QgeyBkYXRhOiBwaWxlcyB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgICAgIC5mcm9tKCdwaWxlcycpXG4gICAgICAgICAgICAuc2VsZWN0KCcqJylcbiAgICAgICAgICAgIC5pbignaWQnLCBwaWxlSWRzKVxuICAgICAgICAgIFxuICAgICAgICAgIGlmIChwaWxlcykge1xuICAgICAgICAgICAgcGlsZXMuZm9yRWFjaChwID0+IHsgcGlsZXNNYXBbcC5pZF0gPSBwIH0pXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIFRyYW5zZm9ybSBjYXJkcyB0byBpbmNsdWRlIHBpbGUgaW5mbyBmb3IgdGhlIGZyb250ZW5kXG4gICAgICBjb25zdCB0cmFuc2Zvcm1lZENhcmRzID0gKGNhcmRzIHx8IFtdKS5tYXAoY2FyZCA9PiB7XG4gICAgICAgIGNvbnN0IHBpbGUgPSBwaWxlc01hcFtjYXJkLnBpbGVfaWRdIHx8IHt9XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgaWQ6IGNhcmQuaWQsXG4gICAgICAgICAgYm94X2lkOiBjYXJkLmJveF9pZCxcbiAgICAgICAgICBwaWxlX2lkOiBjYXJkLnBpbGVfaWQsXG4gICAgICAgICAgdGV4dDogY2FyZC50ZXh0LFxuICAgICAgICAgIGltYWdlX3BhdGg6IGNhcmQuaW1hZ2VfcGF0aCxcbiAgICAgICAgICBpc19hY3RpdmU6IGNhcmQuaXNfYWN0aXZlLFxuICAgICAgICAgIGNyZWF0ZWRfYXQ6IGNhcmQuY3JlYXRlZF9hdCxcbiAgICAgICAgICAvLyBBZGQgcGlsZSBpbmZvIGZvciBjYXJkIGJhY2sgaW1hZ2VzXG4gICAgICAgICAgY29sb3I6IHBpbGUuc2x1ZyB8fCAnYmxhY2snLCAvLyAnYmxhY2snIG9yICd3aGl0ZScgZnJvbSBwaWxlIHNsdWdcbiAgICAgICAgICBwaWxlX25hbWU6IHBpbGUubmFtZSxcbiAgICAgICAgICBwaWxlX2ltYWdlOiBwaWxlLmltYWdlX3BhdGgsXG4gICAgICAgICAgLy8gTGVnYWN5IGZpZWxkcyBmb3IgY29tcGF0aWJpbGl0eVxuICAgICAgICAgIHRpdGxlOiBjYXJkLnRleHQsXG4gICAgICAgICAgaW1hZ2VQYXRoOiBjYXJkLmltYWdlX3BhdGhcbiAgICAgICAgfVxuICAgICAgfSlcbiAgICAgIFxuICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBjYXJkczogdHJhbnNmb3JtZWRDYXJkcyB9KSlcbiAgICB9XG5cbiAgICAvLyBTVUJTQ1JJUFRJT04gUExBTlNcbiAgICBpZiAocGF0aCA9PT0gJ3BsYW5zJykge1xuICAgICAgY29uc3QgeyBkYXRhOiBwbGFucywgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgIC5mcm9tKCdzdWJzY3JpcHRpb25fcGxhbnMnKVxuICAgICAgICAuc2VsZWN0KCcqJylcbiAgICAgICAgLmVxKCdpc19hY3RpdmUnLCB0cnVlKVxuICAgICAgICAub3JkZXIoJ3ByaWNlJywgeyBhc2NlbmRpbmc6IHRydWUgfSlcbiAgICAgIFxuICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfSwgeyBzdGF0dXM6IDUwMCB9KSlcbiAgICAgIH1cbiAgICAgIFxuICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBwbGFuczogcGxhbnMgfHwgW10gfSkpXG4gICAgfVxuXG4gICAgLy8gQ09MTEVDVElPTiBTRVJJRVMgLSBQdWJsaWMgZW5kcG9pbnRcbiAgICBpZiAocGF0aCA9PT0gJ2NvbGxlY3Rpb24tc2VyaWVzJykge1xuICAgICAgY29uc3QgeyBkYXRhOiBzZXJpZXMsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAuZnJvbSgnY29sbGVjdGlvbl9zZXJpZXMnKVxuICAgICAgICAuc2VsZWN0KCcqJylcbiAgICAgICAgLmVxKCdpc19hY3RpdmUnLCB0cnVlKVxuICAgICAgICAub3JkZXIoJ2Rpc3BsYXlfb3JkZXInLCB7IGFzY2VuZGluZzogdHJ1ZSB9KVxuICAgICAgXG4gICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogZXJyb3IubWVzc2FnZSB9LCB7IHN0YXR1czogNTAwIH0pKVxuICAgICAgfVxuICAgICAgXG4gICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IHNlcmllczogc2VyaWVzIHx8IFtdIH0pKVxuICAgIH1cblxuICAgIC8vIFVTRVIgUFVSQ0hBU0VTIC0gR2V0IHVzZXIncyBwdXJjaGFzZSBoaXN0b3J5XG4gICAgaWYgKHBhdGggPT09ICdwdXJjaGFzZXMnKSB7XG4gICAgICBjb25zdCB7IHVzZXIsIGVycm9yOiBhdXRoRXJyb3IgfSA9IGF3YWl0IGdldEF1dGhlbnRpY2F0ZWRVc2VyKClcbiAgICAgIFxuICAgICAgaWYgKGF1dGhFcnJvciB8fCAhdXNlcikge1xuICAgICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnVW5hdXRob3JpemVkJyB9LCB7IHN0YXR1czogNDAxIH0pKVxuICAgICAgfVxuICAgICAgXG4gICAgICBjb25zdCB7IGRhdGE6IHB1cmNoYXNlcywgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgIC5mcm9tKCd1c2VyX3Byb2R1Y3RzJylcbiAgICAgICAgLnNlbGVjdCgnKiwgYm94ZXMobmFtZSwgY29sb3IsIHByaWNlKScpXG4gICAgICAgIC5lcSgndXNlcl9pZCcsIHVzZXIuaWQpXG4gICAgICAgIC5vcmRlcignY3JlYXRlZF9hdCcsIHsgYXNjZW5kaW5nOiBmYWxzZSB9KVxuICAgICAgXG4gICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogZXJyb3IubWVzc2FnZSB9LCB7IHN0YXR1czogNTAwIH0pKVxuICAgICAgfVxuICAgICAgXG4gICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IHB1cmNoYXNlczogcHVyY2hhc2VzIHx8IFtdIH0pKVxuICAgIH1cblxuICAgIC8vIFNBVkVEIERSQVdTIFJPVVRFU1xuICAgIGlmIChwYXRoID09PSAnZHJhd3MnKSB7XG4gICAgICBjb25zdCB7IHVzZXIsIGVycm9yOiBhdXRoRXJyb3IgfSA9IGF3YWl0IGdldEF1dGhlbnRpY2F0ZWRVc2VyKClcbiAgICAgIFxuICAgICAgaWYgKGF1dGhFcnJvciB8fCAhdXNlcikge1xuICAgICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnVW5hdXRob3JpemVkJyB9LCB7IHN0YXR1czogNDAxIH0pKVxuICAgICAgfVxuICAgICAgXG4gICAgICBjb25zdCB7IGRhdGE6IGRyYXdzLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgLmZyb20oJ3NhdmVkX2RyYXdzJylcbiAgICAgICAgLnNlbGVjdCgnKicpXG4gICAgICAgIC5lcSgndXNlcmlkJywgdXNlci5pZClcbiAgICAgICAgLm9yZGVyKCd0aW1lc3RhbXAnLCB7IGFzY2VuZGluZzogZmFsc2UgfSlcbiAgICAgIFxuICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfSwgeyBzdGF0dXM6IDUwMCB9KSlcbiAgICAgIH1cbiAgICAgIFxuICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBkcmF3czogZHJhd3MgfHwgW10gfSkpXG4gICAgfVxuXG4gICAgLy8gQURNSU4gUk9VVEVTIC0gR2V0IGFsbCBjYXJkc1xuICAgIGlmIChwYXRoID09PSAnYWRtaW4vY2FyZHMnKSB7XG4gICAgICBjb25zdCB7IHVzZXIsIGVycm9yOiBhdXRoRXJyb3IgfSA9IGF3YWl0IGdldEF1dGhlbnRpY2F0ZWRVc2VyKClcbiAgICAgIFxuICAgICAgaWYgKGF1dGhFcnJvciB8fCAhdXNlcikge1xuICAgICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnVW5hdXRob3JpemVkJyB9LCB7IHN0YXR1czogNDAxIH0pKVxuICAgICAgfVxuICAgICAgXG4gICAgICAvLyBHZXQgY2FyZHNcbiAgICAgIGNvbnN0IHsgZGF0YTogY2FyZHMsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAuZnJvbSgnY2FyZHMnKVxuICAgICAgICAuc2VsZWN0KCcqJylcbiAgICAgICAgLm9yZGVyKCdjcmVhdGVkX2F0JywgeyBhc2NlbmRpbmc6IGZhbHNlIH0pXG4gICAgICBcbiAgICAgIGlmIChlcnJvcikge1xuICAgICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiBlcnJvci5tZXNzYWdlIH0sIHsgc3RhdHVzOiA1MDAgfSkpXG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIEdldCBib3hlcywgcGlsZXMgYW5kIHNlcmllcyBmb3IgZW5yaWNobWVudCAtIHVzZSBQcm9taXNlLmFsbCBmb3IgcmVsaWFiaWxpdHlcbiAgICAgIGNvbnN0IFtib3hlc1Jlc3VsdCwgcGlsZXNSZXN1bHQsIHNlcmllc1Jlc3VsdF0gPSBhd2FpdCBQcm9taXNlLmFsbChbXG4gICAgICAgIHN1cGFiYXNlLmZyb20oJ2JveGVzJykuc2VsZWN0KCcqJyksXG4gICAgICAgIHN1cGFiYXNlLmZyb20oJ3BpbGVzJykuc2VsZWN0KCcqJyksXG4gICAgICAgIHN1cGFiYXNlLmZyb20oJ2NvbGxlY3Rpb25fc2VyaWVzJykuc2VsZWN0KCcqJylcbiAgICAgIF0pXG4gICAgICBcbiAgICAgIGNvbnN0IGJveGVzID0gYm94ZXNSZXN1bHQuZGF0YSB8fCBbXVxuICAgICAgY29uc3QgcGlsZXMgPSBwaWxlc1Jlc3VsdC5kYXRhIHx8IFtdXG4gICAgICBjb25zdCBzZXJpZXMgPSBzZXJpZXNSZXN1bHQuZGF0YSB8fCBbXVxuICAgICAgXG4gICAgICBjb25zdCBib3hNYXAgPSB7fVxuICAgICAgY29uc3QgcGlsZU1hcCA9IHt9XG4gICAgICBjb25zdCBzZXJpZXNNYXAgPSB7fVxuICAgICAgXG4gICAgICBib3hlcy5mb3JFYWNoKGIgPT4geyBpZiAoYiAmJiBiLmlkKSBib3hNYXBbYi5pZF0gPSBiIH0pXG4gICAgICBwaWxlcy5mb3JFYWNoKHAgPT4geyBpZiAocCAmJiBwLmlkKSBwaWxlTWFwW3AuaWRdID0gcCB9KVxuICAgICAgc2VyaWVzLmZvckVhY2gocyA9PiB7IGlmIChzICYmIHMuaWQpIHNlcmllc01hcFtzLmlkXSA9IHMgfSlcbiAgICAgIFxuICAgICAgLy8gRW5yaWNoIGNhcmRzIHdpdGggYm94L3BpbGUgaW5mb1xuICAgICAgY29uc3QgZW5yaWNoZWRDYXJkcyA9IChjYXJkcyB8fCBbXSkubWFwKGNhcmQgPT4ge1xuICAgICAgICBjb25zdCBib3ggPSBib3hNYXBbY2FyZC5ib3hfaWRdXG4gICAgICAgIGNvbnN0IHBpbGUgPSBwaWxlTWFwW2NhcmQucGlsZV9pZF1cbiAgICAgICAgY29uc3QgY29sbGVjdGlvblNlcmllcyA9IGJveCA/IHNlcmllc01hcFtib3guY29sbGVjdGlvbl9zZXJpZXNfaWRdIDogbnVsbFxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAuLi5jYXJkLFxuICAgICAgICAgIGJveGVzOiBib3ggPyB7XG4gICAgICAgICAgICBuYW1lOiBib3gubmFtZSxcbiAgICAgICAgICAgIGNvbG9yOiBib3guY29sb3IsXG4gICAgICAgICAgICBjb2xsZWN0aW9uX3Nlcmllc19pZDogYm94LmNvbGxlY3Rpb25fc2VyaWVzX2lkLFxuICAgICAgICAgICAgY29sbGVjdGlvbl9zZXJpZXM6IGNvbGxlY3Rpb25TZXJpZXMgPyB7IG5hbWU6IGNvbGxlY3Rpb25TZXJpZXMubmFtZSB9IDogbnVsbFxuICAgICAgICAgIH0gOiBudWxsLFxuICAgICAgICAgIHBpbGVzOiBwaWxlID8ge1xuICAgICAgICAgICAgbmFtZTogcGlsZS5uYW1lLFxuICAgICAgICAgICAgc2x1ZzogcGlsZS5zbHVnXG4gICAgICAgICAgfSA6IG51bGxcbiAgICAgICAgfVxuICAgICAgfSlcbiAgICAgIFxuICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBjYXJkczogZW5yaWNoZWRDYXJkcyB9KSlcbiAgICB9XG5cbiAgICAvLyBBRE1JTiBST1VURVMgLSBHZXQgYWxsIGJveGVzXG4gICAgaWYgKHBhdGggPT09ICdhZG1pbi9ib3hlcycpIHtcbiAgICAgIGNvbnN0IHsgdXNlciwgZXJyb3I6IGF1dGhFcnJvciB9ID0gYXdhaXQgZ2V0QXV0aGVudGljYXRlZFVzZXIoKVxuICAgICAgXG4gICAgICBpZiAoYXV0aEVycm9yIHx8ICF1c2VyKSB7XG4gICAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdVbmF1dGhvcml6ZWQnIH0sIHsgc3RhdHVzOiA0MDEgfSkpXG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIEdldCBib3hlc1xuICAgICAgY29uc3QgeyBkYXRhOiBib3hlcywgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgIC5mcm9tKCdib3hlcycpXG4gICAgICAgIC5zZWxlY3QoJyonKVxuICAgICAgICAub3JkZXIoJ2Rpc3BsYXlfb3JkZXInLCB7IGFzY2VuZGluZzogdHJ1ZSB9KVxuICAgICAgXG4gICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogZXJyb3IubWVzc2FnZSB9LCB7IHN0YXR1czogNTAwIH0pKVxuICAgICAgfVxuICAgICAgXG4gICAgICAvLyBHZXQgYWxsIHJlbGF0ZWQgZGF0YSAtIHVzZSBQcm9taXNlLmFsbCBmb3IgcGFyYWxsZWwgZmV0Y2hpbmdcbiAgICAgIGNvbnN0IFtjYXJkc1Jlc3VsdCwgcGlsZXNSZXN1bHQsIHNlcmllc1Jlc3VsdCwgcHJpY2VzUmVzdWx0XSA9IGF3YWl0IFByb21pc2UuYWxsKFtcbiAgICAgICAgc3VwYWJhc2UuZnJvbSgnY2FyZHMnKS5zZWxlY3QoJyonKSxcbiAgICAgICAgc3VwYWJhc2UuZnJvbSgncGlsZXMnKS5zZWxlY3QoJyonKSxcbiAgICAgICAgc3VwYWJhc2UuZnJvbSgnY29sbGVjdGlvbl9zZXJpZXMnKS5zZWxlY3QoJyonKSxcbiAgICAgICAgc3VwYWJhc2UuZnJvbSgncHJpY2VzJykuc2VsZWN0KCcqJylcbiAgICAgIF0pXG4gICAgICBcbiAgICAgIGNvbnN0IGNhcmRzID0gY2FyZHNSZXN1bHQuZGF0YSB8fCBbXVxuICAgICAgY29uc3QgcGlsZXMgPSBwaWxlc1Jlc3VsdC5kYXRhIHx8IFtdXG4gICAgICBjb25zdCBzZXJpZXMgPSBzZXJpZXNSZXN1bHQuZGF0YSB8fCBbXVxuICAgICAgY29uc3QgcHJpY2VzID0gcHJpY2VzUmVzdWx0LmRhdGEgfHwgW11cbiAgICAgIFxuICAgICAgLy8gTG9nIGZvciBkZWJ1Z2dpbmdcbiAgICAgIGNvbnNvbGUubG9nKGBbYWRtaW4vYm94ZXNdIExvYWRlZCAke2JveGVzPy5sZW5ndGggfHwgMH0gYm94ZXMsICR7c2VyaWVzLmxlbmd0aH0gc2VyaWVzLCAke3BpbGVzLmxlbmd0aH0gcGlsZXMsICR7cHJpY2VzLmxlbmd0aH0gcHJpY2VzYClcbiAgICAgIFxuICAgICAgY29uc3Qgc2VyaWVzTWFwID0ge31cbiAgICAgIGNvbnN0IHByaWNlTWFwID0ge31cbiAgICAgIGNvbnN0IHBpbGVNYXAgPSB7fVxuICAgICAgXG4gICAgICBzZXJpZXMuZm9yRWFjaChzID0+IHsgaWYgKHMgJiYgcy5pZCkgc2VyaWVzTWFwW3MuaWRdID0gcyB9KVxuICAgICAgcHJpY2VzLmZvckVhY2gocCA9PiB7IGlmIChwICYmIHAuaWQpIHByaWNlTWFwW3AuaWRdID0gcCB9KVxuICAgICAgcGlsZXMuZm9yRWFjaChwID0+IHsgaWYgKHAgJiYgcC5pZCkgcGlsZU1hcFtwLmlkXSA9IHAgfSlcbiAgICAgIFxuICAgICAgLy8gQ291bnQgY2FyZHMgcGVyIGJveCBwZXIgcGlsZVxuICAgICAgY29uc3QgY2FyZENvdW50cyA9IHt9XG4gICAgICBpZiAoY2FyZHMpIHtcbiAgICAgICAgY2FyZHMuZm9yRWFjaChjYXJkID0+IHtcbiAgICAgICAgICBjb25zdCBrZXkgPSBgJHtjYXJkLmJveF9pZH1gXG4gICAgICAgICAgaWYgKCFjYXJkQ291bnRzW2tleV0pIHtcbiAgICAgICAgICAgIGNhcmRDb3VudHNba2V5XSA9IHsgdG90YWw6IDAsIGJ5UGlsZToge30gfVxuICAgICAgICAgIH1cbiAgICAgICAgICBjYXJkQ291bnRzW2tleV0udG90YWwrK1xuICAgICAgICAgIFxuICAgICAgICAgIGNvbnN0IHBpbGVJZCA9IGNhcmQucGlsZV9pZFxuICAgICAgICAgIGlmICghY2FyZENvdW50c1trZXldLmJ5UGlsZVtwaWxlSWRdKSB7XG4gICAgICAgICAgICBjYXJkQ291bnRzW2tleV0uYnlQaWxlW3BpbGVJZF0gPSB7IGNvdW50OiAwLCBwaWxlTmFtZTogcGlsZU1hcFtwaWxlSWRdPy5uYW1lIHx8ICdVbmtub3duJywgcGlsZVNsdWc6IHBpbGVNYXBbcGlsZUlkXT8uc2x1ZyB8fCAnJyB9XG4gICAgICAgICAgfVxuICAgICAgICAgIGNhcmRDb3VudHNba2V5XS5ieVBpbGVbcGlsZUlkXS5jb3VudCsrXG4gICAgICAgIH0pXG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIEVucmljaCBib3hlcyB3aXRoIHJlbGF0ZWQgZGF0YVxuICAgICAgY29uc3QgZW5yaWNoZWRCb3hlcyA9IChib3hlcyB8fCBbXSkubWFwKGJveCA9PiAoe1xuICAgICAgICAuLi5ib3gsXG4gICAgICAgIGNvbGxlY3Rpb25fc2VyaWVzOiBzZXJpZXNNYXBbYm94LmNvbGxlY3Rpb25fc2VyaWVzX2lkXSB8fCBudWxsLFxuICAgICAgICBwcmljZXM6IHByaWNlTWFwW2JveC5wcmljZV9pZF0gfHwgbnVsbCxcbiAgICAgICAgY2FyZFN0YXRzOiBjYXJkQ291bnRzW2JveC5pZF0gfHwgeyB0b3RhbDogMCwgYnlQaWxlOiB7fSB9XG4gICAgICB9KSlcbiAgICAgIFxuICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBib3hlczogZW5yaWNoZWRCb3hlcywgcGlsZXM6IHBpbGVzIHx8IFtdIH0pKVxuICAgIH1cblxuICAgIC8vIEFETUlOIFJPVVRFUyAtIEdldCBhbGwgY29sbGVjdGlvbiBzZXJpZXNcbiAgICBpZiAocGF0aCA9PT0gJ2FkbWluL2NvbGxlY3Rpb24tc2VyaWVzJykge1xuICAgICAgY29uc3QgeyB1c2VyLCBlcnJvcjogYXV0aEVycm9yIH0gPSBhd2FpdCBnZXRBdXRoZW50aWNhdGVkVXNlcigpXG4gICAgICBcbiAgICAgIGlmIChhdXRoRXJyb3IgfHwgIXVzZXIpIHtcbiAgICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ1VuYXV0aG9yaXplZCcgfSwgeyBzdGF0dXM6IDQwMSB9KSlcbiAgICAgIH1cbiAgICAgIFxuICAgICAgY29uc3QgeyBkYXRhOiBzZXJpZXMsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAuZnJvbSgnY29sbGVjdGlvbl9zZXJpZXMnKVxuICAgICAgICAuc2VsZWN0KCcqJylcbiAgICAgICAgLm9yZGVyKCdkaXNwbGF5X29yZGVyJywgeyBhc2NlbmRpbmc6IHRydWUgfSlcbiAgICAgIFxuICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfSwgeyBzdGF0dXM6IDUwMCB9KSlcbiAgICAgIH1cbiAgICAgIFxuICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBzZXJpZXM6IHNlcmllcyB8fCBbXSB9KSlcbiAgICB9XG5cbiAgICAvLyBBRE1JTiBST1VURVMgLSBHZXQgYWxsIHByaWNlc1xuICAgIGlmIChwYXRoID09PSAnYWRtaW4vcHJpY2VzJykge1xuICAgICAgY29uc3QgeyB1c2VyLCBlcnJvcjogYXV0aEVycm9yIH0gPSBhd2FpdCBnZXRBdXRoZW50aWNhdGVkVXNlcigpXG4gICAgICBcbiAgICAgIGlmIChhdXRoRXJyb3IgfHwgIXVzZXIpIHtcbiAgICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ1VuYXV0aG9yaXplZCcgfSwgeyBzdGF0dXM6IDQwMSB9KSlcbiAgICAgIH1cbiAgICAgIFxuICAgICAgY29uc3QgeyBkYXRhOiBwcmljZXMsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAuZnJvbSgncHJpY2VzJylcbiAgICAgICAgLnNlbGVjdCgnKicpXG4gICAgICAgIC5vcmRlcignZGlzcGxheV9vcmRlcicsIHsgYXNjZW5kaW5nOiB0cnVlIH0pXG4gICAgICBcbiAgICAgIGlmIChlcnJvcikge1xuICAgICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiBlcnJvci5tZXNzYWdlIH0sIHsgc3RhdHVzOiA1MDAgfSkpXG4gICAgICB9XG4gICAgICBcbiAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgcHJpY2VzOiBwcmljZXMgfHwgW10gfSkpXG4gICAgfVxuXG4gICAgLy8gQURNSU4gUk9VVEVTIC0gR2V0IGFsbCBwaWxlc1xuICAgIGlmIChwYXRoID09PSAnYWRtaW4vcGlsZXMnKSB7XG4gICAgICBjb25zdCB7IHVzZXIsIGVycm9yOiBhdXRoRXJyb3IgfSA9IGF3YWl0IGdldEF1dGhlbnRpY2F0ZWRVc2VyKClcbiAgICAgIFxuICAgICAgaWYgKGF1dGhFcnJvciB8fCAhdXNlcikge1xuICAgICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnVW5hdXRob3JpemVkJyB9LCB7IHN0YXR1czogNDAxIH0pKVxuICAgICAgfVxuICAgICAgXG4gICAgICAvLyBHZXQgcGlsZXMgZmlyc3RcbiAgICAgIGNvbnN0IHsgZGF0YTogcGlsZXMsIGVycm9yOiBwaWxlc0Vycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAuZnJvbSgncGlsZXMnKVxuICAgICAgICAuc2VsZWN0KCcqJylcbiAgICAgICAgLm9yZGVyKCdkaXNwbGF5X29yZGVyJywgeyBhc2NlbmRpbmc6IHRydWUgfSlcbiAgICAgIFxuICAgICAgaWYgKHBpbGVzRXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGxvYWQgcGlsZXM6JywgcGlsZXNFcnJvcilcbiAgICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogcGlsZXNFcnJvci5tZXNzYWdlIH0sIHsgc3RhdHVzOiA1MDAgfSkpXG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIEdldCBhbGwgc2VyaWVzIGZvciBtYXBwaW5nIC0gZG8gdGhpcyBhcyBhIHNlcGFyYXRlIGd1YXJhbnRlZWQgcXVlcnlcbiAgICAgIGNvbnN0IHsgZGF0YTogc2VyaWVzLCBlcnJvcjogc2VyaWVzRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgIC5mcm9tKCdjb2xsZWN0aW9uX3NlcmllcycpXG4gICAgICAgIC5zZWxlY3QoJyonKVxuICAgICAgXG4gICAgICBpZiAoc2VyaWVzRXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGxvYWQgY29sbGVjdGlvbl9zZXJpZXM6Jywgc2VyaWVzRXJyb3IpXG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIEJ1aWxkIHNlcmllcyBsb29rdXAgbWFwXG4gICAgICBjb25zdCBzZXJpZXNNYXAgPSB7fVxuICAgICAgaWYgKHNlcmllcyAmJiBBcnJheS5pc0FycmF5KHNlcmllcykpIHtcbiAgICAgICAgc2VyaWVzLmZvckVhY2gocyA9PiB7IFxuICAgICAgICAgIGlmIChzICYmIHMuaWQpIHtcbiAgICAgICAgICAgIHNlcmllc01hcFtzLmlkXSA9IHMgXG4gICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgfVxuICAgICAgXG4gICAgICAvLyBMb2cgZm9yIGRlYnVnZ2luZ1xuICAgICAgY29uc29sZS5sb2coYFthZG1pbi9waWxlc10gTG9hZGVkICR7KHBpbGVzIHx8IFtdKS5sZW5ndGh9IHBpbGVzLCAke09iamVjdC5rZXlzKHNlcmllc01hcCkubGVuZ3RofSBzZXJpZXNgKVxuICAgICAgXG4gICAgICAvLyBFbnJpY2ggcGlsZXMgd2l0aCBzZXJpZXMgZGF0YVxuICAgICAgY29uc3QgZW5yaWNoZWRQaWxlcyA9IChwaWxlcyB8fCBbXSkubWFwKHAgPT4ge1xuICAgICAgICBjb25zdCBzZXJpZXNEYXRhID0gcC5jb2xsZWN0aW9uX3Nlcmllc19pZCA/IHNlcmllc01hcFtwLmNvbGxlY3Rpb25fc2VyaWVzX2lkXSA6IG51bGxcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAuLi5wLFxuICAgICAgICAgIGNvbGxlY3Rpb25fc2VyaWVzOiBzZXJpZXNEYXRhIHx8IG51bGxcbiAgICAgICAgfVxuICAgICAgfSlcbiAgICAgIFxuICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBwaWxlczogZW5yaWNoZWRQaWxlcyB9KSlcbiAgICB9XG5cbiAgICAvLyBBRE1JTiBST1VURVMgLSBHZXQgYWxsIGJ1bmRsZXNcbiAgICBpZiAocGF0aCA9PT0gJ2FkbWluL2J1bmRsZXMnKSB7XG4gICAgICBjb25zdCB7IHVzZXIsIGVycm9yOiBhdXRoRXJyb3IgfSA9IGF3YWl0IGdldEF1dGhlbnRpY2F0ZWRVc2VyKClcbiAgICAgIFxuICAgICAgaWYgKGF1dGhFcnJvciB8fCAhdXNlcikge1xuICAgICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnVW5hdXRob3JpemVkJyB9LCB7IHN0YXR1czogNDAxIH0pKVxuICAgICAgfVxuICAgICAgXG4gICAgICBjb25zdCB7IGRhdGE6IGJ1bmRsZXMsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAuZnJvbSgnYnVuZGxlcycpXG4gICAgICAgIC5zZWxlY3QoJyonKVxuICAgICAgICAub3JkZXIoJ2Rpc3BsYXlfb3JkZXInLCB7IGFzY2VuZGluZzogdHJ1ZSB9KVxuICAgICAgXG4gICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogZXJyb3IubWVzc2FnZSB9LCB7IHN0YXR1czogNTAwIH0pKVxuICAgICAgfVxuICAgICAgXG4gICAgICAvLyBFbnJpY2ggd2l0aCBwcmljZSBpbmZvXG4gICAgICBjb25zdCB7IGRhdGE6IHByaWNlcyB9ID0gYXdhaXQgc3VwYWJhc2UuZnJvbSgncHJpY2VzJykuc2VsZWN0KCcqJylcbiAgICAgIGNvbnN0IHByaWNlTWFwID0ge31cbiAgICAgIGlmIChwcmljZXMpIHByaWNlcy5mb3JFYWNoKHAgPT4geyBwcmljZU1hcFtwLmlkXSA9IHAgfSlcbiAgICAgIFxuICAgICAgY29uc3QgZW5yaWNoZWRCdW5kbGVzID0gKGJ1bmRsZXMgfHwgW10pLm1hcChiID0+ICh7XG4gICAgICAgIC4uLmIsXG4gICAgICAgIHByaWNlczogcHJpY2VNYXBbYi5wcmljZV9pZF0gfHwgbnVsbFxuICAgICAgfSkpXG4gICAgICBcbiAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgYnVuZGxlczogZW5yaWNoZWRCdW5kbGVzIH0pKVxuICAgICAgXG4gICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IGJ1bmRsZXM6IGJ1bmRsZXMgfHwgW10gfSkpXG4gICAgfVxuXG4gICAgLy8gUFVCTElDIFJPVVRFUyAtIEdldCBhY3RpdmUgcHJpY2VzIGZvciBzdG9yZVxuICAgIGlmIChwYXRoID09PSAnc3RvcmUvcHJpY2VzJykge1xuICAgICAgY29uc3QgeyBkYXRhOiBwcmljZXMsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAuZnJvbSgncHJpY2VzJylcbiAgICAgICAgLnNlbGVjdCgnKicpXG4gICAgICAgIC5lcSgnaXNfYWN0aXZlJywgdHJ1ZSlcbiAgICAgICAgLm9yZGVyKCdkaXNwbGF5X29yZGVyJywgeyBhc2NlbmRpbmc6IHRydWUgfSlcbiAgICAgIFxuICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfSwgeyBzdGF0dXM6IDUwMCB9KSlcbiAgICAgIH1cbiAgICAgIFxuICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBwcmljZXM6IHByaWNlcyB8fCBbXSB9KSlcbiAgICB9XG5cbiAgICAvLyBQVUJMSUMgUk9VVEVTIC0gR2V0IGFjdGl2ZSBidW5kbGVzIGZvciBzdG9yZVxuICAgIGlmIChwYXRoID09PSAnc3RvcmUvYnVuZGxlcycpIHtcbiAgICAgIGNvbnN0IHsgZGF0YTogYnVuZGxlcywgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgIC5mcm9tKCdidW5kbGVzJylcbiAgICAgICAgLnNlbGVjdCgnKiwgcHJpY2VzKGlkLCBsYWJlbCwgYW1vdW50LCBjdXJyZW5jeSwgaXNfbWVtYmVyc2hpcCwgbWVtYmVyc2hpcF9kYXlzKScpXG4gICAgICAgIC5lcSgnaXNfYWN0aXZlJywgdHJ1ZSlcbiAgICAgICAgLm9yZGVyKCdkaXNwbGF5X29yZGVyJywgeyBhc2NlbmRpbmc6IHRydWUgfSlcbiAgICAgIFxuICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfSwgeyBzdGF0dXM6IDUwMCB9KSlcbiAgICAgIH1cbiAgICAgIFxuICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBidW5kbGVzOiBidW5kbGVzIHx8IFtdIH0pKVxuICAgIH1cblxuICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdSb3V0ZSBub3QgZm91bmQnIH0sIHsgc3RhdHVzOiA0MDQgfSkpXG4gICAgXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignQVBJIEVycm9yOicsIGVycm9yKVxuICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfSwgeyBzdGF0dXM6IDUwMCB9KSlcbiAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gUE9TVChyZXF1ZXN0KSB7XG4gIGNvbnN0IHVybCA9IG5ldyBVUkwocmVxdWVzdC51cmwpXG4gIGNvbnN0IHBhdGggPSB1cmwucGF0aG5hbWUucmVwbGFjZSgnL2FwaS8nLCAnJylcbiAgY29uc3Qgc3VwYWJhc2UgPSBjcmVhdGVTdXBhYmFzZVNlcnZlcigpXG5cbiAgdHJ5IHtcbiAgICBjb25zdCBib2R5ID0gYXdhaXQgcmVxdWVzdC5qc29uKClcblxuICAgIC8vIEFVVEggUk9VVEVTXG4gICAgaWYgKHBhdGggPT09ICdhdXRoL3NpZ251cCcpIHtcbiAgICAgIGNvbnN0IHsgZW1haWwsIHBhc3N3b3JkIH0gPSBib2R5XG4gICAgICBcbiAgICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlLmF1dGguc2lnblVwKHtcbiAgICAgICAgZW1haWwsXG4gICAgICAgIHBhc3N3b3JkLFxuICAgICAgfSlcbiAgICAgIFxuICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfSwgeyBzdGF0dXM6IDQwMCB9KSlcbiAgICAgIH1cbiAgICAgIFxuICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyB1c2VyOiBkYXRhLnVzZXIgfSkpXG4gICAgfVxuXG4gICAgaWYgKHBhdGggPT09ICdhdXRoL3NpZ25pbicpIHtcbiAgICAgIGNvbnN0IHsgZW1haWwsIHBhc3N3b3JkIH0gPSBib2R5XG4gICAgICBcbiAgICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlLmF1dGguc2lnbkluV2l0aFBhc3N3b3JkKHtcbiAgICAgICAgZW1haWwsXG4gICAgICAgIHBhc3N3b3JkLFxuICAgICAgfSlcbiAgICAgIFxuICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfSwgeyBzdGF0dXM6IDQwMCB9KSlcbiAgICAgIH1cbiAgICAgIFxuICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyB1c2VyOiBkYXRhLnVzZXIgfSkpXG4gICAgfVxuXG4gICAgaWYgKHBhdGggPT09ICdhdXRoL3NpZ25vdXQnKSB7XG4gICAgICBjb25zdCB7IGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZS5hdXRoLnNpZ25PdXQoKVxuICAgICAgXG4gICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogZXJyb3IubWVzc2FnZSB9LCB7IHN0YXR1czogNDAwIH0pKVxuICAgICAgfVxuICAgICAgXG4gICAgICAvLyBDcmVhdGUgcmVzcG9uc2UgYW5kIGNsZWFyIGF1dGggY29va2llc1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBOZXh0UmVzcG9uc2UuanNvbih7IHN1Y2Nlc3M6IHRydWUgfSlcbiAgICAgIFxuICAgICAgLy8gQ2xlYXIgU3VwYWJhc2UgYXV0aCBjb29raWVzIGJ5IHNldHRpbmcgdGhlbSB0byBleHBpcmVcbiAgICAgIGNvbnN0IGNvb2tpZU9wdGlvbnMgPSB7XG4gICAgICAgIHBhdGg6ICcvJyxcbiAgICAgICAgZXhwaXJlczogbmV3IERhdGUoMCksXG4gICAgICAgIG1heEFnZTogMFxuICAgICAgfVxuICAgICAgXG4gICAgICByZXNwb25zZS5jb29raWVzLnNldCgnc2ItYWNjZXNzLXRva2VuJywgJycsIGNvb2tpZU9wdGlvbnMpXG4gICAgICByZXNwb25zZS5jb29raWVzLnNldCgnc2ItcmVmcmVzaC10b2tlbicsICcnLCBjb29raWVPcHRpb25zKVxuICAgICAgXG4gICAgICAvLyBBbHNvIHRyeSB0byBjbGVhciBhbnkgU3VwYWJhc2UgcHJvamVjdC1zcGVjaWZpYyBjb29raWVzXG4gICAgICBjb25zdCBzdXBhYmFzZVVybCA9IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTCB8fCAnJ1xuICAgICAgY29uc3QgcHJvamVjdFJlZiA9IHN1cGFiYXNlVXJsLm1hdGNoKC9odHRwczpcXC9cXC8oW14uXSspLyk/LlsxXVxuICAgICAgaWYgKHByb2plY3RSZWYpIHtcbiAgICAgICAgcmVzcG9uc2UuY29va2llcy5zZXQoYHNiLSR7cHJvamVjdFJlZn0tYXV0aC10b2tlbmAsICcnLCBjb29raWVPcHRpb25zKVxuICAgICAgICByZXNwb25zZS5jb29raWVzLnNldChgc2ItJHtwcm9qZWN0UmVmfS1hdXRoLXRva2VuLWNvZGUtdmVyaWZpZXJgLCAnJywgY29va2llT3B0aW9ucylcbiAgICAgIH1cbiAgICAgIFxuICAgICAgcmV0dXJuIGhhbmRsZUNPUlMocmVzcG9uc2UpXG4gICAgfVxuXG4gICAgaWYgKHBhdGggPT09ICdhdXRoL2dvb2dsZScpIHtcbiAgICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlLmF1dGguc2lnbkluV2l0aE9BdXRoKHtcbiAgICAgICAgcHJvdmlkZXI6ICdnb29nbGUnLFxuICAgICAgICBvcHRpb25zOiB7XG4gICAgICAgICAgcmVkaXJlY3RUbzogYCR7cHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfQkFTRV9VUkx9L2F1dGgvY2FsbGJhY2tgXG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgICBcbiAgICAgIGlmIChlcnJvcikge1xuICAgICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiBlcnJvci5tZXNzYWdlIH0sIHsgc3RhdHVzOiA0MDAgfSkpXG4gICAgICB9XG4gICAgICBcbiAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgdXJsOiBkYXRhLnVybCB9KSlcbiAgICB9XG5cbiAgICAvLyBQYXNzd29yZCBSZXNldCBSZXF1ZXN0XG4gICAgaWYgKHBhdGggPT09ICdhdXRoL3Jlc2V0LXBhc3N3b3JkJykge1xuICAgICAgY29uc3QgeyBlbWFpbCB9ID0gYm9keVxuICAgICAgXG4gICAgICBpZiAoIWVtYWlsKSB7XG4gICAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdFbWFpbCBpcyByZXF1aXJlZCcgfSwgeyBzdGF0dXM6IDQwMCB9KSlcbiAgICAgIH1cbiAgICAgIFxuICAgICAgY29uc3QgeyBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2UuYXV0aC5yZXNldFBhc3N3b3JkRm9yRW1haWwoZW1haWwsIHtcbiAgICAgICAgcmVkaXJlY3RUbzogYCR7cHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfQkFTRV9VUkx9L2F1dGgvcmVzZXQtY2FsbGJhY2tgXG4gICAgICB9KVxuICAgICAgXG4gICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogZXJyb3IubWVzc2FnZSB9LCB7IHN0YXR1czogNDAwIH0pKVxuICAgICAgfVxuICAgICAgXG4gICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IHN1Y2Nlc3M6IHRydWUsIG1lc3NhZ2U6ICdQYXNzd29yZCByZXNldCBlbWFpbCBzZW50JyB9KSlcbiAgICB9XG5cbiAgICAvLyBTQVZFRCBEUkFXU1xuICAgIGlmIChwYXRoID09PSAnZHJhd3Mvc2F2ZScpIHtcbiAgICAgIGNvbnN0IHsgdXNlciwgZXJyb3I6IGF1dGhFcnJvciB9ID0gYXdhaXQgZ2V0QXV0aGVudGljYXRlZFVzZXIoKVxuICAgICAgXG4gICAgICBpZiAoYXV0aEVycm9yIHx8ICF1c2VyKSB7XG4gICAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdVbmF1dGhvcml6ZWQnIH0sIHsgc3RhdHVzOiA0MDEgfSkpXG4gICAgICB9XG4gICAgICBcbiAgICAgIGNvbnN0IHsgYmxhY2tDYXJkSWQsIHdoaXRlQ2FyZElkLCBibGFja0NhcmRUaXRsZSwgd2hpdGVDYXJkVGl0bGUgfSA9IGJvZHlcbiAgICAgIFxuICAgICAgY29uc3QgZHJhdyA9IHtcbiAgICAgICAgaWQ6IHV1aWR2NCgpLFxuICAgICAgICB1c2VyaWQ6IHVzZXIuaWQsXG4gICAgICAgIHVzZXJlbWFpbDogdXNlci5lbWFpbCxcbiAgICAgICAgYmxhY2tjYXJkaWQ6IGJsYWNrQ2FyZElkLFxuICAgICAgICB3aGl0ZWNhcmRpZDogd2hpdGVDYXJkSWQsXG4gICAgICAgIGJsYWNrY2FyZHRpdGxlOiBibGFja0NhcmRUaXRsZSxcbiAgICAgICAgd2hpdGVjYXJkdGl0bGU6IHdoaXRlQ2FyZFRpdGxlLFxuICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxuICAgICAgfVxuICAgICAgXG4gICAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAuZnJvbSgnc2F2ZWRfZHJhd3MnKVxuICAgICAgICAuaW5zZXJ0KFtkcmF3XSlcbiAgICAgICAgLnNlbGVjdCgpXG4gICAgICAgIC5zaW5nbGUoKVxuICAgICAgXG4gICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogZXJyb3IubWVzc2FnZSB9LCB7IHN0YXR1czogNTAwIH0pKVxuICAgICAgfVxuICAgICAgXG4gICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IGRyYXc6IGRhdGEgfSkpXG4gICAgfVxuXG4gICAgLy8gUEFZTUVOVCBST1VURVMgLSBQdXJjaGFzZSBhIHNpbmdsZSBib3hcbiAgICBpZiAocGF0aCA9PT0gJ3BheW1lbnQvcHVyY2hhc2UtYm94Jykge1xuICAgICAgY29uc3QgeyB1c2VyLCBlcnJvcjogYXV0aEVycm9yIH0gPSBhd2FpdCBnZXRBdXRoZW50aWNhdGVkVXNlcigpXG4gICAgICBcbiAgICAgIGlmIChhdXRoRXJyb3IgfHwgIXVzZXIpIHtcbiAgICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ1VuYXV0aG9yaXplZCcgfSwgeyBzdGF0dXM6IDQwMSB9KSlcbiAgICAgIH1cbiAgICAgIFxuICAgICAgY29uc3QgeyBib3hJZCB9ID0gYm9keVxuICAgICAgXG4gICAgICAvLyBHZXQgYm94IGRldGFpbHNcbiAgICAgIGNvbnN0IHsgZGF0YTogYm94LCBlcnJvcjogYm94RXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgIC5mcm9tKCdib3hlcycpXG4gICAgICAgIC5zZWxlY3QoJyonKVxuICAgICAgICAuZXEoJ2lkJywgYm94SWQpXG4gICAgICAgIC5zaW5nbGUoKVxuICAgICAgXG4gICAgICBpZiAoYm94RXJyb3IgfHwgIWJveCkge1xuICAgICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnQm94IG5vdCBmb3VuZCcgfSwgeyBzdGF0dXM6IDQwNCB9KSlcbiAgICAgIH1cbiAgICAgIFxuICAgICAgaWYgKGJveC5pc19zYW1wbGUpIHtcbiAgICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ1NhbXBsZSBib3ggaXMgZnJlZScgfSwgeyBzdGF0dXM6IDQwMCB9KSlcbiAgICAgIH1cbiAgICAgIFxuICAgICAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IGdldFN0cmlwZSgpLmNoZWNrb3V0LnNlc3Npb25zLmNyZWF0ZSh7XG4gICAgICAgIHBheW1lbnRfbWV0aG9kX3R5cGVzOiBbJ2NhcmQnXSxcbiAgICAgICAgbGluZV9pdGVtczogW3tcbiAgICAgICAgICBwcmljZV9kYXRhOiB7XG4gICAgICAgICAgICBjdXJyZW5jeTogJ3VzZCcsXG4gICAgICAgICAgICBwcm9kdWN0X2RhdGE6IHtcbiAgICAgICAgICAgICAgbmFtZTogYEFTIFdFIEFMTCBBUkUgLSAke2JveC5uYW1lfWAsXG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBib3guZGVzY3JpcHRpb24gfHwgYFVubG9jayB0aGUgJHtib3gubmFtZX0gY2FyZCBjb2xsZWN0aW9uYFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHVuaXRfYW1vdW50OiBNYXRoLnJvdW5kKGJveC5wcmljZSAqIDEwMCksXG4gICAgICAgICAgfSxcbiAgICAgICAgICBxdWFudGl0eTogMSxcbiAgICAgICAgfV0sXG4gICAgICAgIG1vZGU6ICdwYXltZW50JyxcbiAgICAgICAgc3VjY2Vzc191cmw6IGAke3Byb2Nlc3MuZW52Lk5FWFRfUFVCTElDX0JBU0VfVVJMfT9wYXltZW50PXN1Y2Nlc3MmYm94PSR7Ym94SWR9YCxcbiAgICAgICAgY2FuY2VsX3VybDogYCR7cHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfQkFTRV9VUkx9P3BheW1lbnQ9Y2FuY2VsbGVkYCxcbiAgICAgICAgY2xpZW50X3JlZmVyZW5jZV9pZDogdXNlci5pZCxcbiAgICAgICAgY3VzdG9tZXJfZW1haWw6IHVzZXIuZW1haWwsXG4gICAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgICAgYm94X2lkOiBib3hJZCxcbiAgICAgICAgICBwdXJjaGFzZV90eXBlOiAnb25lX3RpbWUnXG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgICBcbiAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgdXJsOiBzZXNzaW9uLnVybCB9KSlcbiAgICB9XG5cbiAgICAvLyBQQVlNRU5UIFJPVVRFUyAtIFN1YnNjcmliZSB0byBhbGwgYWNjZXNzXG4gICAgaWYgKHBhdGggPT09ICdwYXltZW50L3N1YnNjcmliZS1hbGwnKSB7XG4gICAgICBjb25zdCB7IHVzZXIsIGVycm9yOiBhdXRoRXJyb3IgfSA9IGF3YWl0IGdldEF1dGhlbnRpY2F0ZWRVc2VyKClcbiAgICAgIFxuICAgICAgaWYgKGF1dGhFcnJvciB8fCAhdXNlcikge1xuICAgICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnVW5hdXRob3JpemVkJyB9LCB7IHN0YXR1czogNDAxIH0pKVxuICAgICAgfVxuICAgICAgXG4gICAgICBjb25zdCB7IHBsYW5JZCB9ID0gYm9keVxuICAgICAgXG4gICAgICAvLyBHZXQgcGxhbiBkZXRhaWxzXG4gICAgICBjb25zdCB7IGRhdGE6IHBsYW4sIGVycm9yOiBwbGFuRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgIC5mcm9tKCdzdWJzY3JpcHRpb25fcGxhbnMnKVxuICAgICAgICAuc2VsZWN0KCcqJylcbiAgICAgICAgLmVxKCdpZCcsIHBsYW5JZClcbiAgICAgICAgLnNpbmdsZSgpXG4gICAgICBcbiAgICAgIGlmIChwbGFuRXJyb3IgfHwgIXBsYW4pIHtcbiAgICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ1BsYW4gbm90IGZvdW5kJyB9LCB7IHN0YXR1czogNDA0IH0pKVxuICAgICAgfVxuICAgICAgXG4gICAgICAvLyBDYWxjdWxhdGUgaW50ZXJ2YWxcbiAgICAgIGxldCBpbnRlcnZhbCA9ICdtb250aCdcbiAgICAgIGxldCBpbnRlcnZhbENvdW50ID0gMVxuICAgICAgaWYgKHBsYW4uaW50ZXJ2YWwgPT09ICdxdWFydGVyJykge1xuICAgICAgICBpbnRlcnZhbCA9ICdtb250aCdcbiAgICAgICAgaW50ZXJ2YWxDb3VudCA9IDNcbiAgICAgIH0gZWxzZSBpZiAocGxhbi5pbnRlcnZhbCA9PT0gJ3llYXInKSB7XG4gICAgICAgIGludGVydmFsID0gJ3llYXInXG4gICAgICAgIGludGVydmFsQ291bnQgPSAxXG4gICAgICB9XG4gICAgICBcbiAgICAgIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBnZXRTdHJpcGUoKS5jaGVja291dC5zZXNzaW9ucy5jcmVhdGUoe1xuICAgICAgICBwYXltZW50X21ldGhvZF90eXBlczogWydjYXJkJ10sXG4gICAgICAgIGxpbmVfaXRlbXM6IFt7XG4gICAgICAgICAgcHJpY2VfZGF0YToge1xuICAgICAgICAgICAgY3VycmVuY3k6ICd1c2QnLFxuICAgICAgICAgICAgcHJvZHVjdF9kYXRhOiB7XG4gICAgICAgICAgICAgIG5hbWU6IGBBUyBXRSBBTEwgQVJFIC0gJHtwbGFuLm5hbWV9YCxcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IHBsYW4uZGVzY3JpcHRpb24gfHwgJ0Z1bGwgYWNjZXNzIHRvIGFsbCBjYXJkIGJveGVzJ1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHVuaXRfYW1vdW50OiBNYXRoLnJvdW5kKHBsYW4ucHJpY2UgKiAxMDApLFxuICAgICAgICAgICAgcmVjdXJyaW5nOiB7XG4gICAgICAgICAgICAgIGludGVydmFsLFxuICAgICAgICAgICAgICBpbnRlcnZhbF9jb3VudDogaW50ZXJ2YWxDb3VudCxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSxcbiAgICAgICAgICBxdWFudGl0eTogMSxcbiAgICAgICAgfV0sXG4gICAgICAgIG1vZGU6ICdzdWJzY3JpcHRpb24nLFxuICAgICAgICBzdWNjZXNzX3VybDogYCR7cHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfQkFTRV9VUkx9P3BheW1lbnQ9c3VjY2VzcyZzdWJzY3JpcHRpb249dHJ1ZWAsXG4gICAgICAgIGNhbmNlbF91cmw6IGAke3Byb2Nlc3MuZW52Lk5FWFRfUFVCTElDX0JBU0VfVVJMfT9wYXltZW50PWNhbmNlbGxlZGAsXG4gICAgICAgIGNsaWVudF9yZWZlcmVuY2VfaWQ6IHVzZXIuaWQsXG4gICAgICAgIGN1c3RvbWVyX2VtYWlsOiB1c2VyLmVtYWlsLFxuICAgICAgICBtZXRhZGF0YToge1xuICAgICAgICAgIHBsYW5faWQ6IHBsYW5JZCxcbiAgICAgICAgICBwdXJjaGFzZV90eXBlOiAnYWxsX2FjY2VzcydcbiAgICAgICAgfVxuICAgICAgfSlcbiAgICAgIFxuICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyB1cmw6IHNlc3Npb24udXJsIH0pKVxuICAgIH1cblxuICAgIC8vIENBTkNFTCBTVUJTQ1JJUFRJT05cbiAgICBpZiAocGF0aCA9PT0gJ3BheW1lbnQvY2FuY2VsLXN1YnNjcmlwdGlvbicpIHtcbiAgICAgIGNvbnN0IHsgdXNlciwgZXJyb3I6IGF1dGhFcnJvciB9ID0gYXdhaXQgZ2V0QXV0aGVudGljYXRlZFVzZXIoKVxuICAgICAgXG4gICAgICBpZiAoYXV0aEVycm9yIHx8ICF1c2VyKSB7XG4gICAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdVbmF1dGhvcml6ZWQnIH0sIHsgc3RhdHVzOiA0MDEgfSkpXG4gICAgICB9XG4gICAgICBcbiAgICAgIGNvbnN0IHsgcHVyY2hhc2VJZCB9ID0gYm9keVxuICAgICAgXG4gICAgICAvLyBHZXQgdGhlIHB1cmNoYXNlIHJlY29yZFxuICAgICAgY29uc3QgeyBkYXRhOiBwdXJjaGFzZSwgZXJyb3I6IHB1cmNoYXNlRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgIC5mcm9tKCd1c2VyX3Byb2R1Y3RzJylcbiAgICAgICAgLnNlbGVjdCgnKicpXG4gICAgICAgIC5lcSgnaWQnLCBwdXJjaGFzZUlkKVxuICAgICAgICAuZXEoJ3VzZXJfaWQnLCB1c2VyLmlkKVxuICAgICAgICAuc2luZ2xlKClcbiAgICAgIFxuICAgICAgaWYgKHB1cmNoYXNlRXJyb3IgfHwgIXB1cmNoYXNlKSB7XG4gICAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdQdXJjaGFzZSBub3QgZm91bmQnIH0sIHsgc3RhdHVzOiA0MDQgfSkpXG4gICAgICB9XG4gICAgICBcbiAgICAgIGlmICghcHVyY2hhc2Uuc3RyaXBlX3N1YnNjcmlwdGlvbl9pZCkge1xuICAgICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnVGhpcyBpcyBub3QgYSBzdWJzY3JpcHRpb24nIH0sIHsgc3RhdHVzOiA0MDAgfSkpXG4gICAgICB9XG4gICAgICBcbiAgICAgIHRyeSB7XG4gICAgICAgIC8vIENhbmNlbCB0aGUgc3Vic2NyaXB0aW9uIGluIFN0cmlwZVxuICAgICAgICBhd2FpdCBnZXRTdHJpcGUoKS5zdWJzY3JpcHRpb25zLmNhbmNlbChwdXJjaGFzZS5zdHJpcGVfc3Vic2NyaXB0aW9uX2lkKVxuICAgICAgICBcbiAgICAgICAgLy8gVXBkYXRlIG91ciBkYXRhYmFzZVxuICAgICAgICBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAgIC5mcm9tKCd1c2VyX3Byb2R1Y3RzJylcbiAgICAgICAgICAudXBkYXRlKHsgaXNfYWN0aXZlOiBmYWxzZSB9KVxuICAgICAgICAgIC5lcSgnaWQnLCBwdXJjaGFzZUlkKVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBzdWNjZXNzOiB0cnVlLCBtZXNzYWdlOiAnU3Vic2NyaXB0aW9uIGNhbmNlbGxlZCcgfSkpXG4gICAgICB9IGNhdGNoIChzdHJpcGVFcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdTdHJpcGUgY2FuY2VsbGF0aW9uIGVycm9yOicsIHN0cmlwZUVycm9yKVxuICAgICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnRmFpbGVkIHRvIGNhbmNlbCBzdWJzY3JpcHRpb24nIH0sIHsgc3RhdHVzOiA1MDAgfSkpXG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gTGVnYWN5IHBheW1lbnQgcm91dGUgKGZvciBiYWNrd2FyZCBjb21wYXRpYmlsaXR5KVxuICAgIGlmIChwYXRoID09PSAncGF5bWVudC9jcmVhdGUtY2hlY2tvdXQnKSB7XG4gICAgICBjb25zdCB7IHVzZXIsIGVycm9yOiBhdXRoRXJyb3IgfSA9IGF3YWl0IGdldEF1dGhlbnRpY2F0ZWRVc2VyKClcbiAgICAgIFxuICAgICAgaWYgKGF1dGhFcnJvciB8fCAhdXNlcikge1xuICAgICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnVW5hdXRob3JpemVkJyB9LCB7IHN0YXR1czogNDAxIH0pKVxuICAgICAgfVxuICAgICAgXG4gICAgICBjb25zdCB7IHBheW1lbnRUeXBlLCBjb3Vwb25Db2RlIH0gPSBib2R5XG4gICAgICBcbiAgICAgIGxldCBzZXNzaW9uQ29uZmlnID0ge1xuICAgICAgICBwYXltZW50X21ldGhvZF90eXBlczogWydjYXJkJ10sXG4gICAgICAgIGxpbmVfaXRlbXM6IFtdLFxuICAgICAgICBtb2RlOiBwYXltZW50VHlwZSA9PT0gJ3N1YnNjcmlwdGlvbicgPyAnc3Vic2NyaXB0aW9uJyA6ICdwYXltZW50JyxcbiAgICAgICAgc3VjY2Vzc191cmw6IGAke3Byb2Nlc3MuZW52Lk5FWFRfUFVCTElDX0JBU0VfVVJMfT9wYXltZW50PXN1Y2Nlc3NgLFxuICAgICAgICBjYW5jZWxfdXJsOiBgJHtwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19CQVNFX1VSTH0/cGF5bWVudD1jYW5jZWxsZWRgLFxuICAgICAgICBjbGllbnRfcmVmZXJlbmNlX2lkOiB1c2VyLmlkLFxuICAgICAgICBjdXN0b21lcl9lbWFpbDogdXNlci5lbWFpbCxcbiAgICAgICAgbWV0YWRhdGE6IHtcbiAgICAgICAgICBwdXJjaGFzZV90eXBlOiBwYXltZW50VHlwZSA9PT0gJ3N1YnNjcmlwdGlvbicgPyAnYWxsX2FjY2VzcycgOiAnbGVnYWN5X2Z1bGwnXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIFxuICAgICAgaWYgKHBheW1lbnRUeXBlID09PSAnb25ldGltZScpIHtcbiAgICAgICAgc2Vzc2lvbkNvbmZpZy5saW5lX2l0ZW1zLnB1c2goe1xuICAgICAgICAgIHByaWNlX2RhdGE6IHtcbiAgICAgICAgICAgIGN1cnJlbmN5OiAndXNkJyxcbiAgICAgICAgICAgIHByb2R1Y3RfZGF0YToge1xuICAgICAgICAgICAgICBuYW1lOiAnQVMgV0UgQUxMIEFSRSAtIEZ1bGwgQWNjZXNzJyxcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb246ICdPbmUtdGltZSB1bmxvY2sgb2YgYWxsIGNhcmRzJ1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHVuaXRfYW1vdW50OiAyMDAwLFxuICAgICAgICAgIH0sXG4gICAgICAgICAgcXVhbnRpdHk6IDEsXG4gICAgICAgIH0pXG4gICAgICB9IGVsc2Uge1xuICAgICAgICBzZXNzaW9uQ29uZmlnLmxpbmVfaXRlbXMucHVzaCh7XG4gICAgICAgICAgcHJpY2VfZGF0YToge1xuICAgICAgICAgICAgY3VycmVuY3k6ICd1c2QnLFxuICAgICAgICAgICAgcHJvZHVjdF9kYXRhOiB7XG4gICAgICAgICAgICAgIG5hbWU6ICdBUyBXRSBBTEwgQVJFIC0gU3Vic2NyaXB0aW9uJyxcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb246ICdGdWxsIGFjY2VzcyBzdWJzY3JpcHRpb24nXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgdW5pdF9hbW91bnQ6IDMwMCxcbiAgICAgICAgICAgIHJlY3VycmluZzoge1xuICAgICAgICAgICAgICBpbnRlcnZhbDogJ21vbnRoJyxcbiAgICAgICAgICAgICAgaW50ZXJ2YWxfY291bnQ6IDMsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0sXG4gICAgICAgICAgcXVhbnRpdHk6IDEsXG4gICAgICAgIH0pXG4gICAgICB9XG4gICAgICBcbiAgICAgIGlmIChjb3Vwb25Db2RlKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgY29uc3QgY291cG9ucyA9IGF3YWl0IGdldFN0cmlwZSgpLmNvdXBvbnMubGlzdCh7IGxpbWl0OiAxMDAgfSlcbiAgICAgICAgICBjb25zdCB2YWxpZENvdXBvbiA9IGNvdXBvbnMuZGF0YS5maW5kKGMgPT4gYy5pZC50b0xvd2VyQ2FzZSgpID09PSBjb3Vwb25Db2RlLnRvTG93ZXJDYXNlKCkpXG4gICAgICAgICAgXG4gICAgICAgICAgaWYgKHZhbGlkQ291cG9uKSB7XG4gICAgICAgICAgICBzZXNzaW9uQ29uZmlnLmRpc2NvdW50cyA9IFt7IGNvdXBvbjogdmFsaWRDb3Vwb24uaWQgfV1cbiAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgY29uc29sZS5lcnJvcignQ291cG9uIHZhbGlkYXRpb24gZXJyb3I6JywgZXJyb3IpXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIFxuICAgICAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IHN0cmlwZS5jaGVja291dC5zZXNzaW9ucy5jcmVhdGUoc2Vzc2lvbkNvbmZpZylcbiAgICAgIFxuICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyB1cmw6IHNlc3Npb24udXJsIH0pKVxuICAgIH1cblxuICAgIC8vIEFETUlOIFJPVVRFUyAtIENyZWF0ZSBjYXJkXG4gICAgaWYgKHBhdGggPT09ICdhZG1pbi9jYXJkcycpIHtcbiAgICAgIGNvbnN0IHsgdXNlciwgZXJyb3I6IGF1dGhFcnJvciB9ID0gYXdhaXQgZ2V0QXV0aGVudGljYXRlZFVzZXIoKVxuICAgICAgXG4gICAgICBpZiAoYXV0aEVycm9yIHx8ICF1c2VyKSB7XG4gICAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdVbmF1dGhvcml6ZWQnIH0sIHsgc3RhdHVzOiA0MDEgfSkpXG4gICAgICB9XG4gICAgICBcbiAgICAgIGNvbnN0IHsgYm94SWQsIHBpbGVJZCwgdGV4dCwgaW1hZ2VQYXRoLCBpc0FjdGl2ZSB9ID0gYm9keVxuICAgICAgXG4gICAgICAvLyBHZW5lcmF0ZSBNRDUgaGFzaCBJRFxuICAgICAgY29uc3QgY3J5cHRvID0gYXdhaXQgaW1wb3J0KCdjcnlwdG8nKVxuICAgICAgY29uc3QgY2FyZElkID0gY3J5cHRvLmNyZWF0ZUhhc2goJ21kNScpLnVwZGF0ZShgJHtEYXRlLm5vdygpfS0ke01hdGgucmFuZG9tKCl9YCkuZGlnZXN0KCdoZXgnKVxuICAgICAgXG4gICAgICBjb25zdCBjYXJkID0ge1xuICAgICAgICBpZDogY2FyZElkLFxuICAgICAgICBib3hfaWQ6IGJveElkLFxuICAgICAgICBwaWxlX2lkOiBwaWxlSWQsXG4gICAgICAgIHRleHQ6IHRleHQgfHwgbnVsbCxcbiAgICAgICAgaW1hZ2VfcGF0aDogaW1hZ2VQYXRoIHx8ICcnLFxuICAgICAgICBpc19hY3RpdmU6IGlzQWN0aXZlICE9PSBmYWxzZSxcbiAgICAgICAgY3JlYXRlZF9hdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXG4gICAgICB9XG4gICAgICBcbiAgICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgIC5mcm9tKCdjYXJkcycpXG4gICAgICAgIC5pbnNlcnQoW2NhcmRdKVxuICAgICAgICAuc2VsZWN0KClcbiAgICAgICAgLnNpbmdsZSgpXG4gICAgICBcbiAgICAgIGlmIChlcnJvcikge1xuICAgICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiBlcnJvci5tZXNzYWdlIH0sIHsgc3RhdHVzOiA1MDAgfSkpXG4gICAgICB9XG4gICAgICBcbiAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgY2FyZDogZGF0YSB9KSlcbiAgICB9XG5cbiAgICAvLyBBRE1JTiBST1VURVMgLSBDcmVhdGUgYm94IChlbmhhbmNlZCB3aXRoIG5ldyBmaWVsZHMpXG4gICAgaWYgKHBhdGggPT09ICdhZG1pbi9ib3hlcycpIHtcbiAgICAgIGNvbnN0IHsgdXNlciwgZXJyb3I6IGF1dGhFcnJvciB9ID0gYXdhaXQgZ2V0QXV0aGVudGljYXRlZFVzZXIoKVxuICAgICAgXG4gICAgICBpZiAoYXV0aEVycm9yIHx8ICF1c2VyKSB7XG4gICAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdVbmF1dGhvcml6ZWQnIH0sIHsgc3RhdHVzOiA0MDEgfSkpXG4gICAgICB9XG4gICAgICBcbiAgICAgIGNvbnN0IHsgXG4gICAgICAgIGlkOiBib3hJZCwgbmFtZSwgZGVzY3JpcHRpb24sIGRlc2NyaXB0aW9uU2hvcnQsIHRhZ2xpbmUsIHRvcGljcyxcbiAgICAgICAgcHJpY2VJZCwgY29sb3IsIGNvbG9yUGFsZXR0ZSwgcGF0aDogYm94UGF0aCwgZGlzcGxheU9yZGVyLCBcbiAgICAgICAgaXNTYW1wbGUsIGZ1bGxCb3hJZCwgaXNBY3RpdmUsIGNvbGxlY3Rpb25TZXJpZXNJZCBcbiAgICAgIH0gPSBib2R5XG4gICAgICBcbiAgICAgIGNvbnN0IGJveCA9IHtcbiAgICAgICAgaWQ6IGJveElkIHx8IGBib3hfJHt1dWlkdjQoKS5zbGljZSgwLCA4KX1gLFxuICAgICAgICBuYW1lLFxuICAgICAgICBkZXNjcmlwdGlvbjogZGVzY3JpcHRpb24gfHwgJycsXG4gICAgICAgIGRlc2NyaXB0aW9uX3Nob3J0OiBkZXNjcmlwdGlvblNob3J0IHx8ICcnLFxuICAgICAgICB0YWdsaW5lOiB0YWdsaW5lIHx8ICcnLFxuICAgICAgICB0b3BpY3M6IHRvcGljcyB8fCBbXSxcbiAgICAgICAgcHJpY2VfaWQ6IHByaWNlSWQgfHwgbnVsbCxcbiAgICAgICAgY29sb3I6IGNvbG9yIHx8ICcjMDAwMDAwJyxcbiAgICAgICAgY29sb3JfcGFsZXR0ZTogY29sb3JQYWxldHRlIHx8IFtdLFxuICAgICAgICBwYXRoOiBib3hQYXRoIHx8ICcnLFxuICAgICAgICBkaXNwbGF5X29yZGVyOiBkaXNwbGF5T3JkZXIgfHwgMCxcbiAgICAgICAgaXNfc2FtcGxlOiBpc1NhbXBsZSB8fCBmYWxzZSxcbiAgICAgICAgZnVsbF9ib3hfaWQ6IGlzU2FtcGxlID8gKGZ1bGxCb3hJZCB8fCBudWxsKSA6IG51bGwsICAvLyBPbmx5IHNldCBpZiBzYW1wbGVcbiAgICAgICAgaXNfYWN0aXZlOiBpc0FjdGl2ZSAhPT0gZmFsc2UsXG4gICAgICAgIGNvbGxlY3Rpb25fc2VyaWVzX2lkOiBjb2xsZWN0aW9uU2VyaWVzSWQgfHwgJ3Vuc2NyaXB0ZWRfY29udmVyc2F0aW9ucycsXG4gICAgICAgIGNyZWF0ZWRfYXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxuICAgICAgfVxuICAgICAgXG4gICAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAuZnJvbSgnYm94ZXMnKVxuICAgICAgICAuaW5zZXJ0KFtib3hdKVxuICAgICAgICAuc2VsZWN0KClcbiAgICAgICAgLnNpbmdsZSgpXG4gICAgICBcbiAgICAgIGlmIChlcnJvcikge1xuICAgICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiBlcnJvci5tZXNzYWdlIH0sIHsgc3RhdHVzOiA1MDAgfSkpXG4gICAgICB9XG4gICAgICBcbiAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgYm94OiBkYXRhIH0pKVxuICAgIH1cblxuICAgIC8vIEFETUlOIFJPVVRFUyAtIENyZWF0ZSBjb2xsZWN0aW9uIHNlcmllc1xuICAgIGlmIChwYXRoID09PSAnYWRtaW4vY29sbGVjdGlvbi1zZXJpZXMnKSB7XG4gICAgICBjb25zdCB7IHVzZXIsIGVycm9yOiBhdXRoRXJyb3IgfSA9IGF3YWl0IGdldEF1dGhlbnRpY2F0ZWRVc2VyKClcbiAgICAgIFxuICAgICAgaWYgKGF1dGhFcnJvciB8fCAhdXNlcikge1xuICAgICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnVW5hdXRob3JpemVkJyB9LCB7IHN0YXR1czogNDAxIH0pKVxuICAgICAgfVxuICAgICAgXG4gICAgICBjb25zdCB7IGlkLCBuYW1lLCBkZXNjcmlwdGlvbiwgZGlzcGxheU9yZGVyLCBpc0FjdGl2ZSB9ID0gYm9keVxuICAgICAgXG4gICAgICBjb25zdCBzZXJpZXMgPSB7XG4gICAgICAgIGlkOiBpZCB8fCBgc2VyaWVzXyR7dXVpZHY0KCkuc2xpY2UoMCwgOCl9YCxcbiAgICAgICAgbmFtZSxcbiAgICAgICAgZGVzY3JpcHRpb246IGRlc2NyaXB0aW9uIHx8ICcnLFxuICAgICAgICBkaXNwbGF5X29yZGVyOiBkaXNwbGF5T3JkZXIgfHwgMCxcbiAgICAgICAgaXNfYWN0aXZlOiBpc0FjdGl2ZSAhPT0gZmFsc2UsXG4gICAgICAgIGNyZWF0ZWRfYXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxuICAgICAgfVxuICAgICAgXG4gICAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAuZnJvbSgnY29sbGVjdGlvbl9zZXJpZXMnKVxuICAgICAgICAuaW5zZXJ0KFtzZXJpZXNdKVxuICAgICAgICAuc2VsZWN0KClcbiAgICAgICAgLnNpbmdsZSgpXG4gICAgICBcbiAgICAgIGlmIChlcnJvcikge1xuICAgICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiBlcnJvci5tZXNzYWdlIH0sIHsgc3RhdHVzOiA1MDAgfSkpXG4gICAgICB9XG4gICAgICBcbiAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgc2VyaWVzOiBkYXRhIH0pKVxuICAgIH1cblxuICAgIC8vIEFETUlOIFJPVVRFUyAtIENyZWF0ZSBwcmljZVxuICAgIGlmIChwYXRoID09PSAnYWRtaW4vcHJpY2VzJykge1xuICAgICAgY29uc3QgeyB1c2VyLCBlcnJvcjogYXV0aEVycm9yIH0gPSBhd2FpdCBnZXRBdXRoZW50aWNhdGVkVXNlcigpXG4gICAgICBcbiAgICAgIGlmIChhdXRoRXJyb3IgfHwgIXVzZXIpIHtcbiAgICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ1VuYXV0aG9yaXplZCcgfSwgeyBzdGF0dXM6IDQwMSB9KSlcbiAgICAgIH1cbiAgICAgIFxuICAgICAgY29uc3QgeyBcbiAgICAgICAgaWQsIGxhYmVsLCBwYXltZW50SW5mbywgaG9va0luZm8sIGFtb3VudCwgcHJvbW9BbW91bnQsIHByb21vRW5hYmxlZCwgY3VycmVuY3ksXG4gICAgICAgIG1lbWJlcnNoaXBEYXlzLCBzdHJpcGVQcmljZUlkLCBkaXNwbGF5T3JkZXIsIGlzQWN0aXZlIFxuICAgICAgfSA9IGJvZHlcbiAgICAgIFxuICAgICAgY29uc3QgcHJpY2UgPSB7XG4gICAgICAgIGlkOiBpZCB8fCBgcHJpY2VfJHt1dWlkdjQoKS5zbGljZSgwLCA4KX1gLFxuICAgICAgICBsYWJlbCxcbiAgICAgICAgcGF5bWVudF9pbmZvOiBwYXltZW50SW5mbyB8fCAnJyxcbiAgICAgICAgaG9va19pbmZvOiBob29rSW5mbyB8fCAnJyxcbiAgICAgICAgYW1vdW50OiBhbW91bnQgfHwgMCxcbiAgICAgICAgcHJvbW9fYW1vdW50OiBwcm9tb0Ftb3VudCB8fCBudWxsLFxuICAgICAgICBwcm9tb19lbmFibGVkOiBwcm9tb0VuYWJsZWQgfHwgZmFsc2UsXG4gICAgICAgIGN1cnJlbmN5OiBjdXJyZW5jeSB8fCAnVVNEJyxcbiAgICAgICAgbWVtYmVyc2hpcF9kYXlzOiBtZW1iZXJzaGlwRGF5cyB8fCBudWxsLFxuICAgICAgICBzdHJpcGVfcHJpY2VfaWQ6IHN0cmlwZVByaWNlSWQgfHwgbnVsbCxcbiAgICAgICAgZGlzcGxheV9vcmRlcjogZGlzcGxheU9yZGVyIHx8IDAsXG4gICAgICAgIGlzX2FjdGl2ZTogaXNBY3RpdmUgIT09IGZhbHNlLFxuICAgICAgICBjcmVhdGVkX2F0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcbiAgICAgIH1cbiAgICAgIFxuICAgICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgLmZyb20oJ3ByaWNlcycpXG4gICAgICAgIC5pbnNlcnQoW3ByaWNlXSlcbiAgICAgICAgLnNlbGVjdCgpXG4gICAgICAgIC5zaW5nbGUoKVxuICAgICAgXG4gICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogZXJyb3IubWVzc2FnZSB9LCB7IHN0YXR1czogNTAwIH0pKVxuICAgICAgfVxuICAgICAgXG4gICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IHByaWNlOiBkYXRhIH0pKVxuICAgIH1cblxuICAgIC8vIEFETUlOIFJPVVRFUyAtIENyZWF0ZSBwaWxlXG4gICAgaWYgKHBhdGggPT09ICdhZG1pbi9waWxlcycpIHtcbiAgICAgIGNvbnN0IHsgdXNlciwgZXJyb3I6IGF1dGhFcnJvciB9ID0gYXdhaXQgZ2V0QXV0aGVudGljYXRlZFVzZXIoKVxuICAgICAgXG4gICAgICBpZiAoYXV0aEVycm9yIHx8ICF1c2VyKSB7XG4gICAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdVbmF1dGhvcml6ZWQnIH0sIHsgc3RhdHVzOiA0MDEgfSkpXG4gICAgICB9XG4gICAgICBcbiAgICAgIGNvbnN0IHsgaWQsIHNsdWcsIG5hbWUsIGltYWdlUGF0aCwgY29sbGVjdGlvblNlcmllc0lkLCBkaXNwbGF5T3JkZXIsIGlzQWN0aXZlIH0gPSBib2R5XG4gICAgICBcbiAgICAgIGNvbnN0IHBpbGUgPSB7XG4gICAgICAgIGlkOiBpZCB8fCBgcGlsZV8ke3V1aWR2NCgpLnNsaWNlKDAsIDgpfWAsXG4gICAgICAgIHNsdWc6IHNsdWcgfHwgbmFtZS50b0xvd2VyQ2FzZSgpLnJlcGxhY2UoL1xccysvZywgJ18nKSxcbiAgICAgICAgbmFtZSxcbiAgICAgICAgaW1hZ2VfcGF0aDogaW1hZ2VQYXRoIHx8ICcnLFxuICAgICAgICBjb2xsZWN0aW9uX3Nlcmllc19pZDogY29sbGVjdGlvblNlcmllc0lkIHx8IG51bGwsXG4gICAgICAgIGRpc3BsYXlfb3JkZXI6IGRpc3BsYXlPcmRlciB8fCAwLFxuICAgICAgICBpc19hY3RpdmU6IGlzQWN0aXZlICE9PSBmYWxzZSxcbiAgICAgICAgY3JlYXRlZF9hdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXG4gICAgICB9XG4gICAgICBcbiAgICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgIC5mcm9tKCdwaWxlcycpXG4gICAgICAgIC5pbnNlcnQoW3BpbGVdKVxuICAgICAgICAuc2VsZWN0KClcbiAgICAgICAgLnNpbmdsZSgpXG4gICAgICBcbiAgICAgIGlmIChlcnJvcikge1xuICAgICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiBlcnJvci5tZXNzYWdlIH0sIHsgc3RhdHVzOiA1MDAgfSkpXG4gICAgICB9XG4gICAgICBcbiAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgcGlsZTogZGF0YSB9KSlcbiAgICB9XG5cbiAgICAvLyBBRE1JTiBST1VURVMgLSBDcmVhdGUgYnVuZGxlXG4gICAgaWYgKHBhdGggPT09ICdhZG1pbi9idW5kbGVzJykge1xuICAgICAgY29uc3QgeyB1c2VyLCBlcnJvcjogYXV0aEVycm9yIH0gPSBhd2FpdCBnZXRBdXRoZW50aWNhdGVkVXNlcigpXG4gICAgICBcbiAgICAgIGlmIChhdXRoRXJyb3IgfHwgIXVzZXIpIHtcbiAgICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ1VuYXV0aG9yaXplZCcgfSwgeyBzdGF0dXM6IDQwMSB9KSlcbiAgICAgIH1cbiAgICAgIFxuICAgICAgY29uc3QgeyBpZCwgbmFtZSwgZGVzY3JpcHRpb24sIHByaWNlSWQsIGJveElkcywgZGlzcGxheU9yZGVyLCBpc0FjdGl2ZSB9ID0gYm9keVxuICAgICAgXG4gICAgICBjb25zdCBidW5kbGUgPSB7XG4gICAgICAgIGlkOiBpZCB8fCBgYnVuZGxlXyR7dXVpZHY0KCkuc2xpY2UoMCwgOCl9YCxcbiAgICAgICAgbmFtZSxcbiAgICAgICAgZGVzY3JpcHRpb246IGRlc2NyaXB0aW9uIHx8ICcnLFxuICAgICAgICBwcmljZV9pZDogcHJpY2VJZCB8fCBudWxsLFxuICAgICAgICBib3hfaWRzOiBib3hJZHMgfHwgW10sXG4gICAgICAgIGRpc3BsYXlfb3JkZXI6IGRpc3BsYXlPcmRlciB8fCAwLFxuICAgICAgICBpc19hY3RpdmU6IGlzQWN0aXZlICE9PSBmYWxzZSxcbiAgICAgICAgY3JlYXRlZF9hdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXG4gICAgICB9XG4gICAgICBcbiAgICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgIC5mcm9tKCdidW5kbGVzJylcbiAgICAgICAgLmluc2VydChbYnVuZGxlXSlcbiAgICAgICAgLnNlbGVjdCgpXG4gICAgICAgIC5zaW5nbGUoKVxuICAgICAgXG4gICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogZXJyb3IubWVzc2FnZSB9LCB7IHN0YXR1czogNTAwIH0pKVxuICAgICAgfVxuICAgICAgXG4gICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IGJ1bmRsZTogZGF0YSB9KSlcbiAgICB9XG5cbiAgICAvLyBBRE1JTiBST1VURVMgLSBCdWxrIGRlbGV0ZSBjYXJkc1xuICAgIGlmIChwYXRoID09PSAnYWRtaW4vY2FyZHMvYnVsay1kZWxldGUnKSB7XG4gICAgICBjb25zdCB7IHVzZXIsIGVycm9yOiBhdXRoRXJyb3IgfSA9IGF3YWl0IGdldEF1dGhlbnRpY2F0ZWRVc2VyKClcbiAgICAgIFxuICAgICAgaWYgKGF1dGhFcnJvciB8fCAhdXNlcikge1xuICAgICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnVW5hdXRob3JpemVkJyB9LCB7IHN0YXR1czogNDAxIH0pKVxuICAgICAgfVxuICAgICAgXG4gICAgICBjb25zdCB7IGJveElkLCBwaWxlSWQgfSA9IGJvZHlcbiAgICAgIFxuICAgICAgaWYgKCFib3hJZCkge1xuICAgICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnYm94SWQgcmVxdWlyZWQnIH0sIHsgc3RhdHVzOiA0MDAgfSkpXG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIEJ1aWxkIGRlbGV0ZSBxdWVyeVxuICAgICAgbGV0IGRlbGV0ZVJlc3VsdFxuICAgICAgaWYgKHBpbGVJZCkge1xuICAgICAgICAvLyBEZWxldGUgY2FyZHMgZm9yIHNwZWNpZmljIGJveCBhbmQgcGlsZVxuICAgICAgICBjb25zdCB7IGRhdGE6IGNhcmRzIH0gPSBhd2FpdCBzdXBhYmFzZS5mcm9tKCdjYXJkcycpLnNlbGVjdCgnKicpLmVxKCdib3hfaWQnLCBib3hJZCkuZXEoJ3BpbGVfaWQnLCBwaWxlSWQpXG4gICAgICAgIGlmIChjYXJkcyAmJiBjYXJkcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgZm9yIChjb25zdCBjYXJkIG9mIGNhcmRzKSB7XG4gICAgICAgICAgICBhd2FpdCBzdXBhYmFzZS5mcm9tKCdjYXJkcycpLmRlbGV0ZSgpLmVxKCdpZCcsIGNhcmQuaWQpXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGRlbGV0ZVJlc3VsdCA9IHsgZGVsZXRlZDogY2FyZHM/Lmxlbmd0aCB8fCAwIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIERlbGV0ZSBhbGwgY2FyZHMgZm9yIGJveFxuICAgICAgICBjb25zdCB7IGRhdGE6IGNhcmRzIH0gPSBhd2FpdCBzdXBhYmFzZS5mcm9tKCdjYXJkcycpLnNlbGVjdCgnKicpLmVxKCdib3hfaWQnLCBib3hJZClcbiAgICAgICAgaWYgKGNhcmRzICYmIGNhcmRzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICBmb3IgKGNvbnN0IGNhcmQgb2YgY2FyZHMpIHtcbiAgICAgICAgICAgIGF3YWl0IHN1cGFiYXNlLmZyb20oJ2NhcmRzJykuZGVsZXRlKCkuZXEoJ2lkJywgY2FyZC5pZClcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZGVsZXRlUmVzdWx0ID0geyBkZWxldGVkOiBjYXJkcz8ubGVuZ3RoIHx8IDAgfVxuICAgICAgfVxuICAgICAgXG4gICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IHN1Y2Nlc3M6IHRydWUsIC4uLmRlbGV0ZVJlc3VsdCB9KSlcbiAgICB9XG4gICAgXG4gICAgLy8gQURNSU4gUk9VVEVTIC0gRXhwb3J0IGNhcmQgcGF0aHNcbiAgICBpZiAocGF0aCA9PT0gJ2FkbWluL2NhcmRzL2V4cG9ydCcpIHtcbiAgICAgIGNvbnN0IHsgdXNlciwgZXJyb3I6IGF1dGhFcnJvciB9ID0gYXdhaXQgZ2V0QXV0aGVudGljYXRlZFVzZXIoKVxuICAgICAgXG4gICAgICBpZiAoYXV0aEVycm9yIHx8ICF1c2VyKSB7XG4gICAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdVbmF1dGhvcml6ZWQnIH0sIHsgc3RhdHVzOiA0MDEgfSkpXG4gICAgICB9XG4gICAgICBcbiAgICAgIGNvbnN0IHsgYm94SWQsIHBpbGVJZCB9ID0gYm9keVxuICAgICAgXG4gICAgICBpZiAoIWJveElkKSB7XG4gICAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdib3hJZCByZXF1aXJlZCcgfSwgeyBzdGF0dXM6IDQwMCB9KSlcbiAgICAgIH1cbiAgICAgIFxuICAgICAgbGV0IHF1ZXJ5ID0gc3VwYWJhc2UuZnJvbSgnY2FyZHMnKS5zZWxlY3QoJyonKS5lcSgnYm94X2lkJywgYm94SWQpXG4gICAgICBcbiAgICAgIGlmIChwaWxlSWQpIHtcbiAgICAgICAgcXVlcnkgPSBxdWVyeS5lcSgncGlsZV9pZCcsIHBpbGVJZClcbiAgICAgIH1cbiAgICAgIFxuICAgICAgY29uc3QgeyBkYXRhOiBjYXJkcywgZXJyb3IgfSA9IGF3YWl0IHF1ZXJ5XG4gICAgICBcbiAgICAgIGlmIChlcnJvcikge1xuICAgICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiBlcnJvci5tZXNzYWdlIH0sIHsgc3RhdHVzOiA1MDAgfSkpXG4gICAgICB9XG4gICAgICBcbiAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgXG4gICAgICAgIGNhcmRzOiBjYXJkcyB8fCBbXSxcbiAgICAgICAgaW1hZ2VQYXRoczogKGNhcmRzIHx8IFtdKS5tYXAoYyA9PiBjLmltYWdlX3BhdGgpXG4gICAgICB9KSlcbiAgICB9XG5cbiAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnUm91dGUgbm90IGZvdW5kJyB9LCB7IHN0YXR1czogNDA0IH0pKVxuICAgIFxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0FQSSBFcnJvcjonLCBlcnJvcilcbiAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiBlcnJvci5tZXNzYWdlIH0sIHsgc3RhdHVzOiA1MDAgfSkpXG4gIH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIFBVVChyZXF1ZXN0KSB7XG4gIGNvbnN0IHVybCA9IG5ldyBVUkwocmVxdWVzdC51cmwpXG4gIGNvbnN0IHBhdGggPSB1cmwucGF0aG5hbWUucmVwbGFjZSgnL2FwaS8nLCAnJylcbiAgY29uc3Qgc3VwYWJhc2UgPSBjcmVhdGVTdXBhYmFzZVNlcnZlcigpXG5cbiAgdHJ5IHtcbiAgICBjb25zdCB7IHVzZXIsIGVycm9yOiBhdXRoRXJyb3IgfSA9IGF3YWl0IGdldEF1dGhlbnRpY2F0ZWRVc2VyKClcbiAgICBcbiAgICBpZiAoYXV0aEVycm9yIHx8ICF1c2VyKSB7XG4gICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnVW5hdXRob3JpemVkJyB9LCB7IHN0YXR1czogNDAxIH0pKVxuICAgIH1cblxuICAgIC8vIEFETUlOIFJPVVRFUyAtIFVwZGF0ZSBjYXJkXG4gICAgaWYgKHBhdGguc3RhcnRzV2l0aCgnYWRtaW4vY2FyZHMvJykpIHtcbiAgICAgIGNvbnN0IGNhcmRJZCA9IHBhdGguc3BsaXQoJy8nKVsyXVxuICAgICAgY29uc3QgYm9keSA9IGF3YWl0IHJlcXVlc3QuanNvbigpXG4gICAgICBcbiAgICAgIGNvbnN0IHVwZGF0ZURhdGEgPSB7fVxuICAgICAgaWYgKGJvZHkuYm94SWQgIT09IHVuZGVmaW5lZCkgdXBkYXRlRGF0YS5ib3hfaWQgPSBib2R5LmJveElkXG4gICAgICBpZiAoYm9keS5waWxlSWQgIT09IHVuZGVmaW5lZCkgdXBkYXRlRGF0YS5waWxlX2lkID0gYm9keS5waWxlSWRcbiAgICAgIGlmIChib2R5LnRleHQgIT09IHVuZGVmaW5lZCkgdXBkYXRlRGF0YS50ZXh0ID0gYm9keS50ZXh0XG4gICAgICBpZiAoYm9keS5pbWFnZVBhdGggIT09IHVuZGVmaW5lZCkgdXBkYXRlRGF0YS5pbWFnZV9wYXRoID0gYm9keS5pbWFnZVBhdGhcbiAgICAgIGlmIChib2R5LmlzQWN0aXZlICE9PSB1bmRlZmluZWQpIHVwZGF0ZURhdGEuaXNfYWN0aXZlID0gYm9keS5pc0FjdGl2ZVxuICAgICAgXG4gICAgICBjb25zdCB7IGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAuZnJvbSgnY2FyZHMnKVxuICAgICAgICAudXBkYXRlKHVwZGF0ZURhdGEpXG4gICAgICAgIC5lcSgnaWQnLCBjYXJkSWQpXG4gICAgICBcbiAgICAgIGlmIChlcnJvcikge1xuICAgICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiBlcnJvci5tZXNzYWdlIH0sIHsgc3RhdHVzOiA1MDAgfSkpXG4gICAgICB9XG4gICAgICBcbiAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgc3VjY2VzczogdHJ1ZSB9KSlcbiAgICB9XG5cbiAgICAvLyBBRE1JTiBST1VURVMgLSBVcGRhdGUgYm94IChlbmhhbmNlZCB3aXRoIG5ldyBmaWVsZHMpXG4gICAgaWYgKHBhdGguc3RhcnRzV2l0aCgnYWRtaW4vYm94ZXMvJykpIHtcbiAgICAgIGNvbnN0IGJveElkID0gcGF0aC5zcGxpdCgnLycpWzJdXG4gICAgICBjb25zdCBib2R5ID0gYXdhaXQgcmVxdWVzdC5qc29uKClcbiAgICAgIFxuICAgICAgLy8gTWFwIGNhbWVsQ2FzZSB0byBzbmFrZV9jYXNlXG4gICAgICBjb25zdCB1cGRhdGVEYXRhID0ge31cbiAgICAgIGlmIChib2R5Lm5hbWUgIT09IHVuZGVmaW5lZCkgdXBkYXRlRGF0YS5uYW1lID0gYm9keS5uYW1lXG4gICAgICBpZiAoYm9keS5kZXNjcmlwdGlvbiAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLmRlc2NyaXB0aW9uID0gYm9keS5kZXNjcmlwdGlvblxuICAgICAgaWYgKGJvZHkuZGVzY3JpcHRpb25TaG9ydCAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLmRlc2NyaXB0aW9uX3Nob3J0ID0gYm9keS5kZXNjcmlwdGlvblNob3J0XG4gICAgICBpZiAoYm9keS50YWdsaW5lICE9PSB1bmRlZmluZWQpIHVwZGF0ZURhdGEudGFnbGluZSA9IGJvZHkudGFnbGluZVxuICAgICAgaWYgKGJvZHkudG9waWNzICE9PSB1bmRlZmluZWQpIHVwZGF0ZURhdGEudG9waWNzID0gYm9keS50b3BpY3NcbiAgICAgIGlmIChib2R5LnByaWNlSWQgIT09IHVuZGVmaW5lZCkgdXBkYXRlRGF0YS5wcmljZV9pZCA9IGJvZHkucHJpY2VJZFxuICAgICAgaWYgKGJvZHkuY29sb3IgIT09IHVuZGVmaW5lZCkgdXBkYXRlRGF0YS5jb2xvciA9IGJvZHkuY29sb3JcbiAgICAgIGlmIChib2R5LmNvbG9yUGFsZXR0ZSAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLmNvbG9yX3BhbGV0dGUgPSBib2R5LmNvbG9yUGFsZXR0ZVxuICAgICAgaWYgKGJvZHkucGF0aCAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLnBhdGggPSBib2R5LnBhdGhcbiAgICAgIGlmIChib2R5LmRpc3BsYXlPcmRlciAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLmRpc3BsYXlfb3JkZXIgPSBib2R5LmRpc3BsYXlPcmRlclxuICAgICAgaWYgKGJvZHkuY29sbGVjdGlvblNlcmllc0lkICE9PSB1bmRlZmluZWQpIHVwZGF0ZURhdGEuY29sbGVjdGlvbl9zZXJpZXNfaWQgPSBib2R5LmNvbGxlY3Rpb25TZXJpZXNJZFxuICAgICAgaWYgKGJvZHkuaXNBY3RpdmUgIT09IHVuZGVmaW5lZCkgdXBkYXRlRGF0YS5pc19hY3RpdmUgPSBib2R5LmlzQWN0aXZlXG4gICAgICBcbiAgICAgIC8vIEhhbmRsZSBpc19zYW1wbGUgYW5kIGZ1bGxfYm94X2lkIGZpZWxkc1xuICAgICAgaWYgKGJvZHkuaXNTYW1wbGUgIT09IHVuZGVmaW5lZCkgdXBkYXRlRGF0YS5pc19zYW1wbGUgPSBib2R5LmlzU2FtcGxlXG4gICAgICBpZiAoYm9keS5mdWxsQm94SWQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAvLyBPbmx5IHNldCBmdWxsX2JveF9pZCBpZiB0aGlzIGlzIGEgc2FtcGxlIGJveFxuICAgICAgICB1cGRhdGVEYXRhLmZ1bGxfYm94X2lkID0gYm9keS5pc1NhbXBsZSA/IGJvZHkuZnVsbEJveElkIDogbnVsbFxuICAgICAgfVxuICAgICAgLy8gSWYgc2V0dGluZyBpc1NhbXBsZSB0byBmYWxzZSwgY2xlYXIgdGhlIGZ1bGxfYm94X2lkXG4gICAgICBpZiAoYm9keS5pc1NhbXBsZSA9PT0gZmFsc2UpIHtcbiAgICAgICAgdXBkYXRlRGF0YS5mdWxsX2JveF9pZCA9IG51bGxcbiAgICAgIH1cbiAgICAgIFxuICAgICAgY29uc3QgeyBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgLmZyb20oJ2JveGVzJylcbiAgICAgICAgLnVwZGF0ZSh1cGRhdGVEYXRhKVxuICAgICAgICAuZXEoJ2lkJywgYm94SWQpXG4gICAgICBcbiAgICAgIGlmIChlcnJvcikge1xuICAgICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiBlcnJvci5tZXNzYWdlIH0sIHsgc3RhdHVzOiA1MDAgfSkpXG4gICAgICB9XG4gICAgICBcbiAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgc3VjY2VzczogdHJ1ZSB9KSlcbiAgICB9XG5cbiAgICAvLyBBRE1JTiBST1VURVMgLSBVcGRhdGUgY29sbGVjdGlvbiBzZXJpZXNcbiAgICBpZiAocGF0aC5zdGFydHNXaXRoKCdhZG1pbi9jb2xsZWN0aW9uLXNlcmllcy8nKSkge1xuICAgICAgY29uc3Qgc2VyaWVzSWQgPSBwYXRoLnNwbGl0KCcvJylbMl1cbiAgICAgIGNvbnN0IGJvZHkgPSBhd2FpdCByZXF1ZXN0Lmpzb24oKVxuICAgICAgXG4gICAgICBjb25zdCB1cGRhdGVEYXRhID0ge31cbiAgICAgIGlmIChib2R5Lm5hbWUgIT09IHVuZGVmaW5lZCkgdXBkYXRlRGF0YS5uYW1lID0gYm9keS5uYW1lXG4gICAgICBpZiAoYm9keS5kZXNjcmlwdGlvbiAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLmRlc2NyaXB0aW9uID0gYm9keS5kZXNjcmlwdGlvblxuICAgICAgaWYgKGJvZHkuZGlzcGxheU9yZGVyICE9PSB1bmRlZmluZWQpIHVwZGF0ZURhdGEuZGlzcGxheV9vcmRlciA9IGJvZHkuZGlzcGxheU9yZGVyXG4gICAgICBpZiAoYm9keS5pc0FjdGl2ZSAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLmlzX2FjdGl2ZSA9IGJvZHkuaXNBY3RpdmVcbiAgICAgIFxuICAgICAgY29uc3QgeyBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgLmZyb20oJ2NvbGxlY3Rpb25fc2VyaWVzJylcbiAgICAgICAgLnVwZGF0ZSh1cGRhdGVEYXRhKVxuICAgICAgICAuZXEoJ2lkJywgc2VyaWVzSWQpXG4gICAgICBcbiAgICAgIGlmIChlcnJvcikge1xuICAgICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiBlcnJvci5tZXNzYWdlIH0sIHsgc3RhdHVzOiA1MDAgfSkpXG4gICAgICB9XG4gICAgICBcbiAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgc3VjY2VzczogdHJ1ZSB9KSlcbiAgICB9XG5cbiAgICAvLyBBRE1JTiBST1VURVMgLSBVcGRhdGUgcHJpY2VcbiAgICBpZiAocGF0aC5zdGFydHNXaXRoKCdhZG1pbi9wcmljZXMvJykpIHtcbiAgICAgIGNvbnN0IHByaWNlSWQgPSBwYXRoLnNwbGl0KCcvJylbMl1cbiAgICAgIGNvbnN0IGJvZHkgPSBhd2FpdCByZXF1ZXN0Lmpzb24oKVxuICAgICAgXG4gICAgICBjb25zdCB1cGRhdGVEYXRhID0ge31cbiAgICAgIGlmIChib2R5LmxhYmVsICE9PSB1bmRlZmluZWQpIHVwZGF0ZURhdGEubGFiZWwgPSBib2R5LmxhYmVsXG4gICAgICBpZiAoYm9keS5wYXltZW50SW5mbyAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLnBheW1lbnRfaW5mbyA9IGJvZHkucGF5bWVudEluZm9cbiAgICAgIGlmIChib2R5Lmhvb2tJbmZvICE9PSB1bmRlZmluZWQpIHVwZGF0ZURhdGEuaG9va19pbmZvID0gYm9keS5ob29rSW5mb1xuICAgICAgaWYgKGJvZHkuYW1vdW50ICE9PSB1bmRlZmluZWQpIHVwZGF0ZURhdGEuYW1vdW50ID0gYm9keS5hbW91bnRcbiAgICAgIGlmIChib2R5LnByb21vQW1vdW50ICE9PSB1bmRlZmluZWQpIHVwZGF0ZURhdGEucHJvbW9fYW1vdW50ID0gYm9keS5wcm9tb0Ftb3VudFxuICAgICAgaWYgKGJvZHkucHJvbW9FbmFibGVkICE9PSB1bmRlZmluZWQpIHVwZGF0ZURhdGEucHJvbW9fZW5hYmxlZCA9IGJvZHkucHJvbW9FbmFibGVkXG4gICAgICBpZiAoYm9keS5jdXJyZW5jeSAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLmN1cnJlbmN5ID0gYm9keS5jdXJyZW5jeVxuICAgICAgaWYgKGJvZHkubWVtYmVyc2hpcERheXMgIT09IHVuZGVmaW5lZCkgdXBkYXRlRGF0YS5tZW1iZXJzaGlwX2RheXMgPSBib2R5Lm1lbWJlcnNoaXBEYXlzXG4gICAgICBpZiAoYm9keS5zdHJpcGVQcmljZUlkICE9PSB1bmRlZmluZWQpIHVwZGF0ZURhdGEuc3RyaXBlX3ByaWNlX2lkID0gYm9keS5zdHJpcGVQcmljZUlkXG4gICAgICBpZiAoYm9keS5kaXNwbGF5T3JkZXIgIT09IHVuZGVmaW5lZCkgdXBkYXRlRGF0YS5kaXNwbGF5X29yZGVyID0gYm9keS5kaXNwbGF5T3JkZXJcbiAgICAgIGlmIChib2R5LmlzQWN0aXZlICE9PSB1bmRlZmluZWQpIHVwZGF0ZURhdGEuaXNfYWN0aXZlID0gYm9keS5pc0FjdGl2ZVxuICAgICAgXG4gICAgICBjb25zdCB7IGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAuZnJvbSgncHJpY2VzJylcbiAgICAgICAgLnVwZGF0ZSh1cGRhdGVEYXRhKVxuICAgICAgICAuZXEoJ2lkJywgcHJpY2VJZClcbiAgICAgIFxuICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfSwgeyBzdGF0dXM6IDUwMCB9KSlcbiAgICAgIH1cbiAgICAgIFxuICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBzdWNjZXNzOiB0cnVlIH0pKVxuICAgIH1cblxuICAgIC8vIEFETUlOIFJPVVRFUyAtIFVwZGF0ZSBwaWxlXG4gICAgaWYgKHBhdGguc3RhcnRzV2l0aCgnYWRtaW4vcGlsZXMvJykpIHtcbiAgICAgIGNvbnN0IHBpbGVJZCA9IHBhdGguc3BsaXQoJy8nKVsyXVxuICAgICAgY29uc3QgYm9keSA9IGF3YWl0IHJlcXVlc3QuanNvbigpXG4gICAgICBcbiAgICAgIGNvbnN0IHVwZGF0ZURhdGEgPSB7fVxuICAgICAgaWYgKGJvZHkuc2x1ZyAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLnNsdWcgPSBib2R5LnNsdWdcbiAgICAgIGlmIChib2R5Lm5hbWUgIT09IHVuZGVmaW5lZCkgdXBkYXRlRGF0YS5uYW1lID0gYm9keS5uYW1lXG4gICAgICBpZiAoYm9keS5pbWFnZVBhdGggIT09IHVuZGVmaW5lZCkgdXBkYXRlRGF0YS5pbWFnZV9wYXRoID0gYm9keS5pbWFnZVBhdGhcbiAgICAgIGlmIChib2R5LmNvbGxlY3Rpb25TZXJpZXNJZCAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLmNvbGxlY3Rpb25fc2VyaWVzX2lkID0gYm9keS5jb2xsZWN0aW9uU2VyaWVzSWRcbiAgICAgIGlmIChib2R5LmRpc3BsYXlPcmRlciAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLmRpc3BsYXlfb3JkZXIgPSBib2R5LmRpc3BsYXlPcmRlclxuICAgICAgaWYgKGJvZHkuaXNBY3RpdmUgIT09IHVuZGVmaW5lZCkgdXBkYXRlRGF0YS5pc19hY3RpdmUgPSBib2R5LmlzQWN0aXZlXG4gICAgICBcbiAgICAgIGNvbnN0IHsgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgIC5mcm9tKCdwaWxlcycpXG4gICAgICAgIC51cGRhdGUodXBkYXRlRGF0YSlcbiAgICAgICAgLmVxKCdpZCcsIHBpbGVJZClcbiAgICAgIFxuICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfSwgeyBzdGF0dXM6IDUwMCB9KSlcbiAgICAgIH1cbiAgICAgIFxuICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBzdWNjZXNzOiB0cnVlIH0pKVxuICAgIH1cblxuICAgIC8vIEFETUlOIFJPVVRFUyAtIFVwZGF0ZSBidW5kbGVcbiAgICBpZiAocGF0aC5zdGFydHNXaXRoKCdhZG1pbi9idW5kbGVzLycpKSB7XG4gICAgICBjb25zdCBidW5kbGVJZCA9IHBhdGguc3BsaXQoJy8nKVsyXVxuICAgICAgY29uc3QgYm9keSA9IGF3YWl0IHJlcXVlc3QuanNvbigpXG4gICAgICBcbiAgICAgIGNvbnN0IHVwZGF0ZURhdGEgPSB7fVxuICAgICAgaWYgKGJvZHkubmFtZSAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLm5hbWUgPSBib2R5Lm5hbWVcbiAgICAgIGlmIChib2R5LmRlc2NyaXB0aW9uICE9PSB1bmRlZmluZWQpIHVwZGF0ZURhdGEuZGVzY3JpcHRpb24gPSBib2R5LmRlc2NyaXB0aW9uXG4gICAgICBpZiAoYm9keS5wcmljZUlkICE9PSB1bmRlZmluZWQpIHVwZGF0ZURhdGEucHJpY2VfaWQgPSBib2R5LnByaWNlSWRcbiAgICAgIGlmIChib2R5LmJveElkcyAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLmJveF9pZHMgPSBib2R5LmJveElkc1xuICAgICAgaWYgKGJvZHkuZGlzcGxheU9yZGVyICE9PSB1bmRlZmluZWQpIHVwZGF0ZURhdGEuZGlzcGxheV9vcmRlciA9IGJvZHkuZGlzcGxheU9yZGVyXG4gICAgICBpZiAoYm9keS5pc0FjdGl2ZSAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLmlzX2FjdGl2ZSA9IGJvZHkuaXNBY3RpdmVcbiAgICAgIFxuICAgICAgY29uc3QgeyBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgLmZyb20oJ2J1bmRsZXMnKVxuICAgICAgICAudXBkYXRlKHVwZGF0ZURhdGEpXG4gICAgICAgIC5lcSgnaWQnLCBidW5kbGVJZClcbiAgICAgIFxuICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfSwgeyBzdGF0dXM6IDUwMCB9KSlcbiAgICAgIH1cbiAgICAgIFxuICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBzdWNjZXNzOiB0cnVlIH0pKVxuICAgIH1cblxuICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdSb3V0ZSBub3QgZm91bmQnIH0sIHsgc3RhdHVzOiA0MDQgfSkpXG4gICAgXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignQVBJIEVycm9yOicsIGVycm9yKVxuICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfSwgeyBzdGF0dXM6IDUwMCB9KSlcbiAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gREVMRVRFKHJlcXVlc3QpIHtcbiAgY29uc3QgdXJsID0gbmV3IFVSTChyZXF1ZXN0LnVybClcbiAgY29uc3QgcGF0aCA9IHVybC5wYXRobmFtZS5yZXBsYWNlKCcvYXBpLycsICcnKVxuICBjb25zdCBzdXBhYmFzZSA9IGNyZWF0ZVN1cGFiYXNlU2VydmVyKClcblxuICB0cnkge1xuICAgIGNvbnN0IHsgdXNlciwgZXJyb3I6IGF1dGhFcnJvciB9ID0gYXdhaXQgZ2V0QXV0aGVudGljYXRlZFVzZXIoKVxuICAgIFxuICAgIGlmIChhdXRoRXJyb3IgfHwgIXVzZXIpIHtcbiAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdVbmF1dGhvcml6ZWQnIH0sIHsgc3RhdHVzOiA0MDEgfSkpXG4gICAgfVxuXG4gICAgLy8gQURNSU4gUk9VVEVTIC0gRGVsZXRlIGNhcmRcbiAgICBpZiAocGF0aC5zdGFydHNXaXRoKCdhZG1pbi9jYXJkcy8nKSkge1xuICAgICAgY29uc3QgY2FyZElkID0gcGF0aC5zcGxpdCgnLycpWzJdXG4gICAgICBcbiAgICAgIGNvbnN0IHsgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgIC5mcm9tKCdjYXJkcycpXG4gICAgICAgIC5kZWxldGUoKVxuICAgICAgICAuZXEoJ2lkJywgY2FyZElkKVxuICAgICAgXG4gICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogZXJyb3IubWVzc2FnZSB9LCB7IHN0YXR1czogNTAwIH0pKVxuICAgICAgfVxuICAgICAgXG4gICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IHN1Y2Nlc3M6IHRydWUgfSkpXG4gICAgfVxuXG4gICAgLy8gQURNSU4gUk9VVEVTIC0gRGVsZXRlIGJveFxuICAgIGlmIChwYXRoLnN0YXJ0c1dpdGgoJ2FkbWluL2JveGVzLycpKSB7XG4gICAgICBjb25zdCBib3hJZCA9IHBhdGguc3BsaXQoJy8nKVsyXVxuICAgICAgXG4gICAgICAvLyBGaXJzdCBjaGVjayBpZiBhbnkgY2FyZHMgYXJlIGFzc2lnbmVkIHRvIHRoaXMgYm94XG4gICAgICBjb25zdCB7IGRhdGE6IGNhcmRzIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAuZnJvbSgnY2FyZHMnKVxuICAgICAgICAuc2VsZWN0KCdpZCcpXG4gICAgICAgIC5lcSgnYm94X2lkJywgYm94SWQpXG4gICAgICAgIC5saW1pdCgxKVxuICAgICAgXG4gICAgICBpZiAoY2FyZHMgJiYgY2FyZHMubGVuZ3RoID4gMCkge1xuICAgICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IFxuICAgICAgICAgIGVycm9yOiAnQ2Fubm90IGRlbGV0ZSBib3ggd2l0aCBhc3NpZ25lZCBjYXJkcy4gUmVtb3ZlIGNhcmRzIGZpcnN0LicgXG4gICAgICAgIH0sIHsgc3RhdHVzOiA0MDAgfSkpXG4gICAgICB9XG4gICAgICBcbiAgICAgIGNvbnN0IHsgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgIC5mcm9tKCdib3hlcycpXG4gICAgICAgIC5kZWxldGUoKVxuICAgICAgICAuZXEoJ2lkJywgYm94SWQpXG4gICAgICBcbiAgICAgIGlmIChlcnJvcikge1xuICAgICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiBlcnJvci5tZXNzYWdlIH0sIHsgc3RhdHVzOiA1MDAgfSkpXG4gICAgICB9XG4gICAgICBcbiAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgc3VjY2VzczogdHJ1ZSB9KSlcbiAgICB9XG5cbiAgICAvLyBBRE1JTiBST1VURVMgLSBEZWxldGUgY29sbGVjdGlvbiBzZXJpZXNcbiAgICBpZiAocGF0aC5zdGFydHNXaXRoKCdhZG1pbi9jb2xsZWN0aW9uLXNlcmllcy8nKSkge1xuICAgICAgY29uc3Qgc2VyaWVzSWQgPSBwYXRoLnNwbGl0KCcvJylbMl1cbiAgICAgIFxuICAgICAgY29uc3QgeyBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgLmZyb20oJ2NvbGxlY3Rpb25fc2VyaWVzJylcbiAgICAgICAgLmRlbGV0ZSgpXG4gICAgICAgIC5lcSgnaWQnLCBzZXJpZXNJZClcbiAgICAgIFxuICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfSwgeyBzdGF0dXM6IDUwMCB9KSlcbiAgICAgIH1cbiAgICAgIFxuICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBzdWNjZXNzOiB0cnVlIH0pKVxuICAgIH1cblxuICAgIC8vIEFETUlOIFJPVVRFUyAtIERlbGV0ZSBwcmljZVxuICAgIGlmIChwYXRoLnN0YXJ0c1dpdGgoJ2FkbWluL3ByaWNlcy8nKSkge1xuICAgICAgY29uc3QgcHJpY2VJZCA9IHBhdGguc3BsaXQoJy8nKVsyXVxuICAgICAgXG4gICAgICBjb25zdCB7IGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAuZnJvbSgncHJpY2VzJylcbiAgICAgICAgLmRlbGV0ZSgpXG4gICAgICAgIC5lcSgnaWQnLCBwcmljZUlkKVxuICAgICAgXG4gICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogZXJyb3IubWVzc2FnZSB9LCB7IHN0YXR1czogNTAwIH0pKVxuICAgICAgfVxuICAgICAgXG4gICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IHN1Y2Nlc3M6IHRydWUgfSkpXG4gICAgfVxuXG4gICAgLy8gQURNSU4gUk9VVEVTIC0gRGVsZXRlIHBpbGVcbiAgICBpZiAocGF0aC5zdGFydHNXaXRoKCdhZG1pbi9waWxlcy8nKSkge1xuICAgICAgY29uc3QgcGlsZUlkID0gcGF0aC5zcGxpdCgnLycpWzJdXG4gICAgICBcbiAgICAgIGNvbnN0IHsgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgIC5mcm9tKCdwaWxlcycpXG4gICAgICAgIC5kZWxldGUoKVxuICAgICAgICAuZXEoJ2lkJywgcGlsZUlkKVxuICAgICAgXG4gICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogZXJyb3IubWVzc2FnZSB9LCB7IHN0YXR1czogNTAwIH0pKVxuICAgICAgfVxuICAgICAgXG4gICAgICByZXR1cm4gaGFuZGxlQ09SUyhOZXh0UmVzcG9uc2UuanNvbih7IHN1Y2Nlc3M6IHRydWUgfSkpXG4gICAgfVxuXG4gICAgLy8gQURNSU4gUk9VVEVTIC0gRGVsZXRlIGJ1bmRsZVxuICAgIGlmIChwYXRoLnN0YXJ0c1dpdGgoJ2FkbWluL2J1bmRsZXMvJykpIHtcbiAgICAgIGNvbnN0IGJ1bmRsZUlkID0gcGF0aC5zcGxpdCgnLycpWzJdXG4gICAgICBcbiAgICAgIGNvbnN0IHsgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgIC5mcm9tKCdidW5kbGVzJylcbiAgICAgICAgLmRlbGV0ZSgpXG4gICAgICAgIC5lcSgnaWQnLCBidW5kbGVJZClcbiAgICAgIFxuICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfSwgeyBzdGF0dXM6IDUwMCB9KSlcbiAgICAgIH1cbiAgICAgIFxuICAgICAgcmV0dXJuIGhhbmRsZUNPUlMoTmV4dFJlc3BvbnNlLmpzb24oeyBzdWNjZXNzOiB0cnVlIH0pKVxuICAgIH1cblxuICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdSb3V0ZSBub3QgZm91bmQnIH0sIHsgc3RhdHVzOiA0MDQgfSkpXG4gICAgXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignQVBJIEVycm9yOicsIGVycm9yKVxuICAgIHJldHVybiBoYW5kbGVDT1JTKE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfSwgeyBzdGF0dXM6IDUwMCB9KSlcbiAgfVxufVxuIl0sIm5hbWVzIjpbIk5leHRSZXNwb25zZSIsImNyZWF0ZVN1cGFiYXNlU2VydmVyIiwiZ2V0U3RyaXBlIiwidjQiLCJ1dWlkdjQiLCJoYW5kbGVDT1JTIiwicmVzcG9uc2UiLCJoZWFkZXJzIiwic2V0IiwiT1BUSU9OUyIsInN0YXR1cyIsImdldEF1dGhlbnRpY2F0ZWRVc2VyIiwicHJvY2VzcyIsImVudiIsIkxPQ0FMX01PREUiLCJjb29raWVzIiwiZ2V0VXNlckZyb21Ub2tlbiIsImNvb2tpZVN0b3JlIiwidG9rZW4iLCJnZXQiLCJ2YWx1ZSIsInVzZXIiLCJlcnJvciIsInN1cGFiYXNlIiwiZGF0YSIsImF1dGgiLCJnZXRVc2VyIiwiZ2V0VXNlckVudGl0bGVkQm94SWRzIiwiZ2V0Qm94ZXNXaXRoVmlzaWJpbGl0eSIsImdldFVzZXJBY2Nlc3NpYmxlQm94ZXMiLCJ1c2VySWQiLCJib3hlcyIsImJveEVycm9yIiwiZnJvbSIsInNlbGVjdCIsImVxIiwib3JkZXIiLCJhc2NlbmRpbmciLCJhY2Nlc3NpYmxlQm94SWRzIiwiYm94SWRzIiwiaGFzTWVtYmVyc2hpcCIsImhhc0FsbEFjY2VzcyIsImNoZWNrVXNlckFjY2VzcyIsInNhbXBsZUJveGVzIiwic2FtcGxlQm94SWRzIiwibWFwIiwiYiIsImlkIiwiaGFzUGFpZEFjY2VzcyIsInNvbWUiLCJpbmNsdWRlcyIsIkdFVCIsInJlcXVlc3QiLCJ1cmwiLCJVUkwiLCJwYXRoIiwicGF0aG5hbWUiLCJyZXBsYWNlIiwianNvbiIsImVtYWlsIiwiYm94ZXNXaXRoQWNjZXNzIiwiYm94IiwiaGFzQWNjZXNzIiwic2VhcmNoUGFyYW1zIiwic3BsaXQiLCJmaWx0ZXIiLCJCb29sZWFuIiwicXVlcnlCb3hJZHMiLCJsZW5ndGgiLCJjYXJkcyIsIm1lc3NhZ2UiLCJpbiIsImNvbnNvbGUiLCJwaWxlc01hcCIsInBpbGVJZHMiLCJTZXQiLCJjIiwicGlsZV9pZCIsInBpbGVzIiwiZm9yRWFjaCIsInAiLCJ0cmFuc2Zvcm1lZENhcmRzIiwiY2FyZCIsInBpbGUiLCJib3hfaWQiLCJ0ZXh0IiwiaW1hZ2VfcGF0aCIsImlzX2FjdGl2ZSIsImNyZWF0ZWRfYXQiLCJjb2xvciIsInNsdWciLCJwaWxlX25hbWUiLCJuYW1lIiwicGlsZV9pbWFnZSIsInRpdGxlIiwiaW1hZ2VQYXRoIiwicGxhbnMiLCJzZXJpZXMiLCJhdXRoRXJyb3IiLCJwdXJjaGFzZXMiLCJkcmF3cyIsImJveGVzUmVzdWx0IiwicGlsZXNSZXN1bHQiLCJzZXJpZXNSZXN1bHQiLCJQcm9taXNlIiwiYWxsIiwiYm94TWFwIiwicGlsZU1hcCIsInNlcmllc01hcCIsInMiLCJlbnJpY2hlZENhcmRzIiwiY29sbGVjdGlvblNlcmllcyIsImNvbGxlY3Rpb25fc2VyaWVzX2lkIiwiY29sbGVjdGlvbl9zZXJpZXMiLCJjYXJkc1Jlc3VsdCIsInByaWNlc1Jlc3VsdCIsInByaWNlcyIsImxvZyIsInByaWNlTWFwIiwiY2FyZENvdW50cyIsImtleSIsInRvdGFsIiwiYnlQaWxlIiwicGlsZUlkIiwiY291bnQiLCJwaWxlTmFtZSIsInBpbGVTbHVnIiwiZW5yaWNoZWRCb3hlcyIsInByaWNlX2lkIiwiY2FyZFN0YXRzIiwicGlsZXNFcnJvciIsInNlcmllc0Vycm9yIiwiQXJyYXkiLCJpc0FycmF5IiwiT2JqZWN0Iiwia2V5cyIsImVucmljaGVkUGlsZXMiLCJzZXJpZXNEYXRhIiwiYnVuZGxlcyIsImVucmljaGVkQnVuZGxlcyIsIlBPU1QiLCJib2R5IiwicGFzc3dvcmQiLCJzaWduVXAiLCJzaWduSW5XaXRoUGFzc3dvcmQiLCJzaWduT3V0Iiwic3VjY2VzcyIsImNvb2tpZU9wdGlvbnMiLCJleHBpcmVzIiwiRGF0ZSIsIm1heEFnZSIsInN1cGFiYXNlVXJsIiwiTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMIiwicHJvamVjdFJlZiIsIm1hdGNoIiwic2lnbkluV2l0aE9BdXRoIiwicHJvdmlkZXIiLCJvcHRpb25zIiwicmVkaXJlY3RUbyIsIk5FWFRfUFVCTElDX0JBU0VfVVJMIiwicmVzZXRQYXNzd29yZEZvckVtYWlsIiwiYmxhY2tDYXJkSWQiLCJ3aGl0ZUNhcmRJZCIsImJsYWNrQ2FyZFRpdGxlIiwid2hpdGVDYXJkVGl0bGUiLCJkcmF3IiwidXNlcmlkIiwidXNlcmVtYWlsIiwiYmxhY2tjYXJkaWQiLCJ3aGl0ZWNhcmRpZCIsImJsYWNrY2FyZHRpdGxlIiwid2hpdGVjYXJkdGl0bGUiLCJ0aW1lc3RhbXAiLCJ0b0lTT1N0cmluZyIsImluc2VydCIsInNpbmdsZSIsImJveElkIiwiaXNfc2FtcGxlIiwic2Vzc2lvbiIsImNoZWNrb3V0Iiwic2Vzc2lvbnMiLCJjcmVhdGUiLCJwYXltZW50X21ldGhvZF90eXBlcyIsImxpbmVfaXRlbXMiLCJwcmljZV9kYXRhIiwiY3VycmVuY3kiLCJwcm9kdWN0X2RhdGEiLCJkZXNjcmlwdGlvbiIsInVuaXRfYW1vdW50IiwiTWF0aCIsInJvdW5kIiwicHJpY2UiLCJxdWFudGl0eSIsIm1vZGUiLCJzdWNjZXNzX3VybCIsImNhbmNlbF91cmwiLCJjbGllbnRfcmVmZXJlbmNlX2lkIiwiY3VzdG9tZXJfZW1haWwiLCJtZXRhZGF0YSIsInB1cmNoYXNlX3R5cGUiLCJwbGFuSWQiLCJwbGFuIiwicGxhbkVycm9yIiwiaW50ZXJ2YWwiLCJpbnRlcnZhbENvdW50IiwicmVjdXJyaW5nIiwiaW50ZXJ2YWxfY291bnQiLCJwbGFuX2lkIiwicHVyY2hhc2VJZCIsInB1cmNoYXNlIiwicHVyY2hhc2VFcnJvciIsInN0cmlwZV9zdWJzY3JpcHRpb25faWQiLCJzdWJzY3JpcHRpb25zIiwiY2FuY2VsIiwidXBkYXRlIiwic3RyaXBlRXJyb3IiLCJwYXltZW50VHlwZSIsImNvdXBvbkNvZGUiLCJzZXNzaW9uQ29uZmlnIiwicHVzaCIsImNvdXBvbnMiLCJsaXN0IiwibGltaXQiLCJ2YWxpZENvdXBvbiIsImZpbmQiLCJ0b0xvd2VyQ2FzZSIsImRpc2NvdW50cyIsImNvdXBvbiIsInN0cmlwZSIsImlzQWN0aXZlIiwiY3J5cHRvIiwiY2FyZElkIiwiY3JlYXRlSGFzaCIsIm5vdyIsInJhbmRvbSIsImRpZ2VzdCIsImRlc2NyaXB0aW9uU2hvcnQiLCJ0YWdsaW5lIiwidG9waWNzIiwicHJpY2VJZCIsImNvbG9yUGFsZXR0ZSIsImJveFBhdGgiLCJkaXNwbGF5T3JkZXIiLCJpc1NhbXBsZSIsImZ1bGxCb3hJZCIsImNvbGxlY3Rpb25TZXJpZXNJZCIsInNsaWNlIiwiZGVzY3JpcHRpb25fc2hvcnQiLCJjb2xvcl9wYWxldHRlIiwiZGlzcGxheV9vcmRlciIsImZ1bGxfYm94X2lkIiwibGFiZWwiLCJwYXltZW50SW5mbyIsImhvb2tJbmZvIiwiYW1vdW50IiwicHJvbW9BbW91bnQiLCJwcm9tb0VuYWJsZWQiLCJtZW1iZXJzaGlwRGF5cyIsInN0cmlwZVByaWNlSWQiLCJwYXltZW50X2luZm8iLCJob29rX2luZm8iLCJwcm9tb19hbW91bnQiLCJwcm9tb19lbmFibGVkIiwibWVtYmVyc2hpcF9kYXlzIiwic3RyaXBlX3ByaWNlX2lkIiwiYnVuZGxlIiwiYm94X2lkcyIsImRlbGV0ZVJlc3VsdCIsImRlbGV0ZSIsImRlbGV0ZWQiLCJxdWVyeSIsImltYWdlUGF0aHMiLCJQVVQiLCJzdGFydHNXaXRoIiwidXBkYXRlRGF0YSIsInVuZGVmaW5lZCIsInNlcmllc0lkIiwiYnVuZGxlSWQiLCJERUxFVEUiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./app/api/[[...path]]/route.js\n");

/***/ }),

/***/ "(rsc)/./lib/db-local.js":
/*!*************************!*\
  !*** ./lib/db-local.js ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createLocalClient: () => (/* binding */ createLocalClient),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   getPool: () => (/* binding */ getPool),\n/* harmony export */   query: () => (/* binding */ query)\n/* harmony export */ });\n/* harmony import */ var pg__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! pg */ \"pg\");\n/* harmony import */ var pg__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(pg__WEBPACK_IMPORTED_MODULE_0__);\n// Local PostgreSQL Database Client\n// Used when LOCAL_MODE=true\n\nlet pool = null;\nfunction getPool() {\n    if (!pool) {\n        const connectionString = process.env.DATABASE_URL || \"postgresql://postgres:postgres@localhost:5432/asweallare\";\n        console.log(\"[DB-LOCAL] Creating pool with:\", connectionString.replace(/:[^:@]+@/, \":***@\"));\n        pool = new pg__WEBPACK_IMPORTED_MODULE_0__.Pool({\n            connectionString\n        });\n        pool.on(\"error\", (err)=>{\n            console.error(\"[DB-LOCAL] Pool error:\", err.message);\n        });\n    }\n    return pool;\n}\nasync function query(text, params) {\n    const pool = getPool();\n    try {\n        const result = await pool.query(text, params);\n        return result;\n    } catch (error) {\n        console.error(\"[DB-LOCAL] Query error:\", error.message);\n        console.error(\"[DB-LOCAL] Query was:\", text);\n        throw error;\n    }\n}\n// Helper to mimic Supabase response format\nfunction createLocalClient() {\n    return {\n        from: (table)=>new QueryBuilder(table),\n        auth: {\n            getUser: async ()=>{\n                // In local mode, return a mock admin user\n                return {\n                    data: {\n                        user: {\n                            id: \"00000000-0000-0000-0000-000000000001\",\n                            email: \"admin@local.dev\"\n                        }\n                    },\n                    error: null\n                };\n            },\n            getSession: async ()=>{\n                return {\n                    data: {\n                        session: {\n                            user: {\n                                id: \"00000000-0000-0000-0000-000000000001\",\n                                email: \"admin@local.dev\"\n                            }\n                        }\n                    },\n                    error: null\n                };\n            },\n            signOut: async ()=>({\n                    error: null\n                }),\n            onAuthStateChange: ()=>({\n                    data: {\n                        subscription: {\n                            unsubscribe: ()=>{}\n                        }\n                    }\n                })\n        }\n    };\n}\nclass QueryBuilder {\n    constructor(table){\n        this.table = table;\n        this._select = \"*\";\n        this._where = [];\n        this._whereParams = [];\n        this._order = null;\n        this._single = false;\n        this._limit = null;\n        this._returnData = true;\n        this._operation = null // 'update', 'delete', or null for select\n        ;\n        this._updateData = null;\n    }\n    select(columns = \"*\") {\n        // Handle Supabase-style nested selects by stripping them\n        // e.g., '*, piles(slug, name)' becomes '*'\n        if (columns.includes(\"(\")) {\n            this._select = columns.split(\",\").filter((c)=>!c.includes(\"(\")).map((c)=>c.trim()).join(\", \") || \"*\";\n        } else {\n            this._select = columns;\n        }\n        return this;\n    }\n    eq(column, value) {\n        this._whereParams.push(value);\n        this._where.push(`\"${column}\" = $${this._whereParams.length}`);\n        return this;\n    }\n    neq(column, value) {\n        this._whereParams.push(value);\n        this._where.push(`\"${column}\" != $${this._whereParams.length}`);\n        return this;\n    }\n    in(column, values) {\n        if (values && values.length > 0) {\n            const placeholders = values.map((_, i)=>`$${this._whereParams.length + i + 1}`).join(\", \");\n            this._whereParams.push(...values);\n            this._where.push(`\"${column}\" IN (${placeholders})`);\n        }\n        // If empty array, don't add any condition (will return all or be filtered by other conditions)\n        return this;\n    }\n    order(column, { ascending = true } = {}) {\n        this._order = `\"${column}\" ${ascending ? \"ASC\" : \"DESC\"}`;\n        return this;\n    }\n    limit(count) {\n        this._limit = count;\n        return this;\n    }\n    single() {\n        this._single = true;\n        this._limit = 1;\n        return this;\n    }\n    // Execute SELECT query\n    async then(resolve, reject) {\n        try {\n            let sql = `SELECT ${this._select} FROM \"${this.table}\"`;\n            if (this._where.length > 0) {\n                sql += ` WHERE ${this._where.join(\" AND \")}`;\n            }\n            if (this._order) {\n                sql += ` ORDER BY ${this._order}`;\n            }\n            if (this._limit) {\n                sql += ` LIMIT ${this._limit}`;\n            }\n            console.log(\"[DB-LOCAL] Executing:\", sql, \"with params:\", this._whereParams);\n            const result = await query(sql, this._whereParams);\n            if (this._single) {\n                resolve({\n                    data: result.rows[0] || null,\n                    error: null\n                });\n            } else {\n                resolve({\n                    data: result.rows,\n                    error: null\n                });\n            }\n        } catch (error) {\n            console.error(\"[DB-LOCAL] Query failed:\", error.message);\n            if (reject) {\n                reject(error);\n            } else {\n                resolve({\n                    data: null,\n                    error\n                });\n            }\n        }\n    }\n    async insert(data) {\n        try {\n            // Handle array of objects\n            const records = Array.isArray(data) ? data : [\n                data\n            ];\n            const results = [];\n            for (const record of records){\n                const keys = Object.keys(record);\n                const values = Object.values(record);\n                const placeholders = values.map((_, i)=>`$${i + 1}`).join(\", \");\n                const quotedKeys = keys.map((k)=>`\"${k}\"`).join(\", \");\n                const sql = `INSERT INTO \"${this.table}\" (${quotedKeys}) VALUES (${placeholders}) RETURNING *`;\n                console.log(\"[DB-LOCAL] Insert:\", sql);\n                const result = await query(sql, values);\n                results.push(result.rows[0]);\n            }\n            // Return a chainable object that mimics Supabase behavior\n            const insertResult = {\n                data: results,\n                error: null\n            };\n            return {\n                ...insertResult,\n                select: ()=>({\n                        single: ()=>Promise.resolve({\n                                data: results[0],\n                                error: null\n                            }),\n                        then: (resolve)=>resolve({\n                                data: results,\n                                error: null\n                            })\n                    }),\n                then: (resolve)=>resolve(insertResult)\n            };\n        } catch (error) {\n            console.error(\"[DB-LOCAL] Insert failed:\", error.message);\n            const errorResult = {\n                data: null,\n                error\n            };\n            return {\n                ...errorResult,\n                select: ()=>({\n                        single: ()=>Promise.resolve(errorResult),\n                        then: (resolve)=>resolve(errorResult)\n                    }),\n                then: (resolve)=>resolve(errorResult)\n            };\n        }\n    }\n    // Store update data for later execution\n    update(data) {\n        this._updateData = data;\n        this._operation = \"update\";\n        return this;\n    }\n    // Execute UPDATE query\n    async _executeUpdate() {\n        try {\n            const keys = Object.keys(this._updateData);\n            const values = Object.values(this._updateData);\n            const setClause = keys.map((k, i)=>`\"${k}\" = $${i + 1}`).join(\", \");\n            let sql = `UPDATE \"${this.table}\" SET ${setClause}`;\n            const params = [\n                ...values\n            ];\n            if (this._where.length > 0) {\n                // Adjust parameter indices for where clause\n                const whereWithOffset = this._where.map((w)=>{\n                    return w.replace(/\\$(\\d+)/g, (match, num)=>`$${parseInt(num) + values.length}`);\n                });\n                sql += ` WHERE ${whereWithOffset.join(\" AND \")}`;\n                params.push(...this._whereParams);\n            }\n            sql += \" RETURNING *\";\n            console.log(\"[DB-LOCAL] Update:\", sql, \"params:\", params);\n            const result = await query(sql, params);\n            return {\n                data: result.rows,\n                error: null\n            };\n        } catch (error) {\n            console.error(\"[DB-LOCAL] Update failed:\", error.message);\n            return {\n                data: null,\n                error\n            };\n        }\n    }\n    // Execute DELETE query\n    async _executeDelete() {\n        try {\n            let sql = `DELETE FROM \"${this.table}\"`;\n            if (this._where.length > 0) {\n                sql += ` WHERE ${this._where.join(\" AND \")}`;\n            }\n            sql += \" RETURNING *\";\n            console.log(\"[DB-LOCAL] Delete:\", sql);\n            const result = await query(sql, this._whereParams);\n            return {\n                data: result.rows,\n                error: null\n            };\n        } catch (error) {\n            console.error(\"[DB-LOCAL] Delete failed:\", error.message);\n            return {\n                data: null,\n                error\n            };\n        }\n    }\n    // Mark as delete operation\n    delete() {\n        this._operation = \"delete\";\n        return this;\n    }\n    // Execute SELECT query (and UPDATE/DELETE if flagged)\n    async then(resolve, reject) {\n        try {\n            // Handle update operation\n            if (this._operation === \"update\") {\n                const result = await this._executeUpdate();\n                resolve(result);\n                return;\n            }\n            // Handle delete operation\n            if (this._operation === \"delete\") {\n                const result = await this._executeDelete();\n                resolve(result);\n                return;\n            }\n            // Default: SELECT\n            let sql = `SELECT ${this._select} FROM \"${this.table}\"`;\n            if (this._where.length > 0) {\n                sql += ` WHERE ${this._where.join(\" AND \")}`;\n            }\n            if (this._order) {\n                sql += ` ORDER BY ${this._order}`;\n            }\n            if (this._limit) {\n                sql += ` LIMIT ${this._limit}`;\n            }\n            console.log(\"[DB-LOCAL] Executing:\", sql, \"with params:\", this._whereParams);\n            const result = await query(sql, this._whereParams);\n            if (this._single) {\n                resolve({\n                    data: result.rows[0] || null,\n                    error: null\n                });\n            } else {\n                resolve({\n                    data: result.rows,\n                    error: null\n                });\n            }\n        } catch (error) {\n            console.error(\"[DB-LOCAL] Query failed:\", error.message);\n            if (reject) {\n                reject(error);\n            } else {\n                resolve({\n                    data: null,\n                    error\n                });\n            }\n        }\n    }\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({\n    query,\n    getPool,\n    createLocalClient\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RUFBRTtnQkFDZmtDLE9BQU8sQ0FBQyxVQUFVLEVBQUUsSUFBSSxDQUFDbEMsTUFBTSxDQUFDLENBQUM7WUFDbkM7WUFFQSxJQUFJLElBQUksQ0FBQ0UsTUFBTSxFQUFFO2dCQUNmZ0MsT0FBTyxDQUFDLE9BQU8sRUFBRSxJQUFJLENBQUNoQyxNQUFNLENBQUMsQ0FBQztZQUNoQztZQUVBakMsUUFBUUMsR0FBRyxDQUFDLHlCQUF5QmdFLEtBQUssZ0JBQWdCLElBQUksQ0FBQ25DLFlBQVk7WUFDM0UsTUFBTXBCLFNBQVMsTUFBTUgsTUFBTTBELEtBQUssSUFBSSxDQUFDbkMsWUFBWTtZQUVqRCxJQUFJLElBQUksQ0FBQ0UsT0FBTyxFQUFFO2dCQUNoQitCLFFBQVE7b0JBQUU5QyxNQUFNUCxPQUFPd0QsSUFBSSxDQUFDLEVBQUUsSUFBSTtvQkFBTTdELE9BQU87Z0JBQUs7WUFDdEQsT0FBTztnQkFDTDBELFFBQVE7b0JBQUU5QyxNQUFNUCxPQUFPd0QsSUFBSTtvQkFBRTdELE9BQU87Z0JBQUs7WUFDM0M7UUFDRixFQUFFLE9BQU9BLE9BQU87WUFDZEwsUUFBUUssS0FBSyxDQUFDLDRCQUE0QkEsTUFBTUMsT0FBTztZQUN2RCxJQUFJMEQsUUFBUTtnQkFDVkEsT0FBTzNEO1lBQ1QsT0FBTztnQkFDTDBELFFBQVE7b0JBQUU5QyxNQUFNO29CQUFNWjtnQkFBTTtZQUM5QjtRQUNGO0lBQ0Y7QUFFRjtBQUVBLGlFQUFlO0lBQUVFO0lBQU9aO0lBQVNnQjtBQUFrQixDQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYXN3ZWFsbGFyZS1hZG1pbi8uL2xpYi9kYi1sb2NhbC5qcz82MTM2Il0sInNvdXJjZXNDb250ZW50IjpbIi8vIExvY2FsIFBvc3RncmVTUUwgRGF0YWJhc2UgQ2xpZW50XG4vLyBVc2VkIHdoZW4gTE9DQUxfTU9ERT10cnVlXG5cbmltcG9ydCB7IFBvb2wgfSBmcm9tICdwZydcblxubGV0IHBvb2wgPSBudWxsXG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRQb29sKCkge1xuICBpZiAoIXBvb2wpIHtcbiAgICBjb25zdCBjb25uZWN0aW9uU3RyaW5nID0gcHJvY2Vzcy5lbnYuREFUQUJBU0VfVVJMIHx8ICdwb3N0Z3Jlc3FsOi8vcG9zdGdyZXM6cG9zdGdyZXNAbG9jYWxob3N0OjU0MzIvYXN3ZWFsbGFyZSdcbiAgICBjb25zb2xlLmxvZygnW0RCLUxPQ0FMXSBDcmVhdGluZyBwb29sIHdpdGg6JywgY29ubmVjdGlvblN0cmluZy5yZXBsYWNlKC86W146QF0rQC8sICc6KioqQCcpKVxuICAgIHBvb2wgPSBuZXcgUG9vbCh7IGNvbm5lY3Rpb25TdHJpbmcgfSlcbiAgICBcbiAgICBwb29sLm9uKCdlcnJvcicsIChlcnIpID0+IHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1tEQi1MT0NBTF0gUG9vbCBlcnJvcjonLCBlcnIubWVzc2FnZSlcbiAgICB9KVxuICB9XG4gIHJldHVybiBwb29sXG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBxdWVyeSh0ZXh0LCBwYXJhbXMpIHtcbiAgY29uc3QgcG9vbCA9IGdldFBvb2woKVxuICB0cnkge1xuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHBvb2wucXVlcnkodGV4dCwgcGFyYW1zKVxuICAgIHJldHVybiByZXN1bHRcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdbREItTE9DQUxdIFF1ZXJ5IGVycm9yOicsIGVycm9yLm1lc3NhZ2UpXG4gICAgY29uc29sZS5lcnJvcignW0RCLUxPQ0FMXSBRdWVyeSB3YXM6JywgdGV4dClcbiAgICB0aHJvdyBlcnJvclxuICB9XG59XG5cbi8vIEhlbHBlciB0byBtaW1pYyBTdXBhYmFzZSByZXNwb25zZSBmb3JtYXRcbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVMb2NhbENsaWVudCgpIHtcbiAgcmV0dXJuIHtcbiAgICBmcm9tOiAodGFibGUpID0+IG5ldyBRdWVyeUJ1aWxkZXIodGFibGUpLFxuICAgIGF1dGg6IHtcbiAgICAgIGdldFVzZXI6IGFzeW5jICgpID0+IHtcbiAgICAgICAgLy8gSW4gbG9jYWwgbW9kZSwgcmV0dXJuIGEgbW9jayBhZG1pbiB1c2VyXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgdXNlcjoge1xuICAgICAgICAgICAgICBpZDogJzAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMScsXG4gICAgICAgICAgICAgIGVtYWlsOiAnYWRtaW5AbG9jYWwuZGV2J1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sXG4gICAgICAgICAgZXJyb3I6IG51bGxcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIGdldFNlc3Npb246IGFzeW5jICgpID0+IHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICBzZXNzaW9uOiB7XG4gICAgICAgICAgICAgIHVzZXI6IHtcbiAgICAgICAgICAgICAgICBpZDogJzAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMScsXG4gICAgICAgICAgICAgICAgZW1haWw6ICdhZG1pbkBsb2NhbC5kZXYnXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9LFxuICAgICAgICAgIGVycm9yOiBudWxsXG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBzaWduT3V0OiBhc3luYyAoKSA9PiAoeyBlcnJvcjogbnVsbCB9KSxcbiAgICAgIG9uQXV0aFN0YXRlQ2hhbmdlOiAoKSA9PiAoeyBkYXRhOiB7IHN1YnNjcmlwdGlvbjogeyB1bnN1YnNjcmliZTogKCkgPT4ge30gfSB9IH0pXG4gICAgfVxuICB9XG59XG5cbmNsYXNzIFF1ZXJ5QnVpbGRlciB7XG4gIGNvbnN0cnVjdG9yKHRhYmxlKSB7XG4gICAgdGhpcy50YWJsZSA9IHRhYmxlXG4gICAgdGhpcy5fc2VsZWN0ID0gJyonXG4gICAgdGhpcy5fd2hlcmUgPSBbXVxuICAgIHRoaXMuX3doZXJlUGFyYW1zID0gW11cbiAgICB0aGlzLl9vcmRlciA9IG51bGxcbiAgICB0aGlzLl9zaW5nbGUgPSBmYWxzZVxuICAgIHRoaXMuX2xpbWl0ID0gbnVsbFxuICAgIHRoaXMuX3JldHVybkRhdGEgPSB0cnVlXG4gICAgdGhpcy5fb3BlcmF0aW9uID0gbnVsbCAvLyAndXBkYXRlJywgJ2RlbGV0ZScsIG9yIG51bGwgZm9yIHNlbGVjdFxuICAgIHRoaXMuX3VwZGF0ZURhdGEgPSBudWxsXG4gIH1cblxuICBzZWxlY3QoY29sdW1ucyA9ICcqJykge1xuICAgIC8vIEhhbmRsZSBTdXBhYmFzZS1zdHlsZSBuZXN0ZWQgc2VsZWN0cyBieSBzdHJpcHBpbmcgdGhlbVxuICAgIC8vIGUuZy4sICcqLCBwaWxlcyhzbHVnLCBuYW1lKScgYmVjb21lcyAnKidcbiAgICBpZiAoY29sdW1ucy5pbmNsdWRlcygnKCcpKSB7XG4gICAgICB0aGlzLl9zZWxlY3QgPSBjb2x1bW5zLnNwbGl0KCcsJykuZmlsdGVyKGMgPT4gIWMuaW5jbHVkZXMoJygnKSkubWFwKGMgPT4gYy50cmltKCkpLmpvaW4oJywgJykgfHwgJyonXG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX3NlbGVjdCA9IGNvbHVtbnNcbiAgICB9XG4gICAgcmV0dXJuIHRoaXNcbiAgfVxuXG4gIGVxKGNvbHVtbiwgdmFsdWUpIHtcbiAgICB0aGlzLl93aGVyZVBhcmFtcy5wdXNoKHZhbHVlKVxuICAgIHRoaXMuX3doZXJlLnB1c2goYFwiJHtjb2x1bW59XCIgPSAkJHt0aGlzLl93aGVyZVBhcmFtcy5sZW5ndGh9YClcbiAgICByZXR1cm4gdGhpc1xuICB9XG5cbiAgbmVxKGNvbHVtbiwgdmFsdWUpIHtcbiAgICB0aGlzLl93aGVyZVBhcmFtcy5wdXNoKHZhbHVlKVxuICAgIHRoaXMuX3doZXJlLnB1c2goYFwiJHtjb2x1bW59XCIgIT0gJCR7dGhpcy5fd2hlcmVQYXJhbXMubGVuZ3RofWApXG4gICAgcmV0dXJuIHRoaXNcbiAgfVxuXG4gIGluKGNvbHVtbiwgdmFsdWVzKSB7XG4gICAgaWYgKHZhbHVlcyAmJiB2YWx1ZXMubGVuZ3RoID4gMCkge1xuICAgICAgY29uc3QgcGxhY2Vob2xkZXJzID0gdmFsdWVzLm1hcCgoXywgaSkgPT4gYCQke3RoaXMuX3doZXJlUGFyYW1zLmxlbmd0aCArIGkgKyAxfWApLmpvaW4oJywgJylcbiAgICAgIHRoaXMuX3doZXJlUGFyYW1zLnB1c2goLi4udmFsdWVzKVxuICAgICAgdGhpcy5fd2hlcmUucHVzaChgXCIke2NvbHVtbn1cIiBJTiAoJHtwbGFjZWhvbGRlcnN9KWApXG4gICAgfVxuICAgIC8vIElmIGVtcHR5IGFycmF5LCBkb24ndCBhZGQgYW55IGNvbmRpdGlvbiAod2lsbCByZXR1cm4gYWxsIG9yIGJlIGZpbHRlcmVkIGJ5IG90aGVyIGNvbmRpdGlvbnMpXG4gICAgcmV0dXJuIHRoaXNcbiAgfVxuXG4gIG9yZGVyKGNvbHVtbiwgeyBhc2NlbmRpbmcgPSB0cnVlIH0gPSB7fSkge1xuICAgIHRoaXMuX29yZGVyID0gYFwiJHtjb2x1bW59XCIgJHthc2NlbmRpbmcgPyAnQVNDJyA6ICdERVNDJ31gXG4gICAgcmV0dXJuIHRoaXNcbiAgfVxuXG4gIGxpbWl0KGNvdW50KSB7XG4gICAgdGhpcy5fbGltaXQgPSBjb3VudFxuICAgIHJldHVybiB0aGlzXG4gIH1cblxuICBzaW5nbGUoKSB7XG4gICAgdGhpcy5fc2luZ2xlID0gdHJ1ZVxuICAgIHRoaXMuX2xpbWl0ID0gMVxuICAgIHJldHVybiB0aGlzXG4gIH1cblxuICAvLyBFeGVjdXRlIFNFTEVDVCBxdWVyeVxuICBhc3luYyB0aGVuKHJlc29sdmUsIHJlamVjdCkge1xuICAgIHRyeSB7XG4gICAgICBsZXQgc3FsID0gYFNFTEVDVCAke3RoaXMuX3NlbGVjdH0gRlJPTSBcIiR7dGhpcy50YWJsZX1cImBcbiAgICAgIFxuICAgICAgaWYgKHRoaXMuX3doZXJlLmxlbmd0aCA+IDApIHtcbiAgICAgICAgc3FsICs9IGAgV0hFUkUgJHt0aGlzLl93aGVyZS5qb2luKCcgQU5EICcpfWBcbiAgICAgIH1cbiAgICAgIFxuICAgICAgaWYgKHRoaXMuX29yZGVyKSB7XG4gICAgICAgIHNxbCArPSBgIE9SREVSIEJZICR7dGhpcy5fb3JkZXJ9YFxuICAgICAgfVxuICAgICAgXG4gICAgICBpZiAodGhpcy5fbGltaXQpIHtcbiAgICAgICAgc3FsICs9IGAgTElNSVQgJHt0aGlzLl9saW1pdH1gXG4gICAgICB9XG5cbiAgICAgIGNvbnNvbGUubG9nKCdbREItTE9DQUxdIEV4ZWN1dGluZzonLCBzcWwsICd3aXRoIHBhcmFtczonLCB0aGlzLl93aGVyZVBhcmFtcylcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHF1ZXJ5KHNxbCwgdGhpcy5fd2hlcmVQYXJhbXMpXG4gICAgICBcbiAgICAgIGlmICh0aGlzLl9zaW5nbGUpIHtcbiAgICAgICAgcmVzb2x2ZSh7IGRhdGE6IHJlc3VsdC5yb3dzWzBdIHx8IG51bGwsIGVycm9yOiBudWxsIH0pXG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXNvbHZlKHsgZGF0YTogcmVzdWx0LnJvd3MsIGVycm9yOiBudWxsIH0pXG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1tEQi1MT0NBTF0gUXVlcnkgZmFpbGVkOicsIGVycm9yLm1lc3NhZ2UpXG4gICAgICBpZiAocmVqZWN0KSB7XG4gICAgICAgIHJlamVjdChlcnJvcilcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlc29sdmUoeyBkYXRhOiBudWxsLCBlcnJvciB9KVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGluc2VydChkYXRhKSB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIEhhbmRsZSBhcnJheSBvZiBvYmplY3RzXG4gICAgICBjb25zdCByZWNvcmRzID0gQXJyYXkuaXNBcnJheShkYXRhKSA/IGRhdGEgOiBbZGF0YV1cbiAgICAgIGNvbnN0IHJlc3VsdHMgPSBbXVxuICAgICAgXG4gICAgICBmb3IgKGNvbnN0IHJlY29yZCBvZiByZWNvcmRzKSB7XG4gICAgICAgIGNvbnN0IGtleXMgPSBPYmplY3Qua2V5cyhyZWNvcmQpXG4gICAgICAgIGNvbnN0IHZhbHVlcyA9IE9iamVjdC52YWx1ZXMocmVjb3JkKVxuICAgICAgICBjb25zdCBwbGFjZWhvbGRlcnMgPSB2YWx1ZXMubWFwKChfLCBpKSA9PiBgJCR7aSArIDF9YCkuam9pbignLCAnKVxuICAgICAgICBjb25zdCBxdW90ZWRLZXlzID0ga2V5cy5tYXAoayA9PiBgXCIke2t9XCJgKS5qb2luKCcsICcpXG4gICAgICAgIFxuICAgICAgICBjb25zdCBzcWwgPSBgSU5TRVJUIElOVE8gXCIke3RoaXMudGFibGV9XCIgKCR7cXVvdGVkS2V5c30pIFZBTFVFUyAoJHtwbGFjZWhvbGRlcnN9KSBSRVRVUk5JTkcgKmBcbiAgICAgICAgY29uc29sZS5sb2coJ1tEQi1MT0NBTF0gSW5zZXJ0OicsIHNxbClcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcXVlcnkoc3FsLCB2YWx1ZXMpXG4gICAgICAgIHJlc3VsdHMucHVzaChyZXN1bHQucm93c1swXSlcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8gUmV0dXJuIGEgY2hhaW5hYmxlIG9iamVjdCB0aGF0IG1pbWljcyBTdXBhYmFzZSBiZWhhdmlvclxuICAgICAgY29uc3QgaW5zZXJ0UmVzdWx0ID0geyBkYXRhOiByZXN1bHRzLCBlcnJvcjogbnVsbCB9XG4gICAgICByZXR1cm4ge1xuICAgICAgICAuLi5pbnNlcnRSZXN1bHQsXG4gICAgICAgIHNlbGVjdDogKCkgPT4gKHtcbiAgICAgICAgICBzaW5nbGU6ICgpID0+IFByb21pc2UucmVzb2x2ZSh7IGRhdGE6IHJlc3VsdHNbMF0sIGVycm9yOiBudWxsIH0pLFxuICAgICAgICAgIHRoZW46IChyZXNvbHZlKSA9PiByZXNvbHZlKHsgZGF0YTogcmVzdWx0cywgZXJyb3I6IG51bGwgfSlcbiAgICAgICAgfSksXG4gICAgICAgIHRoZW46IChyZXNvbHZlKSA9PiByZXNvbHZlKGluc2VydFJlc3VsdClcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignW0RCLUxPQ0FMXSBJbnNlcnQgZmFpbGVkOicsIGVycm9yLm1lc3NhZ2UpXG4gICAgICBjb25zdCBlcnJvclJlc3VsdCA9IHsgZGF0YTogbnVsbCwgZXJyb3IgfVxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgLi4uZXJyb3JSZXN1bHQsXG4gICAgICAgIHNlbGVjdDogKCkgPT4gKHtcbiAgICAgICAgICBzaW5nbGU6ICgpID0+IFByb21pc2UucmVzb2x2ZShlcnJvclJlc3VsdCksXG4gICAgICAgICAgdGhlbjogKHJlc29sdmUpID0+IHJlc29sdmUoZXJyb3JSZXN1bHQpXG4gICAgICAgIH0pLFxuICAgICAgICB0aGVuOiAocmVzb2x2ZSkgPT4gcmVzb2x2ZShlcnJvclJlc3VsdClcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvLyBTdG9yZSB1cGRhdGUgZGF0YSBmb3IgbGF0ZXIgZXhlY3V0aW9uXG4gIHVwZGF0ZShkYXRhKSB7XG4gICAgdGhpcy5fdXBkYXRlRGF0YSA9IGRhdGFcbiAgICB0aGlzLl9vcGVyYXRpb24gPSAndXBkYXRlJ1xuICAgIHJldHVybiB0aGlzXG4gIH1cblxuICAvLyBFeGVjdXRlIFVQREFURSBxdWVyeVxuICBhc3luYyBfZXhlY3V0ZVVwZGF0ZSgpIHtcbiAgICB0cnkge1xuICAgICAgY29uc3Qga2V5cyA9IE9iamVjdC5rZXlzKHRoaXMuX3VwZGF0ZURhdGEpXG4gICAgICBjb25zdCB2YWx1ZXMgPSBPYmplY3QudmFsdWVzKHRoaXMuX3VwZGF0ZURhdGEpXG4gICAgICBjb25zdCBzZXRDbGF1c2UgPSBrZXlzLm1hcCgoaywgaSkgPT4gYFwiJHtrfVwiID0gJCR7aSArIDF9YCkuam9pbignLCAnKVxuICAgICAgXG4gICAgICBsZXQgc3FsID0gYFVQREFURSBcIiR7dGhpcy50YWJsZX1cIiBTRVQgJHtzZXRDbGF1c2V9YFxuICAgICAgY29uc3QgcGFyYW1zID0gWy4uLnZhbHVlc11cbiAgICAgIFxuICAgICAgaWYgKHRoaXMuX3doZXJlLmxlbmd0aCA+IDApIHtcbiAgICAgICAgLy8gQWRqdXN0IHBhcmFtZXRlciBpbmRpY2VzIGZvciB3aGVyZSBjbGF1c2VcbiAgICAgICAgY29uc3Qgd2hlcmVXaXRoT2Zmc2V0ID0gdGhpcy5fd2hlcmUubWFwKHcgPT4ge1xuICAgICAgICAgIHJldHVybiB3LnJlcGxhY2UoL1xcJChcXGQrKS9nLCAobWF0Y2gsIG51bSkgPT4gYCQke3BhcnNlSW50KG51bSkgKyB2YWx1ZXMubGVuZ3RofWApXG4gICAgICAgIH0pXG4gICAgICAgIHNxbCArPSBgIFdIRVJFICR7d2hlcmVXaXRoT2Zmc2V0LmpvaW4oJyBBTkQgJyl9YFxuICAgICAgICBwYXJhbXMucHVzaCguLi50aGlzLl93aGVyZVBhcmFtcylcbiAgICAgIH1cbiAgICAgIFxuICAgICAgc3FsICs9ICcgUkVUVVJOSU5HIConXG4gICAgICBjb25zb2xlLmxvZygnW0RCLUxPQ0FMXSBVcGRhdGU6Jywgc3FsLCAncGFyYW1zOicsIHBhcmFtcylcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHF1ZXJ5KHNxbCwgcGFyYW1zKVxuICAgICAgXG4gICAgICByZXR1cm4geyBkYXRhOiByZXN1bHQucm93cywgZXJyb3I6IG51bGwgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdbREItTE9DQUxdIFVwZGF0ZSBmYWlsZWQ6JywgZXJyb3IubWVzc2FnZSlcbiAgICAgIHJldHVybiB7IGRhdGE6IG51bGwsIGVycm9yIH1cbiAgICB9XG4gIH1cblxuICAvLyBFeGVjdXRlIERFTEVURSBxdWVyeVxuICBhc3luYyBfZXhlY3V0ZURlbGV0ZSgpIHtcbiAgICB0cnkge1xuICAgICAgbGV0IHNxbCA9IGBERUxFVEUgRlJPTSBcIiR7dGhpcy50YWJsZX1cImBcbiAgICAgIFxuICAgICAgaWYgKHRoaXMuX3doZXJlLmxlbmd0aCA+IDApIHtcbiAgICAgICAgc3FsICs9IGAgV0hFUkUgJHt0aGlzLl93aGVyZS5qb2luKCcgQU5EICcpfWBcbiAgICAgIH1cbiAgICAgIFxuICAgICAgc3FsICs9ICcgUkVUVVJOSU5HIConXG4gICAgICBjb25zb2xlLmxvZygnW0RCLUxPQ0FMXSBEZWxldGU6Jywgc3FsKVxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcXVlcnkoc3FsLCB0aGlzLl93aGVyZVBhcmFtcylcbiAgICAgIFxuICAgICAgcmV0dXJuIHsgZGF0YTogcmVzdWx0LnJvd3MsIGVycm9yOiBudWxsIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignW0RCLUxPQ0FMXSBEZWxldGUgZmFpbGVkOicsIGVycm9yLm1lc3NhZ2UpXG4gICAgICByZXR1cm4geyBkYXRhOiBudWxsLCBlcnJvciB9XG4gICAgfVxuICB9XG5cbiAgLy8gTWFyayBhcyBkZWxldGUgb3BlcmF0aW9uXG4gIGRlbGV0ZSgpIHtcbiAgICB0aGlzLl9vcGVyYXRpb24gPSAnZGVsZXRlJ1xuICAgIHJldHVybiB0aGlzXG4gIH1cblxuICAvLyBFeGVjdXRlIFNFTEVDVCBxdWVyeSAoYW5kIFVQREFURS9ERUxFVEUgaWYgZmxhZ2dlZClcbiAgYXN5bmMgdGhlbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICB0cnkge1xuICAgICAgLy8gSGFuZGxlIHVwZGF0ZSBvcGVyYXRpb25cbiAgICAgIGlmICh0aGlzLl9vcGVyYXRpb24gPT09ICd1cGRhdGUnKSB7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuX2V4ZWN1dGVVcGRhdGUoKVxuICAgICAgICByZXNvbHZlKHJlc3VsdClcbiAgICAgICAgcmV0dXJuXG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIEhhbmRsZSBkZWxldGUgb3BlcmF0aW9uXG4gICAgICBpZiAodGhpcy5fb3BlcmF0aW9uID09PSAnZGVsZXRlJykge1xuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLl9leGVjdXRlRGVsZXRlKClcbiAgICAgICAgcmVzb2x2ZShyZXN1bHQpXG4gICAgICAgIHJldHVyblxuICAgICAgfVxuICAgICAgXG4gICAgICAvLyBEZWZhdWx0OiBTRUxFQ1RcbiAgICAgIGxldCBzcWwgPSBgU0VMRUNUICR7dGhpcy5fc2VsZWN0fSBGUk9NIFwiJHt0aGlzLnRhYmxlfVwiYFxuICAgICAgXG4gICAgICBpZiAodGhpcy5fd2hlcmUubGVuZ3RoID4gMCkge1xuICAgICAgICBzcWwgKz0gYCBXSEVSRSAke3RoaXMuX3doZXJlLmpvaW4oJyBBTkQgJyl9YFxuICAgICAgfVxuICAgICAgXG4gICAgICBpZiAodGhpcy5fb3JkZXIpIHtcbiAgICAgICAgc3FsICs9IGAgT1JERVIgQlkgJHt0aGlzLl9vcmRlcn1gXG4gICAgICB9XG4gICAgICBcbiAgICAgIGlmICh0aGlzLl9saW1pdCkge1xuICAgICAgICBzcWwgKz0gYCBMSU1JVCAke3RoaXMuX2xpbWl0fWBcbiAgICAgIH1cblxuICAgICAgY29uc29sZS5sb2coJ1tEQi1MT0NBTF0gRXhlY3V0aW5nOicsIHNxbCwgJ3dpdGggcGFyYW1zOicsIHRoaXMuX3doZXJlUGFyYW1zKVxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcXVlcnkoc3FsLCB0aGlzLl93aGVyZVBhcmFtcylcbiAgICAgIFxuICAgICAgaWYgKHRoaXMuX3NpbmdsZSkge1xuICAgICAgICByZXNvbHZlKHsgZGF0YTogcmVzdWx0LnJvd3NbMF0gfHwgbnVsbCwgZXJyb3I6IG51bGwgfSlcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlc29sdmUoeyBkYXRhOiByZXN1bHQucm93cywgZXJyb3I6IG51bGwgfSlcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignW0RCLUxPQ0FMXSBRdWVyeSBmYWlsZWQ6JywgZXJyb3IubWVzc2FnZSlcbiAgICAgIGlmIChyZWplY3QpIHtcbiAgICAgICAgcmVqZWN0KGVycm9yKVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmVzb2x2ZSh7IGRhdGE6IG51bGwsIGVycm9yIH0pXG4gICAgICB9XG4gICAgfVxuICB9XG5cbn1cblxuZXhwb3J0IGRlZmF1bHQgeyBxdWVyeSwgZ2V0UG9vbCwgY3JlYXRlTG9jYWxDbGllbnQgfSJdLCJuYW1lcyI6WyJQb29sIiwicG9vbCIsImdldFBvb2wiLCJjb25uZWN0aW9uU3RyaW5nIiwicHJvY2VzcyIsImVudiIsIkRBVEFCQVNFX1VSTCIsImNvbnNvbGUiLCJsb2ciLCJyZXBsYWNlIiwib24iLCJlcnIiLCJlcnJvciIsIm1lc3NhZ2UiLCJxdWVyeSIsInRleHQiLCJwYXJhbXMiLCJyZXN1bHQiLCJjcmVhdGVMb2NhbENsaWVudCIsImZyb20iLCJ0YWJsZSIsIlF1ZXJ5QnVpbGRlciIsImF1dGgiLCJnZXRVc2VyIiwiZGF0YSIsInVzZXIiLCJpZCIsImVtYWlsIiwiZ2V0U2Vzc2lvbiIsInNlc3Npb24iLCJzaWduT3V0Iiwib25BdXRoU3RhdGVDaGFuZ2UiLCJzdWJzY3JpcHRpb24iLCJ1bnN1YnNjcmliZSIsImNvbnN0cnVjdG9yIiwiX3NlbGVjdCIsIl93aGVyZSIsIl93aGVyZVBhcmFtcyIsIl9vcmRlciIsIl9zaW5nbGUiLCJfbGltaXQiLCJfcmV0dXJuRGF0YSIsIl9vcGVyYXRpb24iLCJfdXBkYXRlRGF0YSIsInNlbGVjdCIsImNvbHVtbnMiLCJpbmNsdWRlcyIsInNwbGl0IiwiZmlsdGVyIiwiYyIsIm1hcCIsInRyaW0iLCJqb2luIiwiZXEiLCJjb2x1bW4iLCJ2YWx1ZSIsInB1c2giLCJsZW5ndGgiLCJuZXEiLCJpbiIsInZhbHVlcyIsInBsYWNlaG9sZGVycyIsIl8iLCJpIiwib3JkZXIiLCJhc2NlbmRpbmciLCJsaW1pdCIsImNvdW50Iiwic2luZ2xlIiwidGhlbiIsInJlc29sdmUiLCJyZWplY3QiLCJzcWwiLCJyb3dzIiwiaW5zZXJ0IiwicmVjb3JkcyIsIkFycmF5IiwiaXNBcnJheSIsInJlc3VsdHMiLCJyZWNvcmQiLCJrZXlzIiwiT2JqZWN0IiwicXVvdGVkS2V5cyIsImsiLCJpbnNlcnRSZXN1bHQiLCJQcm9taXNlIiwiZXJyb3JSZXN1bHQiLCJ1cGRhdGUiLCJfZXhlY3V0ZVVwZGF0ZSIsInNldENsYXVzZSIsIndoZXJlV2l0aE9mZnNldCIsInciLCJtYXRjaCIsIm51bSIsInBhcnNlSW50IiwiX2V4ZWN1dGVEZWxldGUiLCJkZWxldGUiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/db-local.js\n");

/***/ }),

/***/ "(rsc)/./lib/entitlements.js":
/*!*****************************!*\
  !*** ./lib/entitlements.js ***!
  \*****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   getBoxesWithVisibility: () => (/* binding */ getBoxesWithVisibility),\n/* harmony export */   getUserEntitledBoxIds: () => (/* binding */ getUserEntitledBoxIds),\n/* harmony export */   userHasBoxAccess: () => (/* binding */ userHasBoxAccess)\n/* harmony export */ });\n/* harmony import */ var _supabase_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./supabase-server */ \"(rsc)/./lib/supabase-server.js\");\n// Entitlements Helper - Single source of truth for user access\n// Determines which boxes a user can access based on their purchases and memberships\n\n/**\n * Get all box IDs that a user is entitled to access\n * @param {string|null} userId - The user's ID (null for unauthenticated users)\n * @returns {Promise<{boxIds: string[], hasMembership: boolean, membershipExpiry: Date|null}>}\n */ async function getUserEntitledBoxIds(userId) {\n    const supabase = (0,_supabase_server__WEBPACK_IMPORTED_MODULE_0__.createSupabaseServer)();\n    const entitledBoxIds = new Set();\n    let hasMembership = false;\n    let membershipExpiry = null;\n    // Sample boxes are always accessible to everyone\n    const { data: sampleBoxes } = await supabase.from(\"boxes\").select(\"id\").eq(\"is_sample\", true).eq(\"is_active\", true);\n    if (sampleBoxes) {\n        sampleBoxes.forEach((box)=>entitledBoxIds.add(box.id));\n    }\n    // If no user, only sample boxes are accessible\n    if (!userId) {\n        return {\n            boxIds: Array.from(entitledBoxIds),\n            hasMembership: false,\n            membershipExpiry: null\n        };\n    }\n    // Check user_products for direct box purchases\n    const { data: userProducts } = await supabase.from(\"user_products\").select(\"box_id, expires_at\").eq(\"user_id\", userId).eq(\"is_active\", true);\n    if (userProducts) {\n        const now = new Date();\n        userProducts.forEach((product)=>{\n            // Check if not expired (null expires_at means permanent access)\n            if (!product.expires_at || new Date(product.expires_at) > now) {\n                if (product.box_id) {\n                    entitledBoxIds.add(product.box_id);\n                }\n            }\n        });\n    }\n    // Check user_memberships for bundle/membership access\n    const { data: userMemberships } = await supabase.from(\"user_memberships\").select(\"bundle_id, price_id, expires_at\").eq(\"user_id\", userId).eq(\"is_active\", true);\n    if (userMemberships) {\n        const now = new Date();\n        for (const membership of userMemberships){\n            // Check if not expired\n            if (membership.expires_at && new Date(membership.expires_at) > now) {\n                hasMembership = true;\n                // Track the latest expiry\n                const expiryDate = new Date(membership.expires_at);\n                if (!membershipExpiry || expiryDate > membershipExpiry) {\n                    membershipExpiry = expiryDate;\n                }\n                // Get boxes from bundle\n                if (membership.bundle_id) {\n                    const { data: bundle } = await supabase.from(\"bundles\").select(\"box_ids\").eq(\"id\", membership.bundle_id).single();\n                    if (bundle?.box_ids) {\n                        bundle.box_ids.forEach((boxId)=>entitledBoxIds.add(boxId));\n                    }\n                }\n                // If membership has a price with all-access, add all active boxes\n                if (membership.price_id) {\n                    const { data: price } = await supabase.from(\"prices\").select(\"membership_days\").eq(\"id\", membership.price_id).single();\n                    // If it's a membership price, it grants all-access\n                    if (price?.membership_days) {\n                        const { data: allBoxes } = await supabase.from(\"boxes\").select(\"id\").eq(\"is_active\", true);\n                        if (allBoxes) {\n                            allBoxes.forEach((box)=>entitledBoxIds.add(box.id));\n                        }\n                    }\n                }\n            }\n        }\n    }\n    return {\n        boxIds: Array.from(entitledBoxIds),\n        hasMembership,\n        membershipExpiry\n    };\n}\n/**\n * Check if a user has access to a specific box\n * @param {string|null} userId - The user's ID\n * @param {string} boxId - The box ID to check\n * @returns {Promise<boolean>}\n */ async function userHasBoxAccess(userId, boxId) {\n    const { boxIds } = await getUserEntitledBoxIds(userId);\n    return boxIds.includes(boxId);\n}\n/**\n * Get boxes with visibility rules applied\n * Hide sample boxes if user owns the related full box (via full_box_id)\n * @param {string|null} userId - The user's ID\n * @returns {Promise<{boxes: any[], entitledBoxIds: string[], hasMembership: boolean}>}\n */ async function getBoxesWithVisibility(userId) {\n    const supabase = (0,_supabase_server__WEBPACK_IMPORTED_MODULE_0__.createSupabaseServer)();\n    // Get user entitlements\n    const { boxIds: entitledBoxIds, hasMembership, membershipExpiry } = await getUserEntitledBoxIds(userId);\n    // Get all active boxes\n    const { data: boxes } = await supabase.from(\"boxes\").select(\"*\").eq(\"is_active\", true).order(\"display_order\", {\n        ascending: true\n    });\n    if (!boxes) {\n        return {\n            boxes: [],\n            entitledBoxIds,\n            hasMembership,\n            membershipExpiry\n        };\n    }\n    // Build a set of full box IDs that user owns\n    const ownedFullBoxIds = new Set();\n    boxes.forEach((box)=>{\n        if (!box.is_sample && entitledBoxIds.includes(box.id)) {\n            ownedFullBoxIds.add(box.id);\n        }\n    });\n    // Filter boxes based on visibility rules:\n    // Hide sample box if user owns its related full box (full_box_id)\n    const visibleBoxes = boxes.filter((box)=>{\n        // Non-sample boxes are always visible\n        if (!box.is_sample) return true;\n        // Sample boxes: hide if user owns the related full box\n        if (box.full_box_id && ownedFullBoxIds.has(box.full_box_id)) {\n            return false;\n        }\n        return true;\n    });\n    // Mark boxes with access info\n    const boxesWithAccess = visibleBoxes.map((box)=>({\n            ...box,\n            hasAccess: entitledBoxIds.includes(box.id)\n        }));\n    return {\n        boxes: boxesWithAccess,\n        entitledBoxIds,\n        hasMembership,\n        membershipExpiry\n    };\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({\n    getUserEntitledBoxIds,\n    userHasBoxAccess,\n    getBoxesWithVisibility\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QyxDQUFBQTtRQUNaLElBQUksQ0FBQ0EsSUFBSThCLFNBQVMsSUFBSXhDLGVBQWVrQyxRQUFRLENBQUN4QixJQUFJRSxFQUFFLEdBQUc7WUFDckQyQixnQkFBZ0I1QixHQUFHLENBQUNELElBQUlFLEVBQUU7UUFDNUI7SUFDRjtJQUVBLDBDQUEwQztJQUMxQyxrRUFBa0U7SUFDbEUsTUFBTTZCLGVBQWVMLE1BQU1NLE1BQU0sQ0FBQ2hDLENBQUFBO1FBQ2hDLHNDQUFzQztRQUN0QyxJQUFJLENBQUNBLElBQUk4QixTQUFTLEVBQUUsT0FBTztRQUUzQix1REFBdUQ7UUFDdkQsSUFBSTlCLElBQUlpQyxXQUFXLElBQUlKLGdCQUFnQkssR0FBRyxDQUFDbEMsSUFBSWlDLFdBQVcsR0FBRztZQUMzRCxPQUFPO1FBQ1Q7UUFFQSxPQUFPO0lBQ1Q7SUFFQSw4QkFBOEI7SUFDOUIsTUFBTUUsa0JBQWtCSixhQUFhSyxHQUFHLENBQUNwQyxDQUFBQSxNQUFRO1lBQy9DLEdBQUdBLEdBQUc7WUFDTnFDLFdBQVcvQyxlQUFla0MsUUFBUSxDQUFDeEIsSUFBSUUsRUFBRTtRQUMzQztJQUVBLE9BQU87UUFDTHdCLE9BQU9TO1FBQ1A3QztRQUNBRTtRQUNBQztJQUNGO0FBQ0Y7QUFFQSxpRUFBZTtJQUNiTjtJQUNBb0M7SUFDQUU7QUFDRixDQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYXN3ZWFsbGFyZS1hZG1pbi8uL2xpYi9lbnRpdGxlbWVudHMuanM/YzJmMiJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBFbnRpdGxlbWVudHMgSGVscGVyIC0gU2luZ2xlIHNvdXJjZSBvZiB0cnV0aCBmb3IgdXNlciBhY2Nlc3Ncbi8vIERldGVybWluZXMgd2hpY2ggYm94ZXMgYSB1c2VyIGNhbiBhY2Nlc3MgYmFzZWQgb24gdGhlaXIgcHVyY2hhc2VzIGFuZCBtZW1iZXJzaGlwc1xuXG5pbXBvcnQgeyBjcmVhdGVTdXBhYmFzZVNlcnZlciB9IGZyb20gJy4vc3VwYWJhc2Utc2VydmVyJ1xuXG4vKipcbiAqIEdldCBhbGwgYm94IElEcyB0aGF0IGEgdXNlciBpcyBlbnRpdGxlZCB0byBhY2Nlc3NcbiAqIEBwYXJhbSB7c3RyaW5nfG51bGx9IHVzZXJJZCAtIFRoZSB1c2VyJ3MgSUQgKG51bGwgZm9yIHVuYXV0aGVudGljYXRlZCB1c2VycylcbiAqIEByZXR1cm5zIHtQcm9taXNlPHtib3hJZHM6IHN0cmluZ1tdLCBoYXNNZW1iZXJzaGlwOiBib29sZWFuLCBtZW1iZXJzaGlwRXhwaXJ5OiBEYXRlfG51bGx9Pn1cbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFVzZXJFbnRpdGxlZEJveElkcyh1c2VySWQpIHtcbiAgY29uc3Qgc3VwYWJhc2UgPSBjcmVhdGVTdXBhYmFzZVNlcnZlcigpXG4gIGNvbnN0IGVudGl0bGVkQm94SWRzID0gbmV3IFNldCgpXG4gIGxldCBoYXNNZW1iZXJzaGlwID0gZmFsc2VcbiAgbGV0IG1lbWJlcnNoaXBFeHBpcnkgPSBudWxsXG4gIFxuICAvLyBTYW1wbGUgYm94ZXMgYXJlIGFsd2F5cyBhY2Nlc3NpYmxlIHRvIGV2ZXJ5b25lXG4gIGNvbnN0IHsgZGF0YTogc2FtcGxlQm94ZXMgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgLmZyb20oJ2JveGVzJylcbiAgICAuc2VsZWN0KCdpZCcpXG4gICAgLmVxKCdpc19zYW1wbGUnLCB0cnVlKVxuICAgIC5lcSgnaXNfYWN0aXZlJywgdHJ1ZSlcbiAgXG4gIGlmIChzYW1wbGVCb3hlcykge1xuICAgIHNhbXBsZUJveGVzLmZvckVhY2goYm94ID0+IGVudGl0bGVkQm94SWRzLmFkZChib3guaWQpKVxuICB9XG4gIFxuICAvLyBJZiBubyB1c2VyLCBvbmx5IHNhbXBsZSBib3hlcyBhcmUgYWNjZXNzaWJsZVxuICBpZiAoIXVzZXJJZCkge1xuICAgIHJldHVybiB7XG4gICAgICBib3hJZHM6IEFycmF5LmZyb20oZW50aXRsZWRCb3hJZHMpLFxuICAgICAgaGFzTWVtYmVyc2hpcDogZmFsc2UsXG4gICAgICBtZW1iZXJzaGlwRXhwaXJ5OiBudWxsXG4gICAgfVxuICB9XG4gIFxuICAvLyBDaGVjayB1c2VyX3Byb2R1Y3RzIGZvciBkaXJlY3QgYm94IHB1cmNoYXNlc1xuICBjb25zdCB7IGRhdGE6IHVzZXJQcm9kdWN0cyB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAuZnJvbSgndXNlcl9wcm9kdWN0cycpXG4gICAgLnNlbGVjdCgnYm94X2lkLCBleHBpcmVzX2F0JylcbiAgICAuZXEoJ3VzZXJfaWQnLCB1c2VySWQpXG4gICAgLmVxKCdpc19hY3RpdmUnLCB0cnVlKVxuICBcbiAgaWYgKHVzZXJQcm9kdWN0cykge1xuICAgIGNvbnN0IG5vdyA9IG5ldyBEYXRlKClcbiAgICB1c2VyUHJvZHVjdHMuZm9yRWFjaChwcm9kdWN0ID0+IHtcbiAgICAgIC8vIENoZWNrIGlmIG5vdCBleHBpcmVkIChudWxsIGV4cGlyZXNfYXQgbWVhbnMgcGVybWFuZW50IGFjY2VzcylcbiAgICAgIGlmICghcHJvZHVjdC5leHBpcmVzX2F0IHx8IG5ldyBEYXRlKHByb2R1Y3QuZXhwaXJlc19hdCkgPiBub3cpIHtcbiAgICAgICAgaWYgKHByb2R1Y3QuYm94X2lkKSB7XG4gICAgICAgICAgZW50aXRsZWRCb3hJZHMuYWRkKHByb2R1Y3QuYm94X2lkKVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSlcbiAgfVxuICBcbiAgLy8gQ2hlY2sgdXNlcl9tZW1iZXJzaGlwcyBmb3IgYnVuZGxlL21lbWJlcnNoaXAgYWNjZXNzXG4gIGNvbnN0IHsgZGF0YTogdXNlck1lbWJlcnNoaXBzIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgIC5mcm9tKCd1c2VyX21lbWJlcnNoaXBzJylcbiAgICAuc2VsZWN0KCdidW5kbGVfaWQsIHByaWNlX2lkLCBleHBpcmVzX2F0JylcbiAgICAuZXEoJ3VzZXJfaWQnLCB1c2VySWQpXG4gICAgLmVxKCdpc19hY3RpdmUnLCB0cnVlKVxuICBcbiAgaWYgKHVzZXJNZW1iZXJzaGlwcykge1xuICAgIGNvbnN0IG5vdyA9IG5ldyBEYXRlKClcbiAgICBcbiAgICBmb3IgKGNvbnN0IG1lbWJlcnNoaXAgb2YgdXNlck1lbWJlcnNoaXBzKSB7XG4gICAgICAvLyBDaGVjayBpZiBub3QgZXhwaXJlZFxuICAgICAgaWYgKG1lbWJlcnNoaXAuZXhwaXJlc19hdCAmJiBuZXcgRGF0ZShtZW1iZXJzaGlwLmV4cGlyZXNfYXQpID4gbm93KSB7XG4gICAgICAgIGhhc01lbWJlcnNoaXAgPSB0cnVlXG4gICAgICAgIFxuICAgICAgICAvLyBUcmFjayB0aGUgbGF0ZXN0IGV4cGlyeVxuICAgICAgICBjb25zdCBleHBpcnlEYXRlID0gbmV3IERhdGUobWVtYmVyc2hpcC5leHBpcmVzX2F0KVxuICAgICAgICBpZiAoIW1lbWJlcnNoaXBFeHBpcnkgfHwgZXhwaXJ5RGF0ZSA+IG1lbWJlcnNoaXBFeHBpcnkpIHtcbiAgICAgICAgICBtZW1iZXJzaGlwRXhwaXJ5ID0gZXhwaXJ5RGF0ZVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBHZXQgYm94ZXMgZnJvbSBidW5kbGVcbiAgICAgICAgaWYgKG1lbWJlcnNoaXAuYnVuZGxlX2lkKSB7XG4gICAgICAgICAgY29uc3QgeyBkYXRhOiBidW5kbGUgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgICAgICAuZnJvbSgnYnVuZGxlcycpXG4gICAgICAgICAgICAuc2VsZWN0KCdib3hfaWRzJylcbiAgICAgICAgICAgIC5lcSgnaWQnLCBtZW1iZXJzaGlwLmJ1bmRsZV9pZClcbiAgICAgICAgICAgIC5zaW5nbGUoKVxuICAgICAgICAgIFxuICAgICAgICAgIGlmIChidW5kbGU/LmJveF9pZHMpIHtcbiAgICAgICAgICAgIGJ1bmRsZS5ib3hfaWRzLmZvckVhY2goYm94SWQgPT4gZW50aXRsZWRCb3hJZHMuYWRkKGJveElkKSlcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIElmIG1lbWJlcnNoaXAgaGFzIGEgcHJpY2Ugd2l0aCBhbGwtYWNjZXNzLCBhZGQgYWxsIGFjdGl2ZSBib3hlc1xuICAgICAgICBpZiAobWVtYmVyc2hpcC5wcmljZV9pZCkge1xuICAgICAgICAgIGNvbnN0IHsgZGF0YTogcHJpY2UgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgICAgICAuZnJvbSgncHJpY2VzJylcbiAgICAgICAgICAgIC5zZWxlY3QoJ21lbWJlcnNoaXBfZGF5cycpXG4gICAgICAgICAgICAuZXEoJ2lkJywgbWVtYmVyc2hpcC5wcmljZV9pZClcbiAgICAgICAgICAgIC5zaW5nbGUoKVxuICAgICAgICAgIFxuICAgICAgICAgIC8vIElmIGl0J3MgYSBtZW1iZXJzaGlwIHByaWNlLCBpdCBncmFudHMgYWxsLWFjY2Vzc1xuICAgICAgICAgIGlmIChwcmljZT8ubWVtYmVyc2hpcF9kYXlzKSB7XG4gICAgICAgICAgICBjb25zdCB7IGRhdGE6IGFsbEJveGVzIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAgICAgICAuZnJvbSgnYm94ZXMnKVxuICAgICAgICAgICAgICAuc2VsZWN0KCdpZCcpXG4gICAgICAgICAgICAgIC5lcSgnaXNfYWN0aXZlJywgdHJ1ZSlcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKGFsbEJveGVzKSB7XG4gICAgICAgICAgICAgIGFsbEJveGVzLmZvckVhY2goYm94ID0+IGVudGl0bGVkQm94SWRzLmFkZChib3guaWQpKVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxuICBcbiAgcmV0dXJuIHtcbiAgICBib3hJZHM6IEFycmF5LmZyb20oZW50aXRsZWRCb3hJZHMpLFxuICAgIGhhc01lbWJlcnNoaXAsXG4gICAgbWVtYmVyc2hpcEV4cGlyeVxuICB9XG59XG5cbi8qKlxuICogQ2hlY2sgaWYgYSB1c2VyIGhhcyBhY2Nlc3MgdG8gYSBzcGVjaWZpYyBib3hcbiAqIEBwYXJhbSB7c3RyaW5nfG51bGx9IHVzZXJJZCAtIFRoZSB1c2VyJ3MgSURcbiAqIEBwYXJhbSB7c3RyaW5nfSBib3hJZCAtIFRoZSBib3ggSUQgdG8gY2hlY2tcbiAqIEByZXR1cm5zIHtQcm9taXNlPGJvb2xlYW4+fVxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXNlckhhc0JveEFjY2Vzcyh1c2VySWQsIGJveElkKSB7XG4gIGNvbnN0IHsgYm94SWRzIH0gPSBhd2FpdCBnZXRVc2VyRW50aXRsZWRCb3hJZHModXNlcklkKVxuICByZXR1cm4gYm94SWRzLmluY2x1ZGVzKGJveElkKVxufVxuXG4vKipcbiAqIEdldCBib3hlcyB3aXRoIHZpc2liaWxpdHkgcnVsZXMgYXBwbGllZFxuICogSGlkZSBzYW1wbGUgYm94ZXMgaWYgdXNlciBvd25zIHRoZSByZWxhdGVkIGZ1bGwgYm94ICh2aWEgZnVsbF9ib3hfaWQpXG4gKiBAcGFyYW0ge3N0cmluZ3xudWxsfSB1c2VySWQgLSBUaGUgdXNlcidzIElEXG4gKiBAcmV0dXJucyB7UHJvbWlzZTx7Ym94ZXM6IGFueVtdLCBlbnRpdGxlZEJveElkczogc3RyaW5nW10sIGhhc01lbWJlcnNoaXA6IGJvb2xlYW59Pn1cbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEJveGVzV2l0aFZpc2liaWxpdHkodXNlcklkKSB7XG4gIGNvbnN0IHN1cGFiYXNlID0gY3JlYXRlU3VwYWJhc2VTZXJ2ZXIoKVxuICBcbiAgLy8gR2V0IHVzZXIgZW50aXRsZW1lbnRzXG4gIGNvbnN0IHsgYm94SWRzOiBlbnRpdGxlZEJveElkcywgaGFzTWVtYmVyc2hpcCwgbWVtYmVyc2hpcEV4cGlyeSB9ID0gYXdhaXQgZ2V0VXNlckVudGl0bGVkQm94SWRzKHVzZXJJZClcbiAgXG4gIC8vIEdldCBhbGwgYWN0aXZlIGJveGVzXG4gIGNvbnN0IHsgZGF0YTogYm94ZXMgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgLmZyb20oJ2JveGVzJylcbiAgICAuc2VsZWN0KCcqJylcbiAgICAuZXEoJ2lzX2FjdGl2ZScsIHRydWUpXG4gICAgLm9yZGVyKCdkaXNwbGF5X29yZGVyJywgeyBhc2NlbmRpbmc6IHRydWUgfSlcbiAgXG4gIGlmICghYm94ZXMpIHtcbiAgICByZXR1cm4geyBib3hlczogW10sIGVudGl0bGVkQm94SWRzLCBoYXNNZW1iZXJzaGlwLCBtZW1iZXJzaGlwRXhwaXJ5IH1cbiAgfVxuICBcbiAgLy8gQnVpbGQgYSBzZXQgb2YgZnVsbCBib3ggSURzIHRoYXQgdXNlciBvd25zXG4gIGNvbnN0IG93bmVkRnVsbEJveElkcyA9IG5ldyBTZXQoKVxuICBib3hlcy5mb3JFYWNoKGJveCA9PiB7XG4gICAgaWYgKCFib3guaXNfc2FtcGxlICYmIGVudGl0bGVkQm94SWRzLmluY2x1ZGVzKGJveC5pZCkpIHtcbiAgICAgIG93bmVkRnVsbEJveElkcy5hZGQoYm94LmlkKVxuICAgIH1cbiAgfSlcbiAgXG4gIC8vIEZpbHRlciBib3hlcyBiYXNlZCBvbiB2aXNpYmlsaXR5IHJ1bGVzOlxuICAvLyBIaWRlIHNhbXBsZSBib3ggaWYgdXNlciBvd25zIGl0cyByZWxhdGVkIGZ1bGwgYm94IChmdWxsX2JveF9pZClcbiAgY29uc3QgdmlzaWJsZUJveGVzID0gYm94ZXMuZmlsdGVyKGJveCA9PiB7XG4gICAgLy8gTm9uLXNhbXBsZSBib3hlcyBhcmUgYWx3YXlzIHZpc2libGVcbiAgICBpZiAoIWJveC5pc19zYW1wbGUpIHJldHVybiB0cnVlXG4gICAgXG4gICAgLy8gU2FtcGxlIGJveGVzOiBoaWRlIGlmIHVzZXIgb3ducyB0aGUgcmVsYXRlZCBmdWxsIGJveFxuICAgIGlmIChib3guZnVsbF9ib3hfaWQgJiYgb3duZWRGdWxsQm94SWRzLmhhcyhib3guZnVsbF9ib3hfaWQpKSB7XG4gICAgICByZXR1cm4gZmFsc2VcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIHRydWVcbiAgfSlcbiAgXG4gIC8vIE1hcmsgYm94ZXMgd2l0aCBhY2Nlc3MgaW5mb1xuICBjb25zdCBib3hlc1dpdGhBY2Nlc3MgPSB2aXNpYmxlQm94ZXMubWFwKGJveCA9PiAoe1xuICAgIC4uLmJveCxcbiAgICBoYXNBY2Nlc3M6IGVudGl0bGVkQm94SWRzLmluY2x1ZGVzKGJveC5pZClcbiAgfSkpXG4gIFxuICByZXR1cm4ge1xuICAgIGJveGVzOiBib3hlc1dpdGhBY2Nlc3MsXG4gICAgZW50aXRsZWRCb3hJZHMsXG4gICAgaGFzTWVtYmVyc2hpcCxcbiAgICBtZW1iZXJzaGlwRXhwaXJ5XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQge1xuICBnZXRVc2VyRW50aXRsZWRCb3hJZHMsXG4gIHVzZXJIYXNCb3hBY2Nlc3MsXG4gIGdldEJveGVzV2l0aFZpc2liaWxpdHlcbn1cbiJdLCJuYW1lcyI6WyJjcmVhdGVTdXBhYmFzZVNlcnZlciIsImdldFVzZXJFbnRpdGxlZEJveElkcyIsInVzZXJJZCIsInN1cGFiYXNlIiwiZW50aXRsZWRCb3hJZHMiLCJTZXQiLCJoYXNNZW1iZXJzaGlwIiwibWVtYmVyc2hpcEV4cGlyeSIsImRhdGEiLCJzYW1wbGVCb3hlcyIsImZyb20iLCJzZWxlY3QiLCJlcSIsImZvckVhY2giLCJib3giLCJhZGQiLCJpZCIsImJveElkcyIsIkFycmF5IiwidXNlclByb2R1Y3RzIiwibm93IiwiRGF0ZSIsInByb2R1Y3QiLCJleHBpcmVzX2F0IiwiYm94X2lkIiwidXNlck1lbWJlcnNoaXBzIiwibWVtYmVyc2hpcCIsImV4cGlyeURhdGUiLCJidW5kbGVfaWQiLCJidW5kbGUiLCJzaW5nbGUiLCJib3hfaWRzIiwiYm94SWQiLCJwcmljZV9pZCIsInByaWNlIiwibWVtYmVyc2hpcF9kYXlzIiwiYWxsQm94ZXMiLCJ1c2VySGFzQm94QWNjZXNzIiwiaW5jbHVkZXMiLCJnZXRCb3hlc1dpdGhWaXNpYmlsaXR5IiwiYm94ZXMiLCJvcmRlciIsImFzY2VuZGluZyIsIm93bmVkRnVsbEJveElkcyIsImlzX3NhbXBsZSIsInZpc2libGVCb3hlcyIsImZpbHRlciIsImZ1bGxfYm94X2lkIiwiaGFzIiwiYm94ZXNXaXRoQWNjZXNzIiwibWFwIiwiaGFzQWNjZXNzIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/entitlements.js\n");

/***/ }),

/***/ "(rsc)/./lib/stripe.js":
/*!***********************!*\
  !*** ./lib/stripe.js ***!
  \***********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getStripe: () => (/* binding */ getStripe),\n/* harmony export */   stripe: () => (/* binding */ stripe)\n/* harmony export */ });\n/* harmony import */ var stripe__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! stripe */ \"(rsc)/./node_modules/stripe/esm/stripe.esm.node.js\");\n\n// Lazy initialization to avoid build-time errors\nlet stripeInstance = null;\nfunction getStripe() {\n    if (!stripeInstance) {\n        if (!process.env.STRIPE_SECRET_KEY) {\n            throw new Error(\"STRIPE_SECRET_KEY is not set\");\n        }\n        stripeInstance = new stripe__WEBPACK_IMPORTED_MODULE_0__[\"default\"](process.env.STRIPE_SECRET_KEY, {\n            apiVersion: \"2024-12-18.acacia\"\n        });\n    }\n    return stripeInstance;\n}\n// For backward compatibility - but this will fail at build time if imported directly\n// Use getStripe() instead\nconst stripe = typeof process !== \"undefined\" && process.env.STRIPE_SECRET_KEY ? new stripe__WEBPACK_IMPORTED_MODULE_0__[\"default\"](process.env.STRIPE_SECRET_KEY, {\n    apiVersion: \"2024-12-18.acacia\"\n}) : null;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvc3RyaXBlLmpzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUEyQjtBQUUzQixpREFBaUQ7QUFDakQsSUFBSUMsaUJBQWlCO0FBRWQsU0FBU0M7SUFDZCxJQUFJLENBQUNELGdCQUFnQjtRQUNuQixJQUFJLENBQUNFLFFBQVFDLEdBQUcsQ0FBQ0MsaUJBQWlCLEVBQUU7WUFDbEMsTUFBTSxJQUFJQyxNQUFNO1FBQ2xCO1FBQ0FMLGlCQUFpQixJQUFJRCw4Q0FBTUEsQ0FBQ0csUUFBUUMsR0FBRyxDQUFDQyxpQkFBaUIsRUFBRTtZQUN6REUsWUFBWTtRQUNkO0lBQ0Y7SUFDQSxPQUFPTjtBQUNUO0FBRUEscUZBQXFGO0FBQ3JGLDBCQUEwQjtBQUNuQixNQUFNTyxTQUFTLE9BQU9MLFlBQVksZUFBZUEsUUFBUUMsR0FBRyxDQUFDQyxpQkFBaUIsR0FDakYsSUFBSUwsOENBQU1BLENBQUNHLFFBQVFDLEdBQUcsQ0FBQ0MsaUJBQWlCLEVBQUU7SUFBRUUsWUFBWTtBQUFvQixLQUM1RSxLQUFJIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYXN3ZWFsbGFyZS1hZG1pbi8uL2xpYi9zdHJpcGUuanM/NTA0ZCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgU3RyaXBlIGZyb20gJ3N0cmlwZSdcblxuLy8gTGF6eSBpbml0aWFsaXphdGlvbiB0byBhdm9pZCBidWlsZC10aW1lIGVycm9yc1xubGV0IHN0cmlwZUluc3RhbmNlID0gbnVsbFxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0U3RyaXBlKCkge1xuICBpZiAoIXN0cmlwZUluc3RhbmNlKSB7XG4gICAgaWYgKCFwcm9jZXNzLmVudi5TVFJJUEVfU0VDUkVUX0tFWSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdTVFJJUEVfU0VDUkVUX0tFWSBpcyBub3Qgc2V0JylcbiAgICB9XG4gICAgc3RyaXBlSW5zdGFuY2UgPSBuZXcgU3RyaXBlKHByb2Nlc3MuZW52LlNUUklQRV9TRUNSRVRfS0VZLCB7XG4gICAgICBhcGlWZXJzaW9uOiAnMjAyNC0xMi0xOC5hY2FjaWEnLFxuICAgIH0pXG4gIH1cbiAgcmV0dXJuIHN0cmlwZUluc3RhbmNlXG59XG5cbi8vIEZvciBiYWNrd2FyZCBjb21wYXRpYmlsaXR5IC0gYnV0IHRoaXMgd2lsbCBmYWlsIGF0IGJ1aWxkIHRpbWUgaWYgaW1wb3J0ZWQgZGlyZWN0bHlcbi8vIFVzZSBnZXRTdHJpcGUoKSBpbnN0ZWFkXG5leHBvcnQgY29uc3Qgc3RyaXBlID0gdHlwZW9mIHByb2Nlc3MgIT09ICd1bmRlZmluZWQnICYmIHByb2Nlc3MuZW52LlNUUklQRV9TRUNSRVRfS0VZIFxuICA/IG5ldyBTdHJpcGUocHJvY2Vzcy5lbnYuU1RSSVBFX1NFQ1JFVF9LRVksIHsgYXBpVmVyc2lvbjogJzIwMjQtMTItMTguYWNhY2lhJyB9KVxuICA6IG51bGxcbiJdLCJuYW1lcyI6WyJTdHJpcGUiLCJzdHJpcGVJbnN0YW5jZSIsImdldFN0cmlwZSIsInByb2Nlc3MiLCJlbnYiLCJTVFJJUEVfU0VDUkVUX0tFWSIsIkVycm9yIiwiYXBpVmVyc2lvbiIsInN0cmlwZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/stripe.js\n");

/***/ }),

/***/ "(rsc)/./lib/supabase-server.js":
/*!********************************!*\
  !*** ./lib/supabase-server.js ***!
  \********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createSupabaseServer: () => (/* binding */ createSupabaseServer)\n/* harmony export */ });\n/* harmony import */ var _supabase_ssr__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @supabase/ssr */ \"(rsc)/./node_modules/@supabase/ssr/dist/module/index.js\");\n/* harmony import */ var next_headers__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/headers */ \"(rsc)/./node_modules/next/dist/api/headers.js\");\n/* harmony import */ var _db_local__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./db-local */ \"(rsc)/./lib/db-local.js\");\n\n\n\nfunction createSupabaseServer() {\n    // Check if running in local mode\n    if (process.env.LOCAL_MODE === \"true\") {\n        return (0,_db_local__WEBPACK_IMPORTED_MODULE_2__.createLocalClient)();\n    }\n    const cookieStore = (0,next_headers__WEBPACK_IMPORTED_MODULE_1__.cookies)();\n    return (0,_supabase_ssr__WEBPACK_IMPORTED_MODULE_0__.createServerClient)(process.env.NEXT_PUBLIC_SUPABASE_URL, process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY, {\n        cookies: {\n            getAll () {\n                return cookieStore.getAll();\n            },\n            setAll (cookiesToSet) {\n                try {\n                    cookiesToSet.forEach(({ name, value, options })=>cookieStore.set(name, value, options));\n                } catch  {\n                // Server component, ignore\n                }\n            }\n        }\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvc3VwYWJhc2Utc2VydmVyLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBa0Q7QUFDWjtBQUNRO0FBRXZDLFNBQVNHO0lBQ2QsaUNBQWlDO0lBQ2pDLElBQUlDLFFBQVFDLEdBQUcsQ0FBQ0MsVUFBVSxLQUFLLFFBQVE7UUFDckMsT0FBT0osNERBQWlCQTtJQUMxQjtJQUVBLE1BQU1LLGNBQWNOLHFEQUFPQTtJQUUzQixPQUFPRCxpRUFBa0JBLENBQ3ZCSSxRQUFRQyxHQUFHLENBQUNHLHdCQUF3QixFQUNwQ0osUUFBUUMsR0FBRyxDQUFDSSw2QkFBNkIsRUFDekM7UUFDRVIsU0FBUztZQUNQUztnQkFDRSxPQUFPSCxZQUFZRyxNQUFNO1lBQzNCO1lBQ0FDLFFBQU9DLFlBQVk7Z0JBQ2pCLElBQUk7b0JBQ0ZBLGFBQWFDLE9BQU8sQ0FBQyxDQUFDLEVBQUVDLElBQUksRUFBRUMsS0FBSyxFQUFFQyxPQUFPLEVBQUUsR0FDNUNULFlBQVlVLEdBQUcsQ0FBQ0gsTUFBTUMsT0FBT0M7Z0JBRWpDLEVBQUUsT0FBTTtnQkFDTiwyQkFBMkI7Z0JBQzdCO1lBQ0Y7UUFDRjtJQUNGO0FBRUoiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9hc3dlYWxsYXJlLWFkbWluLy4vbGliL3N1cGFiYXNlLXNlcnZlci5qcz9kYmFjIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNyZWF0ZVNlcnZlckNsaWVudCB9IGZyb20gJ0BzdXBhYmFzZS9zc3InXG5pbXBvcnQgeyBjb29raWVzIH0gZnJvbSAnbmV4dC9oZWFkZXJzJ1xuaW1wb3J0IHsgY3JlYXRlTG9jYWxDbGllbnQgfSBmcm9tICcuL2RiLWxvY2FsJ1xuXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlU3VwYWJhc2VTZXJ2ZXIoKSB7XG4gIC8vIENoZWNrIGlmIHJ1bm5pbmcgaW4gbG9jYWwgbW9kZVxuICBpZiAocHJvY2Vzcy5lbnYuTE9DQUxfTU9ERSA9PT0gJ3RydWUnKSB7XG4gICAgcmV0dXJuIGNyZWF0ZUxvY2FsQ2xpZW50KClcbiAgfVxuXG4gIGNvbnN0IGNvb2tpZVN0b3JlID0gY29va2llcygpXG4gIFxuICByZXR1cm4gY3JlYXRlU2VydmVyQ2xpZW50KFxuICAgIHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTCxcbiAgICBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19TVVBBQkFTRV9BTk9OX0tFWSxcbiAgICB7XG4gICAgICBjb29raWVzOiB7XG4gICAgICAgIGdldEFsbCgpIHtcbiAgICAgICAgICByZXR1cm4gY29va2llU3RvcmUuZ2V0QWxsKClcbiAgICAgICAgfSxcbiAgICAgICAgc2V0QWxsKGNvb2tpZXNUb1NldCkge1xuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb29raWVzVG9TZXQuZm9yRWFjaCgoeyBuYW1lLCB2YWx1ZSwgb3B0aW9ucyB9KSA9PlxuICAgICAgICAgICAgICBjb29raWVTdG9yZS5zZXQobmFtZSwgdmFsdWUsIG9wdGlvbnMpXG4gICAgICAgICAgICApXG4gICAgICAgICAgfSBjYXRjaCB7XG4gICAgICAgICAgICAvLyBTZXJ2ZXIgY29tcG9uZW50LCBpZ25vcmVcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgIH1cbiAgKVxufVxuIl0sIm5hbWVzIjpbImNyZWF0ZVNlcnZlckNsaWVudCIsImNvb2tpZXMiLCJjcmVhdGVMb2NhbENsaWVudCIsImNyZWF0ZVN1cGFiYXNlU2VydmVyIiwicHJvY2VzcyIsImVudiIsIkxPQ0FMX01PREUiLCJjb29raWVTdG9yZSIsIk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTCIsIk5FWFRfUFVCTElDX1NVUEFCQVNFX0FOT05fS0VZIiwiZ2V0QWxsIiwic2V0QWxsIiwiY29va2llc1RvU2V0IiwiZm9yRWFjaCIsIm5hbWUiLCJ2YWx1ZSIsIm9wdGlvbnMiLCJzZXQiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/supabase-server.js\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/stripe","vendor-chunks/@supabase","vendor-chunks/math-intrinsics","vendor-chunks/es-errors","vendor-chunks/uuid","vendor-chunks/qs","vendor-chunks/call-bind-apply-helpers","vendor-chunks/get-proto","vendor-chunks/object-inspect","vendor-chunks/has-symbols","vendor-chunks/gopd","vendor-chunks/function-bind","vendor-chunks/tslib","vendor-chunks/iceberg-js","vendor-chunks/side-channel","vendor-chunks/side-channel-weakmap","vendor-chunks/side-channel-map","vendor-chunks/side-channel-list","vendor-chunks/hasown","vendor-chunks/get-intrinsic","vendor-chunks/es-object-atoms","vendor-chunks/es-define-property","vendor-chunks/dunder-proto","vendor-chunks/cookie","vendor-chunks/call-bound"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2F%5B%5B...path%5D%5D%2Froute&page=%2Fapi%2F%5B%5B...path%5D%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2F%5B%5B...path%5D%5D%2Froute.js&appDir=%2Fapp%2Fapps%2Fadmin%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fapp%2Fapps%2Fadmin&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();