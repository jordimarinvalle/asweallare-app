"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "_rsc_lib_auth-local_js-_ee011";
exports.ids = ["_rsc_lib_auth-local_js-_ee011"];
exports.modules = {

/***/ "(rsc)/./lib/auth-local.js":
/*!***************************!*\
  !*** ./lib/auth-local.js ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createUser: () => (/* binding */ createUser),\n/* harmony export */   generateToken: () => (/* binding */ generateToken),\n/* harmony export */   getUserById: () => (/* binding */ getUserById),\n/* harmony export */   getUserFromToken: () => (/* binding */ getUserFromToken),\n/* harmony export */   hashPassword: () => (/* binding */ hashPassword),\n/* harmony export */   signIn: () => (/* binding */ signIn),\n/* harmony export */   verifyPassword: () => (/* binding */ verifyPassword),\n/* harmony export */   verifyToken: () => (/* binding */ verifyToken)\n/* harmony export */ });\n/* harmony import */ var bcryptjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! bcryptjs */ \"(rsc)/./node_modules/bcryptjs/index.js\");\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! jsonwebtoken */ \"(rsc)/./node_modules/jsonwebtoken/index.js\");\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(jsonwebtoken__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _db_local__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./db-local */ \"(rsc)/./lib/db-local.js\");\n// Local Authentication System\n// Used when LOCAL_MODE=true - no Supabase needed\n\n\n\nconst JWT_SECRET = process.env.JWT_SECRET || \"local-dev-secret-change-in-production\";\nconst TOKEN_EXPIRY = \"7d\";\nasync function hashPassword(password) {\n    return bcryptjs__WEBPACK_IMPORTED_MODULE_0__[\"default\"].hash(password, 10);\n}\nasync function verifyPassword(password, hash) {\n    return bcryptjs__WEBPACK_IMPORTED_MODULE_0__[\"default\"].compare(password, hash);\n}\nfunction generateToken(user) {\n    return jsonwebtoken__WEBPACK_IMPORTED_MODULE_1___default().sign({\n        id: user.id,\n        email: user.email,\n        is_admin: user.is_admin\n    }, JWT_SECRET, {\n        expiresIn: TOKEN_EXPIRY\n    });\n}\nfunction verifyToken(token) {\n    try {\n        return jsonwebtoken__WEBPACK_IMPORTED_MODULE_1___default().verify(token, JWT_SECRET);\n    } catch (error) {\n        return null;\n    }\n}\nasync function createUser(email, password) {\n    const passwordHash = await hashPassword(password);\n    const id = crypto.randomUUID();\n    try {\n        const result = await (0,_db_local__WEBPACK_IMPORTED_MODULE_2__.query)(`INSERT INTO local_users (id, email, password_hash, is_admin) \n       VALUES ($1, $2, $3, $4) \n       RETURNING id, email, is_admin, created_at`, [\n            id,\n            email.toLowerCase(),\n            passwordHash,\n            false\n        ]);\n        return {\n            user: result.rows[0],\n            error: null\n        };\n    } catch (error) {\n        if (error.code === \"23505\") {\n            return {\n                user: null,\n                error: \"User already exists\"\n            };\n        }\n        return {\n            user: null,\n            error: error.message\n        };\n    }\n}\nasync function signIn(email, password) {\n    try {\n        const result = await (0,_db_local__WEBPACK_IMPORTED_MODULE_2__.query)(\"SELECT * FROM local_users WHERE email = $1\", [\n            email.toLowerCase()\n        ]);\n        if (result.rows.length === 0) {\n            return {\n                user: null,\n                token: null,\n                error: \"Invalid email or password\"\n            };\n        }\n        const user = result.rows[0];\n        const validPassword = await verifyPassword(password, user.password_hash);\n        if (!validPassword) {\n            return {\n                user: null,\n                token: null,\n                error: \"Invalid email or password\"\n            };\n        }\n        const token = generateToken(user);\n        return {\n            user: {\n                id: user.id,\n                email: user.email,\n                is_admin: user.is_admin\n            },\n            token,\n            error: null\n        };\n    } catch (error) {\n        return {\n            user: null,\n            token: null,\n            error: error.message\n        };\n    }\n}\nasync function getUserFromToken(token) {\n    const decoded = verifyToken(token);\n    if (!decoded) return null;\n    try {\n        const result = await (0,_db_local__WEBPACK_IMPORTED_MODULE_2__.query)(\"SELECT id, email, is_admin, created_at FROM local_users WHERE id = $1\", [\n            decoded.id\n        ]);\n        return result.rows[0] || null;\n    } catch (error) {\n        return null;\n    }\n}\nasync function getUserById(id) {\n    try {\n        const result = await (0,_db_local__WEBPACK_IMPORTED_MODULE_2__.query)(\"SELECT id, email, is_admin, created_at FROM local_users WHERE id = $1\", [\n            id\n        ]);\n        return result.rows[0] || null;\n    } catch (error) {\n        return null;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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SUFBSTtJQUMzQixFQUFFLE9BQU9QLE9BQU87UUFDZCxPQUFPO0lBQ1Q7QUFDRjtBQUVPLGVBQWVnQixZQUFZdkIsRUFBRTtJQUNsQyxJQUFJO1FBQ0YsTUFBTVksU0FBUyxNQUFNekIsZ0RBQUtBLENBQ3hCLHlFQUNBO1lBQUNhO1NBQUc7UUFFTixPQUFPWSxPQUFPRSxJQUFJLENBQUMsRUFBRSxJQUFJO0lBQzNCLEVBQUUsT0FBT1AsT0FBTztRQUNkLE9BQU87SUFDVDtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYXN3ZWFsbGFyZS1hZG1pbi8uL2xpYi9hdXRoLWxvY2FsLmpzPzUxODciXSwic291cmNlc0NvbnRlbnQiOlsiLy8gTG9jYWwgQXV0aGVudGljYXRpb24gU3lzdGVtXG4vLyBVc2VkIHdoZW4gTE9DQUxfTU9ERT10cnVlIC0gbm8gU3VwYWJhc2UgbmVlZGVkXG5cbmltcG9ydCBiY3J5cHQgZnJvbSAnYmNyeXB0anMnXG5pbXBvcnQgand0IGZyb20gJ2pzb253ZWJ0b2tlbidcbmltcG9ydCB7IHF1ZXJ5IH0gZnJvbSAnLi9kYi1sb2NhbCdcblxuY29uc3QgSldUX1NFQ1JFVCA9IHByb2Nlc3MuZW52LkpXVF9TRUNSRVQgfHwgJ2xvY2FsLWRldi1zZWNyZXQtY2hhbmdlLWluLXByb2R1Y3Rpb24nXG5jb25zdCBUT0tFTl9FWFBJUlkgPSAnN2QnXG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBoYXNoUGFzc3dvcmQocGFzc3dvcmQpIHtcbiAgcmV0dXJuIGJjcnlwdC5oYXNoKHBhc3N3b3JkLCAxMClcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHZlcmlmeVBhc3N3b3JkKHBhc3N3b3JkLCBoYXNoKSB7XG4gIHJldHVybiBiY3J5cHQuY29tcGFyZShwYXNzd29yZCwgaGFzaClcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdlbmVyYXRlVG9rZW4odXNlcikge1xuICByZXR1cm4gand0LnNpZ24oXG4gICAgeyBpZDogdXNlci5pZCwgZW1haWw6IHVzZXIuZW1haWwsIGlzX2FkbWluOiB1c2VyLmlzX2FkbWluIH0sXG4gICAgSldUX1NFQ1JFVCxcbiAgICB7IGV4cGlyZXNJbjogVE9LRU5fRVhQSVJZIH1cbiAgKVxufVxuXG5leHBvcnQgZnVuY3Rpb24gdmVyaWZ5VG9rZW4odG9rZW4pIHtcbiAgdHJ5IHtcbiAgICByZXR1cm4gand0LnZlcmlmeSh0b2tlbiwgSldUX1NFQ1JFVClcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICByZXR1cm4gbnVsbFxuICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVVc2VyKGVtYWlsLCBwYXNzd29yZCkge1xuICBjb25zdCBwYXNzd29yZEhhc2ggPSBhd2FpdCBoYXNoUGFzc3dvcmQocGFzc3dvcmQpXG4gIGNvbnN0IGlkID0gY3J5cHRvLnJhbmRvbVVVSUQoKVxuICBcbiAgdHJ5IHtcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBxdWVyeShcbiAgICAgIGBJTlNFUlQgSU5UTyBsb2NhbF91c2VycyAoaWQsIGVtYWlsLCBwYXNzd29yZF9oYXNoLCBpc19hZG1pbikgXG4gICAgICAgVkFMVUVTICgkMSwgJDIsICQzLCAkNCkgXG4gICAgICAgUkVUVVJOSU5HIGlkLCBlbWFpbCwgaXNfYWRtaW4sIGNyZWF0ZWRfYXRgLFxuICAgICAgW2lkLCBlbWFpbC50b0xvd2VyQ2FzZSgpLCBwYXNzd29yZEhhc2gsIGZhbHNlXVxuICAgIClcbiAgICByZXR1cm4geyB1c2VyOiByZXN1bHQucm93c1swXSwgZXJyb3I6IG51bGwgfVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGlmIChlcnJvci5jb2RlID09PSAnMjM1MDUnKSB7IC8vIFVuaXF1ZSB2aW9sYXRpb25cbiAgICAgIHJldHVybiB7IHVzZXI6IG51bGwsIGVycm9yOiAnVXNlciBhbHJlYWR5IGV4aXN0cycgfVxuICAgIH1cbiAgICByZXR1cm4geyB1c2VyOiBudWxsLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9XG4gIH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNpZ25JbihlbWFpbCwgcGFzc3dvcmQpIHtcbiAgdHJ5IHtcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBxdWVyeShcbiAgICAgICdTRUxFQ1QgKiBGUk9NIGxvY2FsX3VzZXJzIFdIRVJFIGVtYWlsID0gJDEnLFxuICAgICAgW2VtYWlsLnRvTG93ZXJDYXNlKCldXG4gICAgKVxuICAgIFxuICAgIGlmIChyZXN1bHQucm93cy5sZW5ndGggPT09IDApIHtcbiAgICAgIHJldHVybiB7IHVzZXI6IG51bGwsIHRva2VuOiBudWxsLCBlcnJvcjogJ0ludmFsaWQgZW1haWwgb3IgcGFzc3dvcmQnIH1cbiAgICB9XG4gICAgXG4gICAgY29uc3QgdXNlciA9IHJlc3VsdC5yb3dzWzBdXG4gICAgY29uc3QgdmFsaWRQYXNzd29yZCA9IGF3YWl0IHZlcmlmeVBhc3N3b3JkKHBhc3N3b3JkLCB1c2VyLnBhc3N3b3JkX2hhc2gpXG4gICAgXG4gICAgaWYgKCF2YWxpZFBhc3N3b3JkKSB7XG4gICAgICByZXR1cm4geyB1c2VyOiBudWxsLCB0b2tlbjogbnVsbCwgZXJyb3I6ICdJbnZhbGlkIGVtYWlsIG9yIHBhc3N3b3JkJyB9XG4gICAgfVxuICAgIFxuICAgIGNvbnN0IHRva2VuID0gZ2VuZXJhdGVUb2tlbih1c2VyKVxuICAgIHJldHVybiB7XG4gICAgICB1c2VyOiB7IGlkOiB1c2VyLmlkLCBlbWFpbDogdXNlci5lbWFpbCwgaXNfYWRtaW46IHVzZXIuaXNfYWRtaW4gfSxcbiAgICAgIHRva2VuLFxuICAgICAgZXJyb3I6IG51bGxcbiAgICB9XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgcmV0dXJuIHsgdXNlcjogbnVsbCwgdG9rZW46IG51bGwsIGVycm9yOiBlcnJvci5tZXNzYWdlIH1cbiAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0VXNlckZyb21Ub2tlbih0b2tlbikge1xuICBjb25zdCBkZWNvZGVkID0gdmVyaWZ5VG9rZW4odG9rZW4pXG4gIGlmICghZGVjb2RlZCkgcmV0dXJuIG51bGxcbiAgXG4gIHRyeSB7XG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcXVlcnkoXG4gICAgICAnU0VMRUNUIGlkLCBlbWFpbCwgaXNfYWRtaW4sIGNyZWF0ZWRfYXQgRlJPTSBsb2NhbF91c2VycyBXSEVSRSBpZCA9ICQxJyxcbiAgICAgIFtkZWNvZGVkLmlkXVxuICAgIClcbiAgICByZXR1cm4gcmVzdWx0LnJvd3NbMF0gfHwgbnVsbFxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIHJldHVybiBudWxsXG4gIH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFVzZXJCeUlkKGlkKSB7XG4gIHRyeSB7XG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcXVlcnkoXG4gICAgICAnU0VMRUNUIGlkLCBlbWFpbCwgaXNfYWRtaW4sIGNyZWF0ZWRfYXQgRlJPTSBsb2NhbF91c2VycyBXSEVSRSBpZCA9ICQxJyxcbiAgICAgIFtpZF1cbiAgICApXG4gICAgcmV0dXJuIHJlc3VsdC5yb3dzWzBdIHx8IG51bGxcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICByZXR1cm4gbnVsbFxuICB9XG59XG4iXSwibmFtZXMiOlsiYmNyeXB0Iiwiand0IiwicXVlcnkiLCJKV1RfU0VDUkVUIiwicHJvY2VzcyIsImVudiIsIlRPS0VOX0VYUElSWSIsImhhc2hQYXNzd29yZCIsInBhc3N3b3JkIiwiaGFzaCIsInZlcmlmeVBhc3N3b3JkIiwiY29tcGFyZSIsImdlbmVyYXRlVG9rZW4iLCJ1c2VyIiwic2lnbiIsImlkIiwiZW1haWwiLCJpc19hZG1pbiIsImV4cGlyZXNJbiIsInZlcmlmeVRva2VuIiwidG9rZW4iLCJ2ZXJpZnkiLCJlcnJvciIsImNyZWF0ZVVzZXIiLCJwYXNzd29yZEhhc2giLCJjcnlwdG8iLCJyYW5kb21VVUlEIiwicmVzdWx0IiwidG9Mb3dlckNhc2UiLCJyb3dzIiwiY29kZSIsIm1lc3NhZ2UiLCJzaWduSW4iLCJsZW5ndGgiLCJ2YWxpZFBhc3N3b3JkIiwicGFzc3dvcmRfaGFzaCIsImdldFVzZXJGcm9tVG9rZW4iLCJkZWNvZGVkIiwiZ2V0VXNlckJ5SWQiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/auth-local.js\n");

/***/ }),

/***/ "(rsc)/./lib/db-local.js":
/*!*************************!*\
  !*** ./lib/db-local.js ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createLocalClient: () => (/* binding */ createLocalClient),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   getPool: () => (/* binding */ getPool),\n/* harmony export */   query: () => (/* binding */ query)\n/* harmony export */ });\n/* harmony import */ var pg__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! pg */ \"pg\");\n/* harmony import */ var pg__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(pg__WEBPACK_IMPORTED_MODULE_0__);\n// Local PostgreSQL Database Client\n// Used when LOCAL_MODE=true\n\nlet pool = null;\nfunction getPool() {\n    if (!pool) {\n        const connectionString = process.env.DATABASE_URL || \"postgresql://postgres:postgres@localhost:5432/asweallare\";\n        console.log(\"[DB-LOCAL] Creating pool with:\", connectionString.replace(/:[^:@]+@/, \":***@\"));\n        pool = new pg__WEBPACK_IMPORTED_MODULE_0__.Pool({\n            connectionString\n        });\n        pool.on(\"error\", (err)=>{\n            console.error(\"[DB-LOCAL] Pool error:\", err.message);\n        });\n    }\n    return pool;\n}\nasync function query(text, params) {\n    const pool = getPool();\n    try {\n        const result = await pool.query(text, params);\n        return result;\n    } catch (error) {\n        console.error(\"[DB-LOCAL] Query error:\", error.message);\n        console.error(\"[DB-LOCAL] Query was:\", text);\n        throw error;\n    }\n}\n// Helper to mimic Supabase response format\nfunction createLocalClient() {\n    return {\n        from: (table)=>new QueryBuilder(table),\n        auth: {\n            getUser: async ()=>{\n                // In local mode, return a mock admin user\n                return {\n                    data: {\n                        user: {\n                            id: \"00000000-0000-0000-0000-000000000001\",\n                            email: \"admin@local.dev\"\n                        }\n                    },\n                    error: null\n                };\n            },\n            getSession: async ()=>{\n                return {\n                    data: {\n                        session: {\n                            user: {\n                                id: \"00000000-0000-0000-0000-000000000001\",\n                                email: \"admin@local.dev\"\n                            }\n                        }\n                    },\n                    error: null\n                };\n            },\n            signOut: async ()=>({\n                    error: null\n                }),\n            onAuthStateChange: ()=>({\n                    data: {\n                        subscription: {\n                            unsubscribe: ()=>{}\n                        }\n                    }\n                })\n        }\n    };\n}\nclass QueryBuilder {\n    constructor(table){\n        this.table = table;\n        this._select = \"*\";\n        this._where = [];\n        this._whereParams = [];\n        this._order = null;\n        this._single = false;\n        this._limit = null;\n        this._returnData = true;\n        this._operation = null // 'update', 'delete', or null for select\n        ;\n        this._updateData = null;\n    }\n    select(columns = \"*\") {\n        // Handle Supabase-style nested selects by stripping them\n        // e.g., '*, piles(slug, name)' becomes '*'\n        if (columns.includes(\"(\")) {\n            this._select = columns.split(\",\").filter((c)=>!c.includes(\"(\")).map((c)=>c.trim()).join(\", \") || \"*\";\n        } else {\n            this._select = columns;\n        }\n        return this;\n    }\n    eq(column, value) {\n        this._whereParams.push(value);\n        this._where.push(`\"${column}\" = $${this._whereParams.length}`);\n        return this;\n    }\n    neq(column, value) {\n        this._whereParams.push(value);\n        this._where.push(`\"${column}\" != $${this._whereParams.length}`);\n        return this;\n    }\n    in(column, values) {\n        if (values && values.length > 0) {\n            const placeholders = values.map((_, i)=>`$${this._whereParams.length + i + 1}`).join(\", \");\n            this._whereParams.push(...values);\n            this._where.push(`\"${column}\" IN (${placeholders})`);\n        }\n        // If empty array, don't add any condition (will return all or be filtered by other conditions)\n        return this;\n    }\n    order(column, { ascending = true } = {}) {\n        this._order = `\"${column}\" ${ascending ? \"ASC\" : \"DESC\"}`;\n        return this;\n    }\n    limit(count) {\n        this._limit = count;\n        return this;\n    }\n    single() {\n        this._single = true;\n        this._limit = 1;\n        return this;\n    }\n    // Execute SELECT query\n    async then(resolve, reject) {\n        try {\n            let sql = `SELECT ${this._select} FROM \"${this.table}\"`;\n            if (this._where.length > 0) {\n                sql += ` WHERE ${this._where.join(\" AND \")}`;\n            }\n            if (this._order) {\n                sql += ` ORDER BY ${this._order}`;\n            }\n            if (this._limit) {\n                sql += ` LIMIT ${this._limit}`;\n            }\n            console.log(\"[DB-LOCAL] Executing:\", sql, \"with params:\", this._whereParams);\n            const result = await query(sql, this._whereParams);\n            if (this._single) {\n                resolve({\n                    data: result.rows[0] || null,\n                    error: null\n                });\n            } else {\n                resolve({\n                    data: result.rows,\n                    error: null\n                });\n            }\n        } catch (error) {\n            console.error(\"[DB-LOCAL] Query failed:\", error.message);\n            if (reject) {\n                reject(error);\n            } else {\n                resolve({\n                    data: null,\n                    error\n                });\n            }\n        }\n    }\n    async insert(data) {\n        try {\n            // Handle array of objects\n            const records = Array.isArray(data) ? data : [\n                data\n            ];\n            const results = [];\n            for (const record of records){\n                const keys = Object.keys(record);\n                const values = Object.values(record);\n                const placeholders = values.map((_, i)=>`$${i + 1}`).join(\", \");\n                const quotedKeys = keys.map((k)=>`\"${k}\"`).join(\", \");\n                const sql = `INSERT INTO \"${this.table}\" (${quotedKeys}) VALUES (${placeholders}) RETURNING *`;\n                console.log(\"[DB-LOCAL] Insert:\", sql);\n                const result = await query(sql, values);\n                results.push(result.rows[0]);\n            }\n            // Return a chainable object that mimics Supabase behavior\n            const insertResult = {\n                data: results,\n                error: null\n            };\n            return {\n                ...insertResult,\n                select: ()=>({\n                        single: ()=>Promise.resolve({\n                                data: results[0],\n                                error: null\n                            }),\n                        then: (resolve)=>resolve({\n                                data: results,\n                                error: null\n                            })\n                    }),\n                then: (resolve)=>resolve(insertResult)\n            };\n        } catch (error) {\n            console.error(\"[DB-LOCAL] Insert failed:\", error.message);\n            const errorResult = {\n                data: null,\n                error\n            };\n            return {\n                ...errorResult,\n                select: ()=>({\n                        single: ()=>Promise.resolve(errorResult),\n                        then: (resolve)=>resolve(errorResult)\n                    }),\n                then: (resolve)=>resolve(errorResult)\n            };\n        }\n    }\n    // Store update data for later execution\n    update(data) {\n        this._updateData = data;\n        this._operation = \"update\";\n        return this;\n    }\n    // Execute UPDATE query\n    async _executeUpdate() {\n        try {\n            const keys = Object.keys(this._updateData);\n            const values = Object.values(this._updateData);\n            const setClause = keys.map((k, i)=>`\"${k}\" = $${i + 1}`).join(\", \");\n            let sql = `UPDATE \"${this.table}\" SET ${setClause}`;\n            const params = [\n                ...values\n            ];\n            if (this._where.length > 0) {\n                // Adjust parameter indices for where clause\n                const whereWithOffset = this._where.map((w)=>{\n                    return w.replace(/\\$(\\d+)/g, (match, num)=>`$${parseInt(num) + values.length}`);\n                });\n                sql += ` WHERE ${whereWithOffset.join(\" AND \")}`;\n                params.push(...this._whereParams);\n            }\n            sql += \" RETURNING *\";\n            console.log(\"[DB-LOCAL] Update:\", sql, \"params:\", params);\n            const result = await query(sql, params);\n            return {\n                data: result.rows,\n                error: null\n            };\n        } catch (error) {\n            console.error(\"[DB-LOCAL] Update failed:\", error.message);\n            return {\n                data: null,\n                error\n            };\n        }\n    }\n    // Execute DELETE query\n    async _executeDelete() {\n        try {\n            let sql = `DELETE FROM \"${this.table}\"`;\n            if (this._where.length > 0) {\n                sql += ` WHERE ${this._where.join(\" AND \")}`;\n            }\n            sql += \" RETURNING *\";\n            console.log(\"[DB-LOCAL] Delete:\", sql);\n            const result = await query(sql, this._whereParams);\n            return {\n                data: result.rows,\n                error: null\n            };\n        } catch (error) {\n            console.error(\"[DB-LOCAL] Delete failed:\", error.message);\n            return {\n                data: null,\n                error\n            };\n        }\n    }\n    // Mark as delete operation\n    delete() {\n        this._operation = \"delete\";\n        return this;\n    }\n    // Execute SELECT query (and UPDATE/DELETE if flagged)\n    async then(resolve, reject) {\n        try {\n            // Handle update operation\n            if (this._operation === \"update\") {\n                const result = await this._executeUpdate();\n                resolve(result);\n                return;\n            }\n            // Handle delete operation\n            if (this._operation === \"delete\") {\n                const result = await this._executeDelete();\n                resolve(result);\n                return;\n            }\n            // Default: SELECT\n            let sql = `SELECT ${this._select} FROM \"${this.table}\"`;\n            if (this._where.length > 0) {\n                sql += ` WHERE ${this._where.join(\" AND \")}`;\n            }\n            if (this._order) {\n                sql += ` ORDER BY ${this._order}`;\n            }\n            if (this._limit) {\n                sql += ` LIMIT ${this._limit}`;\n            }\n            console.log(\"[DB-LOCAL] Executing:\", sql, \"with params:\", this._whereParams);\n            const result = await query(sql, this._whereParams);\n            if (this._single) {\n                resolve({\n                    data: result.rows[0] || null,\n                    error: null\n                });\n            } else {\n                resolve({\n                    data: result.rows,\n                    error: null\n                });\n            }\n        } catch (error) {\n            console.error(\"[DB-LOCAL] Query failed:\", error.message);\n            if (reject) {\n                reject(error);\n            } else {\n                resolve({\n                    data: null,\n                    error\n                });\n            }\n        }\n    }\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({\n    query,\n    getPool,\n    createLocalClient\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RUFBRTtnQkFDZmtDLE9BQU8sQ0FBQyxVQUFVLEVBQUUsSUFBSSxDQUFDbEMsTUFBTSxDQUFDLENBQUM7WUFDbkM7WUFFQSxJQUFJLElBQUksQ0FBQ0UsTUFBTSxFQUFFO2dCQUNmZ0MsT0FBTyxDQUFDLE9BQU8sRUFBRSxJQUFJLENBQUNoQyxNQUFNLENBQUMsQ0FBQztZQUNoQztZQUVBakMsUUFBUUMsR0FBRyxDQUFDLHlCQUF5QmdFLEtBQUssZ0JBQWdCLElBQUksQ0FBQ25DLFlBQVk7WUFDM0UsTUFBTXBCLFNBQVMsTUFBTUgsTUFBTTBELEtBQUssSUFBSSxDQUFDbkMsWUFBWTtZQUVqRCxJQUFJLElBQUksQ0FBQ0UsT0FBTyxFQUFFO2dCQUNoQitCLFFBQVE7b0JBQUU5QyxNQUFNUCxPQUFPd0QsSUFBSSxDQUFDLEVBQUUsSUFBSTtvQkFBTTdELE9BQU87Z0JBQUs7WUFDdEQsT0FBTztnQkFDTDBELFFBQVE7b0JBQUU5QyxNQUFNUCxPQUFPd0QsSUFBSTtvQkFBRTdELE9BQU87Z0JBQUs7WUFDM0M7UUFDRixFQUFFLE9BQU9BLE9BQU87WUFDZEwsUUFBUUssS0FBSyxDQUFDLDRCQUE0QkEsTUFBTUMsT0FBTztZQUN2RCxJQUFJMEQsUUFBUTtnQkFDVkEsT0FBTzNEO1lBQ1QsT0FBTztnQkFDTDBELFFBQVE7b0JBQUU5QyxNQUFNO29CQUFNWjtnQkFBTTtZQUM5QjtRQUNGO0lBQ0Y7QUFFRjtBQUVBLGlFQUFlO0lBQUVFO0lBQU9aO0lBQVNnQjtBQUFrQixDQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYXN3ZWFsbGFyZS1hZG1pbi8uL2xpYi9kYi1sb2NhbC5qcz82MTM2Il0sInNvdXJjZXNDb250ZW50IjpbIi8vIExvY2FsIFBvc3RncmVTUUwgRGF0YWJhc2UgQ2xpZW50XG4vLyBVc2VkIHdoZW4gTE9DQUxfTU9ERT10cnVlXG5cbmltcG9ydCB7IFBvb2wgfSBmcm9tICdwZydcblxubGV0IHBvb2wgPSBudWxsXG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRQb29sKCkge1xuICBpZiAoIXBvb2wpIHtcbiAgICBjb25zdCBjb25uZWN0aW9uU3RyaW5nID0gcHJvY2Vzcy5lbnYuREFUQUJBU0VfVVJMIHx8ICdwb3N0Z3Jlc3FsOi8vcG9zdGdyZXM6cG9zdGdyZXNAbG9jYWxob3N0OjU0MzIvYXN3ZWFsbGFyZSdcbiAgICBjb25zb2xlLmxvZygnW0RCLUxPQ0FMXSBDcmVhdGluZyBwb29sIHdpdGg6JywgY29ubmVjdGlvblN0cmluZy5yZXBsYWNlKC86W146QF0rQC8sICc6KioqQCcpKVxuICAgIHBvb2wgPSBuZXcgUG9vbCh7IGNvbm5lY3Rpb25TdHJpbmcgfSlcbiAgICBcbiAgICBwb29sLm9uKCdlcnJvcicsIChlcnIpID0+IHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1tEQi1MT0NBTF0gUG9vbCBlcnJvcjonLCBlcnIubWVzc2FnZSlcbiAgICB9KVxuICB9XG4gIHJldHVybiBwb29sXG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBxdWVyeSh0ZXh0LCBwYXJhbXMpIHtcbiAgY29uc3QgcG9vbCA9IGdldFBvb2woKVxuICB0cnkge1xuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHBvb2wucXVlcnkodGV4dCwgcGFyYW1zKVxuICAgIHJldHVybiByZXN1bHRcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdbREItTE9DQUxdIFF1ZXJ5IGVycm9yOicsIGVycm9yLm1lc3NhZ2UpXG4gICAgY29uc29sZS5lcnJvcignW0RCLUxPQ0FMXSBRdWVyeSB3YXM6JywgdGV4dClcbiAgICB0aHJvdyBlcnJvclxuICB9XG59XG5cbi8vIEhlbHBlciB0byBtaW1pYyBTdXBhYmFzZSByZXNwb25zZSBmb3JtYXRcbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVMb2NhbENsaWVudCgpIHtcbiAgcmV0dXJuIHtcbiAgICBmcm9tOiAodGFibGUpID0+IG5ldyBRdWVyeUJ1aWxkZXIodGFibGUpLFxuICAgIGF1dGg6IHtcbiAgICAgIGdldFVzZXI6IGFzeW5jICgpID0+IHtcbiAgICAgICAgLy8gSW4gbG9jYWwgbW9kZSwgcmV0dXJuIGEgbW9jayBhZG1pbiB1c2VyXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgdXNlcjoge1xuICAgICAgICAgICAgICBpZDogJzAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMScsXG4gICAgICAgICAgICAgIGVtYWlsOiAnYWRtaW5AbG9jYWwuZGV2J1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sXG4gICAgICAgICAgZXJyb3I6IG51bGxcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIGdldFNlc3Npb246IGFzeW5jICgpID0+IHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICBzZXNzaW9uOiB7XG4gICAgICAgICAgICAgIHVzZXI6IHtcbiAgICAgICAgICAgICAgICBpZDogJzAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMScsXG4gICAgICAgICAgICAgICAgZW1haWw6ICdhZG1pbkBsb2NhbC5kZXYnXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9LFxuICAgICAgICAgIGVycm9yOiBudWxsXG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBzaWduT3V0OiBhc3luYyAoKSA9PiAoeyBlcnJvcjogbnVsbCB9KSxcbiAgICAgIG9uQXV0aFN0YXRlQ2hhbmdlOiAoKSA9PiAoeyBkYXRhOiB7IHN1YnNjcmlwdGlvbjogeyB1bnN1YnNjcmliZTogKCkgPT4ge30gfSB9IH0pXG4gICAgfVxuICB9XG59XG5cbmNsYXNzIFF1ZXJ5QnVpbGRlciB7XG4gIGNvbnN0cnVjdG9yKHRhYmxlKSB7XG4gICAgdGhpcy50YWJsZSA9IHRhYmxlXG4gICAgdGhpcy5fc2VsZWN0ID0gJyonXG4gICAgdGhpcy5fd2hlcmUgPSBbXVxuICAgIHRoaXMuX3doZXJlUGFyYW1zID0gW11cbiAgICB0aGlzLl9vcmRlciA9IG51bGxcbiAgICB0aGlzLl9zaW5nbGUgPSBmYWxzZVxuICAgIHRoaXMuX2xpbWl0ID0gbnVsbFxuICAgIHRoaXMuX3JldHVybkRhdGEgPSB0cnVlXG4gICAgdGhpcy5fb3BlcmF0aW9uID0gbnVsbCAvLyAndXBkYXRlJywgJ2RlbGV0ZScsIG9yIG51bGwgZm9yIHNlbGVjdFxuICAgIHRoaXMuX3VwZGF0ZURhdGEgPSBudWxsXG4gIH1cblxuICBzZWxlY3QoY29sdW1ucyA9ICcqJykge1xuICAgIC8vIEhhbmRsZSBTdXBhYmFzZS1zdHlsZSBuZXN0ZWQgc2VsZWN0cyBieSBzdHJpcHBpbmcgdGhlbVxuICAgIC8vIGUuZy4sICcqLCBwaWxlcyhzbHVnLCBuYW1lKScgYmVjb21lcyAnKidcbiAgICBpZiAoY29sdW1ucy5pbmNsdWRlcygnKCcpKSB7XG4gICAgICB0aGlzLl9zZWxlY3QgPSBjb2x1bW5zLnNwbGl0KCcsJykuZmlsdGVyKGMgPT4gIWMuaW5jbHVkZXMoJygnKSkubWFwKGMgPT4gYy50cmltKCkpLmpvaW4oJywgJykgfHwgJyonXG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX3NlbGVjdCA9IGNvbHVtbnNcbiAgICB9XG4gICAgcmV0dXJuIHRoaXNcbiAgfVxuXG4gIGVxKGNvbHVtbiwgdmFsdWUpIHtcbiAgICB0aGlzLl93aGVyZVBhcmFtcy5wdXNoKHZhbHVlKVxuICAgIHRoaXMuX3doZXJlLnB1c2goYFwiJHtjb2x1bW59XCIgPSAkJHt0aGlzLl93aGVyZVBhcmFtcy5sZW5ndGh9YClcbiAgICByZXR1cm4gdGhpc1xuICB9XG5cbiAgbmVxKGNvbHVtbiwgdmFsdWUpIHtcbiAgICB0aGlzLl93aGVyZVBhcmFtcy5wdXNoKHZhbHVlKVxuICAgIHRoaXMuX3doZXJlLnB1c2goYFwiJHtjb2x1bW59XCIgIT0gJCR7dGhpcy5fd2hlcmVQYXJhbXMubGVuZ3RofWApXG4gICAgcmV0dXJuIHRoaXNcbiAgfVxuXG4gIGluKGNvbHVtbiwgdmFsdWVzKSB7XG4gICAgaWYgKHZhbHVlcyAmJiB2YWx1ZXMubGVuZ3RoID4gMCkge1xuICAgICAgY29uc3QgcGxhY2Vob2xkZXJzID0gdmFsdWVzLm1hcCgoXywgaSkgPT4gYCQke3RoaXMuX3doZXJlUGFyYW1zLmxlbmd0aCArIGkgKyAxfWApLmpvaW4oJywgJylcbiAgICAgIHRoaXMuX3doZXJlUGFyYW1zLnB1c2goLi4udmFsdWVzKVxuICAgICAgdGhpcy5fd2hlcmUucHVzaChgXCIke2NvbHVtbn1cIiBJTiAoJHtwbGFjZWhvbGRlcnN9KWApXG4gICAgfVxuICAgIC8vIElmIGVtcHR5IGFycmF5LCBkb24ndCBhZGQgYW55IGNvbmRpdGlvbiAod2lsbCByZXR1cm4gYWxsIG9yIGJlIGZpbHRlcmVkIGJ5IG90aGVyIGNvbmRpdGlvbnMpXG4gICAgcmV0dXJuIHRoaXNcbiAgfVxuXG4gIG9yZGVyKGNvbHVtbiwgeyBhc2NlbmRpbmcgPSB0cnVlIH0gPSB7fSkge1xuICAgIHRoaXMuX29yZGVyID0gYFwiJHtjb2x1bW59XCIgJHthc2NlbmRpbmcgPyAnQVNDJyA6ICdERVNDJ31gXG4gICAgcmV0dXJuIHRoaXNcbiAgfVxuXG4gIGxpbWl0KGNvdW50KSB7XG4gICAgdGhpcy5fbGltaXQgPSBjb3VudFxuICAgIHJldHVybiB0aGlzXG4gIH1cblxuICBzaW5nbGUoKSB7XG4gICAgdGhpcy5fc2luZ2xlID0gdHJ1ZVxuICAgIHRoaXMuX2xpbWl0ID0gMVxuICAgIHJldHVybiB0aGlzXG4gIH1cblxuICAvLyBFeGVjdXRlIFNFTEVDVCBxdWVyeVxuICBhc3luYyB0aGVuKHJlc29sdmUsIHJlamVjdCkge1xuICAgIHRyeSB7XG4gICAgICBsZXQgc3FsID0gYFNFTEVDVCAke3RoaXMuX3NlbGVjdH0gRlJPTSBcIiR7dGhpcy50YWJsZX1cImBcbiAgICAgIFxuICAgICAgaWYgKHRoaXMuX3doZXJlLmxlbmd0aCA+IDApIHtcbiAgICAgICAgc3FsICs9IGAgV0hFUkUgJHt0aGlzLl93aGVyZS5qb2luKCcgQU5EICcpfWBcbiAgICAgIH1cbiAgICAgIFxuICAgICAgaWYgKHRoaXMuX29yZGVyKSB7XG4gICAgICAgIHNxbCArPSBgIE9SREVSIEJZICR7dGhpcy5fb3JkZXJ9YFxuICAgICAgfVxuICAgICAgXG4gICAgICBpZiAodGhpcy5fbGltaXQpIHtcbiAgICAgICAgc3FsICs9IGAgTElNSVQgJHt0aGlzLl9saW1pdH1gXG4gICAgICB9XG5cbiAgICAgIGNvbnNvbGUubG9nKCdbREItTE9DQUxdIEV4ZWN1dGluZzonLCBzcWwsICd3aXRoIHBhcmFtczonLCB0aGlzLl93aGVyZVBhcmFtcylcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHF1ZXJ5KHNxbCwgdGhpcy5fd2hlcmVQYXJhbXMpXG4gICAgICBcbiAgICAgIGlmICh0aGlzLl9zaW5nbGUpIHtcbiAgICAgICAgcmVzb2x2ZSh7IGRhdGE6IHJlc3VsdC5yb3dzWzBdIHx8IG51bGwsIGVycm9yOiBudWxsIH0pXG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXNvbHZlKHsgZGF0YTogcmVzdWx0LnJvd3MsIGVycm9yOiBudWxsIH0pXG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1tEQi1MT0NBTF0gUXVlcnkgZmFpbGVkOicsIGVycm9yLm1lc3NhZ2UpXG4gICAgICBpZiAocmVqZWN0KSB7XG4gICAgICAgIHJlamVjdChlcnJvcilcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlc29sdmUoeyBkYXRhOiBudWxsLCBlcnJvciB9KVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGluc2VydChkYXRhKSB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIEhhbmRsZSBhcnJheSBvZiBvYmplY3RzXG4gICAgICBjb25zdCByZWNvcmRzID0gQXJyYXkuaXNBcnJheShkYXRhKSA/IGRhdGEgOiBbZGF0YV1cbiAgICAgIGNvbnN0IHJlc3VsdHMgPSBbXVxuICAgICAgXG4gICAgICBmb3IgKGNvbnN0IHJlY29yZCBvZiByZWNvcmRzKSB7XG4gICAgICAgIGNvbnN0IGtleXMgPSBPYmplY3Qua2V5cyhyZWNvcmQpXG4gICAgICAgIGNvbnN0IHZhbHVlcyA9IE9iamVjdC52YWx1ZXMocmVjb3JkKVxuICAgICAgICBjb25zdCBwbGFjZWhvbGRlcnMgPSB2YWx1ZXMubWFwKChfLCBpKSA9PiBgJCR7aSArIDF9YCkuam9pbignLCAnKVxuICAgICAgICBjb25zdCBxdW90ZWRLZXlzID0ga2V5cy5tYXAoayA9PiBgXCIke2t9XCJgKS5qb2luKCcsICcpXG4gICAgICAgIFxuICAgICAgICBjb25zdCBzcWwgPSBgSU5TRVJUIElOVE8gXCIke3RoaXMudGFibGV9XCIgKCR7cXVvdGVkS2V5c30pIFZBTFVFUyAoJHtwbGFjZWhvbGRlcnN9KSBSRVRVUk5JTkcgKmBcbiAgICAgICAgY29uc29sZS5sb2coJ1tEQi1MT0NBTF0gSW5zZXJ0OicsIHNxbClcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcXVlcnkoc3FsLCB2YWx1ZXMpXG4gICAgICAgIHJlc3VsdHMucHVzaChyZXN1bHQucm93c1swXSlcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8gUmV0dXJuIGEgY2hhaW5hYmxlIG9iamVjdCB0aGF0IG1pbWljcyBTdXBhYmFzZSBiZWhhdmlvclxuICAgICAgY29uc3QgaW5zZXJ0UmVzdWx0ID0geyBkYXRhOiByZXN1bHRzLCBlcnJvcjogbnVsbCB9XG4gICAgICByZXR1cm4ge1xuICAgICAgICAuLi5pbnNlcnRSZXN1bHQsXG4gICAgICAgIHNlbGVjdDogKCkgPT4gKHtcbiAgICAgICAgICBzaW5nbGU6ICgpID0+IFByb21pc2UucmVzb2x2ZSh7IGRhdGE6IHJlc3VsdHNbMF0sIGVycm9yOiBudWxsIH0pLFxuICAgICAgICAgIHRoZW46IChyZXNvbHZlKSA9PiByZXNvbHZlKHsgZGF0YTogcmVzdWx0cywgZXJyb3I6IG51bGwgfSlcbiAgICAgICAgfSksXG4gICAgICAgIHRoZW46IChyZXNvbHZlKSA9PiByZXNvbHZlKGluc2VydFJlc3VsdClcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignW0RCLUxPQ0FMXSBJbnNlcnQgZmFpbGVkOicsIGVycm9yLm1lc3NhZ2UpXG4gICAgICBjb25zdCBlcnJvclJlc3VsdCA9IHsgZGF0YTogbnVsbCwgZXJyb3IgfVxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgLi4uZXJyb3JSZXN1bHQsXG4gICAgICAgIHNlbGVjdDogKCkgPT4gKHtcbiAgICAgICAgICBzaW5nbGU6ICgpID0+IFByb21pc2UucmVzb2x2ZShlcnJvclJlc3VsdCksXG4gICAgICAgICAgdGhlbjogKHJlc29sdmUpID0+IHJlc29sdmUoZXJyb3JSZXN1bHQpXG4gICAgICAgIH0pLFxuICAgICAgICB0aGVuOiAocmVzb2x2ZSkgPT4gcmVzb2x2ZShlcnJvclJlc3VsdClcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvLyBTdG9yZSB1cGRhdGUgZGF0YSBmb3IgbGF0ZXIgZXhlY3V0aW9uXG4gIHVwZGF0ZShkYXRhKSB7XG4gICAgdGhpcy5fdXBkYXRlRGF0YSA9IGRhdGFcbiAgICB0aGlzLl9vcGVyYXRpb24gPSAndXBkYXRlJ1xuICAgIHJldHVybiB0aGlzXG4gIH1cblxuICAvLyBFeGVjdXRlIFVQREFURSBxdWVyeVxuICBhc3luYyBfZXhlY3V0ZVVwZGF0ZSgpIHtcbiAgICB0cnkge1xuICAgICAgY29uc3Qga2V5cyA9IE9iamVjdC5rZXlzKHRoaXMuX3VwZGF0ZURhdGEpXG4gICAgICBjb25zdCB2YWx1ZXMgPSBPYmplY3QudmFsdWVzKHRoaXMuX3VwZGF0ZURhdGEpXG4gICAgICBjb25zdCBzZXRDbGF1c2UgPSBrZXlzLm1hcCgoaywgaSkgPT4gYFwiJHtrfVwiID0gJCR7aSArIDF9YCkuam9pbignLCAnKVxuICAgICAgXG4gICAgICBsZXQgc3FsID0gYFVQREFURSBcIiR7dGhpcy50YWJsZX1cIiBTRVQgJHtzZXRDbGF1c2V9YFxuICAgICAgY29uc3QgcGFyYW1zID0gWy4uLnZhbHVlc11cbiAgICAgIFxuICAgICAgaWYgKHRoaXMuX3doZXJlLmxlbmd0aCA+IDApIHtcbiAgICAgICAgLy8gQWRqdXN0IHBhcmFtZXRlciBpbmRpY2VzIGZvciB3aGVyZSBjbGF1c2VcbiAgICAgICAgY29uc3Qgd2hlcmVXaXRoT2Zmc2V0ID0gdGhpcy5fd2hlcmUubWFwKHcgPT4ge1xuICAgICAgICAgIHJldHVybiB3LnJlcGxhY2UoL1xcJChcXGQrKS9nLCAobWF0Y2gsIG51bSkgPT4gYCQke3BhcnNlSW50KG51bSkgKyB2YWx1ZXMubGVuZ3RofWApXG4gICAgICAgIH0pXG4gICAgICAgIHNxbCArPSBgIFdIRVJFICR7d2hlcmVXaXRoT2Zmc2V0LmpvaW4oJyBBTkQgJyl9YFxuICAgICAgICBwYXJhbXMucHVzaCguLi50aGlzLl93aGVyZVBhcmFtcylcbiAgICAgIH1cbiAgICAgIFxuICAgICAgc3FsICs9ICcgUkVUVVJOSU5HIConXG4gICAgICBjb25zb2xlLmxvZygnW0RCLUxPQ0FMXSBVcGRhdGU6Jywgc3FsLCAncGFyYW1zOicsIHBhcmFtcylcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHF1ZXJ5KHNxbCwgcGFyYW1zKVxuICAgICAgXG4gICAgICByZXR1cm4geyBkYXRhOiByZXN1bHQucm93cywgZXJyb3I6IG51bGwgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdbREItTE9DQUxdIFVwZGF0ZSBmYWlsZWQ6JywgZXJyb3IubWVzc2FnZSlcbiAgICAgIHJldHVybiB7IGRhdGE6IG51bGwsIGVycm9yIH1cbiAgICB9XG4gIH1cblxuICAvLyBFeGVjdXRlIERFTEVURSBxdWVyeVxuICBhc3luYyBfZXhlY3V0ZURlbGV0ZSgpIHtcbiAgICB0cnkge1xuICAgICAgbGV0IHNxbCA9IGBERUxFVEUgRlJPTSBcIiR7dGhpcy50YWJsZX1cImBcbiAgICAgIFxuICAgICAgaWYgKHRoaXMuX3doZXJlLmxlbmd0aCA+IDApIHtcbiAgICAgICAgc3FsICs9IGAgV0hFUkUgJHt0aGlzLl93aGVyZS5qb2luKCcgQU5EICcpfWBcbiAgICAgIH1cbiAgICAgIFxuICAgICAgc3FsICs9ICcgUkVUVVJOSU5HIConXG4gICAgICBjb25zb2xlLmxvZygnW0RCLUxPQ0FMXSBEZWxldGU6Jywgc3FsKVxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcXVlcnkoc3FsLCB0aGlzLl93aGVyZVBhcmFtcylcbiAgICAgIFxuICAgICAgcmV0dXJuIHsgZGF0YTogcmVzdWx0LnJvd3MsIGVycm9yOiBudWxsIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignW0RCLUxPQ0FMXSBEZWxldGUgZmFpbGVkOicsIGVycm9yLm1lc3NhZ2UpXG4gICAgICByZXR1cm4geyBkYXRhOiBudWxsLCBlcnJvciB9XG4gICAgfVxuICB9XG5cbiAgLy8gTWFyayBhcyBkZWxldGUgb3BlcmF0aW9uXG4gIGRlbGV0ZSgpIHtcbiAgICB0aGlzLl9vcGVyYXRpb24gPSAnZGVsZXRlJ1xuICAgIHJldHVybiB0aGlzXG4gIH1cblxuICAvLyBFeGVjdXRlIFNFTEVDVCBxdWVyeSAoYW5kIFVQREFURS9ERUxFVEUgaWYgZmxhZ2dlZClcbiAgYXN5bmMgdGhlbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICB0cnkge1xuICAgICAgLy8gSGFuZGxlIHVwZGF0ZSBvcGVyYXRpb25cbiAgICAgIGlmICh0aGlzLl9vcGVyYXRpb24gPT09ICd1cGRhdGUnKSB7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuX2V4ZWN1dGVVcGRhdGUoKVxuICAgICAgICByZXNvbHZlKHJlc3VsdClcbiAgICAgICAgcmV0dXJuXG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIEhhbmRsZSBkZWxldGUgb3BlcmF0aW9uXG4gICAgICBpZiAodGhpcy5fb3BlcmF0aW9uID09PSAnZGVsZXRlJykge1xuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLl9leGVjdXRlRGVsZXRlKClcbiAgICAgICAgcmVzb2x2ZShyZXN1bHQpXG4gICAgICAgIHJldHVyblxuICAgICAgfVxuICAgICAgXG4gICAgICAvLyBEZWZhdWx0OiBTRUxFQ1RcbiAgICAgIGxldCBzcWwgPSBgU0VMRUNUICR7dGhpcy5fc2VsZWN0fSBGUk9NIFwiJHt0aGlzLnRhYmxlfVwiYFxuICAgICAgXG4gICAgICBpZiAodGhpcy5fd2hlcmUubGVuZ3RoID4gMCkge1xuICAgICAgICBzcWwgKz0gYCBXSEVSRSAke3RoaXMuX3doZXJlLmpvaW4oJyBBTkQgJyl9YFxuICAgICAgfVxuICAgICAgXG4gICAgICBpZiAodGhpcy5fb3JkZXIpIHtcbiAgICAgICAgc3FsICs9IGAgT1JERVIgQlkgJHt0aGlzLl9vcmRlcn1gXG4gICAgICB9XG4gICAgICBcbiAgICAgIGlmICh0aGlzLl9saW1pdCkge1xuICAgICAgICBzcWwgKz0gYCBMSU1JVCAke3RoaXMuX2xpbWl0fWBcbiAgICAgIH1cblxuICAgICAgY29uc29sZS5sb2coJ1tEQi1MT0NBTF0gRXhlY3V0aW5nOicsIHNxbCwgJ3dpdGggcGFyYW1zOicsIHRoaXMuX3doZXJlUGFyYW1zKVxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcXVlcnkoc3FsLCB0aGlzLl93aGVyZVBhcmFtcylcbiAgICAgIFxuICAgICAgaWYgKHRoaXMuX3NpbmdsZSkge1xuICAgICAgICByZXNvbHZlKHsgZGF0YTogcmVzdWx0LnJvd3NbMF0gfHwgbnVsbCwgZXJyb3I6IG51bGwgfSlcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlc29sdmUoeyBkYXRhOiByZXN1bHQucm93cywgZXJyb3I6IG51bGwgfSlcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignW0RCLUxPQ0FMXSBRdWVyeSBmYWlsZWQ6JywgZXJyb3IubWVzc2FnZSlcbiAgICAgIGlmIChyZWplY3QpIHtcbiAgICAgICAgcmVqZWN0KGVycm9yKVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmVzb2x2ZSh7IGRhdGE6IG51bGwsIGVycm9yIH0pXG4gICAgICB9XG4gICAgfVxuICB9XG5cbn1cblxuZXhwb3J0IGRlZmF1bHQgeyBxdWVyeSwgZ2V0UG9vbCwgY3JlYXRlTG9jYWxDbGllbnQgfSJdLCJuYW1lcyI6WyJQb29sIiwicG9vbCIsImdldFBvb2wiLCJjb25uZWN0aW9uU3RyaW5nIiwicHJvY2VzcyIsImVudiIsIkRBVEFCQVNFX1VSTCIsImNvbnNvbGUiLCJsb2ciLCJyZXBsYWNlIiwib24iLCJlcnIiLCJlcnJvciIsIm1lc3NhZ2UiLCJxdWVyeSIsInRleHQiLCJwYXJhbXMiLCJyZXN1bHQiLCJjcmVhdGVMb2NhbENsaWVudCIsImZyb20iLCJ0YWJsZSIsIlF1ZXJ5QnVpbGRlciIsImF1dGgiLCJnZXRVc2VyIiwiZGF0YSIsInVzZXIiLCJpZCIsImVtYWlsIiwiZ2V0U2Vzc2lvbiIsInNlc3Npb24iLCJzaWduT3V0Iiwib25BdXRoU3RhdGVDaGFuZ2UiLCJzdWJzY3JpcHRpb24iLCJ1bnN1YnNjcmliZSIsImNvbnN0cnVjdG9yIiwiX3NlbGVjdCIsIl93aGVyZSIsIl93aGVyZVBhcmFtcyIsIl9vcmRlciIsIl9zaW5nbGUiLCJfbGltaXQiLCJfcmV0dXJuRGF0YSIsIl9vcGVyYXRpb24iLCJfdXBkYXRlRGF0YSIsInNlbGVjdCIsImNvbHVtbnMiLCJpbmNsdWRlcyIsInNwbGl0IiwiZmlsdGVyIiwiYyIsIm1hcCIsInRyaW0iLCJqb2luIiwiZXEiLCJjb2x1bW4iLCJ2YWx1ZSIsInB1c2giLCJsZW5ndGgiLCJuZXEiLCJpbiIsInZhbHVlcyIsInBsYWNlaG9sZGVycyIsIl8iLCJpIiwib3JkZXIiLCJhc2NlbmRpbmciLCJsaW1pdCIsImNvdW50Iiwic2luZ2xlIiwidGhlbiIsInJlc29sdmUiLCJyZWplY3QiLCJzcWwiLCJyb3dzIiwiaW5zZXJ0IiwicmVjb3JkcyIsIkFycmF5IiwiaXNBcnJheSIsInJlc3VsdHMiLCJyZWNvcmQiLCJrZXlzIiwiT2JqZWN0IiwicXVvdGVkS2V5cyIsImsiLCJpbnNlcnRSZXN1bHQiLCJQcm9taXNlIiwiZXJyb3JSZXN1bHQiLCJ1cGRhdGUiLCJfZXhlY3V0ZVVwZGF0ZSIsInNldENsYXVzZSIsIndoZXJlV2l0aE9mZnNldCIsInciLCJtYXRjaCIsIm51bSIsInBhcnNlSW50IiwiX2V4ZWN1dGVEZWxldGUiLCJkZWxldGUiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/db-local.js\n");

/***/ })

};
;